(()=>{var Rn=Object.create;var en=Object.defineProperty;var Dn=Object.getOwnPropertyDescriptor;var In=Object.getOwnPropertyNames;var Ln=Object.getPrototypeOf,An=Object.prototype.hasOwnProperty;var tn=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Mn=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of In(e))!An.call(r,s)&&s!==t&&en(r,s,{get:()=>e[s],enumerable:!(i=Dn(e,s))||i.enumerable});return r};var Nn=(r,e,t)=>(t=r!=null?Rn(Ln(r)):{},Mn(e||!r||!r.__esModule?en(t,"default",{value:r,enumerable:!0}):t,r));var sn=tn((Si,$i)=>{(function(r,e){typeof Si=="object"&&typeof $i!="undefined"?$i.exports=e():typeof define=="function"&&define.amd?define(e):(r=r||self).Sortable=e()})(Si,function(){"use strict";function r(n,o){var a,u=Object.keys(n);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(n),o&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),u.push.apply(u,a)),u}function e(n){for(var o=1;o<arguments.length;o++){var a=arguments[o]!=null?arguments[o]:{};o%2?r(Object(a),!0).forEach(function(u){var c,p;c=n,u=a[p=u],p in c?Object.defineProperty(c,p,{value:u,enumerable:!0,configurable:!0,writable:!0}):c[p]=u}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(a,u))})}return n}function t(n){return(t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(n)}function i(){return(i=Object.assign||function(n){for(var o=1;o<arguments.length;o++){var a,u=arguments[o];for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(n[a]=u[a])}return n}).apply(this,arguments)}function s(n,o){if(n==null)return{};var a,u=function(m,g){if(m==null)return{};for(var x,R={},D=Object.keys(m),j=0;j<D.length;j++)x=D[j],0<=g.indexOf(x)||(R[x]=m[x]);return R}(n,o);if(Object.getOwnPropertySymbols)for(var c=Object.getOwnPropertySymbols(n),p=0;p<c.length;p++)a=c[p],0<=o.indexOf(a)||Object.prototype.propertyIsEnumerable.call(n,a)&&(u[a]=n[a]);return u}function l(n){return function(o){if(Array.isArray(o))return d(o)}(n)||function(o){if(typeof Symbol!="undefined"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}(n)||function(o,a){if(o){if(typeof o=="string")return d(o,a);var u=Object.prototype.toString.call(o).slice(8,-1);return(u=u==="Object"&&o.constructor?o.constructor.name:u)==="Map"||u==="Set"?Array.from(o):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?d(o,a):void 0}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(n,o){(o==null||o>n.length)&&(o=n.length);for(var a=0,u=new Array(o);a<o;a++)u[a]=n[a];return u}function h(n){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(n)}var f=h(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),b=h(/Edge/i),v=h(/firefox/i),y=h(/safari/i)&&!h(/chrome/i)&&!h(/android/i),S=h(/iP(ad|od|hone)/i),ot=h(/chrome/i)&&h(/android/i),T={capture:!1,passive:!1};function C(n,o,a){n.addEventListener(o,a,!f&&T)}function w(n,o,a){n.removeEventListener(o,a,!f&&T)}function L(n,o){if(o&&(o[0]===">"&&(o=o.substring(1)),n))try{if(n.matches)return n.matches(o);if(n.msMatchesSelector)return n.msMatchesSelector(o);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(o)}catch(a){return}}function A(n,o,a,u){if(n){a=a||document;do if(o!=null&&(o[0]!==">"||n.parentNode===a)&&L(n,o)||u&&n===a)return n;while(n!==a&&(n=(c=n).host&&c!==document&&c.host.nodeType?c.host:c.parentNode))}var c;return null}var W,q=/\s+/g;function M(n,o,a){var u;n&&o&&(n.classList?n.classList[a?"add":"remove"](o):(u=(" "+n.className+" ").replace(q," ").replace(" "+o+" "," "),n.className=(u+(a?" "+o:"")).replace(q," ")))}function k(n,o,a){var u=n&&n.style;if(u){if(a===void 0)return document.defaultView&&document.defaultView.getComputedStyle?a=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(a=n.currentStyle),o===void 0?a:a[o];u[o=o in u||o.indexOf("webkit")!==-1?o:"-webkit-"+o]=a+(typeof a=="string"?"":"px")}}function N(n,o){var a="";if(typeof n=="string")a=n;else do var u=k(n,"transform");while(u&&u!=="none"&&(a=u+" "+a),!o&&(n=n.parentNode));var c=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return c&&new c(a)}function oe(n,o,a){if(n){var u=n.getElementsByTagName(o),c=0,p=u.length;if(a)for(;c<p;c++)a(u[c],c);return u}return[]}function re(){var n=document.scrollingElement;return n||document.documentElement}function B(n,o,a,u,c){if(n.getBoundingClientRect||n===window){var p,m,g,x,R,D,j=n!==window&&n.parentNode&&n!==re()?(m=(p=n.getBoundingClientRect()).top,g=p.left,x=p.bottom,R=p.right,D=p.height,p.width):(g=m=0,x=window.innerHeight,R=window.innerWidth,D=window.innerHeight,window.innerWidth);if((o||a)&&n!==window&&(c=c||n.parentNode,!f))do if(c&&c.getBoundingClientRect&&(k(c,"transform")!=="none"||a&&k(c,"position")!=="static")){var z=c.getBoundingClientRect();m-=z.top+parseInt(k(c,"border-top-width")),g-=z.left+parseInt(k(c,"border-left-width")),x=m+p.height,R=g+p.width;break}while(c=c.parentNode);return u&&n!==window&&(u=(o=N(c||n))&&o.a,n=o&&o.d,o&&(x=(m/=n)+(D/=n),R=(g/=u)+(j/=u))),{top:m,left:g,bottom:x,right:R,width:j,height:D}}}function Ne(n,o,a){for(var u=De(n,!0),c=B(n)[o];u;){var p=B(u)[a];if(!(a==="top"||a==="left"?p<=c:c<=p))return u;if(u===re())break;u=De(u,!1)}return!1}function We(n,o,a,u){for(var c=0,p=0,m=n.children;p<m.length;){if(m[p].style.display!=="none"&&m[p]!==I.ghost&&(u||m[p]!==I.dragged)&&A(m[p],a.draggable,n,!1)){if(c===o)return m[p];c++}p++}return null}function Yt(n,o){for(var a=n.lastElementChild;a&&(a===I.ghost||k(a,"display")==="none"||o&&!L(a,o));)a=a.previousElementSibling;return a||null}function J(n,o){var a=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()==="TEMPLATE"||n===I.clone||o&&!L(n,o)||a++;return a}function ji(n){var o=0,a=0,u=re();if(n)do var p=N(n),c=p.a,p=p.d;while(o+=n.scrollLeft*c,a+=n.scrollTop*p,n!==u&&(n=n.parentNode));return[o,a]}function De(n,o){if(!n||!n.getBoundingClientRect)return re();var a=n,u=!1;do if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var c=k(a);if(a.clientWidth<a.scrollWidth&&(c.overflowX=="auto"||c.overflowX=="scroll")||a.clientHeight<a.scrollHeight&&(c.overflowY=="auto"||c.overflowY=="scroll")){if(!a.getBoundingClientRect||a===document.body)return re();if(u||o)return a;u=!0}}while(a=a.parentNode);return re()}function Ut(n,o){return Math.round(n.top)===Math.round(o.top)&&Math.round(n.left)===Math.round(o.left)&&Math.round(n.height)===Math.round(o.height)&&Math.round(n.width)===Math.round(o.width)}function Pi(n,o){return function(){var a;W||((a=arguments).length===1?n.call(this,a[0]):n.apply(this,a),W=setTimeout(function(){W=void 0},o))}}function Wi(n,o,a){n.scrollLeft+=o,n.scrollTop+=a}function Xt(n){var o=window.Polymer,a=window.jQuery||window.Zepto;return o&&o.dom?o.dom(n).cloneNode(!0):a?a(n).clone(!0)[0]:n.cloneNode(!0)}function Bi(n,o){k(n,"position","absolute"),k(n,"top",o.top),k(n,"left",o.left),k(n,"width",o.width),k(n,"height",o.height)}function Gt(n){k(n,"position",""),k(n,"top",""),k(n,"left",""),k(n,"width",""),k(n,"height","")}var ae="Sortable"+new Date().getTime();function Cn(){var n,o=[];return{captureAnimationState:function(){o=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(a){var u,c;k(a,"display")!=="none"&&a!==I.ghost&&(o.push({target:a,rect:B(a)}),u=e({},o[o.length-1].rect),!a.thisAnimationDuration||(c=N(a,!0))&&(u.top-=c.f,u.left-=c.e),a.fromRect=u)})},addAnimationState:function(a){o.push(a)},removeAnimationState:function(a){o.splice(function(u,c){for(var p in u)if(u.hasOwnProperty(p)){for(var m in c)if(c.hasOwnProperty(m)&&c[m]===u[p][m])return Number(p)}return-1}(o,{target:a}),1)},animateAll:function(a){var u=this;if(!this.options.animation)return clearTimeout(n),void(typeof a=="function"&&a());var c=!1,p=0;o.forEach(function(m){var g=0,x=m.target,R=x.fromRect,D=B(x),j=x.prevFromRect,z=x.prevToRect,H=m.rect,G=N(x,!0);G&&(D.top-=G.f,D.left-=G.e),x.toRect=D,x.thisAnimationDuration&&Ut(j,D)&&!Ut(R,D)&&(H.top-D.top)/(H.left-D.left)==(R.top-D.top)/(R.left-D.left)&&(m=H,G=j,j=z,z=u.options,g=Math.sqrt(Math.pow(G.top-m.top,2)+Math.pow(G.left-m.left,2))/Math.sqrt(Math.pow(G.top-j.top,2)+Math.pow(G.left-j.left,2))*z.animation),Ut(D,R)||(x.prevFromRect=R,x.prevToRect=D,g=g||u.options.animation,u.animate(x,H,D,g)),g&&(c=!0,p=Math.max(p,g),clearTimeout(x.animationResetTimer),x.animationResetTimer=setTimeout(function(){x.animationTime=0,x.prevFromRect=null,x.fromRect=null,x.prevToRect=null,x.thisAnimationDuration=null},g),x.thisAnimationDuration=g)}),clearTimeout(n),c?n=setTimeout(function(){typeof a=="function"&&a()},p):typeof a=="function"&&a(),o=[]},animate:function(a,u,c,p){var m,g;p&&(k(a,"transition",""),k(a,"transform",""),m=(g=N(this.el))&&g.a,g=g&&g.d,m=(u.left-c.left)/(m||1),g=(u.top-c.top)/(g||1),a.animatingX=!!m,a.animatingY=!!g,k(a,"transform","translate3d("+m+"px,"+g+"px,0)"),this.forRepaintDummy=a.offsetWidth,k(a,"transition","transform "+p+"ms"+(this.options.easing?" "+this.options.easing:"")),k(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){k(a,"transition",""),k(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},p))}}}var Be=[],Kt={initializeByDefault:!0},Qe={mount:function(n){for(var o in Kt)!Kt.hasOwnProperty(o)||o in n||(n[o]=Kt[o]);Be.forEach(function(a){if(a.pluginName===n.pluginName)throw"Sortable: Cannot mount plugin ".concat(n.pluginName," more than once")}),Be.push(n)},pluginEvent:function(n,o,a){var u=this;this.eventCanceled=!1,a.cancel=function(){u.eventCanceled=!0};var c=n+"Global";Be.forEach(function(p){o[p.pluginName]&&(o[p.pluginName][c]&&o[p.pluginName][c](e({sortable:o},a)),o.options[p.pluginName]&&o[p.pluginName][n]&&o[p.pluginName][n](e({sortable:o},a)))})},initializePlugins:function(n,o,a,u){for(var c in Be.forEach(function(m){var g=m.pluginName;(n.options[g]||m.initializeByDefault)&&((m=new m(n,o,n.options)).sortable=n,m.options=n.options,n[g]=m,i(a,m.defaults))}),n.options){var p;n.options.hasOwnProperty(c)&&(p=this.modifyOption(n,c,n.options[c]))!==void 0&&(n.options[c]=p)}},getEventProperties:function(n,o){var a={};return Be.forEach(function(u){typeof u.eventProperties=="function"&&i(a,u.eventProperties.call(o[u.pluginName],n))}),a},modifyOption:function(n,o,a){var u;return Be.forEach(function(c){n[c.pluginName]&&c.optionListeners&&typeof c.optionListeners[o]=="function"&&(u=c.optionListeners[o].call(n[c.pluginName],a))}),u}};function Ze(n){var o=n.sortable,a=n.rootEl,u=n.name,c=n.targetEl,p=n.cloneEl,m=n.toEl,g=n.fromEl,x=n.oldIndex,R=n.newIndex,D=n.oldDraggableIndex,j=n.newDraggableIndex,z=n.originalEvent,H=n.putSortable,G=n.extraEventProperties;if(o=o||a&&a[ae]){var P,ee=o.options,n="on"+u.charAt(0).toUpperCase()+u.substr(1);!window.CustomEvent||f||b?(P=document.createEvent("Event")).initEvent(u,!0,!0):P=new CustomEvent(u,{bubbles:!0,cancelable:!0}),P.to=m||a,P.from=g||a,P.item=c||a,P.clone=p,P.oldIndex=x,P.newIndex=R,P.oldDraggableIndex=D,P.newDraggableIndex=j,P.originalEvent=z,P.pullMode=H?H.lastPutMode:void 0;var _e,V=e(e({},G),Qe.getEventProperties(u,o));for(_e in V)P[_e]=V[_e];a&&a.dispatchEvent(P),ee[n]&&ee[n].call(o,P)}}function he(n,o){var a=(u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{}).evt,u=s(u,xn);Qe.pluginEvent.bind(I)(n,o,e({dragEl:E,parentEl:Q,ghostEl:F,rootEl:U,nextEl:Oe,lastDownEl:Ct,cloneEl:Z,cloneHidden:Ie,dragStarted:tt,putSortable:ce,activeSortable:I.active,originalEvent:a,oldIndex:ze,oldDraggableIndex:et,newIndex:pe,newDraggableIndex:Le,hideGhostForTarget:Gi,unhideGhostForTarget:Ki,cloneNowHidden:function(){Ie=!0},cloneNowShown:function(){Ie=!1},dispatchSortableEvent:function(c){de({sortable:o,name:c,originalEvent:a})}},u))}var xn=["evt"];function de(n){Ze(e({putSortable:ce,cloneEl:Z,targetEl:E,rootEl:U,oldIndex:ze,oldDraggableIndex:et,newIndex:pe,newDraggableIndex:Le},n))}var E,Q,F,U,Oe,Ct,Z,Ie,ze,pe,et,Le,xt,ce,He,ve,Jt,Qt,zi,qi,tt,qe,it,St,le,Ve=!1,$t=!1,kt=[],nt=!1,Tt=!1,Zt=[],ei=!1,Et=[],Rt=typeof document!="undefined",Dt=S,Vi=b||f?"cssFloat":"float",Sn=Rt&&!ot&&!S&&"draggable"in document.createElement("div"),Yi=function(){if(Rt){if(f)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),Ui=function(R,o){var a=k(R),u=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),c=We(R,0,o),p=We(R,1,o),m=c&&k(c),g=p&&k(p),x=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+B(c).width,R=g&&parseInt(g.marginLeft)+parseInt(g.marginRight)+B(p).width;return a.display==="flex"?a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal":a.display==="grid"?a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal":c&&m.float&&m.float!=="none"?(o=m.float==="left"?"left":"right",!p||g.clear!=="both"&&g.clear!==o?"horizontal":"vertical"):c&&(m.display==="block"||m.display==="flex"||m.display==="table"||m.display==="grid"||u<=x&&a[Vi]==="none"||p&&a[Vi]==="none"&&u<x+R)?"vertical":"horizontal"},Xi=function(n){function o(c,p){return function(m,g,x,R){var D=m.options.group.name&&g.options.group.name&&m.options.group.name===g.options.group.name;return c==null&&(p||D)?!0:c==null||c===!1?!1:p&&c==="clone"?c:typeof c=="function"?o(c(m,g,x,R),p)(m,g,x,R):(g=(p?m:g).options.group.name,c===!0||typeof c=="string"&&c===g||c.join&&-1<c.indexOf(g))}}var a={},u=n.group;u&&t(u)=="object"||(u={name:u}),a.name=u.name,a.checkPull=o(u.pull,!0),a.checkPut=o(u.put),a.revertClone=u.revertClone,n.group=a},Gi=function(){!Yi&&F&&k(F,"display","none")},Ki=function(){!Yi&&F&&k(F,"display","")};Rt&&!ot&&document.addEventListener("click",function(n){if($t)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),$t=!1},!0);function Fe(n){if(E){n=n.touches?n.touches[0]:n;var o=(c=n.clientX,p=n.clientY,kt.some(function(g){var x=g[ae].options.emptyInsertThreshold;if(x&&!Yt(g)){var R=B(g),D=c>=R.left-x&&c<=R.right+x,x=p>=R.top-x&&p<=R.bottom+x;return D&&x?m=g:void 0}}),m);if(o){var a,u={};for(a in n)n.hasOwnProperty(a)&&(u[a]=n[a]);u.target=u.rootEl=o,u.preventDefault=void 0,u.stopPropagation=void 0,o[ae]._onDragOver(u)}}var c,p,m}function $n(n){E&&E.parentNode[ae]._isOutsideThisEl(n.target)}function I(n,o){if(!n||!n.nodeType||n.nodeType!==1)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=o=i({},o),n[ae]=this;var a,u,c={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ui(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(p,m){p.setData("Text",m.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:I.supportPointer!==!1&&"PointerEvent"in window&&!y,emptyInsertThreshold:5};for(a in Qe.initializePlugins(this,n,c),c)a in o||(o[a]=c[a]);for(u in Xi(o),this)u.charAt(0)==="_"&&typeof this[u]=="function"&&(this[u]=this[u].bind(this));this.nativeDraggable=!o.forceFallback&&Sn,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?C(n,"pointerdown",this._onTapStart):(C(n,"mousedown",this._onTapStart),C(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(C(n,"dragover",this),C(n,"dragenter",this)),kt.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[]),i(this,Cn())}function It(n,o,a,u,c,p,m,g){var x,R,D=n[ae],j=D.options.onMove;return!window.CustomEvent||f||b?(x=document.createEvent("Event")).initEvent("move",!0,!0):x=new CustomEvent("move",{bubbles:!0,cancelable:!0}),x.to=o,x.from=n,x.dragged=a,x.draggedRect=u,x.related=c||o,x.relatedRect=p||B(o),x.willInsertAfter=g,x.originalEvent=m,n.dispatchEvent(x),R=j?j.call(D,x,m):R}function ti(n){n.draggable=!1}function kn(){ei=!1}function Lt(n){return setTimeout(n,0)}function ii(n){return clearTimeout(n)}I.prototype={constructor:I,_isOutsideThisEl:function(n){this.el.contains(n)||n===this.el||(qe=null)},_getDirection:function(n,o){return typeof this.options.direction=="function"?this.options.direction.call(this,n,o,E):this.options.direction},_onTapStart:function(n){if(n.cancelable){var o=this,a=this.el,u=this.options,c=u.preventOnFilter,p=n.type,m=n.touches&&n.touches[0]||n.pointerType&&n.pointerType==="touch"&&n,g=(m||n).target,x=n.target.shadowRoot&&(n.path&&n.path[0]||n.composedPath&&n.composedPath()[0])||g,R=u.filter;if(function(D){Et.length=0;for(var j=D.getElementsByTagName("input"),z=j.length;z--;){var H=j[z];H.checked&&Et.push(H)}}(a),!E&&!(/mousedown|pointerdown/.test(p)&&n.button!==0||u.disabled)&&!x.isContentEditable&&(this.nativeDraggable||!y||!g||g.tagName.toUpperCase()!=="SELECT")&&!((g=A(g,u.draggable,a,!1))&&g.animated||Ct===g)){if(ze=J(g),et=J(g,u.draggable),typeof R=="function"){if(R.call(this,n,g,this))return de({sortable:o,rootEl:x,name:"filter",targetEl:g,toEl:a,fromEl:a}),he("filter",o,{evt:n}),void(c&&n.cancelable&&n.preventDefault())}else if(R=R&&R.split(",").some(function(D){if(D=A(x,D.trim(),a,!1))return de({sortable:o,rootEl:D,name:"filter",targetEl:g,fromEl:a,toEl:a}),he("filter",o,{evt:n}),!0}))return void(c&&n.cancelable&&n.preventDefault());u.handle&&!A(x,u.handle,a,!1)||this._prepareDragStart(n,m,g)}}},_prepareDragStart:function(n,o,a){var u,c=this,p=c.el,m=c.options,g=p.ownerDocument;a&&!E&&a.parentNode===p&&(u=B(a),U=p,Q=(E=a).parentNode,Oe=E.nextSibling,Ct=a,xt=m.group,He={target:I.dragged=E,clientX:(o||n).clientX,clientY:(o||n).clientY},zi=He.clientX-u.left,qi=He.clientY-u.top,this._lastX=(o||n).clientX,this._lastY=(o||n).clientY,E.style["will-change"]="all",u=function(){he("delayEnded",c,{evt:n}),I.eventCanceled?c._onDrop():(c._disableDelayedDragEvents(),!v&&c.nativeDraggable&&(E.draggable=!0),c._triggerDragStart(n,o),de({sortable:c,name:"choose",originalEvent:n}),M(E,m.chosenClass,!0))},m.ignore.split(",").forEach(function(x){oe(E,x.trim(),ti)}),C(g,"dragover",Fe),C(g,"mousemove",Fe),C(g,"touchmove",Fe),C(g,"mouseup",c._onDrop),C(g,"touchend",c._onDrop),C(g,"touchcancel",c._onDrop),v&&this.nativeDraggable&&(this.options.touchStartThreshold=4,E.draggable=!0),he("delayStart",this,{evt:n}),!m.delay||m.delayOnTouchOnly&&!o||this.nativeDraggable&&(b||f)?u():I.eventCanceled?this._onDrop():(C(g,"mouseup",c._disableDelayedDrag),C(g,"touchend",c._disableDelayedDrag),C(g,"touchcancel",c._disableDelayedDrag),C(g,"mousemove",c._delayedDragTouchMoveHandler),C(g,"touchmove",c._delayedDragTouchMoveHandler),m.supportPointer&&C(g,"pointermove",c._delayedDragTouchMoveHandler),c._dragStartTimer=setTimeout(u,m.delay)))},_delayedDragTouchMoveHandler:function(n){n=n.touches?n.touches[0]:n,Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){E&&ti(E),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var n=this.el.ownerDocument;w(n,"mouseup",this._disableDelayedDrag),w(n,"touchend",this._disableDelayedDrag),w(n,"touchcancel",this._disableDelayedDrag),w(n,"mousemove",this._delayedDragTouchMoveHandler),w(n,"touchmove",this._delayedDragTouchMoveHandler),w(n,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(n,o){o=o||n.pointerType=="touch"&&n,!this.nativeDraggable||o?this.options.supportPointer?C(document,"pointermove",this._onTouchMove):C(document,o?"touchmove":"mousemove",this._onTouchMove):(C(E,"dragend",this),C(U,"dragstart",this._onDragStart));try{document.selection?Lt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(a){}},_dragStarted:function(n,o){var a;Ve=!1,U&&E?(he("dragStarted",this,{evt:o}),this.nativeDraggable&&C(document,"dragover",$n),a=this.options,n||M(E,a.dragClass,!1),M(E,a.ghostClass,!0),I.active=this,n&&this._appendGhost(),de({sortable:this,name:"start",originalEvent:o})):this._nulling()},_emulateDragOver:function(){if(ve){this._lastX=ve.clientX,this._lastY=ve.clientY,Gi();for(var n=document.elementFromPoint(ve.clientX,ve.clientY),o=n;n&&n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(ve.clientX,ve.clientY))!==o;)o=n;if(E.parentNode[ae]._isOutsideThisEl(n),o)do if(o[ae]&&o[ae]._onDragOver({clientX:ve.clientX,clientY:ve.clientY,target:n,rootEl:o})&&!this.options.dragoverBubble)break;while(o=(n=o).parentNode);Ki()}},_onTouchMove:function(n){if(He){var p=this.options,o=p.fallbackTolerance,a=p.fallbackOffset,u=n.touches?n.touches[0]:n,c=F&&N(F,!0),m=F&&c&&c.a,g=F&&c&&c.d,p=Dt&&le&&ji(le),m=(u.clientX-He.clientX+a.x)/(m||1)+(p?p[0]-Zt[0]:0)/(m||1),g=(u.clientY-He.clientY+a.y)/(g||1)+(p?p[1]-Zt[1]:0)/(g||1);if(!I.active&&!Ve){if(o&&Math.max(Math.abs(u.clientX-this._lastX),Math.abs(u.clientY-this._lastY))<o)return;this._onDragStart(n,!0)}F&&(c?(c.e+=m-(Jt||0),c.f+=g-(Qt||0)):c={a:1,b:0,c:0,d:1,e:m,f:g},c="matrix(".concat(c.a,",").concat(c.b,",").concat(c.c,",").concat(c.d,",").concat(c.e,",").concat(c.f,")"),k(F,"webkitTransform",c),k(F,"mozTransform",c),k(F,"msTransform",c),k(F,"transform",c),Jt=m,Qt=g,ve=u),n.cancelable&&n.preventDefault()}},_appendGhost:function(){if(!F){var n=this.options.fallbackOnBody?document.body:U,o=B(E,!0,Dt,!0,n),a=this.options;if(Dt){for(le=n;k(le,"position")==="static"&&k(le,"transform")==="none"&&le!==document;)le=le.parentNode;le!==document.body&&le!==document.documentElement?(le===document&&(le=re()),o.top+=le.scrollTop,o.left+=le.scrollLeft):le=re(),Zt=ji(le)}M(F=E.cloneNode(!0),a.ghostClass,!1),M(F,a.fallbackClass,!0),M(F,a.dragClass,!0),k(F,"transition",""),k(F,"transform",""),k(F,"box-sizing","border-box"),k(F,"margin",0),k(F,"top",o.top),k(F,"left",o.left),k(F,"width",o.width),k(F,"height",o.height),k(F,"opacity","0.8"),k(F,"position",Dt?"absolute":"fixed"),k(F,"zIndex","100000"),k(F,"pointerEvents","none"),I.ghost=F,n.appendChild(F),k(F,"transform-origin",zi/parseInt(F.style.width)*100+"% "+qi/parseInt(F.style.height)*100+"%")}},_onDragStart:function(n,o){var a=this,u=n.dataTransfer,c=a.options;he("dragStart",this,{evt:n}),I.eventCanceled?this._onDrop():(he("setupClone",this),I.eventCanceled||((Z=Xt(E)).removeAttribute("id"),Z.draggable=!1,Z.style["will-change"]="",this._hideClone(),M(Z,this.options.chosenClass,!1),I.clone=Z),a.cloneId=Lt(function(){he("clone",a),I.eventCanceled||(a.options.removeCloneOnHide||U.insertBefore(Z,E),a._hideClone(),de({sortable:a,name:"clone"}))}),o||M(E,c.dragClass,!0),o?($t=!0,a._loopId=setInterval(a._emulateDragOver,50)):(w(document,"mouseup",a._onDrop),w(document,"touchend",a._onDrop),w(document,"touchcancel",a._onDrop),u&&(u.effectAllowed="move",c.setData&&c.setData.call(a,u,E)),C(document,"drop",a),k(E,"transform","translateZ(0)")),Ve=!0,a._dragStartId=Lt(a._dragStarted.bind(a,o,n)),C(document,"selectstart",a),tt=!0,y&&k(document.body,"user-select","none"))},_onDragOver:function(n){var o,a,u,c,p=this.el,m=n.target,g=this.options,x=g.group,R=I.active,D=xt===x,j=g.sort,z=ce||R,H=this,G=!1;if(!ei){if(n.preventDefault!==void 0&&n.cancelable&&n.preventDefault(),m=A(m,g.draggable,p,!0),se("dragOver"),I.eventCanceled)return G;if(E.contains(n.target)||m.animated&&m.animatingX&&m.animatingY||H._ignoreWhileAnimating===m)return ge(!1);if($t=!1,R&&!g.disabled&&(D?j||(a=Q!==U):ce===this||(this.lastPutMode=xt.checkPull(this,R,E,n))&&x.checkPut(this,R,E,n))){if(u=this._getDirection(n,m)==="vertical",o=B(E),se("dragOverValid"),I.eventCanceled)return G;if(a)return Q=U,ke(),this._hideClone(),se("revert"),I.eventCanceled||(Oe?U.insertBefore(E,Oe):U.appendChild(E)),ge(!0);var P=Yt(p,g.draggable);if(!P||function(ie,ht,X){return X=B(Yt(X.el,X.options.draggable)),ht?ie.clientX>X.right+10||ie.clientX<=X.right&&ie.clientY>X.bottom&&ie.clientX>=X.left:ie.clientX>X.right&&ie.clientY>X.top||ie.clientX<=X.right&&ie.clientY>X.bottom+10}(n,u,this)&&!P.animated){if(P===E)return ge(!1);if((m=P&&p===n.target?P:m)&&(me=B(m)),It(U,p,E,o,m,me,n,!!m)!==!1)return ke(),P&&P.nextSibling?p.insertBefore(E,P.nextSibling):p.appendChild(E),Q=p,je(),ge(!0)}else if(P&&function(ie,ht,X){return X=B(We(X.el,0,X.options,!0)),ht?ie.clientX<X.left-10||ie.clientY<X.top&&ie.clientX<X.right:ie.clientY<X.top-10||ie.clientY<X.bottom&&ie.clientX<X.left}(n,u,this)){var ee=We(p,0,g,!0);if(ee===E)return ge(!1);if(me=B(m=ee),It(U,p,E,o,m,me,n,!1)!==!1)return ke(),p.insertBefore(E,ee),Q=p,je(),ge(!0)}else if(m.parentNode===p){var _e,V,be,me=B(m),$e=E.parentNode!==p,K=(K=E.animated&&E.toRect||o,te=m.animated&&m.toRect||me,Se=(c=u)?K.left:K.top,x=c?K.right:K.bottom,P=c?K.width:K.height,ee=c?te.left:te.top,K=c?te.right:te.bottom,te=c?te.width:te.height,!(Se===ee||x===K||Se+P/2===ee+te/2)),Se=u?"top":"left",P=Ne(m,"top","top")||Ne(E,"top","top"),ee=P?P.scrollTop:void 0;if(qe!==m&&(V=me[Se],nt=!1,Tt=!K&&g.invertSwap||$e),(_e=function(Me,ci,Ce,Ee,hi,Ht,Zi,Tn){var Te=Ee?Me.clientY:Me.clientX,Ae=Ee?Ce.height:Ce.width,Me=Ee?Ce.top:Ce.left,Ee=Ee?Ce.bottom:Ce.right,Ce=!1;if(!Zi){if(Tn&&St<Ae*hi){if(nt=!nt&&(it===1?Me+Ae*Ht/2<Te:Te<Ee-Ae*Ht/2)?!0:nt)Ce=!0;else if(it===1?Te<Me+St:Ee-St<Te)return-it}else if(Me+Ae*(1-hi)/2<Te&&Te<Ee-Ae*(1-hi)/2)return function(En){return J(E)<J(En)?1:-1}(ci)}return(Ce=Ce||Zi)&&(Te<Me+Ae*Ht/2||Ee-Ae*Ht/2<Te)?Me+Ae/2<Te?1:-1:0}(n,m,me,u,K?1:g.swapThreshold,g.invertedSwapThreshold==null?g.swapThreshold:g.invertedSwapThreshold,Tt,qe===m))!==0)for(var ct=J(E);(be=Q.children[ct-=_e])&&(k(be,"display")==="none"||be===F););if(_e===0||be===m)return ge(!1);it=_e;var te=(qe=m).nextElementSibling,$e=!1,K=It(U,p,E,o,m,me,n,$e=_e===1);if(K!==!1)return K!==1&&K!==-1||($e=K===1),ei=!0,setTimeout(kn,30),ke(),$e&&!te?p.appendChild(E):m.parentNode.insertBefore(E,$e?te:m),P&&Wi(P,0,ee-P.scrollTop),Q=E.parentNode,V===void 0||Tt||(St=Math.abs(V-B(m)[Se])),je(),ge(!0)}if(p.contains(E))return ge(!1)}return!1}function se(ie,ht){he(ie,H,e({evt:n,isOwner:D,axis:u?"vertical":"horizontal",revert:a,dragRect:o,targetRect:me,canSort:j,fromSortable:z,target:m,completed:ge,onMove:function(X,ci){return It(U,p,E,o,X,B(X),n,ci)},changed:je},ht))}function ke(){se("dragOverAnimationCapture"),H.captureAnimationState(),H!==z&&z.captureAnimationState()}function ge(ie){return se("dragOverCompleted",{insertion:ie}),ie&&(D?R._hideClone():R._showClone(H),H!==z&&(M(E,(ce||R).options.ghostClass,!1),M(E,g.ghostClass,!0)),ce!==H&&H!==I.active?ce=H:H===I.active&&ce&&(ce=null),z===H&&(H._ignoreWhileAnimating=m),H.animateAll(function(){se("dragOverAnimationComplete"),H._ignoreWhileAnimating=null}),H!==z&&(z.animateAll(),z._ignoreWhileAnimating=null)),(m===E&&!E.animated||m===p&&!m.animated)&&(qe=null),g.dragoverBubble||n.rootEl||m===document||(E.parentNode[ae]._isOutsideThisEl(n.target),ie||Fe(n)),!g.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),G=!0}function je(){pe=J(E),Le=J(E,g.draggable),de({sortable:H,name:"change",toEl:p,newIndex:pe,newDraggableIndex:Le,originalEvent:n})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){w(document,"mousemove",this._onTouchMove),w(document,"touchmove",this._onTouchMove),w(document,"pointermove",this._onTouchMove),w(document,"dragover",Fe),w(document,"mousemove",Fe),w(document,"touchmove",Fe)},_offUpEvents:function(){var n=this.el.ownerDocument;w(n,"mouseup",this._onDrop),w(n,"touchend",this._onDrop),w(n,"pointerup",this._onDrop),w(n,"touchcancel",this._onDrop),w(document,"selectstart",this)},_onDrop:function(n){var o=this.el,a=this.options;pe=J(E),Le=J(E,a.draggable),he("drop",this,{evt:n}),Q=E&&E.parentNode,pe=J(E),Le=J(E,a.draggable),I.eventCanceled||(nt=Tt=Ve=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ii(this.cloneId),ii(this._dragStartId),this.nativeDraggable&&(w(document,"drop",this),w(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),y&&k(document.body,"user-select",""),k(E,"transform",""),n&&(tt&&(n.cancelable&&n.preventDefault(),a.dropBubble||n.stopPropagation()),F&&F.parentNode&&F.parentNode.removeChild(F),(U===Q||ce&&ce.lastPutMode!=="clone")&&Z&&Z.parentNode&&Z.parentNode.removeChild(Z),E&&(this.nativeDraggable&&w(E,"dragend",this),ti(E),E.style["will-change"]="",tt&&!Ve&&M(E,(ce||this).options.ghostClass,!1),M(E,this.options.chosenClass,!1),de({sortable:this,name:"unchoose",toEl:Q,newIndex:null,newDraggableIndex:null,originalEvent:n}),U!==Q?(0<=pe&&(de({rootEl:Q,name:"add",toEl:Q,fromEl:U,originalEvent:n}),de({sortable:this,name:"remove",toEl:Q,originalEvent:n}),de({rootEl:Q,name:"sort",toEl:Q,fromEl:U,originalEvent:n}),de({sortable:this,name:"sort",toEl:Q,originalEvent:n})),ce&&ce.save()):pe!==ze&&0<=pe&&(de({sortable:this,name:"update",toEl:Q,originalEvent:n}),de({sortable:this,name:"sort",toEl:Q,originalEvent:n})),I.active&&(pe!=null&&pe!==-1||(pe=ze,Le=et),de({sortable:this,name:"end",toEl:Q,originalEvent:n}),this.save())))),this._nulling()},_nulling:function(){he("nulling",this),U=E=Q=F=Oe=Z=Ct=Ie=He=ve=tt=pe=Le=ze=et=qe=it=ce=xt=I.dragged=I.ghost=I.clone=I.active=null,Et.forEach(function(n){n.checked=!0}),Et.length=Jt=Qt=0},handleEvent:function(n){switch(n.type){case"drop":case"dragend":this._onDrop(n);break;case"dragenter":case"dragover":E&&(this._onDragOver(n),function(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}(n));break;case"selectstart":n.preventDefault()}},toArray:function(){for(var n,o=[],a=this.el.children,u=0,c=a.length,p=this.options;u<c;u++)A(n=a[u],p.draggable,this.el,!1)&&o.push(n.getAttribute(p.dataIdAttr)||function(m){for(var g=m.tagName+m.className+m.src+m.href+m.textContent,x=g.length,R=0;x--;)R+=g.charCodeAt(x);return R.toString(36)}(n));return o},sort:function(n,o){var a={},u=this.el;this.toArray().forEach(function(c,p){p=u.children[p],A(p,this.options.draggable,u,!1)&&(a[c]=p)},this),o&&this.captureAnimationState(),n.forEach(function(c){a[c]&&(u.removeChild(a[c]),u.appendChild(a[c]))}),o&&this.animateAll()},save:function(){var n=this.options.store;n&&n.set&&n.set(this)},closest:function(n,o){return A(n,o||this.options.draggable,this.el,!1)},option:function(n,o){var a=this.options;if(o===void 0)return a[n];var u=Qe.modifyOption(this,n,o);a[n]=u!==void 0?u:o,n==="group"&&Xi(a)},destroy:function(){he("destroy",this);var n=this.el;n[ae]=null,w(n,"mousedown",this._onTapStart),w(n,"touchstart",this._onTapStart),w(n,"pointerdown",this._onTapStart),this.nativeDraggable&&(w(n,"dragover",this),w(n,"dragenter",this)),Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),kt.splice(kt.indexOf(this.el),1),this.el=n=null},_hideClone:function(){Ie||(he("hideClone",this),I.eventCanceled||(k(Z,"display","none"),this.options.removeCloneOnHide&&Z.parentNode&&Z.parentNode.removeChild(Z),Ie=!0))},_showClone:function(n){n.lastPutMode==="clone"?Ie&&(he("showClone",this),I.eventCanceled||(E.parentNode!=U||this.options.group.revertClone?Oe?U.insertBefore(Z,Oe):U.appendChild(Z):U.insertBefore(Z,E),this.options.group.revertClone&&this.animate(E,Z),k(Z,"display",""),Ie=!1)):this._hideClone()}},Rt&&C(document,"touchmove",function(n){(I.active||Ve)&&n.cancelable&&n.preventDefault()}),I.utils={on:C,off:w,css:k,find:oe,is:function(n,o){return!!A(n,o,n,!1)},extend:function(n,o){if(n&&o)for(var a in o)o.hasOwnProperty(a)&&(n[a]=o[a]);return n},throttle:Pi,closest:A,toggleClass:M,clone:Xt,index:J,nextTick:Lt,cancelNextTick:ii,detectDirection:Ui,getChild:We},I.get=function(n){return n[ae]},I.mount=function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];(o=o[0].constructor===Array?o[0]:o).forEach(function(u){if(!u.prototype||!u.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(u));u.utils&&(I.utils=e(e({},I.utils),u.utils)),Qe.mount(u)})},I.create=function(n,o){return new I(n,o)};var st,ni,si,ri,At,rt,ne=[],oi=!(I.version="1.15.0");function Mt(){ne.forEach(function(n){clearInterval(n.pid)}),ne=[]}function Ji(){clearInterval(rt)}var ye,ai=Pi(function(n,o,a,u){if(o.scroll){var c,p=(n.touches?n.touches[0]:n).clientX,m=(n.touches?n.touches[0]:n).clientY,g=o.scrollSensitivity,x=o.scrollSpeed,R=re(),D=!1;ni!==a&&(ni=a,Mt(),st=o.scroll,c=o.scrollFn,st===!0&&(st=De(a,!0)));var j=0,z=st;do{var H=z,se=B(H),G=se.top,P=se.bottom,ee=se.left,_e=se.right,V=se.width,be=se.height,me=void 0,$e=void 0,Se=H.scrollWidth,ct=H.scrollHeight,te=k(H),K=H.scrollLeft,se=H.scrollTop,$e=H===R?(me=V<Se&&(te.overflowX==="auto"||te.overflowX==="scroll"||te.overflowX==="visible"),be<ct&&(te.overflowY==="auto"||te.overflowY==="scroll"||te.overflowY==="visible")):(me=V<Se&&(te.overflowX==="auto"||te.overflowX==="scroll"),be<ct&&(te.overflowY==="auto"||te.overflowY==="scroll")),K=me&&(Math.abs(_e-p)<=g&&K+V<Se)-(Math.abs(ee-p)<=g&&!!K),se=$e&&(Math.abs(P-m)<=g&&se+be<ct)-(Math.abs(G-m)<=g&&!!se);if(!ne[j])for(var ke=0;ke<=j;ke++)ne[ke]||(ne[ke]={});ne[j].vx==K&&ne[j].vy==se&&ne[j].el===H||(ne[j].el=H,ne[j].vx=K,ne[j].vy=se,clearInterval(ne[j].pid),K==0&&se==0||(D=!0,ne[j].pid=setInterval(function(){u&&this.layer===0&&I.active._onTouchMove(At);var ge=ne[this.layer].vy?ne[this.layer].vy*x:0,je=ne[this.layer].vx?ne[this.layer].vx*x:0;typeof c=="function"&&c.call(I.dragged.parentNode[ae],je,ge,n,At,ne[this.layer].el)!=="continue"||Wi(ne[this.layer].el,je,ge)}.bind({layer:j}),24))),j++}while(o.bubbleScroll&&z!==R&&(z=De(z,!1)));oi=D}},30),ot=function(g){var o=g.originalEvent,a=g.putSortable,u=g.dragEl,c=g.activeSortable,p=g.dispatchSortableEvent,m=g.hideGhostForTarget,g=g.unhideGhostForTarget;o&&(c=a||c,m(),o=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,o=document.elementFromPoint(o.clientX,o.clientY),g(),c&&!c.el.contains(o)&&(p("spill"),this.onSpill({dragEl:u,putSortable:a})))};function li(){}function di(){}li.prototype={startIndex:null,dragStart:function(n){n=n.oldDraggableIndex,this.startIndex=n},onSpill:function(n){var o=n.dragEl,a=n.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState(),n=We(this.sortable.el,this.startIndex,this.options),n?this.sortable.el.insertBefore(o,n):this.sortable.el.appendChild(o),this.sortable.animateAll(),a&&a.animateAll()},drop:ot},i(li,{pluginName:"revertOnSpill"}),di.prototype={onSpill:function(a){var o=a.dragEl,a=a.putSortable||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:ot},i(di,{pluginName:"removeOnSpill"});var at,we,Y,lt,Nt,O=[],fe=[],dt=!1,ue=!1,Ye=!1;function Qi(n,o){fe.forEach(function(a,u){u=o.children[a.sortableIndex+(n?Number(u):0)],u?o.insertBefore(a,u):o.appendChild(a)})}function Ot(){O.forEach(function(n){n!==Y&&n.parentNode&&n.parentNode.removeChild(n)})}return I.mount(new function(){function n(){for(var o in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this))}return n.prototype={dragStarted:function(o){o=o.originalEvent,this.sortable.nativeDraggable?C(document,"dragover",this._handleAutoScroll):this.options.supportPointer?C(document,"pointermove",this._handleFallbackAutoScroll):o.touches?C(document,"touchmove",this._handleFallbackAutoScroll):C(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){o=o.originalEvent,this.options.dragOverBubble||o.rootEl||this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):(w(document,"pointermove",this._handleFallbackAutoScroll),w(document,"touchmove",this._handleFallbackAutoScroll),w(document,"mousemove",this._handleFallbackAutoScroll)),Ji(),Mt(),clearTimeout(W),W=void 0},nulling:function(){At=ni=st=oi=rt=si=ri=null,ne.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,a){var u,c=this,p=(o.touches?o.touches[0]:o).clientX,m=(o.touches?o.touches[0]:o).clientY,g=document.elementFromPoint(p,m);At=o,a||this.options.forceAutoScrollFallback||b||f||y?(ai(o,this.options,g,a),u=De(g,!0),!oi||rt&&p===si&&m===ri||(rt&&Ji(),rt=setInterval(function(){var x=De(document.elementFromPoint(p,m),!0);x!==u&&(u=x,Mt()),ai(o,c.options,x,a)},10),si=p,ri=m)):this.options.bubbleScroll&&De(g,!0)!==re()?ai(o,this.options,De(g,!1),!1):Mt()}},i(n,{pluginName:"scroll",initializeByDefault:!0})}),I.mount(di,li),I.mount(new function(){function n(){this.defaults={swapClass:"sortable-swap-highlight"}}return n.prototype={dragStart:function(o){o=o.dragEl,ye=o},dragOverValid:function(o){var a=o.completed,u=o.target,c=o.onMove,p=o.activeSortable,m=o.changed,g=o.cancel;p.options.swap&&(o=this.sortable.el,p=this.options,u&&u!==o&&(o=ye,ye=c(u)!==!1?(M(u,p.swapClass,!0),u):null,o&&o!==ye&&M(o,p.swapClass,!1)),m(),a(!0),g())},drop:function(o){var a,u,c=o.activeSortable,p=o.putSortable,m=o.dragEl,g=p||this.sortable,x=this.options;ye&&M(ye,x.swapClass,!1),ye&&(x.swap||p&&p.options.swap)&&m!==ye&&(g.captureAnimationState(),g!==c&&c.captureAnimationState(),u=ye,o=(a=m).parentNode,x=u.parentNode,o&&x&&!o.isEqualNode(u)&&!x.isEqualNode(a)&&(p=J(a),m=J(u),o.isEqualNode(x)&&p<m&&m++,o.insertBefore(u,o.children[p]),x.insertBefore(a,x.children[m])),g.animateAll(),g!==c&&c.animateAll())},nulling:function(){ye=null}},i(n,{pluginName:"swap",eventProperties:function(){return{swapItem:ye}}})}),I.mount(new function(){function n(o){for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));o.options.avoidImplicitDeselect||(o.options.supportPointer?C(document,"pointerup",this._deselectMultiDrag):(C(document,"mouseup",this._deselectMultiDrag),C(document,"touchend",this._deselectMultiDrag))),C(document,"keydown",this._checkKeyDown),C(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(u,c){var p="";O.length&&we===o?O.forEach(function(m,g){p+=(g?", ":"")+m.textContent}):p=c.textContent,u.setData("Text",p)}}}return n.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(o){o=o.dragEl,Y=o},delayEnded:function(){this.isMultiDrag=~O.indexOf(Y)},setupClone:function(u){var a=u.sortable,u=u.cancel;if(this.isMultiDrag){for(var c=0;c<O.length;c++)fe.push(Xt(O[c])),fe[c].sortableIndex=O[c].sortableIndex,fe[c].draggable=!1,fe[c].style["will-change"]="",M(fe[c],this.options.selectedClass,!1),O[c]===Y&&M(fe[c],this.options.chosenClass,!1);a._hideClone(),u()}},clone:function(p){var a=p.sortable,u=p.rootEl,c=p.dispatchSortableEvent,p=p.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||O.length&&we===a&&(Qi(!0,u),c("clone"),p()))},showClone:function(c){var a=c.cloneNowShown,u=c.rootEl,c=c.cancel;this.isMultiDrag&&(Qi(!1,u),fe.forEach(function(p){k(p,"display","")}),a(),Nt=!1,c())},hideClone:function(c){var a=this,u=(c.sortable,c.cloneNowHidden),c=c.cancel;this.isMultiDrag&&(fe.forEach(function(p){k(p,"display","none"),a.options.removeCloneOnHide&&p.parentNode&&p.parentNode.removeChild(p)}),u(),Nt=!0,c())},dragStartGlobal:function(o){o.sortable,!this.isMultiDrag&&we&&we.multiDrag._deselectMultiDrag(),O.forEach(function(a){a.sortableIndex=J(a)}),O=O.sort(function(a,u){return a.sortableIndex-u.sortableIndex}),Ye=!0},dragStarted:function(c){var a,u=this,c=c.sortable;this.isMultiDrag&&(this.options.sort&&(c.captureAnimationState(),this.options.animation&&(O.forEach(function(p){p!==Y&&k(p,"position","absolute")}),a=B(Y,!1,!0,!0),O.forEach(function(p){p!==Y&&Bi(p,a)}),dt=ue=!0)),c.animateAll(function(){dt=ue=!1,u.options.animation&&O.forEach(function(p){Gt(p)}),u.options.sort&&Ot()}))},dragOver:function(c){var a=c.target,u=c.completed,c=c.cancel;ue&&~O.indexOf(a)&&(u(!1),c())},revert:function(o){var a,u,c=o.fromSortable,p=o.rootEl,m=o.sortable,g=o.dragRect;1<O.length&&(O.forEach(function(x){m.addAnimationState({target:x,rect:ue?B(x):g}),Gt(x),x.fromRect=g,c.removeAnimationState(x)}),ue=!1,a=!this.options.removeCloneOnHide,u=p,O.forEach(function(x,R){R=u.children[x.sortableIndex+(a?Number(R):0)],R?u.insertBefore(x,R):u.appendChild(x)}))},dragOverCompleted:function(R){var a,u=R.sortable,c=R.isOwner,p=R.insertion,m=R.activeSortable,g=R.parentEl,x=R.putSortable,R=this.options;p&&(c&&m._hideClone(),dt=!1,R.animation&&1<O.length&&(ue||!c&&!m.options.sort&&!x)&&(a=B(Y,!1,!0,!0),O.forEach(function(D){D!==Y&&(Bi(D,a),g.appendChild(D))}),ue=!0),c||(ue||Ot(),1<O.length?(c=Nt,m._showClone(u),m.options.animation&&!Nt&&c&&fe.forEach(function(D){m.addAnimationState({target:D,rect:lt}),D.fromRect=lt,D.thisAnimationDuration=null})):m._showClone(u)))},dragOverAnimationCapture:function(c){var a=c.dragRect,u=c.isOwner,c=c.activeSortable;O.forEach(function(p){p.thisAnimationDuration=null}),c.options.animation&&!u&&c.multiDrag.isMultiDrag&&(lt=i({},a),a=N(Y,!0),lt.top-=a.f,lt.left-=a.e)},dragOverAnimationComplete:function(){ue&&(ue=!1,Ot())},drop:function(o){var a=o.originalEvent,u=o.rootEl,c=o.parentEl,p=o.sortable,m=o.dispatchSortableEvent,g=o.oldIndex,x=o.putSortable,R=x||this.sortable;if(a){var D,j,z,H=this.options,G=c.children;if(!Ye)if(H.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),M(Y,H.selectedClass,!~O.indexOf(Y)),~O.indexOf(Y))O.splice(O.indexOf(Y),1),at=null,Ze({sortable:p,rootEl:u,name:"deselect",targetEl:Y,originalEvent:a});else{if(O.push(Y),Ze({sortable:p,rootEl:u,name:"select",targetEl:Y,originalEvent:a}),a.shiftKey&&at&&p.el.contains(at)){var P=J(at),o=J(Y);if(~P&&~o&&P!==o)for(var ee,_e=P<o?(ee=P,o):(ee=o,P+1);ee<_e;ee++)~O.indexOf(G[ee])||(M(G[ee],H.selectedClass,!0),O.push(G[ee]),Ze({sortable:p,rootEl:u,name:"select",targetEl:G[ee],originalEvent:a}))}else at=Y;we=R}Ye&&this.isMultiDrag&&(ue=!1,(c[ae].options.sort||c!==u)&&1<O.length&&(D=B(Y),j=J(Y,":not(."+this.options.selectedClass+")"),!dt&&H.animation&&(Y.thisAnimationDuration=null),R.captureAnimationState(),dt||(H.animation&&(Y.fromRect=D,O.forEach(function(V){var be;V.thisAnimationDuration=null,V!==Y&&(be=ue?B(V):D,V.fromRect=be,R.addAnimationState({target:V,rect:be}))})),Ot(),O.forEach(function(V){G[j]?c.insertBefore(V,G[j]):c.appendChild(V),j++}),g===J(Y)&&(z=!1,O.forEach(function(V){V.sortableIndex!==J(V)&&(z=!0)}),z&&m("update"))),O.forEach(function(V){Gt(V)}),R.animateAll()),we=R),(u===c||x&&x.lastPutMode!=="clone")&&fe.forEach(function(V){V.parentNode&&V.parentNode.removeChild(V)})}},nullingGlobal:function(){this.isMultiDrag=Ye=!1,fe.length=0},destroyGlobal:function(){this._deselectMultiDrag(),w(document,"pointerup",this._deselectMultiDrag),w(document,"mouseup",this._deselectMultiDrag),w(document,"touchend",this._deselectMultiDrag),w(document,"keydown",this._checkKeyDown),w(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(o){if(!(Ye!==void 0&&Ye||we!==this.sortable||o&&A(o.target,this.options.draggable,this.sortable.el,!1)||o&&o.button!==0))for(;O.length;){var a=O[0];M(a,this.options.selectedClass,!1),O.shift(),Ze({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:a,originalEvent:o})}},_checkKeyDown:function(o){o.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(o){o.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},i(n,{pluginName:"multiDrag",utils:{select:function(o){var a=o.parentNode[ae];a&&a.options.multiDrag&&!~O.indexOf(o)&&(we&&we!==a&&(we.multiDrag._deselectMultiDrag(),we=a),M(o,a.options.selectedClass,!0),O.push(o))},deselect:function(o){var a=o.parentNode[ae],u=O.indexOf(o);a&&a.options.multiDrag&&~u&&(M(o,a.options.selectedClass,!1),O.splice(u,1))}},eventProperties:function(){var o=this,a=[],u=[];return O.forEach(function(c){var p;a.push({multiDragElement:c,index:c.sortableIndex}),p=ue&&c!==Y?-1:ue?J(c,":not(."+o.options.selectedClass+")"):J(c),u.push({multiDragElement:c,index:p})}),{items:l(O),clones:[].concat(fe),oldIndicies:a,newIndicies:u}},optionListeners:{multiDragKey:function(o){return(o=o.toLowerCase())==="ctrl"?o="Control":1<o.length&&(o=o.charAt(0).toUpperCase()+o.substr(1)),o}}})}),I})});var yn=tn((Ma,vn)=>{"use strict";function On(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var Hn=On(sn());function _(r,e){return typeof r=="string"?(e||document).querySelector(r):r||null}_.each=(r,e)=>typeof r=="string"?Array.from((e||document).querySelectorAll(r)):r||null;_.create=(r,e)=>{let t=document.createElement(r);for(let i in e){let s=e[i];if(i==="inside")_(s).appendChild(t);else if(i==="around"){let l=_(s);l.parentNode.insertBefore(t,l),t.appendChild(l)}else i==="styles"?typeof s=="object"&&Object.keys(s).map(l=>{t.style[l]=s[l]}):i in t?t[i]=s:t.setAttribute(i,s)}return t};_.on=(r,e,t,i)=>{i?_.delegate(r,e,t,i):(i=t,_.bind(r,e,i))};_.off=(r,e,t)=>{r.removeEventListener(e,t)};_.bind=(r,e,t)=>{e.split(/\s+/).forEach(function(i){r.addEventListener(i,t)})};_.delegate=(r,e,t,i)=>{r.addEventListener(e,function(s){let l=s.target.closest(t);l&&(s.delegatedTarget=l,i.call(this,s,l))})};_.unbind=(r,e)=>{if(r)for(let t in e){let i=e[t];t.split(/\s+/).forEach(function(s){r.removeEventListener(s,i)})}};_.fire=(r,e,t)=>{let i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0);for(let s in t)i[s]=t[s];return r.dispatchEvent(i)};_.data=(r,e)=>{if(!e)return r.dataset;for(let t in e)r.dataset[t]=e[t]};_.style=(r,e)=>{if(typeof e=="string")return _.getStyle(r,e);Array.isArray(r)||(r=[r]),r.map(t=>{for(let i in e)t.style[i]=e[i]})};_.removeStyle=(r,e)=>{Array.isArray(r)||(r=[r]),Array.isArray(e)||(e=[e]),r.map(t=>{for(let i of e)t.style[i]=""})};_.getStyle=(r,e)=>{if(!e)return getComputedStyle(r);let t=getComputedStyle(r)[e];return["width","height"].includes(e)&&(t=parseFloat(t)),t};_.closest=(r,e)=>e?e.matches(r)?e:_.closest(r,e.parentNode):null;_.inViewport=(r,e)=>{let{top:t,left:i,bottom:s,right:l}=r.getBoundingClientRect(),{top:d,left:h,bottom:f,right:b}=e.getBoundingClientRect();return t>=d&&i>=h&&s<=f&&l<=b};_.scrollTop=function(e,t){requestAnimationFrame(()=>{e.scrollTop=t})};_.scrollbarSize=function(){return _.scrollBarSizeValue||(_.scrollBarSizeValue=Fn()),_.scrollBarSizeValue};function Fn(){let r=document.createElement("div");_.style(r,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(r);let e=r.offsetWidth-r.clientWidth;return document.body.removeChild(r),e}_.hasVerticalOverflow=function(r){return r.scrollHeight>r.offsetHeight+10};_.hasHorizontalOverflow=function(r){return r.scrollWidth>r.offsetWidth+10};_.measureTextWidth=function(r){let e=document.createElement("div");return e.style.position="absolute",e.style.visibility="hidden",e.style.height="auto",e.style.width="auto",e.style.whiteSpace="nowrap",e.innerText=r,document.body.appendChild(e),e.clientWidth+1};function jn(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Ue=jn,Ft=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function jt(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function Pn(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Wn(r,e){return e={exports:{}},r(e,e.exports),e.exports}var Bn=typeof Ft=="object"&&Ft&&Ft.Object===Object&&Ft,zn=Bn,qn=typeof self=="object"&&self&&self.Object===Object&&self,Vn=zn||qn||Function("return this")(),wt=Vn,Yn=function(){return wt.Date.now()},ki=Yn,Un=wt.Symbol,Pt=Un,pn=Object.prototype,Xn=pn.hasOwnProperty,Gn=pn.toString,_t=Pt?Pt.toStringTag:void 0;function Kn(r){var e=Xn.call(r,_t),t=r[_t];try{r[_t]=void 0}catch(s){}var i=Gn.call(r);return e?r[_t]=t:delete r[_t],i}var Jn=Kn,Qn=Object.prototype,Zn=Qn.toString;function es(r){return Zn.call(r)}var ts=es,is="[object Null]",ns="[object Undefined]",rn=Pt?Pt.toStringTag:void 0;function ss(r){return r==null?r===void 0?ns:is:rn&&rn in Object(r)?Jn(r):ts(r)}var fn=ss;function rs(r){return r!=null&&typeof r=="object"}var os=rs,as="[object Symbol]";function ls(r){return typeof r=="symbol"||os(r)&&fn(r)==as}var ds=ls,on=0/0,cs=/^\s+|\s+$/g,hs=/^[-+]0x[0-9a-f]+$/i,us=/^0b[01]+$/i,ps=/^0o[0-7]+$/i,fs=parseInt;function _s(r){if(typeof r=="number")return r;if(ds(r))return on;if(Ue(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Ue(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(cs,"");var t=us.test(r);return t||ps.test(r)?fs(r.slice(2),t?2:8):hs.test(r)?on:+r}var an=_s,ms="Expected a function",gs=Math.max,bs=Math.min;function vs(r,e,t){var i,s,l,d,h,f,b=0,v=!1,y=!1,S=!0;if(typeof r!="function")throw new TypeError(ms);e=an(e)||0,Ue(t)&&(v=!!t.leading,y="maxWait"in t,l=y?gs(an(t.maxWait)||0,e):l,S="trailing"in t?!!t.trailing:S);function T(N){var oe=i,re=s;return i=s=void 0,b=N,d=r.apply(re,oe),d}function C(N){return b=N,h=setTimeout(A,e),v?T(N):d}function w(N){var oe=N-f,re=N-b,B=e-oe;return y?bs(B,l-re):B}function L(N){var oe=N-f,re=N-b;return f===void 0||oe>=e||oe<0||y&&re>=l}function A(){var N=ki();if(L(N))return W(N);h=setTimeout(A,w(N))}function W(N){return h=void 0,S&&i?T(N):(i=s=void 0,d)}function q(){h!==void 0&&clearTimeout(h),b=0,i=f=s=h=void 0}function M(){return h===void 0?d:W(ki())}function k(){var N=ki(),oe=L(N);if(i=arguments,s=this,f=N,oe){if(h===void 0)return C(f);if(y)return h=setTimeout(A,e),T(f)}return h===void 0&&(h=setTimeout(A,e)),d}return k.cancel=q,k.flush=M,k}var _n=vs,ys="Expected a function";function ws(r,e,t){var i=!0,s=!0;if(typeof r!="function")throw new TypeError(ys);return Ue(t)&&(i="leading"in t?!!t.leading:i,s="trailing"in t?!!t.trailing:s),_n(r,e,{leading:i,maxWait:e,trailing:s})}var Cs=ws,xs="[object AsyncFunction]",Ss="[object Function]",$s="[object GeneratorFunction]",ks="[object Proxy]";function Ts(r){if(!Ue(r))return!1;var e=fn(r);return e==Ss||e==$s||e==xs||e==ks}var Es=Ts,Rs=wt["__core-js_shared__"],Ti=Rs,ln=function(){var r=/[^.]+$/.exec(Ti&&Ti.keys&&Ti.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function Ds(r){return!!ln&&ln in r}var Is=Ds,Ls=Function.prototype,As=Ls.toString;function Ms(r){if(r!=null){try{return As.call(r)}catch(e){}try{return r+""}catch(e){}}return""}var Ns=Ms,Os=/[\\^$.*+?()[\]{}|]/g,Hs=/^\[object .+?Constructor\]$/,Fs=Function.prototype,js=Object.prototype,Ps=Fs.toString,Ws=js.hasOwnProperty,Bs=RegExp("^"+Ps.call(Ws).replace(Os,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zs(r){if(!Ue(r)||Is(r))return!1;var e=Es(r)?Bs:Hs;return e.test(Ns(r))}var qs=zs;function Vs(r,e){return r==null?void 0:r[e]}var Ys=Vs;function Us(r,e){var t=Ys(r,e);return qs(t)?t:void 0}var Fi=Us,Xs=Fi(Object,"create"),yt=Xs;function Gs(){this.__data__=yt?yt(null):{},this.size=0}var Ks=Gs;function Js(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var Qs=Js,Zs="__lodash_hash_undefined__",er=Object.prototype,tr=er.hasOwnProperty;function ir(r){var e=this.__data__;if(yt){var t=e[r];return t===Zs?void 0:t}return tr.call(e,r)?e[r]:void 0}var nr=ir,sr=Object.prototype,rr=sr.hasOwnProperty;function or(r){var e=this.__data__;return yt?e[r]!==void 0:rr.call(e,r)}var ar=or,lr="__lodash_hash_undefined__";function dr(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=yt&&e===void 0?lr:e,this}var cr=dr;function Ge(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}Ge.prototype.clear=Ks;Ge.prototype.delete=Qs;Ge.prototype.get=nr;Ge.prototype.has=ar;Ge.prototype.set=cr;var dn=Ge;function hr(){this.__data__=[],this.size=0}var ur=hr;function pr(r,e){return r===e||r!==r&&e!==e}var fr=pr;function _r(r,e){for(var t=r.length;t--;)if(fr(r[t][0],e))return t;return-1}var Bt=_r,mr=Array.prototype,gr=mr.splice;function br(r){var e=this.__data__,t=Bt(e,r);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():gr.call(e,t,1),--this.size,!0}var vr=br;function yr(r){var e=this.__data__,t=Bt(e,r);return t<0?void 0:e[t][1]}var wr=yr;function Cr(r){return Bt(this.__data__,r)>-1}var xr=Cr;function Sr(r,e){var t=this.__data__,i=Bt(t,r);return i<0?(++this.size,t.push([r,e])):t[i][1]=e,this}var $r=Sr;function Ke(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}Ke.prototype.clear=ur;Ke.prototype.delete=vr;Ke.prototype.get=wr;Ke.prototype.has=xr;Ke.prototype.set=$r;var kr=Ke,Tr=Fi(wt,"Map"),Er=Tr;function Rr(){this.size=0,this.__data__={hash:new dn,map:new(Er||kr),string:new dn}}var Dr=Rr;function Ir(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var Lr=Ir;function Ar(r,e){var t=r.__data__;return Lr(e)?t[typeof e=="string"?"string":"hash"]:t.map}var zt=Ar;function Mr(r){var e=zt(this,r).delete(r);return this.size-=e?1:0,e}var Nr=Mr;function Or(r){return zt(this,r).get(r)}var Hr=Or;function Fr(r){return zt(this,r).has(r)}var jr=Fr;function Pr(r,e){var t=zt(this,r),i=t.size;return t.set(r,e),this.size+=t.size==i?0:1,this}var Wr=Pr;function Je(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}Je.prototype.clear=Dr;Je.prototype.delete=Nr;Je.prototype.get=Hr;Je.prototype.has=jr;Je.prototype.set=Wr;var Br=Je,zr="__lodash_hash_undefined__";function qr(r){return this.__data__.set(r,zr),this}var Vr=qr;function Yr(r){return this.__data__.has(r)}var Ur=Yr;function Wt(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new Br;++e<t;)this.add(r[e])}Wt.prototype.add=Wt.prototype.push=Vr;Wt.prototype.has=Ur;var Xr=Wt;function Gr(r,e,t,i){for(var s=r.length,l=t+(i?1:-1);i?l--:++l<s;)if(e(r[l],l,r))return l;return-1}var Kr=Gr;function Jr(r){return r!==r}var Qr=Jr;function Zr(r,e,t){for(var i=t-1,s=r.length;++i<s;)if(r[i]===e)return i;return-1}var eo=Zr;function to(r,e,t){return e===e?eo(r,e,t):Kr(r,Qr,t)}var io=to;function no(r,e){var t=r==null?0:r.length;return!!t&&io(r,e,0)>-1}var so=no;function ro(r,e,t){for(var i=-1,s=r==null?0:r.length;++i<s;)if(t(e,r[i]))return!0;return!1}var oo=ro;function ao(r,e){return r.has(e)}var lo=ao,co=Fi(wt,"Set"),Ei=co;function ho(){}var uo=ho;function po(r){var e=-1,t=Array(r.size);return r.forEach(function(i){t[++e]=i}),t}var mn=po,fo=1/0,_o=Ei&&1/mn(new Ei([,-0]))[1]==fo?function(r){return new Ei(r)}:uo,mo=_o,go=200;function bo(r,e,t){var i=-1,s=so,l=r.length,d=!0,h=[],f=h;if(t)d=!1,s=oo;else if(l>=go){var b=e?null:mo(r);if(b)return mn(b);d=!1,s=lo,f=new Xr}else f=e?[]:h;e:for(;++i<l;){var v=r[i],y=e?e(v):v;if(v=t||v!==0?v:0,d&&y===y){for(var S=f.length;S--;)if(f[S]===y)continue e;e&&f.push(y),h.push(v)}else s(f,y,t)||(f!==h&&f.push(y),h.push(v))}return h}var vo=bo;function yo(r){return r&&r.length?vo(r):[]}var wo=yo;function gn(r){return r.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`)}function Ri(r){return Object.keys(r).map(t=>{let i=gn(t),s=r[t];return s===void 0?"":`data-${i}="${s}" `}).join("").trim()}function cn(r){var e=document.createElement("textarea");e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width="2em",e.style.height="2em",e.style.padding=0,e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",e.value=r,document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(t){console.log("Oops, unable to copy")}document.body.removeChild(e)}function Co(r){return!isNaN(r)}var bn=Cs,xo=_n;function gt(r,e=null){return(...t)=>new Promise(i=>{setTimeout(()=>{let l=r.apply(e,t);i(l)})})}function qt(r,e,t){let i=t.reduce((s,l)=>(s[l]={get(){return e[l]}},s),{});Object.defineProperties(r,i)}function So(r){return r!==void 0||r!==null}function $o(r){return!So(r)}function bt(r){return!isNaN(r)}function ko(r){return Array.isArray(r)?r:[r]}function hn(r){return wo(r)}function mt(r,e){return r-e}function un(r){return r.replace(/<[^>]*>/g,"")}function To(r,e){return r&&(Object.keys(e).forEach(t=>{let i=new RegExp(`{(${t})}`,"g");r=r.replace(i,e[t])}),r)}function Eo(r){if(!r)return"";let e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(r).replace(/[&<>"'`=/]/g,t=>e[t]||t)}var Di=class{constructor(e){this.options=e,this.sortRows=gt(this.sortRows,this),this.switchColumn=gt(this.switchColumn,this),this.removeColumn=gt(this.removeColumn,this),this.options.filterRows=gt(this.options.filterRows,this)}init(e,t){e||(e=this.options.data),t&&(this.options.columns=t),this.data=e,this.rowCount=0,this.columns=[],this.rows=[],this.prepareColumns(),this.prepareRows(),this.prepareTreeRows(),this.prepareRowView(),this.prepareNumericColumns()}get currentSort(){return this.columns.find(t=>t.sortOrder!=="none")||{colIndex:-1,sortOrder:"none"}}prepareColumns(){this.columns=[],this.validateColumns(),this.prepareDefaultColumns(),this.prepareHeader()}prepareDefaultColumns(){if(this.options.checkboxColumn&&!this.hasColumnById("_checkbox")){let e={id:"_checkbox",content:this.getCheckboxHTML(),editable:!1,resizable:!1,sortable:!1,focusable:!1,dropdown:!1,width:32};this.columns.push(e)}if(this.options.serialNoColumn&&!this.hasColumnById("_rowIndex")){let e={id:"_rowIndex",content:"",align:"center",editable:!1,resizable:!1,focusable:!1,dropdown:!1};this.columns.push(e)}}prepareHeader(){let e=this.columns.concat(this.options.columns),t={isHeader:1,editable:!0,sortable:!0,resizable:!0,focusable:!0,dropdown:!0,width:null,format:i=>i==null?"":i+""};this.columns=e.map((i,s)=>this.prepareCell(i,s)).map(i=>Object.assign({},t,i)).map(i=>(i.content=i.content||i.name||"",i.id=i.id||i.content,i))}prepareCell(e,t){let i={content:"",sortOrder:"none",colIndex:t,column:this.columns[t]};return e!==null&&typeof e=="object"?Object.assign(i,e):i.content=e,i}prepareNumericColumns(){let e=this.getRow(0);!e||(this.columns=this.columns.map((t,i)=>{let s=e[i].content;return!t.align&&Co(s)&&(t.align="right"),t}))}prepareRows(){this.validateData(this.data),this.rows=this.data.map((e,t)=>{let i=this._getNextRowCount(),s=[],l={rowIndex:i};if(Array.isArray(e))for(this.options.checkboxColumn&&s.push(this.getCheckboxHTML()),this.options.serialNoColumn&&s.push(i+1+""),s=s.concat(e);s.length<this.columns.length;)s.push("");else{for(let d of this.columns)d.id==="_checkbox"?s.push(this.getCheckboxHTML()):d.id==="_rowIndex"?s.push(i+1+""):s.push(e[d.id]);l.indent=e.indent||0}return this.prepareRow(s,l)})}prepareTreeRows(){this.rows.forEach((e,t)=>{if(bt(e.meta.indent)){let i=this.getRow(t+1);e.meta.isLeaf=!i||$o(i.meta.indent)||i.meta.indent<=e.meta.indent,e.meta.isTreeNodeClose=!1}})}prepareRowView(){this.rowViewOrder=this.rows.map(e=>e.meta.rowIndex)}prepareRow(e,t){let i={rowIndex:t.rowIndex,indent:t.indent};return e=e.map((s,l)=>this.prepareCell(s,l)).map(s=>Object.assign({},i,s)),e.meta=t,e}validateColumns(){let e=this.options.columns;if(!Array.isArray(e))throw new vt("`columns` must be an array");e.forEach((t,i)=>{if(typeof t!="string"&&typeof t!="object")throw new vt(`column "${i}" must be a string or an object`)})}validateData(e){if(Array.isArray(e)&&(e.length===0||Array.isArray(e[0])||typeof e[0]=="object"))return!0;throw new vt("`data` must be an array of arrays or objects")}appendRows(e){this.validateData(e),this.rows.push(...this.prepareRows(e))}sortRows(e,t="none"){e=+e,this.getColumns().map(i=>{i.colIndex===e?i.sortOrder=t:i.sortOrder="none"}),this._sortRows(e,t)}_sortRows(e,t){if(this.currentSort.colIndex===e&&(this.currentSort.sortOrder==="asc"&&t==="desc"||this.currentSort.sortOrder==="desc"&&t==="asc")){this.reverseArray(this.rowViewOrder),this.currentSort.sortOrder=t;return}if(this.rowViewOrder.sort((i,s)=>{let l=i,d=s,h=this.getCell(e,i).content,f=this.getCell(e,s).content;if(h=h==null?"":h,f=f==null?"":f,t==="none")return l-d;if(t==="asc"){if(h<f)return-1;if(h>f)return 1;if(h===f)return 0}else if(t==="desc"){if(h<f)return 1;if(h>f)return-1;if(h===f)return 0}return 0}),this.hasColumnById("_rowIndex")){let i=this.getColumnIndexById("_rowIndex");this.rows.forEach((s,l)=>{let d=this.rowViewOrder.indexOf(l),h=s[i];h.content=d+1+""})}}reverseArray(e){let t=null,i=null,s=e.length;for(t=0,i=s-1;t<i;t+=1,i-=1){let l=e[t];e[t]=e[i],e[i]=l}}switchColumn(e,t){let i=this.columns[e];this.columns[e]=this.columns[t],this.columns[t]=i,this.columns[e].colIndex=e,this.columns[t].colIndex=t,this.rows.forEach(s=>{let l=Object.assign({},s[e],{colIndex:t}),d=Object.assign({},s[t],{colIndex:e});s[t]=l,s[e]=d})}removeColumn(e){e=+e;let t=s=>s.colIndex!==e,i=(s,l)=>Object.assign({},s,{colIndex:l});this.columns=this.columns.filter(t).map(i),this.rows.forEach(s=>{s.splice(e,1),s.forEach((l,d)=>{l.colIndex=d})})}updateRow(e,t){e.length<this.columns.length&&(this.hasColumnById("_rowIndex")&&(e=[t+1+""].concat(e)),this.hasColumnById("_checkbox")&&(e=['<input type="checkbox" />'].concat(e)));let i=this.prepareRow(e,{rowIndex:t}),s=this.rows.findIndex(l=>l[0].rowIndex===t);return this.rows[s]=i,i}updateCell(e,t,i){let s;typeof e=="object"&&(s=e,e=s.colIndex,t=s.rowIndex,i=s),s=this.getCell(e,t);for(let l in i){let d=i[l];d!==void 0&&(s[l]=d)}return s}updateColumn(e,t){let i=this.getColumn(e);for(let s in t){let l=t[s];l!==void 0&&(i[s]=l)}return i}filterRows(e){return this.options.filterRows(this.rows,e).then(t=>(t||(t=this.getAllRowIndices()),t.then||(t=Promise.resolve(t)),t.then(i=>(this._filteredRows=i,{rowsToHide:this.getAllRowIndices().filter(l=>!i.includes(l)),rowsToShow:i}))))}getFilteredRowIndices(){return this._filteredRows||this.getAllRowIndices()}getAllRowIndices(){return this.rows.map(e=>e.meta.rowIndex)}getRowCount(){return this.rowCount}_getNextRowCount(){let e=this.rowCount;return this.rowCount++,e}getRows(e,t){return this.rows.slice(e,t)}getRowsForView(e,t){return this.rowViewOrder.map(s=>this.rows[s]).slice(e,t)}getColumns(e){let t=this.columns;return e&&(t=t.slice(this.getStandardColumnCount())),t}getStandardColumnCount(){return this.options.checkboxColumn&&this.options.serialNoColumn?2:this.options.checkboxColumn||this.options.serialNoColumn?1:0}getColumnCount(e){let t=this.columns.length;return e&&(t=t-this.getStandardColumnCount()),t}getColumn(e){return e=+e,e<0&&(e=this.columns.length+e),this.columns.find(t=>t.colIndex===e)}getColumnById(e){return this.columns.find(t=>t.id===e)}getRow(e){return e=+e,this.rows[e]}getCell(e,t){return t=+t,e=+e,this.getRow(t)[e]}getChildren(e){e=+e;let t=this.getRow(e).meta.indent,i=[];for(let s=e+1;s<this.rowCount;s++){let l=this.getRow(s);if(!isNaN(l.meta.indent)&&(l.meta.indent>t&&i.push(s),l.meta.indent===t))break}return i}getImmediateChildren(e){e=+e;let t=this.getRow(e).meta.indent,i=[],s=t+1;for(let l=e+1;l<this.rowCount;l++){let d=this.getRow(l);if(!(isNaN(d.meta.indent)||d.meta.indent>s)&&(d.meta.indent===s&&i.push(l),d.meta.indent===t))break}return i}get(){return{columns:this.columns,rows:this.rows}}getData(e){return this.data[e]}hasColumn(e){return Boolean(this.columns.find(t=>t.content===e))}hasColumnById(e){return Boolean(this.columns.find(t=>t.id===e))}getColumnIndex(e){return this.columns.findIndex(t=>t.content===e)}getColumnIndexById(e){return this.columns.findIndex(t=>t.id===e)}getCheckboxHTML(){return'<input type="checkbox" />'}},vt=class extends TypeError{},Ii={chevronDown:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>'},Xe=class{constructor(e){this.instance=e,qt(this,this.instance,["wrapper","options","style","header","bodyScrollable","columnmanager","rowmanager","datamanager","keyboard"]),this.bindEvents()}bindEvents(){this.bindFocusCell(),this.bindEditCell(),this.bindKeyboardSelection(),this.bindCopyCellContents(),this.bindMouseEvents(),this.bindTreeEvents()}bindFocusCell(){this.bindKeyboardNav()}bindEditCell(){this.$editingCell=null,_.on(this.bodyScrollable,"dblclick",".dt-cell",(e,t)=>{this.activateEditing(t)}),this.keyboard.on("enter",()=>{this.$focusedCell&&!this.$editingCell?this.activateEditing(this.$focusedCell):this.$editingCell&&this.deactivateEditing()})}bindKeyboardNav(){let e=t=>{if(!this.$focusedCell||this.$editingCell)return!1;let i=this.$focusedCell,{rowIndex:s,colIndex:l}=_.data(i);return t==="left"?i=this.getLeftMostCell$(s):t==="right"?i=this.getRightMostCell$(s):t==="up"?i=this.getTopMostCell$(l):t==="down"&&(i=this.getBottomMostCell$(l)),this.focusCell(i),!0};["left","right","up","down","tab","shift+tab"].map(t=>this.keyboard.on(t,()=>this.focusCellInDirection(t))),["left","right","up","down"].map(t=>this.keyboard.on(`ctrl+${t}`,()=>e(t))),this.keyboard.on("esc",()=>{this.deactivateEditing(!1),this.columnmanager.toggleFilter(!1)}),this.options.inlineFilters&&(this.keyboard.on("ctrl+f",t=>{let i=_.closest(".dt-cell",t.target),{colIndex:s}=_.data(i);return this.activateFilter(s),!0}),_.on(this.header,"focusin",".dt-filter",()=>{this.unfocusCell(this.$focusedCell)}))}bindKeyboardSelection(){let e=t=>{let i=this.getSelectionCursor();return t==="left"?i=this.getLeftCell$(i):t==="right"?i=this.getRightCell$(i):t==="up"?i=this.getAboveCell$(i):t==="down"&&(i=this.getBelowCell$(i)),i};["left","right","up","down"].map(t=>this.keyboard.on(`shift+${t}`,()=>this.selectArea(e(t))))}bindCopyCellContents(){this.keyboard.on("ctrl+c",()=>{let e=this.copyCellContents(this.$focusedCell,this.$selectionCursor),t=this.instance.translate("{count} cells copied",{count:e});e&&this.instance.showToastMessage(t,2)}),this.options.pasteFromClipboard&&this.keyboard.on("ctrl+v",e=>(this.instance.pasteTarget.focus(),setTimeout(()=>{let t=this.instance.pasteTarget.value;this.instance.pasteTarget.value="",this.pasteContentInCell(t)},10),!1))}bindMouseEvents(){let e=null;_.on(this.bodyScrollable,"mousedown",".dt-cell",i=>{e=!0,this.focusCell(_(i.delegatedTarget))}),_.on(this.bodyScrollable,"mouseup",()=>{e=!1});let t=i=>{!e||this.selectArea(_(i.delegatedTarget))};_.on(this.bodyScrollable,"mousemove",".dt-cell",bn(t,50))}bindTreeEvents(){_.on(this.bodyScrollable,"click",".dt-tree-node__toggle",(e,t)=>{let i=_.closest(".dt-cell",t),{rowIndex:s}=_.data(i);i.classList.contains("dt-cell--tree-close")?this.rowmanager.openSingleNode(s):this.rowmanager.closeSingleNode(s)})}focusCell(e,{skipClearSelection:t=0,skipDOMFocus:i=0,skipScrollToCell:s=0}={}){if(!e||e===this.$editingCell)return;let{colIndex:l,isHeader:d}=_.data(e);d||this.columnmanager.getColumn(l).focusable===!1||(s||this.scrollToCell(e),this.deactivateEditing(),t||this.clearSelection(),this.$focusedCell&&this.$focusedCell.classList.remove("dt-cell--focus"),this.$focusedCell=e,e.classList.add("dt-cell--focus"),i||e.focus(),this.highlightRowColumnHeader(e))}unfocusCell(e){!e||(e.classList.remove("dt-cell--focus"),this.$focusedCell=null,this.lastHeaders&&this.lastHeaders.forEach(t=>t&&t.classList.remove("dt-cell--highlight")))}highlightRowColumnHeader(e){let{colIndex:t,rowIndex:i}=_.data(e),s=this.datamanager.getColumnIndexById("_rowIndex"),l=`.dt-cell--header-${t}`,d=`.dt-cell--${s}-${i}`;this.lastHeaders&&this.lastHeaders.forEach(b=>b&&b.classList.remove("dt-cell--highlight"));let h=_(l,this.wrapper),f=_(d,this.wrapper);this.lastHeaders=[h,f],this.lastHeaders.forEach(b=>b&&b.classList.add("dt-cell--highlight"))}selectAreaOnClusterChanged(){if(!(this.$focusedCell&&this.$selectionCursor))return;let{colIndex:e,rowIndex:t}=_.data(this.$selectionCursor),i=this.getCell$(e,t);if(!i||i===this.$selectionCursor)return;let s=_.data(this.$focusedCell);this.$focusedCell=this.getCell$(s.colIndex,s.rowIndex),this.selectArea(i)}focusCellOnClusterChanged(){if(!this.$focusedCell)return;let{colIndex:e,rowIndex:t}=_.data(this.$focusedCell),i=this.getCell$(e,t);!i||this.focusCell(i,{skipClearSelection:1,skipDOMFocus:1,skipScrollToCell:1})}selectArea(e){!this.$focusedCell||this._selectArea(this.$focusedCell,e)&&(this.$selectionCursor=e)}_selectArea(e,t){if(e===t)return!1;let i=this.getCellsInRange(e,t);return i?(this.clearSelection(),this._selectedCells=i.map(s=>this.getCell$(...s)),requestAnimationFrame(()=>{this._selectedCells.map(s=>s.classList.add("dt-cell--highlight"))}),!0):!1}getCellsInRange(e,t){let i,s,l,d;if(typeof e=="number")[i,s,l,d]=arguments;else if(typeof e=="object"){if(!(e&&t))return!1;let y=_.data(e),S=_.data(t);i=+y.colIndex,s=+y.rowIndex,l=+S.colIndex,d=+S.rowIndex}if(s>d&&([s,d]=[d,s]),i>l&&([i,l]=[l,i]),this.isStandardCell(i)||this.isStandardCell(l))return!1;let h=[],f=i,b=s,v=[];for(;b<=d;)v.push(b),b+=1;return v.map(y=>{for(;f<=l;)h.push([f,y]),f++;f=i}),h}clearSelection(){(this._selectedCells||[]).forEach(e=>e.classList.remove("dt-cell--highlight")),this._selectedCells=[],this.$selectionCursor=null}getSelectionCursor(){return this.$selectionCursor||this.$focusedCell}activateEditing(e){this.focusCell(e);let{rowIndex:t,colIndex:i}=_.data(e),s=this.columnmanager.getColumn(i);if(s&&(s.editable===!1||s.focusable===!1))return;let l=this.getCell(i,t);if(l&&l.editable===!1)return;if(this.$editingCell){let{_rowIndex:f,_colIndex:b}=_.data(this.$editingCell);if(t===f&&i===b)return}this.$editingCell=e,e.classList.add("dt-cell--editing");let d=_(".dt-cell__edit",e);d.innerHTML="";let h=this.getEditor(i,t,l.content,d);h&&(this.currentCellEditor=h,h.initValue(l.content,t,s))}deactivateEditing(e=!0){e&&this.submitEditing(),this.$focusedCell&&this.$focusedCell.focus(),this.$editingCell&&(this.$editingCell.classList.remove("dt-cell--editing"),this.$editingCell=null)}getEditor(e,t,i,s){let l=this.datamanager.getColumn(e),d=this.datamanager.getRow(t),h=this.datamanager.getData(t),f=this.options.getEditor?this.options.getEditor(e,t,i,s,l,d,h):this.getDefaultEditor(s);return f===!1?!1:(f===void 0&&(f=this.getDefaultEditor(s)),f)}getDefaultEditor(e){let t=_.create("input",{class:"dt-input",type:"text",inside:e});return{initValue(i){t.focus(),t.value=i},getValue(){return t.value},setValue(i){t.value=i}}}submitEditing(){let e=Promise.resolve();if(!this.$editingCell)return e;let t=this.$editingCell,{rowIndex:i,colIndex:s}=_.data(t),l=this.datamanager.getColumn(s);if(t){let d=this.currentCellEditor;if(d){let h=d.getValue();h.then||(h=Promise.resolve(h)),e=h.then(f=>{let b=this.getCell(s,i).content;if(b===f)return!1;let v=d.setValue(f,i,l);return this.updateCell(s,i,f,!0),t.focus(),v&&v.then&&v.catch(y=>{console.log(y),this.updateCell(s,i,b)}),v})}}return this.currentCellEditor=null,e}copyCellContents(e,t){if(!t&&e){let{colIndex:d,rowIndex:h}=_.data(e),f=this.getCell(d,h);return cn(f.content),1}let i=this.getCellsInRange(e,t);if(!i)return 0;let s=i.map(d=>this.getCell(...d)).reduce((d,h)=>{let f=h.rowIndex;return d[f]=d[f]||[],d[f].push(h.content),d},[]),l=s.map(d=>d.join("	")).join(`
`);return cn(l),s.reduce((d,h)=>d+h.length,0)}pasteContentInCell(e){if(!this.$focusedCell)return;let t=e.split(`
`).map(d=>d.split("	")).filter(d=>d.length&&d.every(h=>h)),{colIndex:i,rowIndex:s}=_.data(this.$focusedCell),l={colIndex:+i,rowIndex:+s};t.forEach((d,h)=>{let f=h+l.rowIndex;d.forEach((b,v)=>{let y=v+l.colIndex;this.updateCell(y,f,b,!0)})})}activateFilter(e){this.columnmanager.toggleFilter(),this.columnmanager.focusFilter(e),this.columnmanager.isFilterShown||this.$focusedCell&&this.$focusedCell.focus()}updateCell(e,t,i,s=!1){let l=this.datamanager.updateCell(e,t,{content:i});this.refreshCell(l,s)}refreshCell(e,t=!1){let i=_(this.selector(e.colIndex,e.rowIndex),this.bodyScrollable);i.innerHTML=this.getCellContent(e,t)}toggleTreeButton(e,t){let i=this.columnmanager.getFirstColumnIndex(),s=this.getCell$(i,e);s&&s.classList[t?"remove":"add"]("dt-cell--tree-close")}isStandardCell(e){return e<this.columnmanager.getFirstColumnIndex()}focusCellInDirection(e){if(!this.$focusedCell||this.$editingCell&&["left","right","up","down"].includes(e))return!1;this.$editingCell&&["tab","shift+tab"].includes(e)&&this.deactivateEditing();let t=this.$focusedCell;if(e==="left"||e==="shift+tab"?t=this.getLeftCell$(t):e==="right"||e==="tab"?t=this.getRightCell$(t):e==="up"?t=this.getAboveCell$(t):e==="down"&&(t=this.getBelowCell$(t)),!t)return!1;let{colIndex:i}=_.data(t);if(!this.columnmanager.getColumn(i).focusable){let l=this.$focusedCell;this.unfocusCell(l),this.$focusedCell=t;let d=this.focusCellInDirection(e);return d||this.focusCell(l),d}return this.focusCell(t),!0}getCell$(e,t){return _(this.selector(e,t),this.bodyScrollable)}getAboveCell$(e){let{colIndex:t}=_.data(e),i=e.parentElement.previousElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.previousElementSibling;return i?_(`.dt-cell--col-${t}`,i):e}getBelowCell$(e){let{colIndex:t}=_.data(e),i=e.parentElement.nextElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.nextElementSibling;return i?_(`.dt-cell--col-${t}`,i):e}getLeftCell$(e){return e.previousElementSibling}getRightCell$(e){return e.nextElementSibling}getLeftMostCell$(e){return this.getCell$(this.columnmanager.getFirstColumnIndex(),e)}getRightMostCell$(e){return this.getCell$(this.columnmanager.getLastColumnIndex(),e)}getTopMostCell$(e){return this.getCell$(e,this.rowmanager.getFirstRowIndex())}getBottomMostCell$(e){return this.getCell$(e,this.rowmanager.getLastRowIndex())}getCell(e,t){return this.instance.datamanager.getCell(e,t)}getRowHeight(){return _.style(_(".dt-row",this.bodyScrollable),"height")}scrollToCell(e){if(_.inViewport(e,this.bodyScrollable))return!1;let{rowIndex:t}=_.data(e);return this.rowmanager.scrollToRow(t),!1}getRowCountPerPage(){return Math.ceil(this.instance.getViewportHeight()/this.getRowHeight())}getCellHTML(e){let{rowIndex:t,colIndex:i,isHeader:s,isFilter:l,isTotalRow:d}=e,h=Ri({rowIndex:t,colIndex:i,isHeader:s,isFilter:l,isTotalRow:d}),f=this.datamanager.getRow(t),b=!(s||l||d);return`
            <div class="${["dt-cell","dt-cell--col-"+i,b?`dt-cell--${i}-${t}`:"",b?"dt-cell--row-"+t:"",s?"dt-cell--header":"",s?`dt-cell--header-${i}`:"",l?"dt-cell--filter":"",b&&f&&f.meta.isTreeNodeClose?"dt-cell--tree-close":""].join(" ")}" ${h} tabindex="0">
                ${this.getCellContent(e)}
            </div>
        `}getCellContent(e,t=!1){let{isHeader:i,isFilter:s,colIndex:l}=e,h=!i&&e.editable!==!1?this.getEditCellHTML(l):"",b=i&&e.sortable!==!1?`<span class="sort-indicator">
                ${this.options.sortIndicator[e.sortOrder]}
            </span>`:"",y=i&&e.resizable!==!1?'<span class="dt-cell__resize-handle"></span>':"",T=i&&e.dropdown!==!1?this.columnmanager.getDropdownHTML():"",C=Xe.getCustomCellFormatter(e),w;if(i||s||!C)w=e.content;else if(!e.html||t){let M=this.datamanager.getRow(e.rowIndex),k=this.datamanager.getData(e.rowIndex);w=C(e.content,M,e.column,k)}else w=e.html;if(e.html=w,this.options.treeView&&!(i||s)&&e.indent!==void 0){let M=this.datamanager.getRow(e.rowIndex+1),k=M&&M.meta.indent>e.indent,N=20,oe="px";if(this.datamanager.getColumnIndexById("_rowIndex")+1===e.colIndex){let B=(e.indent||0)*N,Ne=k?`<span class="dt-tree-node__toggle" style="left: ${B-N}${oe}">
                        <span class="icon-open">${Ii.chevronDown}</span>
                        <span class="icon-close">${Ii.chevronRight}</span>
                    </span>`:"";w=`<span class="dt-tree-node" style="padding-left: ${B}${oe}">
                    ${Ne}
                    <span>${w}</span>
                </span>`}}let A=`
            <div class="${["dt-cell__content",i?`dt-cell__content--header-${l}`:`dt-cell__content--col-${l}`].join(" ")}">
                ${w}
                ${b}
                ${y}
                ${T}
            </div>
            ${h}
        `,W=document.createElement("div");W.innerHTML=w;let q=W.textContent;return q=q.replace(/\s+/g," ").trim(),A=A.replace(">",` title="${Eo(q)}">`),A}getEditCellHTML(e){return`<div class="dt-cell__edit dt-cell__edit--col-${e}"></div>`}selector(e,t){return`.dt-cell--${e}-${t}`}static getCustomCellFormatter(e){return e.format||e.column&&e.column.format||null}},Li=class{constructor(e){this.instance=e,qt(this,this.instance,["options","fireEvent","header","datamanager","cellmanager","style","wrapper","rowmanager","bodyScrollable","bodyRenderer"]),this.bindEvents()}renderHeader(){this.header.innerHTML="<div></div>",this.refreshHeader()}refreshHeader(){let e=this.datamanager.getColumns();_("div",this.header).innerHTML=this.getHeaderHTML(e),this.$filterRow=_(".dt-row-filter",this.header),this.$filterRow&&_.style(this.$filterRow,{display:"none"}),this.$columnMap=[],this.bindMoveColumn()}getHeaderHTML(e){let t=this.rowmanager.getRowHTML(e,{isHeader:1});return this.options.inlineFilters&&(t+=this.rowmanager.getRowHTML(e,{isFilter:1})),t}bindEvents(){this.bindDropdown(),this.bindResizeColumn(),this.bindPerfectColumnWidth(),this.bindFilter()}bindDropdown(){let e=".dt-dropdown__toggle",t=".dt-dropdown__list";this.instance.dropdownContainer.innerHTML=this.getDropdownListHTML(),this.$dropdownList=this.instance.dropdownContainer.firstElementChild,_.on(this.header,"click",e,d=>{this.openDropdown(d)});let i=d=>{let h=[e,e+" *",t,t+" *"].join(",");d.target.matches(h)||l()};_.on(document.body,"click",i),document.addEventListener("scroll",l,!0),this.instance.on("onDestroy",()=>{_.off(document.body,"click",i),_.off(document,"scroll",l)}),_.on(this.$dropdownList,"click",".dt-dropdown__list-item",(d,h)=>{if(!this._dropdownActiveColIndex)return;let f=this.options.headerDropdown,{index:b}=_.data(h),v=this._dropdownActiveColIndex,y=f[b].action;y&&y.call(this.instance,this.getColumn(v)),this.hideDropdown()});let s=this;function l(d){s.hideDropdown()}this.hideDropdown()}openDropdown(e){this._dropdownWidth||(_.style(this.$dropdownList,{display:""}),this._dropdownWidth=_.style(this.$dropdownList,"width")),_.style(this.$dropdownList,{display:"",left:e.clientX-this._dropdownWidth+4+"px",top:e.clientY+4+"px"});let t=_.closest(".dt-cell",e.target),{colIndex:i}=_.data(t);this._dropdownActiveColIndex=i}hideDropdown(){_.style(this.$dropdownList,{display:"none"}),this._dropdownActiveColIndex=null}bindResizeColumn(){let e=!1,t,i,s;_.on(this.header,"mousedown",".dt-cell .dt-cell__resize-handle",(h,f)=>{document.body.classList.add("dt-resize"),t=f.parentNode.parentNode;let{colIndex:v}=_.data(t),y=this.getColumn(v);y&&y.resizable===!1||(e=!0,i=_.style(_(".dt-cell__content",t),"width"),s=h.pageX)});let l=h=>{if(document.body.classList.remove("dt-resize"),!t)return;e=!1;let{colIndex:f}=_.data(t);this.setColumnWidth(f),this.style.setBodyStyle(),t=null};_.on(document.body,"mouseup",l),this.instance.on("onDestroy",()=>{_.off(document.body,"mouseup",l)});let d=h=>{if(!e)return;let f=h.pageX-s;this.options.direction==="rtl"&&(f=-1*f);let b=i+f,{colIndex:v}=_.data(t);this.options.minimumColumnWidth>b||(this.datamanager.updateColumn(v,{width:b}),this.setColumnHeaderWidth(v))};_.on(document.body,"mousemove",d),this.instance.on("onDestroy",()=>{_.off(document.body,"mousemove",d)})}bindPerfectColumnWidth(){_.on(this.header,"dblclick",".dt-cell .dt-cell__resize-handle",(e,t)=>{let i=t.parentNode.parentNode,{colIndex:s}=_.data(i),l=this.bodyRenderer.visibleRows.map(w=>w[s]).reduce((w,L)=>w.content.length>L.content.length?w:L),d=this.cellmanager.getCellHTML(l),h=document.createElement("div");h.innerHTML=d;let f=h.querySelector(".dt-cell__content").textContent,{borderLeftWidth:b,borderRightWidth:v,paddingLeft:y,paddingRight:S}=_.getStyle(this.bodyScrollable.querySelector(".dt-cell__content")),T=[b,v,y,S].map(parseFloat).reduce((w,L)=>w+L),C=_.measureTextWidth(f)+T;this.datamanager.updateColumn(s,{width:C}),this.setColumnHeaderWidth(s),this.setColumnWidth(s)})}bindMoveColumn(){if(this.options.disableReorderColumn)return;let e=_(".dt-row",this.header);this.sortable=Hn.create(e,{onEnd:t=>{let{oldIndex:i,newIndex:s}=t,l=t.item,{colIndex:d}=_.data(l);+d!==s&&this.switchColumn(i,s)},preventOnFilter:!1,filter:".dt-cell__resize-handle, .dt-dropdown",chosenClass:"dt-cell--dragging",animation:150})}sortColumn(e,t){this.instance.freeze(),this.sortRows(e,t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onSortColumn",this.getColumn(e))})}removeColumn(e){let t=this.getColumn(e);this.instance.freeze(),this.datamanager.removeColumn(e).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onRemoveColumn",t)})}switchColumn(e,t){this.instance.freeze(),this.datamanager.switchColumn(e,t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>{this.setColumnWidth(e),this.setColumnWidth(t),this.instance.unfreeze()}).then(()=>{this.fireEvent("onSwitchColumn",this.getColumn(e),this.getColumn(t))})}toggleFilter(e){if(!this.options.inlineFilters)return;let t;e===void 0?t=!this.isFilterShown:t=e,t?_.style(this.$filterRow,{display:""}):_.style(this.$filterRow,{display:"none"}),this.isFilterShown=t,this.style.setBodyStyle()}focusFilter(e){if(!this.isFilterShown)return;_(`.dt-cell--col-${e} .dt-filter`,this.$filterRow).focus()}bindFilter(){if(!this.options.inlineFilters)return;let e=t=>{this.applyFilter(this.getAppliedFilters())};_.on(this.header,"keydown",".dt-filter",xo(e,300))}applyFilter(e){this.datamanager.filterRows(e).then(({rowsToShow:t})=>{this.rowmanager.showRows(t)})}getAppliedFilters(){let e={};return _.each(".dt-filter",this.header).map(t=>{let i=t.value;i&&(e[t.dataset.colIndex]=i)}),e}applyDefaultSortOrder(){let e=this.getColumns().filter(t=>t.sortOrder!=="none");if(e.length===1){let t=e[0];this.sortColumn(t.colIndex,t.sortOrder)}}sortRows(e,t){return this.datamanager.sortRows(e,t)}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}setColumnWidth(e,t){e=+e;let i=t||this.getColumn(e).width,s=[`.dt-cell__content--col-${e}`,`.dt-cell__edit--col-${e}`].join(", "),l={width:i+"px"};this.style.setStyle(s,l)}setColumnHeaderWidth(e){e=+e,this.$columnMap=this.$columnMap||[];let t=`.dt-cell__content--header-${e}`,{width:i}=this.getColumn(e),s=this.$columnMap[e];s||(s=this.header.querySelector(t),this.$columnMap[e]=s),s.style.width=i+"px"}getColumnMinWidth(e){return e=+e,this.getColumn(e).minWidth||24}getFirstColumnIndex(){return this.datamanager.getColumnIndexById("_rowIndex")+1}getHeaderCell$(e){return _(`.dt-cell--header-${e}`,this.header)}getLastColumnIndex(){return this.datamanager.getColumnCount()-1}getDropdownHTML(){let{dropdownButton:e}=this.options;return`
            <div class="dt-dropdown">
                <div class="dt-dropdown__toggle">${e}</div>
            </div>
      `}getDropdownListHTML(){let{headerDropdown:e}=this.options;return`
            <div class="dt-dropdown__list">
            ${e.map((t,i)=>`
                <div class="dt-dropdown__list-item" data-index="${i}">${t.label}</div>
            `).join("")}
            </div>
        `}},Ai=class{constructor(e){this.instance=e,qt(this,this.instance,["options","fireEvent","wrapper","bodyScrollable","bodyRenderer","style"]),this.bindEvents(),this.refreshRows=gt(this.refreshRows,this)}get datamanager(){return this.instance.datamanager}get cellmanager(){return this.instance.cellmanager}bindEvents(){this.bindCheckbox()}bindCheckbox(){!this.options.checkboxColumn||(this.checkMap=[],_.on(this.wrapper,"click",'.dt-cell--col-0 [type="checkbox"]',(e,t)=>{let i=t.closest(".dt-cell"),{rowIndex:s,isHeader:l}=_.data(i),d=t.checked;l?this.checkAll(d):this.checkRow(s,d)}))}refreshRows(){this.instance.renderBody(),this.instance.setDimensions()}refreshRow(e,t){this.datamanager.updateRow(e,t).forEach(s=>{this.cellmanager.refreshCell(s,!0)})}getCheckedRows(){if(!this.checkMap)return[];let e=[];for(let t in this.checkMap)this.checkMap[t]===1&&e.push(t);return e}highlightCheckedRows(){this.getCheckedRows().map(e=>this.checkRow(e,!0))}checkRow(e,t){let i=t?1:0,s=l=>`.dt-cell--0-${l} [type="checkbox"]`;this.checkMap[e]=i,_.each(s(e),this.bodyScrollable).map(l=>{l.checked=t}),this.highlightRow(e,t),this.showCheckStatus(),this.fireEvent("onCheckRow",this.datamanager.getRow(e))}checkAll(e){let t=e?1:0;e?this.datamanager._filteredRows?this.datamanager._filteredRows.forEach(i=>{this.checkRow(i,e)}):this.checkMap=Array.from(Array(this.getTotalRows())).map(i=>t):this.checkMap=[],_.each('.dt-cell--col-0 [type="checkbox"]',this.bodyScrollable).map(i=>{i.checked=e}),this.highlightAll(e),this.showCheckStatus(),this.fireEvent("onCheckRow")}showCheckStatus(){if(!this.options.checkedRowStatus)return;let t=this.getCheckedRows().length;if(t>0){let i=this.instance.translate("{count} rows selected",{count:t});this.bodyRenderer.showToastMessage(i)}else this.bodyRenderer.clearToastMessage()}highlightRow(e,t=!0){let i=this.getRow$(e);if(!!i){if(!t&&this.bodyScrollable.classList.contains("dt-scrollable--highlight-all")){i.classList.add("dt-row--unhighlight");return}t&&i.classList.contains("dt-row--unhighlight")&&i.classList.remove("dt-row--unhighlight"),this._highlightedRows=this._highlightedRows||{},t?(i.classList.add("dt-row--highlight"),this._highlightedRows[e]=i):(i.classList.remove("dt-row--highlight"),delete this._highlightedRows[e])}}highlightAll(e=!0){if(e)this.bodyScrollable.classList.add("dt-scrollable--highlight-all");else{this.bodyScrollable.classList.remove("dt-scrollable--highlight-all");for(let t in this._highlightedRows)this._highlightedRows[t].classList.remove("dt-row--highlight");this._highlightedRows={}}}showRows(e){e=ko(e);let t=e.map(i=>this.datamanager.getRow(i));this.bodyRenderer.renderRows(t)}showAllRows(){let e=this.datamanager.getAllRowIndices();this.showRows(e)}getChildrenToShowForNode(e){let t=this.datamanager.getRow(e);return t.meta.isTreeNodeClose=!1,this.datamanager.getImmediateChildren(e)}openSingleNode(e){let t=this.getChildrenToShowForNode(e),i=this.bodyRenderer.visibleRowIndices,s=hn([...t,...i]).sort(mt);this.showRows(s)}getChildrenToHideForNode(e){let t=this.datamanager.getRow(e);t.meta.isTreeNodeClose=!0;let i=this.datamanager.getChildren(e);return i.forEach(s=>{let l=this.datamanager.getRow(s);l.meta.isLeaf||(l.meta.isTreeNodeClose=!0)}),i}closeSingleNode(e){let t=this.getChildrenToHideForNode(e),s=this.bodyRenderer.visibleRowIndices.filter(l=>!t.includes(l)).sort(mt);this.showRows(s)}expandAllNodes(){let i=this.datamanager.getRows().filter(d=>!d.meta.isLeaf).map(d=>this.getChildrenToShowForNode(d.meta.rowIndex)).flat(),s=this.bodyRenderer.visibleRowIndices,l=hn([...i,...s]).sort(mt);this.showRows(l)}collapseAllNodes(){let i=this.datamanager.getRows().filter(d=>d.meta.indent===0).map(d=>this.getChildrenToHideForNode(d.meta.rowIndex)).flat(),l=this.bodyRenderer.visibleRowIndices.filter(d=>!i.includes(d)).sort(mt);this.showRows(l)}setTreeDepth(e){let t=this.datamanager.getRows(),i=t.filter(h=>h.meta.indent<e),s=t.filter(h=>h.meta.indent>=e),l=s.filter(h=>h.meta.indent>e);s.forEach(h=>{h.meta.isLeaf||(h.meta.isTreeNodeClose=!0)}),i.forEach(h=>{h.meta.isLeaf||(h.meta.isTreeNodeClose=!1)});let d=t.filter(h=>!l.includes(h)).map(h=>h.meta.rowIndex).sort(mt);this.showRows(d)}getRow$(e){return _(this.selector(e),this.bodyScrollable)}getTotalRows(){return this.datamanager.getRowCount()}getFirstRowIndex(){return 0}getLastRowIndex(){return this.datamanager.getRowCount()-1}scrollToRow(e){e=+e,this._lastScrollTo=this._lastScrollTo||0;let t=this.getRow$(e);if(_.inViewport(t,this.bodyScrollable))return;let{height:i}=t.getBoundingClientRect(),{top:s,bottom:l}=this.bodyScrollable.getBoundingClientRect(),d=Math.floor((l-s)/i),h=0;e>this._lastScrollTo?h=i*(e+1-d):h=i*(e+1-1),this._lastScrollTo=e,_.scrollTop(this.bodyScrollable,h)}getRowHTML(e,t){let i=Ri(t),s=t.rowIndex;return t.isFilter&&(e=e.map(l=>Object.assign({},l,{content:this.getFilterInput({colIndex:l.colIndex,name:l.name}),isFilter:1,isHeader:void 0,editable:!1})),s="filter"),t.isHeader&&(s="header"),`
            <div class="dt-row dt-row-${s}" ${i}>
                ${e.map(l=>this.cellmanager.getCellHTML(l)).join("")}
            </div>
        `}getFilterInput(e){let t=`title="Filter based on ${e.name||"Index"}"`;return`<input class="dt-filter dt-input" type="text" ${Ri(e)} tabindex="1"
            ${e.colIndex===0?"disabled":t} />`}selector(e){return`.dt-row-${e}`}},Ro=Wn(function(r,e){(function(t){r.exports=t()})(function(){return function t(i,s,l){function d(b,v){if(!s[b]){if(!i[b]){var y=typeof jt=="function"&&jt;if(!v&&y)return y(b,!0);if(h)return h(b,!0);var S=new Error("Cannot find module '"+b+"'");throw S.code="MODULE_NOT_FOUND",S}var T=s[b]={exports:{}};i[b][0].call(T.exports,function(C){var w=i[b][1][C];return d(w||C)},T,T.exports,t,i,s,l)}return s[b].exports}for(var h=typeof jt=="function"&&jt,f=0;f<l.length;f++)d(l[f]);return d}({1:[function(t,i,s){Object.defineProperty(s,"__esModule",{value:!0});var l=function(){function v(y,S){for(var T=0;T<S.length;T++){var C=S[T];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(y,C.key,C)}}return function(y,S,T){return S&&v(y.prototype,S),T&&v(y,T),y}}();function d(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}var h={width:"100%",height:"100%"},f=function(y){return Number(y)===Number(y)},b=function(){l(v,null,[{key:"create",value:function(S,T){return new v(S,T)}},{key:"mergeStyle",value:function(S,T){for(var C in T)S.style[C]!==T[C]&&(S.style[C]=T[C])}},{key:"getMaxBrowserHeight",value:function(){var S=document.createElement("div"),T=document.createElement("div");v.mergeStyle(S,{position:"absolute",height:"1px",opacity:0}),v.mergeStyle(T,{height:"1e7px"}),S.appendChild(T),document.body.appendChild(S);var C=T.offsetHeight;return document.body.removeChild(S),C}}]);function v(y,S){var T=this;d(this,v),this._config={},this._lastRepaint=null,this._maxElementHeight=v.getMaxBrowserHeight(),this.refresh(y,S);var C=this._config,w=function L(){var A=T._getScrollPosition(),W=T._lastRepaint;if(T._renderAnimationFrame=window.requestAnimationFrame(L),A!==W&&(!W||Math.abs(A-W)>T._averageHeight)){var q=T._renderChunk();T._lastRepaint=A,q!==!1&&typeof C.afterRender=="function"&&C.afterRender()}};w()}return l(v,[{key:"destroy",value:function(){window.cancelAnimationFrame(this._renderAnimationFrame)}},{key:"refresh",value:function(S,T){var C=this;if(Object.assign(this._config,h,T),!S||S.nodeType!==1)throw new Error("HyperList requires a valid DOM Node container");this._element=S;var w=this._config,L=this._scroller||w.scroller||document.createElement(w.scrollerTagName||"tr");if(typeof w.useFragment!="boolean"&&(this._config.useFragment=!0),!w.generate)throw new Error("Missing required `generate` function");if(!f(w.total))throw new Error("Invalid required `total` value, expected number");if(!Array.isArray(w.itemHeight)&&!f(w.itemHeight))throw new Error("\n        Invalid required `itemHeight` value, expected number or array\n      ".trim());f(w.itemHeight)?this._itemHeights=Array(w.total).fill(w.itemHeight):this._itemHeights=w.itemHeight,Object.keys(h).filter(function(k){return k in w}).forEach(function(k){var N=w[k],oe=f(N),re=oe?!1:N.slice(-1)==="%";if(N&&typeof N!="string"&&typeof N!="number"){var B="Invalid optional `"+k+"`, expected string or number";throw new Error(B)}else oe&&(w[k]=N+"px");if(k==="height"){var Ne=oe?N:parseInt(N.replace(/px|%/,""),10);re?C._containerHeight=window.innerHeight*Ne/100:C._containerHeight=f(N)?N:Ne}});var A={width:""+w.width,height:""+w.height,overflow:"auto",position:"relative"};v.mergeStyle(S,A);var W=w.itemHeight*w.total,q=this._maxElementHeight;W>q&&console.warn(["HyperList: The maximum element height",q+"px has","been exceeded; please reduce your item height."].join(" "));var M={opacity:"0",position:"absolute",width:"1px",height:W+"px"};v.mergeStyle(L,M),this._scroller||S.appendChild(L),this._scroller=L,this._scrollHeight=this._computeScrollHeight(),this._itemPositions=this._itemPositions||Array(w.total).fill(0),this._computePositions(0),this._renderChunk(this._lastRepaint!==null),typeof w.afterRender=="function"&&w.afterRender()}},{key:"_getRow",value:function(S){var T=this._config,C=T.generate(S),w=C.height;if(w!==void 0&&f(w)?(C=C.element,w!==this._itemHeights&&(this._itemHeights[S]=w,this._computePositions(S),this._scrollHeight=this._computeScrollHeight(S))):w=this._itemHeights[S],!C||C.nodeType!==1)throw new Error("Generator did not return a DOM Node for index: "+S);var L=C.getAttribute("class")||"";C.setAttribute("class",L+" "+(T.rowClassName||"vrow"));var A=this._itemPositions[S];return v.mergeStyle(C,{position:"absolute",top:A+"px"}),C}},{key:"_getScrollPosition",value:function(){var S=this._config;return typeof S.overrideScrollPosition=="function"?S.overrideScrollPosition():this._element.scrollTop}},{key:"_renderChunk",value:function(S){var T=this._config,C=this._element,w=this._getScrollPosition(),L=T.total,A=T.reverse?this._getReverseFrom(w):this._getFrom(w)-1;if((A<0||A-this._screenItemsLen<0)&&(A=0),!S&&this._lastFrom===A)return!1;this._lastFrom=A;var W=A+this._cachedItemsLen;(W>L||W+this._cachedItemsLen>L)&&(W=L);var q=T.useFragment?document.createDocumentFragment():[],M=this._scroller;q[T.useFragment?"appendChild":"push"](M);for(var k=A;k<W;k++){var N=this._getRow(k);q[T.useFragment?"appendChild":"push"](N)}if(T.applyPatch)return T.applyPatch(C,q);C.innerHTML="",C.appendChild(q)}},{key:"_computePositions",value:function(){var S=arguments.length<=0||arguments[0]===void 0?1:arguments[0],T=this._config,C=T.total,w=T.reverse;S<1&&!w&&(S=1);for(var L=S;L<C;L++)w?L===0?this._itemPositions[0]=this._scrollHeight-this._itemHeights[0]:this._itemPositions[L]=this._itemPositions[L-1]-this._itemHeights[L]:this._itemPositions[L]=this._itemHeights[L-1]+this._itemPositions[L-1]}},{key:"_computeScrollHeight",value:function(){var S=this,T=this._config,C=T.total,w=this._itemHeights.reduce(function(M,k){return M+k},0);v.mergeStyle(this._scroller,{opacity:0,position:"absolute",width:"1px",height:w+"px"});var L=this._itemHeights.slice(0).sort(function(M,k){return M-k}),A=Math.floor(C/2),W=C%2===0?(L[A]+L[A-1])/2:L[A],q=this._element.clientHeight?this._element.clientHeight:this._containerHeight;return this._screenItemsLen=Math.ceil(q/W),this._containerHeight=q,this._cachedItemsLen=Math.max(this._cachedItemsLen||0,this._screenItemsLen*3),this._averageHeight=W,T.reverse&&window.requestAnimationFrame(function(){S._element.scrollTop=w}),w}},{key:"_getFrom",value:function(S){for(var T=0;this._itemPositions[T]<S;)T++;return T}},{key:"_getReverseFrom",value:function(S){for(var T=this._config.total-1;T>0&&this._itemPositions[T]<S+this._containerHeight;)T--;return T}}]),v}();s.default=b,i.exports=s.default},{}]},{},[1])(1)})}),Do=Pn(Ro),Mi=class{constructor(e){this.instance=e,this.options=e.options,this.datamanager=e.datamanager,this.rowmanager=e.rowmanager,this.cellmanager=e.cellmanager,this.bodyScrollable=e.bodyScrollable,this.footer=this.instance.footer,this.log=e.log}renderRows(e){if(this.visibleRows=e,this.visibleRowIndices=e.map(l=>l.meta.rowIndex),e.length===0){this.bodyScrollable.innerHTML=this.getNoDataHTML();return}let t=this.datamanager.rowViewOrder.map(l=>this.visibleRowIndices.includes(l)?l:null).filter(l=>l!==null),i=getComputedStyle(this.bodyScrollable),s={width:i.width,height:i.height,itemHeight:this.options.cellHeight,total:e.length,generate:l=>{let d=document.createElement("div"),h=t[l],f=this.datamanager.getRow(h),b=this.rowmanager.getRowHTML(f,f.meta);return d.innerHTML=b,d.children[0]},afterRender:()=>{this.restoreState()}};this.hyperlist?this.hyperlist.refresh(this.bodyScrollable,s):this.hyperlist=new Do(this.bodyScrollable,s),this.renderFooter()}render(){let e=this.datamanager.getRowsForView();this.renderRows(e),this.instance.setDimensions()}renderFooter(){if(!this.options.showTotalRow)return;let e=this.getTotalRow(),t=this.rowmanager.getRowHTML(e,{isTotalRow:1,rowIndex:"totalRow"});this.footer.innerHTML=t}getTotalRow(){return this.datamanager.getColumns().map(s=>{let l=null;return["_rowIndex","_checkbox"].includes(s.id)&&(l=""),{content:l,isTotalRow:1,colIndex:s.colIndex,column:s}}).map((s,l)=>{if(s.content==="")return s;if(this.options.hooks.columnTotal){let d=this.visibleRows.map(f=>f[l].content),h=this.options.hooks.columnTotal.call(this.instance,d,s);if(h!=null)return s.content=h,s}return s.content=this.visibleRows.reduce((d,h)=>{let f=h[l];return typeof f.content=="number"?(d==null&&(d=0),d+f.content):d},s.content),s})}restoreState(){this.rowmanager.highlightCheckedRows(),this.cellmanager.selectAreaOnClusterChanged(),this.cellmanager.focusCellOnClusterChanged()}showToastMessage(e,t){this.instance.toastMessage.innerHTML=this.getToastMessageHTML(e),t&&setTimeout(()=>{this.clearToastMessage()},t*1e3)}clearToastMessage(){this.instance.toastMessage.innerHTML=""}getNoDataHTML(){return`<div class="dt-scrollable__no-data">${this.options.noDataMessage}</div>`}getToastMessageHTML(e){return`<span class="dt-toast__message">${e}</span>`}},Ni=class{constructor(e){this.instance=e,qt(this,this.instance,["options","datamanager","columnmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer"]),this.scopeClass="dt-instance-"+e.constructor.instances,e.datatableWrapper.classList.add(this.scopeClass);let t=document.createElement("style");e.wrapper.insertBefore(t,e.datatableWrapper),this.styleEl=t,this.bindResizeWindow(),this.bindScrollHeader()}get stylesheet(){return this.styleEl.sheet}bindResizeWindow(){this.onWindowResize=this.onWindowResize.bind(this),this.onWindowResize=bn(this.onWindowResize,300),this.options.layout==="fluid"&&_.on(window,"resize",this.onWindowResize)}bindScrollHeader(){this._settingHeaderPosition=!1,_.on(this.bodyScrollable,"scroll",e=>{this._settingHeaderPosition||(this._settingHeaderPosition=!0,requestAnimationFrame(()=>{let t=-e.target.scrollLeft;_.style(this.header,{transform:`translateX(${t}px)`}),_.style(this.footer,{transform:`translateX(${t}px)`}),this._settingHeaderPosition=!1}))})}onWindowResize(){this.distributeRemainingWidth(),this.refreshColumnWidth(),this.setBodyStyle()}destroy(){this.styleEl.remove(),_.off(window,"resize",this.onWindowResize)}setStyle(e,t){if(e.includes(",")){e.split(",").map(d=>d.trim()).forEach(d=>{this.setStyle(d,t)});return}if(e=e.trim(),!e)return;this._styleRulesMap=this._styleRulesMap||{};let i=this._getPrefixedSelector(e);this._styleRulesMap[i]&&(this.removeStyle(e),t=Object.assign({},this._styleRulesMap[i],t));let s=this._getRuleString(t),l=`${i} { ${s} }`;this._styleRulesMap[i]=t,this.stylesheet.insertRule(l)}removeStyle(e){if(e.includes(",")){e.split(",").map(s=>s.trim()).forEach(s=>{this.removeStyle(s)});return}if(e=e.trim(),!e)return;let t=this._getPrefixedSelector(e),i=Array.from(this.stylesheet.cssRules).findIndex(s=>s.selectorText===t);i!==-1&&this.stylesheet.deleteRule(i)}_getPrefixedSelector(e){return`.${this.scopeClass} ${e}`}_getRuleString(e){return Object.keys(e).map(t=>{let i=t;return t.includes("-")||(i=gn(t)),`${i}:${e[t]};`}).join("")}setDimensions(){this.setCellHeight(),this.setupMinWidth(),this.setupNaturalColumnWidth(),this.setupColumnWidth(),this.distributeRemainingWidth(),this.setColumnStyle(),this.setBodyStyle()}setCellHeight(){this.setStyle(".dt-cell",{height:this.options.cellHeight+"px"})}setupMinWidth(){_.each(".dt-cell--header",this.header).map(e=>{let{colIndex:t}=_.data(e),i=this.getColumn(t);if(!i.minWidth){let s=_.style(_(".dt-cell__content",e),"width");i.minWidth=s}})}setupNaturalColumnWidth(){!_(".dt-row")||(_.each(".dt-row-header .dt-cell",this.header).map(e=>{let{colIndex:t}=_.data(e),i=this.datamanager.getColumn(t),s=_.style(_(".dt-cell__content",e),"width");typeof s=="number"&&s>=this.options.minimumColumnWidth?i.naturalWidth=s:i.naturalWidth=this.options.minimumColumnWidth}),_.each(".dt-row-0 .dt-cell",this.bodyScrollable).map(e=>{let{colIndex:t}=_.data(e),i=this.datamanager.getColumn(t),s=_.style(_(".dt-cell__content",e),"width");typeof s=="number"&&s>=i.naturalWidth?i.naturalWidth=s:i.naturalWidth=i.naturalWidth}))}setupColumnWidth(){if(this.options.layout==="ratio"){let e=_.style(this.datatableWrapper,"width");if(this.options.serialNoColumn){let s=this.datamanager.getColumnById("_rowIndex");e=e-s.width-1}if(this.options.checkboxColumn){let s=this.datamanager.getColumnById("_checkbox");e=e-s.width-1}let t=this.datamanager.getColumns().map(s=>s.id==="_rowIndex"||s.id==="_checkbox"?0:(s.width||(s.width=1),s.ratioWidth=parseInt(s.width,10),s.ratioWidth)).reduce((s,l)=>s+l),i=e/t;this.datamanager.getColumns().map(s=>{s.id==="_rowIndex"||s.id==="_checkbox"||(s.width=Math.floor(i*s.ratioWidth)-1)})}else this.datamanager.getColumns().map(e=>{e.width||(e.width=e.naturalWidth),e.id==="_rowIndex"&&(e.width=this.getRowIndexColumnWidth()),e.width<this.options.minimumColumnWidth&&(e.width=this.options.minimumColumnWidth)})}distributeRemainingWidth(){if(this.options.layout!=="fluid")return;let e=_.style(this.instance.datatableWrapper,"width"),t=_(".dt-row",this.bodyScrollable),i=e;if(t)i=_.style(t,"width");else{let d=_(".dt-row",this.instance.header);i=Array.from(d.children).map(f=>f.offsetWidth).reduce((f,b)=>f+b,0)}let s=this.datamanager.getColumns().filter(d=>d.resizable),l=(e-i)/s.length;s.map(d=>{let h=_.style(this.getColumnHeaderElement(d.colIndex),"width"),f=Math.floor(h+l)-2;this.datamanager.updateColumn(d.colIndex,{width:f})})}setColumnStyle(){this.datamanager.getColumns().map(e=>{e.align||(e.align="left"),["left","center","right"].includes(e.align)||(e.align="left"),this.setStyle(`.dt-cell--col-${e.colIndex}`,{"text-align":e.align}),this.columnmanager.setColumnHeaderWidth(e.colIndex),this.columnmanager.setColumnWidth(e.colIndex)})}refreshColumnWidth(){this.datamanager.getColumns().map(e=>{this.columnmanager.setColumnHeaderWidth(e.colIndex),this.columnmanager.setColumnWidth(e.colIndex)})}setBodyStyle(){let e=_.style(this.datatableWrapper,"width"),t=_(".dt-row",this.bodyScrollable);if(!t)return;let i=_.style(t,"width"),s=e>i?i:e;_.style(this.bodyScrollable,{width:s+"px"}),_.removeStyle(this.bodyScrollable,"height");let l=_.getStyle(this.bodyScrollable,"height"),d=(this.bodyRenderer.hyperlist||{})._scrollHeight||1/0,h=_.hasHorizontalOverflow(this.bodyScrollable),f;d<l&&(f=d,h&&(f+=_.scrollbarSize()),_.style(this.bodyScrollable,{height:f+"px"})),this.bodyScrollable.scrollHeight-this.bodyScrollable.offsetHeight<_.scrollbarSize()&&_.style(this.bodyScrollable,{overflowY:"hidden"}),this.options.layout==="fluid"&&_.style(this.bodyScrollable,{overflowX:"hidden"})}getColumnHeaderElement(e){return e=+e,e<0?null:_(`.dt-cell--col-${e}`,this.header)}getRowIndexColumnWidth(){let e=this.datamanager.getRowCount(),t=22;return _.measureTextWidth(e+"")+t}},Io={13:"enter",91:"meta",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",9:"tab",27:"esc",67:"c",70:"f",86:"v"},Oi=class{constructor(e){this.listeners={},_.on(e,"keydown",this.handler.bind(this))}handler(e){let t=Io[e.keyCode];e.shiftKey&&t!=="shift"&&(t="shift+"+t),(e.ctrlKey&&t!=="ctrl"||e.metaKey&&t!=="meta")&&(t="ctrl+"+t);let i=this.listeners[t];if(i&&i.length>0)for(let s of i){let l=s(e);(l===void 0||l===!0)&&e.preventDefault()}}on(e,t){e.split(",").map(s=>s.trim()).map(s=>{this.listeners[s]=this.listeners[s]||[],this.listeners[s].push(t)})}},Lo={"Sort Ascending":"Sort Ascending","Sort Descending":"Sort Descending","Reset sorting":"Reset sorting","Remove column":"Remove column","No Data":"No Data","{count} cells copied":{1:"{count} cell copied",default:"{count} cells copied"},"{count} rows selected":{1:"{count} row selected",default:"{count} rows selected"}},Ao={"Sort Ascending":"Aufsteigend sortieren","Sort Descending":"Absteigend sortieren","Reset sorting":"Sortierung zur\xFCcksetzen","Remove column":"Spalte entfernen","No Data":"Keine Daten","{count} cells copied":{1:"{count} Zelle kopiert",default:"{count} Zellen kopiert"},"{count} rows selected":{1:"{count} Zeile ausgew\xE4hlt",default:"{count} Zeilen ausgew\xE4hlt"}},Mo={"Sort Ascending":"Trier par ordre croissant","Sort Descending":"Trier par ordre d\xE9croissant","Reset sorting":"R\xE9initialiser le tri","Remove column":"Supprimer colonne","No Data":"Pas de donn\xE9es","{count} cells copied":{1:"{count} cellule copi\xE9e",default:"{count} cellules copi\xE9es"},"{count} rows selected":{1:"{count} ligne s\xE9lectionn\xE9e",default:"{count} lignes s\xE9lectionn\xE9es"}},No={"Sort Ascending":"Ordinamento ascendente","Sort Descending":"Ordinamento decrescente","Reset sorting":"Azzeramento ordinamento","Remove column":"Rimuovi colonna","No Data":"Nessun dato","{count} cells copied":{1:"Copiato {count} cella",default:"{count} celle copiate"},"{count} rows selected":{1:"{count} linea selezionata",default:"{count} linee selezionate"}};function Oo(){return{en:Lo,de:Ao,fr:Mo,it:No}}var Hi=class{constructor(e){this.language=e,this.translations=Oo()}addTranslations(e){this.translations=Object.assign(this.translations,e)}translate(e,t){let i=this.translations[this.language]&&this.translations[this.language][e]||e;return typeof i=="object"&&(i=t&&t.count?this.getPluralizedTranslation(i,t.count):e),To(i,t||{})}getPluralizedTranslation(e,t){return e[t]||e.default}};function Ho(r,e){let t=[];if(Object.keys(e).length===0)return r.map(i=>i.meta.rowIndex);for(let i in e){let s=e[i],d=(t.length?t.map(b=>r[b]):r).map(b=>b[i]),h=jo(s),f=Fo(r,h);f?t=f(h.text,d):t=d.map(b=>b.rowIndex)}return t}function Fo(r,e){let t=h=>{let f=Xe.getCustomCellFormatter(h);return f&&h.content?(h.html=f(h.content,r[h.rowIndex],h.column,r[h.rowIndex],!0),un(h.html)):h.content||""},i=h=>String(un(h.html||"")||t(h)).toLowerCase(),s=h=>parseFloat(h.content),l=(h,f)=>{if(h.column.compareValue){let v=h.column.compareValue(h,f);if(v&&Array.isArray(v))return v}let b=s(h);return isNaN(b)?[i(h),f]:[b,f]};return{contains(h,f){return f.filter(b=>{let v=i(b),y=(h||"").toLowerCase();return!y||v.includes(y)}).map(b=>b.rowIndex)},greaterThan(h,f){return f.filter(b=>{let[v,y]=l(b,h);return v>y}).map(b=>b.rowIndex)},lessThan(h,f){return f.filter(b=>{let[v,y]=l(b,h);return v<y}).map(b=>b.rowIndex)},equals(h,f){return f.filter(b=>parseFloat(b.content)===h).map(b=>b.rowIndex)},notEquals(h,f){return f.filter(b=>parseFloat(b.content)!==h).map(b=>b.rowIndex)},range(h,f){return f.filter(b=>{let v=l(b,h[0]),y=l(b,h[1]),S=v[0];return S>=v[1]&&S<=y[1]}).map(b=>b.rowIndex)},containsNumber(h,f){return f.filter(b=>{let v=parseFloat(h,10),y=h,S=s(b),T=i(b);return v===S||T.includes(y)}).map(b=>b.rowIndex)}}[e.type]}function jo(r=""){if(r.length===0)return{};let e=r;return[">","<","="].includes(e[0])?e=r.slice(1):e.startsWith("!=")&&(e=r.slice(2)),r.startsWith(">")&&e?{type:"greaterThan",text:e.trim()}:r.startsWith("<")&&e?{type:"lessThan",text:e.trim()}:r.startsWith("=")&&bt(e)?{type:"equals",text:Number(r.slice(1).trim())}:bt(e)?{type:"containsNumber",text:e}:r.startsWith("!=")&&bt(e)?{type:"notEquals",text:Number(r.slice(2).trim())}:r.split(":").length===2&&r.split(":").every(t=>bt(t.trim()))?(e=r.split(":"),{type:"range",text:e.map(t=>t.trim())}):{type:"contains",text:e.toLowerCase()}}function Po(r){return{columns:[],data:[],dropdownButton:Ii.chevronDown,headerDropdown:[{label:r.translate("Sort Ascending"),action:function(e){this.sortColumn(e.colIndex,"asc")}},{label:r.translate("Sort Descending"),action:function(e){this.sortColumn(e.colIndex,"desc")}},{label:r.translate("Reset sorting"),action:function(e){this.sortColumn(e.colIndex,"none")}},{label:r.translate("Remove column"),action:function(e){this.removeColumn(e.colIndex)}}],events:{onRemoveColumn(e){},onSwitchColumn(e,t){},onSortColumn(e){},onCheckRow(e){},onDestroy(){}},hooks:{columnTotal:null},sortIndicator:{asc:"\u2191",desc:"\u2193",none:""},overrideComponents:{},filterRows:Ho,freezeMessage:"",getEditor:null,serialNoColumn:!0,checkboxColumn:!1,clusterize:!0,logs:!1,layout:"fixed",noDataMessage:r.translate("No Data"),cellHeight:40,minimumColumnWidth:30,inlineFilters:!1,treeView:!1,checkedRowStatus:!0,dynamicRowHeight:!1,pasteFromClipboard:!1,showTotalRow:!1,direction:"ltr",disableReorderColumn:!1}}var Wo={DataManager:Di,CellManager:Xe,ColumnManager:Li,RowManager:Ai,BodyRenderer:Mi,Style:Ni,Keyboard:Oi},Pe=class{constructor(e,t){if(Pe.instances++,typeof e=="string"&&(e=document.querySelector(e)),this.wrapper=e,!(this.wrapper instanceof HTMLElement))throw new Error("Invalid argument given for `wrapper`");this.initializeTranslations(t),this.setDefaultOptions(),this.buildOptions(t),this.prepare(),this.initializeComponents(),this.options.data&&(this.refresh(),this.columnmanager.applyDefaultSortOrder())}initializeTranslations(e){this.language=e.language||"en",this.translationManager=new Hi(this.language),e.translations&&this.translationManager.addTranslations(e.translations)}setDefaultOptions(){this.DEFAULT_OPTIONS=Po(this)}buildOptions(e){this.options=this.options||{},this.options=Object.assign({},this.DEFAULT_OPTIONS,this.options||{},e),e.headerDropdown=e.headerDropdown||[],this.options.headerDropdown=[...this.DEFAULT_OPTIONS.headerDropdown,...e.headerDropdown],this.events=Object.assign({},this.DEFAULT_OPTIONS.events,this.options.events||{},e.events||{}),this.fireEvent=this.fireEvent.bind(this)}prepare(){this.prepareDom(),this.unfreeze()}initializeComponents(){let e=Object.assign({},Wo,this.options.overrideComponents),{Style:t,Keyboard:i,DataManager:s,RowManager:l,ColumnManager:d,CellManager:h,BodyRenderer:f}=e;this.style=new t(this),this.keyboard=new i(this.wrapper),this.datamanager=new s(this.options),this.rowmanager=new l(this),this.columnmanager=new d(this),this.cellmanager=new h(this),this.bodyRenderer=new f(this)}prepareDom(){this.wrapper.innerHTML=`
            <div class="datatable" dir="${this.options.direction}">
                <div class="dt-header"></div>
                <div class="dt-scrollable"></div>
                <div class="dt-footer"></div>
                <div class="dt-freeze">
                    <span class="dt-freeze__message">
                        ${this.options.freezeMessage}
                    </span>
                </div>
                <div class="dt-toast"></div>
                <div class="dt-dropdown-container"></div>
                <textarea class="dt-paste-target"></textarea>
            </div>
        `,this.datatableWrapper=_(".datatable",this.wrapper),this.header=_(".dt-header",this.wrapper),this.footer=_(".dt-footer",this.wrapper),this.bodyScrollable=_(".dt-scrollable",this.wrapper),this.freezeContainer=_(".dt-freeze",this.wrapper),this.toastMessage=_(".dt-toast",this.wrapper),this.pasteTarget=_(".dt-paste-target",this.wrapper),this.dropdownContainer=_(".dt-dropdown-container",this.wrapper)}refresh(e,t){this.datamanager.init(e,t),this.render(),this.setDimensions()}destroy(){this.wrapper.innerHTML="",this.style.destroy(),this.fireEvent("onDestroy")}appendRows(e){this.datamanager.appendRows(e),this.rowmanager.refreshRows()}refreshRow(e,t){this.rowmanager.refreshRow(e,t)}render(){this.renderHeader(),this.renderBody()}renderHeader(){this.columnmanager.renderHeader()}renderBody(){this.bodyRenderer.render()}setDimensions(){this.style.setDimensions()}showToastMessage(e,t){this.bodyRenderer.showToastMessage(e,t)}clearToastMessage(){this.bodyRenderer.clearToastMessage()}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}getRows(){return this.datamanager.getRows()}getCell(e,t){return this.datamanager.getCell(e,t)}getColumnHeaderElement(e){return this.columnmanager.getColumnHeaderElement(e)}getViewportHeight(){return this.viewportHeight||(this.viewportHeight=_.style(this.bodyScrollable,"height")),this.viewportHeight}sortColumn(e,t){this.columnmanager.sortColumn(e,t)}removeColumn(e){this.columnmanager.removeColumn(e)}scrollToLastColumn(){this.datatableWrapper.scrollLeft=9999}freeze(){_.style(this.freezeContainer,{display:""})}unfreeze(){_.style(this.freezeContainer,{display:"none"})}updateOptions(e){this.buildOptions(e)}fireEvent(e,...t){let i=[...this._internalEventHandlers[e]||[],this.events[e]].filter(Boolean);for(let s of i)s.apply(this,t)}on(e,t){this._internalEventHandlers=this._internalEventHandlers||{},this._internalEventHandlers[e]=this._internalEventHandlers[e]||[],this._internalEventHandlers[e].push(t)}log(){this.options.logs&&console.log.apply(console,arguments)}translate(e,t){return this.translationManager.translate(e,t)}};Pe.instances=0;var Bo="frappe-datatable",zo="0.0.0-development",qo="A modern datatable library for the web",Vo="dist/frappe-datatable.cjs.js",Yo="dist/frappe-datatable.min.js",Uo="dist/frappe-datatable.min.js",Xo={start:"yarn run dev",build:"rollup -c && NODE_ENV=production rollup -c",dev:"rollup -c -w","cy:server":"http-server -p 8989","cy:open":"cypress open","cy:run":"cypress run",test:"start-server-and-test cy:server http://localhost:8989 cy:run","test-local":"start-server-and-test cy:server http://localhost:8989 cy:open","travis-deploy-once":"travis-deploy-once","semantic-release":"semantic-release",lint:"eslint src","lint-and-build":"yarn lint && yarn build",commit:"npx git-cz"},Go=["dist","src"],Ko={autoprefixer:"^9.0.0",chai:"3.5.0",cypress:"^9.2.0","cz-conventional-changelog":"^2.1.0",deepmerge:"^2.0.1",eslint:"^5.0.1","eslint-config-airbnb":"^16.1.0","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.11.0","http-server":"^0.11.1",mocha:"3.3.0","postcss-custom-properties":"^7.0.0","postcss-nested":"^3.0.0",rollup:"^0.59.4","rollup-plugin-commonjs":"^8.3.0","rollup-plugin-eslint":"^4.0.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.3","rollup-plugin-postcss":"^1.2.8","rollup-plugin-uglify-es":"^0.0.1","semantic-release":"^17.1.1","start-server-and-test":"^1.4.1","travis-deploy-once":"^5.0.1"},Jo={type:"git",url:"https://github.com/frappe/datatable.git"},Qo=["datatable","data","grid","table"],Zo="Faris Ansari",ea="MIT",ta={url:"https://github.com/frappe/datatable/issues"},ia="https://frappe.io/datatable",na={hyperlist:"^1.0.0-beta",lodash:"^4.17.5",sortablejs:"^1.7.0"},sa={commitizen:{path:"cz-conventional-changelog"}},ra={name:Bo,version:zo,description:qo,main:Vo,unpkg:Yo,jsdelivr:Uo,scripts:Xo,files:Go,devDependencies:Ko,repository:Jo,keywords:Qo,author:Zo,license:ea,bugs:ta,homepage:ia,dependencies:na,config:sa};Pe.__version__=ra.version;vn.exports=Pe});$(document).on("app_ready",function(){document.referrer.endsWith("/login")&&frappe.call({method:"erpnext_oob.utils.get_user_default",callback:function(r){r.message&&r.message.forEach(function(e){var t=e.setting_key.toLowerCase().replaceAll(" ","_");frappe.defaults.set_user_default_local(t,e.setting_value)})}})});$(document).bind("toolbar_setup",function(){});frappe.views.Calendar=class extends frappe.views.Calendar{setup_options(e){super.setup_options(e),this.cal_options.locale=="zh"&&(this.cal_options.locale="zh-cn")}};var ua=class extends frappe.views.ListView{get_column_html(e,t){if(e.type==="Status")return`
				<div class="list-row-col hidden-xs ellipsis">
					${this.get_indicator_html(t)}
				</div>
			`;let i=e.df||{},s=i.label,l=i.fieldname,d=t[l]||"",h=()=>i.fieldtype==="Code"?d:i.fieldtype==="Percent"?`<div class="progress level" style="margin: 0px;">
						<div class="progress-bar progress-bar-success" role="progressbar"
							aria-valuenow="${d}"
							aria-valuemin="0" aria-valuemax="100" style="width: ${Math.round(d)}%;">
						</div>
					</div>`:frappe.format(d,i,null,t),f=()=>{let T,C;return this.settings.formatters&&this.settings.formatters[l]?C=this.settings.formatters[l](d,i,t):i.fieldtype=="Text Editor"||i.fetch_from&&["Text","Small Text"].includes(i.fieldtype)?C=strip_html(d):C=typeof d=="string"?frappe.utils.escape_html(d):d,i.fieldtype==="Image"?T=i.options?`<img src="${t[i.options]}" style="max-height: 30px; max-width: 100%;">`:`<div class="missing-image small">
						<span class="octicon octicon-circle-slash"></span>
					</div>`:i.fieldtype==="Select"?T=`<span class="filterable indicator ${frappe.utils.guess_colour(C)} ellipsis"
					data-filter="${l},=,${d}">
					${__(C)}
				</span>`:i.fieldtype==="Link"?T=`<a class="filterable text-muted ellipsis"
					data-filter="${l},=,${d}">
					${__(C)}
				</a>`:["Text Editor","Text","Small Text","HTML Editor"].includes(i.fieldtype)?T=`<span class="text-muted ellipsis">
					${__(C)}
				</span>`:T=`<a class="filterable text-muted ellipsis"
					data-filter="${l},=,${d}">
					${h()}
				</a>`,`<span class="ellipsis"
				title="${__(s)}: ${__(C)}">
				${T}
			</span>`},v=["list-row-col ellipsis",{Subject:"list-subject level",Field:"hidden-xs"}[e.type],frappe.model.is_numeric_field(i)?"text-right":""].join(" "),S={Subject:this.get_subject_html(t),Field:f()}[e.type];return`
			<div class="${v}">
				${S}
			</div>
		`}get_subject_html(e){let t=frappe.session.user,i=this.columns[0].df,s=e[i.fieldname]||e.name,l=strip_html(s.toString()),d=frappe.utils.escape_html(l),h=JSON.parse(e._liked_by||"[]"),f=h.includes(t)?"liked-by":"text-extra-muted not-liked",b=JSON.parse(e._seen||"[]").includes(t)?"":"bold";return`
			<input class="level-item list-row-checkbox hidden-xs" type="checkbox" data-name="${escape(e.name)}">
			<span class="level-item" style="margin-bottom: 1px;">
				<i class="octicon octicon-heart like-action ${f}"
					data-name="${e.name}" data-doctype="${this.doctype}"
					data-liked-by="${encodeURI(e._liked_by)||"[]"}"
				>
				</i>
				<span class="likes-count">
					${h.length>99?__("99")+"+":__(h.length||"")}
				</span>
			</span>
			<span class="level-item ${b} ellipsis" title="${__(d)}">
				<a class="ellipsis" href="${this.get_form_link(e)}" title="${__(d)}" data-doctype="${this.doctype}" data-name="${e.name}">
				${__(l)}
				</a>
			</span>
		`}};frappe.model.with_doctype("Print Format");var xe=class{constructor(e){Object.assign(this,e),this.editing=Boolean(this.values&&Object.keys(this.values).length)}make(){this.make_dialog(),this.setup_dialog_events(),this.dialog.show(),window.cur_dialog=this.dialog,this.editing&&this.set_default_values()}make_dialog(){this.dialog=new frappe.ui.Dialog({title:this.get_title(),fields:this.get_fields(),primary_action:e=>{e=this.process_data(e),!this.editing&&!e.name&&(e.name=`${this.type}-${this.label}-${frappe.utils.get_random(20)}`),this.dialog.hide(),this.primary_action(e)},primary_action_label:this.primary_action_label||__("Add")})}get_title(){let e=this.editing?"Edit":"Add",t=e=e+" "+frappe.model.unscrub(this.type);return __(t)}get_fields(){}set_default_values(){return this.dialog.set_values(this.values)}process_data(e){return e}setup_dialog_events(){}hide_field(e){this.dialog.set_df_property(e,"hidden",!0)}show_field(e){this.dialog.set_df_property(e,"hidden",!1)}setup_filter(e){this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group);let t=this.dialog.get_field("filter_area_loading").$wrapper;$(`<span class="text-muted">${__("Loading Filters...")}</span>`).appendTo(t),this.filters=[],this.generate_filter_from_json&&this.generate_filter_from_json(),this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:e,on_change:()=>{}}),frappe.model.with_doctype(e,()=>{this.filter_group.add_filters_to_filter_group(this.filters),this.hide_field("filter_area_loading"),this.show_field("filter_area")})}},ui=class extends xe{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"chart_name",label:"Chart Name",options:"Dashboard Chart",reqd:1},{fieldtype:"Data",fieldname:"label",label:"Label"}]}process_data(e){return e.label=e.label?e.label:e.chart_name,e}},pi=class extends xe{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"document_type",label:"DocType",options:"DocType",reqd:1,onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.document_type&&this.setup_filter(this.document_type)},get_query:()=>({filters:{issingle:0,istable:0}})},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Section Break",fieldname:"filter_section",label:__("Add Filters"),depends_on:"eval: doc.document_type"},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area"}]}generate_filter_from_json(){this.values&&this.values.quick_list_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.quick_list_filter,this.values.document_type))}process_data(e){if(this.filter_group){let t=this.filter_group.get_filters();e.quick_list_filter=JSON.stringify(t)}return e.label=e.label?e.label:e.document_type,e}},fi=class extends xe{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"onboarding_name",label:"Onboarding Name",options:"Module Onboarding",reqd:1}]}},_i=class extends xe{constructor(e){super(e)}get_fields(){let e=this;return[{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldname:"links",fieldtype:"Table",label:__("Card Links"),editable_grid:1,data:e.values?JSON.parse(e.values.links):[],get_data:()=>e.values?JSON.parse(e.values.links):[],fields:[{fieldname:"label",fieldtype:"Data",in_list_view:1,label:"Label"},{fieldname:"icon",fieldtype:"Icon",label:"Icon"},{fieldname:"link_type",fieldtype:"Select",in_list_view:1,label:"Link Type",reqd:1,options:["DocType","Page","Report"]},{fieldname:"link_to",fieldtype:"Dynamic Link",in_list_view:1,label:"Link To",reqd:1,get_options:t=>t.doc.link_type},{fieldname:"column_break_7",fieldtype:"Column Break"},{fieldname:"dependencies",fieldtype:"Data",label:"Dependencies"},{fieldname:"only_for",fieldtype:"Link",label:"Only for",options:"Country"},{default:"0",fieldname:"onboard",fieldtype:"Check",label:"Onboard"},{default:"0",fieldname:"is_query_report",fieldtype:"Check",label:"Is Query Report"}]}]}process_data(e){let t="";return e.links?e.links.map((i,s)=>{let l=s+1;i.link_type||(t=__("Following fields have missing values")+": <br><br><ul>",t+=`<li>${__("Link Type in Row")} ${l}</li>`),i.link_to||(t+=`<li>${__("Link To in Row")} ${l}</li>`),i.label=i.label?i.label:i.link_to}):t=__("You must add atleast one link."),t&&(t+="</ul>",frappe.throw({message:__(t),title:__("Missing Values Required"),indicator:"orange"})),e.label=e.label?e.label:e.chart_name,e}},mi=class extends xe{constructor(e){super(e)}hide_filters(){this.hide_field("count_section_break"),this.hide_field("filters_section_break")}show_filters(){this.show_field("count_section_break"),this.show_field("filters_section_break")}get_fields(){return[{fieldtype:"Select",fieldname:"type",label:"Type",reqd:1,options:`DocType
Report
Page
Dashboard
URL`,onchange:()=>{this.dialog.get_value("type")=="DocType"?this.dialog.fields_dict.link_to.get_query=()=>({query:"frappe.core.report.permitted_documents_for_user.permitted_documents_for_user.query_doctypes",filters:{user:frappe.session.user,include_single_doctypes:!0}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Dynamic Link",fieldname:"link_to",label:"Link To",options:"type",onchange:()=>{let e=this.dialog.get_value("link_to");e&&this.dialog.get_value("type")=="DocType"?frappe.model.with_doctype(e,async()=>{var l;let t=frappe.get_meta(e);e&&frappe.boot.single_types.includes(e)?this.hide_filters():e&&(this.setup_filter(e),this.show_filters());let i=["List","Report Builder","Dashboard","New"];t.is_tree===1&&i.push("Tree"),frappe.boot.calendars.includes(e)&&i.push("Calendar");let s=await frappe.db.get_value("Kanban Board",{reference_doctype:e},"name");(l=s==null?void 0:s.message)!=null&&l.name&&i.push("Kanban"),this.dialog.set_df_property("doc_view","options",i.join(`
`))}):this.hide_filters()},depends_on:e=>e.type!="URL",mandatory_depends_on:e=>e.type!="URL"},{fieldtype:"Data",fieldname:"url",label:"URL",options:"URL",default:"",depends_on:e=>e.type=="URL",mandatory_depends_on:e=>e.type=="URL"},{fieldtype:"Select",fieldname:"doc_view",label:"DocType View",options:`List
Report Builder
Dashboard
Tree
New
Calendar
Kanban`,description:__("Which view of the associated DocType should this shortcut take you to?"),default:"List",depends_on:e=>{if(this.dialog){let t=this.dialog.get_value("link_to"),i=frappe.boot.single_types.includes(t);return t&&e.type=="DocType"&&!i}return!1},onchange:()=>{this.dialog.get_value("doc_view")=="Kanban"?this.dialog.fields_dict.kanban_board.get_query=()=>({filters:{reference_doctype:this.dialog.get_value("link_to")}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Link",fieldname:"kanban_board",label:"Kanban Board",options:"Kanban Board",depends_on:()=>{var t;return((t=this.dialog)==null?void 0:t.get_value("doc_view"))=="Kanban"},mandatory_depends_on:()=>{var t;return((t=this.dialog)==null?void 0:t.get_value("doc_view"))=="Kanban"}},{fieldtype:"Section Break",fieldname:"filters_section_break",label:__("Count Filter"),hidden:1},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"count_section_break",label:__("Count Customizations"),hidden:1},{fieldtype:"Select",fieldname:"color",label:__("Color"),options:["Grey","Green","Red","Orange","Pink","Yellow","Blue","Cyan"],default:"Grey",input_class:"color-select",onchange:()=>{let e=this.dialog.fields_dict.color.value.toLowerCase(),t=this.dialog.fields_dict.color.$input;t.parent().find(".color-box").get(0)||$('<div class="color-box"></div>').insertBefore(t.get(0)),t.parent().find(".color-box").get(0).style.backgroundColor=`var(--text-on-${e})`}},{fieldtype:"Column Break",fieldname:"column_break_3"},{fieldtype:"Data",fieldname:"format",label:__("Format"),description:__("For Example: {} Open")}]}set_default_values(){super.set_default_values().then(()=>{this.dialog.fields_dict.link_to.df.onchange()})}generate_filter_from_json(){this.values&&this.values.stats_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.stats_filter,this.values.link_to))}process_data(e){if(this.dialog.get_value("type")=="DocType"&&this.filter_group){let t=this.filter_group.get_filters();e.stats_filter=JSON.stringify(t)}return e.label=e.label?e.label:frappe.model.unscrub(e.link_to),e.url&&(!validate_url(e.url)&&frappe.throw({message:__("<b>{0}</b> is not a valid URL",[e.url]),title:__("Invalid URL"),indicator:"red"}),e.label||(e.label="No Label (URL)")),e}},gi=class extends xe{constructor(e){super(e)}get_fields(){let e;return this.for_workspace?[{fieldtype:"Link",fieldname:"number_card_name",label:__("Number Card"),options:"Number Card",reqd:1,get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}})},{fieldtype:"Data",fieldname:"label",label:__("Label")}]:(e=[{fieldtype:"Select",label:__("Choose Existing Card or create New Card"),fieldname:"new_or_existing",options:["New Card","Existing Card"]},{fieldtype:"Link",fieldname:"card",label:__("Number Cards"),options:"Number Card",get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}}),depends_on:'eval: doc.new_or_existing == "Existing Card"'},{fieldtype:"Section Break",fieldname:"sb_1",depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Label"),fieldname:"label",fieldtype:"Data",mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Doctype"),fieldname:"document_type",fieldtype:"Link",options:"DocType",onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.set_aggregate_function_fields(this.dialog.get_values()),this.setup_filter(this.document_type)},hidden:1},{label:__("Color"),fieldname:"color",fieldtype:"Color"},{fieldtype:"Column Break",fieldname:"cb_1"},{label:__("Function"),fieldname:"function",fieldtype:"Select",options:["Count","Sum","Average","Minimum","Maximum"],mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Function Based On"),fieldname:"aggregate_function_based_on",fieldtype:"Select",depends_on:"eval: doc.function !== 'Count'",mandatory_depends_on:'eval: doc.function !== "Count" && doc.new_or_existing == "New Card"'},{fieldtype:"Section Break",fieldname:"sb_1",label:__("Add Filters"),depends_on:'eval: doc.new_or_existing == "New Card"'},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"sb_1"}],e)}setup_dialog_events(){!this.document_type&&!this.for_workspace&&(this.default_values&&this.default_values.doctype?(this.document_type=this.default_values.doctype,this.setup_filter(this.default_values.doctype),this.set_aggregate_function_fields()):this.show_field("document_type"))}set_aggregate_function_fields(){let e=[];this.document_type&&frappe.get_meta(this.document_type)&&frappe.get_meta(this.document_type).fields.map(t=>{if(frappe.model.numeric_fieldtypes.includes(t.fieldtype)){if(t.fieldtype=="Currency"&&(!t.options||t.options!=="Company:company:default_currency"))return;e.push({label:t.label,value:t.fieldname})}}),this.dialog.set_df_property("aggregate_function_based_on","options",e)}process_data(e){return this.for_workspace?(e.label=e.label?e.label:e.number_card_name,e):(e.new_or_existing=="Existing Card"&&(e.name=e.card),e.stats_filter=this.filter_group&&JSON.stringify(this.filter_group.get_filters()),e.document_type=this.document_type,e)}},bi=class extends xe{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"custom_block_name",label:"Custom Block Name",options:"Custom HTML Block",reqd:1,get_query:()=>({query:"frappe.desk.doctype.custom_html_block.custom_html_block.get_custom_blocks_for_user"})}]}};function vi(r){return{chart:ui,shortcut:mi,links:_i,onboarding:fi,quick_list:pi,number_card:gi,custom_block:bi}[r]||xe}var Re=class{constructor(e){Object.assign(this,e),this.make()}refresh(){this.set_title(),this.set_actions(),this.set_body(),this.setup_events(),this.set_footer()}get_config(){return{name:this.name,label:this.label}}customize(e){if(this.in_customize_mode=!0,this.action_area.empty(),e.allow_sorting&&frappe.utils.add_custom_button(frappe.utils.icon("es-line-drag","xs"),null,"drag-handle",__("Drag"),null,this.action_area),e.allow_hiding){this.hidden&&(this.widget.removeClass("hidden"),this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5));let t=this.hidden?"fa fa-eye":"fa fa-eye-slash",i=this.hidden?__("Show"):__("Hide");frappe.utils.add_custom_button(`<i class="${t}" aria-hidden="true"></i>`,()=>this.hide_or_show(),"show-or-hide-button",i,null,this.action_area),this.show_or_hide_button=this.action_area.find(".show-or-hide-button")}e.allow_edit&&frappe.utils.add_custom_button(frappe.utils.icon("es-line-edit-alt","xs"),()=>this.edit(),"edit-button",__("Edit"),null,this.action_area)}make(){this.make_widget(),this.widget.appendTo(this.container)}make_widget(){this.widget=$(`<div class="widget" data-widget-name="${this.name?this.name:""}">
			<div class="widget-head">
				<div class="widget-label">
					<div class="widget-title"></div>
					<div class="widget-subtitle"></div>
				</div>
				<div class="widget-control"></div>
			</div>
			<div class="widget-body"></div>
			<div class="widget-footer"></div>
		</div>`),this.title_field=this.widget.find(".widget-title"),this.subtitle_field=this.widget.find(".widget-subtitle"),this.body=this.widget.find(".widget-body"),this.action_area=this.widget.find(".widget-control"),this.head=this.widget.find(".widget-head"),this.footer=this.widget.find(".widget-footer"),this.refresh()}set_title(e){let t=this.title||this.label||this.name,i=e?frappe.ellipsis(t,e):t;this.title_field[0].innerHTML=`<span class="ellipsis" title="${i}">${i}</span>`,e&&this.title_field[0].setAttribute("title",this.title||this.label),this.subtitle&&this.subtitle_field.html(this.subtitle)}delete(e=!0,t=!1){let i=s=>{this.widget.remove(),!t&&this.options.on_delete&&this.options.on_delete(this.name,s)};e?(this.widget.addClass("zoom-out"),setTimeout(()=>{i(!0)},300)):i(!1)}edit(){var t;let e=vi(this.widget_type);this.edit_dialog=new e({for_workspace:(t=this.options)==null?void 0:t.for_workspace,label:this.label,type:this.widget_type,values:this.get_config(),primary_action:i=>{Object.assign(this,i),i.name=this.name,this.new=!0,this.refresh(),this.options.on_edit&&this.options.on_edit(i)},primary_action_label:__("Save")}),this.edit_dialog.make()}toggle_width(){this.width=="Full"?(this.widget.removeClass("full-width"),this.width=null,this.refresh()):(this.widget.addClass("full-width"),this.width="Full",this.refresh());let e=this.width=="Full"?__("Collapse"):__("Expand");this.resize_button.attr("title",e)}hide_or_show(){this.hidden?(this.body.css("opacity",1),this.title_field.css("opacity",1),this.footer.css("opacity",1),this.hidden=!1):(this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5),this.hidden=!0),this.show_or_hide_button.empty();let e=this.hidden?"fa fa-eye":"fa fa-eye-slash",t=this.hidden?__("Show"):__("Hide");$(`<i class="${e}" aria-hidden="true" title="${t}"></i>`).appendTo(this.show_or_hide_button)}setup_events(){}set_actions(){}set_body(){}set_footer(){}};frappe.provide("frappe.utils");var ut=class extends Re{async refresh(){frappe.utils.load_video_player(),this.new&&await this.get_onboarding_data(),this.set_title(),this.set_actions(),this.set_body(),this.setup_events()}get_config(){return{label:this.onboarding_name}}make_body(){this.body.empty(),this.steps_wrapper=$('<div class="onboarding-steps-wrapper"></div>').appendTo(this.body),this.step_preview=$(`<div class="onboarding-step-preview">
			<div class="onboarding-step-body"></div>
			<div class="onboarding-step-footer"></div>
		</div>`).appendTo(this.body),this.step_body=this.step_preview.find(".onboarding-step-body"),this.step_footer=this.step_preview.find(".onboarding-step-footer"),this.steps.forEach((t,i)=>{this.add_step(t,i)});let e=this.steps.findIndex(t=>!t.is_skipped&&!t.is_complete);e==-1&&(e=0),this.show_step(this.steps[e])}add_step(e,t){let i="pending";e.is_skipped&&(i="skipped"),e.is_complete&&(i="complete");let s=$(`<a class="onboarding-step ${i}">
				<div class="step-title">
					<div class="step-index step-pending">${frappe.utils.icon("es-line-success","md","","","step-icon")}</div>
					<div class="step-index step-skipped">${frappe.utils.icon("es-line-close-circle","md","","--icon-stroke: var(--gray-600);","step-icon")}</div>
					<div class="step-index step-complete">${frappe.utils.icon("es-solid-success","md","","","step-icon")}</div>
					<div class="step-text">${__(e.title)}</div>
				</div>
			</a>`);if(e.$step=s,!e.is_complete&&!e.is_skipped){let l=$(`<div class="step-skip">${__("Skip")}</div>`);l.appendTo(s),l.on("click",()=>{this.skip_step(e),event.stopPropagation()})}return s.on("click",()=>this.show_step(e)),s.appendTo(this.steps_wrapper),s}show_step(e){this.active_step&&this.active_step.$step.removeClass("active"),e.$step.addClass("active"),this.active_step=e;let t={"Watch Video":d=>this.show_video(d),"Create Entry":d=>{d.is_complete?frappe.set_route(`/app/List/${d.reference_document}`):d.show_full_form?this.create_entry(d):this.show_quick_entry(d)},"Show Form Tour":d=>this.show_form_tour(d),"Update Settings":d=>this.update_settings(d),"View Report":d=>this.open_report(d),"Go to Page":d=>this.go_to_page(d)},i=()=>{this.step_body.empty(),this.step_footer.empty(),s(),e.intro_video_url?$(`<button class="btn btn-default btn-sm">${__("Watch Tutorial")}</button>`).appendTo(this.step_footer).on("click",l):$(`<button class="btn btn-default btn-sm">${__(e.action_label||e.action)}</button>`).appendTo(this.step_footer).on("click",()=>t[e.action](e))},s=()=>{let d=e.description?frappe.markdown(e.description):`<h1>${__(e.title)}</h1>`;e.action==="Create Entry"&&(d+=`<p>
					<a href='/app/${frappe.router.slug(e.reference_document)}'>
						${__("Show {0} List",[__(e.reference_document)])}</a>
				</p>`),this.step_body.html(d)},l=()=>{this.step_body.empty(),this.step_footer.empty();let d=$(`<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="${e.intro_video_url}"></div>`);d.appendTo(this.step_body);let h=new frappe.Plyr(d[0],{hideControls:!0,resetOnEnd:!0});$(`<button class="btn btn-primary btn-sm">${__(e.action_label||e.action)}</button>`).appendTo(this.step_footer).on("click",()=>{h.pause(),t[e.action](e)}),$(window).one("hashchange",()=>{h.pause()}),$(`<button class="btn btn-secondary ml-2 btn-sm">${__("Back")}</button>`).appendTo(this.step_footer).on("click",i)};i()}go_to_page(e){this.mark_complete(e),frappe.set_route(e.path).then(()=>{let t=e.callback_message||__("You can continue with the onboarding after exploring this page"),i=e.callback_title||__("Awesome Work"),s=frappe.msgprint({message:t,title:i,primary_action:{action:()=>{s.hide()},label:()=>__("Continue")},wide:!0})})}open_report(e){let t=frappe.utils.generate_route({name:e.reference_report,type:"report",is_query_report:e.report_type!=="Report Builder",doctype:e.report_reference_doctype}),i=frappe.get_route();frappe.set_route(t).then(()=>{let s=frappe.msgprint({message:__(e.report_description),title:__(e.reference_report),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(e)}),s.hide()},label:()=>__("Continue")},secondary_action:{action:()=>{s.hide(),frappe.set_route(i).then(()=>{this.mark_complete(e)})},label:__("Go Back")}});frappe.msg_dialog.custom_onhide=()=>this.mark_complete(e)})}show_form_tour(e){let t;e.is_single?t=frappe.router.slug(e.reference_document):t=`${frappe.router.slug(e.reference_document)}/new`;let i=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=s=>{let l=()=>{let h=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Onboarding complete"),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(e)}),h.hide()},label:()=>__("Continue")}})},d=e.form_tour;s.tour.init({tour_name:d,on_finish:l}).then(()=>s.tour.start())},frappe.set_route(t)}update_settings(e){let t=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=i=>{i.scroll_to_field(e.field),i.doc.__unsaved=!0},frappe.route_hooks.after_save=i=>{let s=!1,l={},d=i.doc[e.field],h=null;d&&e.value_to_validate=="%"&&(s=!0),d==e.value_to_validate&&(s=!0),cstr(d)==cstr(e.value_to_validate)&&(s=!0),s?(l.message=__("Let's take you back to onboarding"),l.title=__("Action Complete"),l.primary_action={action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")},h=()=>l.primary_action.action()):(l.message=__("Looks like you didn't change the value"),l.title=__("Try Again"),l.secondary_action={action:()=>frappe.set_route(t),label:__("Go Back")},l.primary_action={action:()=>{frappe.set_route(t).then(()=>{setTimeout(()=>{this.skip_step(e)},300)})},label:__("Skip Step")},h=()=>l.secondary_action.action()),frappe.msgprint(l),frappe.msg_dialog.custom_onhide=()=>h()},frappe.set_route("Form",e.reference_document)}async create_entry(e){let t=frappe.get_route(),i=await this.get_first_document(e.reference_document);frappe.route_hooks={},frappe.route_hooks.after_load=l=>{let d=()=>{frappe.msgprint({message:__("Awesome, now try making an entry yourself"),title:__("Document Saved"),primary_action:{action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(e)}},h=e.form_tour;l.tour.init({tour_name:h,on_finish:d}).then(()=>l.tour.start())};let s=()=>{frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Action Complete"),primary_action:{action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(e)}};e.is_submittable?(frappe.route_hooks.after_save=()=>{frappe.msgprint({message:__("Submit this document to complete this step."),title:__("Document Saved")})},frappe.route_hooks.after_submit=s):frappe.route_hooks.after_save=s,frappe.set_route("Form",e.reference_document,i)}show_quick_entry(e){let t=frappe.get_route_str();frappe.ui.form.make_quick_entry(e.reference_document,()=>{if(frappe.get_route_str()!=t){let i=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Document Saved"),primary_action:{action:()=>{i.hide(),frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}});frappe.msg_dialog.custom_onhide=()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})}}else frappe.show_alert(__("Document Saved")+"<br>"+__("Let us continue with the onboarding")),this.mark_complete(e)},null,null,!0)}show_video(e){frappe.help.show_video(e.video_url,e.title),this.mark_complete(e)}mark_complete(e){let t=e.$step,i=()=>{e.is_complete=!0,t.removeClass("skipped"),t.addClass("complete")};this.update_step_status(e,"is_complete",1,i),this.activate_next_step(e)}skip_step(e){let t=e.$step,i=()=>{e.is_skipped=!0,t.removeClass("complete"),t.removeClass("pending"),t.addClass("skipped")};this.update_step_status(e,"is_skipped",1,i),this.activate_next_step(e)}activate_next_step(e){let t=this.steps.findIndex(s=>s==e),i=this.steps[t+1];!i||this.show_step(i)}update_step_status(e,t,i,s){let l={is_complete:"complete",is_skipped:"skipped"};frappe.route_hooks={},frappe.call("frappe.desk.desktop.update_onboarding_step",{name:e.name,field:t,value:i}).then(()=>{s(),e.$step.removeClass("pending").removeClass("complete").removeClass("skipped").addClass(l[t]),this.steps.filter(h=>!(h.is_complete||h.is_skipped)).length==0&&this.show_success()})}show_success(){let e=this.success||__("You seem good to go!"),t=this.success_state_image||"/assets/frappe/images/ui-states/success-color.png",i="";this.docs_url&&(i=__('Congratulations on completing the module setup. If you want to learn more you can refer to the documentation <a target="_blank" href="{0}">here</a>.',[this.docs_url]));let s=$(`<div class="text-center onboarding-success">
					<img src="${t}" alt="Success State" class="zoom-in success-state">
					<h3>${e}</h3>
					<div class="text-muted">${i}</div>
					<button class="btn btn-primary btn-sm">${__("Continue")}</button>
			</div>
		`);s.find(".btn").on("click",()=>this.delete()),this.step_preview.empty(),s.appendTo(this.step_preview)}set_body(){this.widget.addClass("onboarding-widget-box"),this.is_dismissed()?this.widget.hide():this.make_body()}is_dismissed(){if(this.in_customize_mode)return!1;let e=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");if(Object.keys(e).includes(this.title)){let t=new Date(e[this.title]),i=new Date;return frappe.datetime.get_hour_diff(i,t)<24}return!1}set_actions(){if(this.in_customize_mode)return;this.action_area.empty();let e=$(`<div class="btn btn-sm btn-secondary small" style="cursor:pointer;">${__("Dismiss",null,"Stop showing the onboarding widget.")}</div>`);e.on("click",()=>{let t=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");t[this.title]=frappe.datetime.now_datetime(),localStorage.setItem("dismissed-onboarding",JSON.stringify(t)),this.delete(!0,!0),this.widget.closest(".ce-block").hide(),frappe.telemetry.capture("dismissed_"+frappe.scrub(this.title),"frappe_onboarding")}),e.appendTo(this.action_area)}get_onboarding_data(){return frappe.model.with_doc("Module Onboarding",this.onboarding_name).then(e=>{if(e){this.onboarding_doc=e,this.label=e.label,this.title=e.title||__("Let's Get Started"),this.subtitle=e.subtitle,this.success=e.success,this.docs_url=e.docs_url,this.user_can_dismiss=e.user_can_dismiss;let t="frappe.desk.doctype.onboarding_step.onboarding_step.get_onboarding_steps";return frappe.xcall(t,{ob_steps:e.steps}).then(i=>{this.steps=i})}})}async get_first_document(e){let{message:t}=await frappe.db.get_value("Form Tour",{reference_doctype:e},["first_document"]),i;return t.first_document&&await frappe.db.get_list(e,{order_by:"creation"}).then(s=>{Array.isArray(s)&&s.length&&(i=s[0].name)}),i||"new"}};var yi=class extends ut{show_step(e){e.description=__(e.description),e.title=__(e.title),super.show_step(e)}};frappe.widget.widget_factory.onboarding=yi;frappe.provide("frappe.utils");var pt=class extends Re{constructor(e){e.shadow=!0,super(e)}get_config(){return{name:this.name,number_card_name:this.number_card_name,label:this.label,color:this.color,hidden:this.hidden}}refresh(){this.set_body()}set_body(){this.widget.addClass("number-widget-box"),this.make_card()}make_card(){frappe.model.with_doc("Number Card",this.number_card_name||this.name).then(e=>{if(e)this.card_doc=e,this.render_card();else if(this.document_type)frappe.run_serially([()=>this.create_number_card(),()=>this.render_card()]);else{this.delete(!1);return}this.set_events()})}create_number_card(){return this.set_doc_args(),frappe.xcall("frappe.desk.doctype.number_card.number_card.create_number_card",{args:this.card_doc}).then(e=>{this.name=e.name,this.card_doc=e,this.widget.attr("data-widget-name",this.name)})}set_events(){$(this.body).click(()=>{this.in_customize_mode||this.set_route()})}set_route(){if(this.card_doc.type==="Custom"){this.set_route_for_custom_card();return}let e=this.card_doc.type!=="Report",t=e?this.card_doc.document_type:this.card_doc.report_name,i=frappe.utils.generate_route({name:t,type:e?"doctype":"report",is_query_report:!e});if(e){let s=JSON.parse(this.card_doc.filters_json);frappe.route_options=s.reduce((l,d)=>Object.assign(l,{[`${d[0]}.${d[1]}`]:[d[2],d[3]]}),{})}frappe.set_route(i)}set_route_for_custom_card(){var e;!((e=this.data)!=null&&e.route)||(this.data.route_options&&(frappe.route_options=this.data.route_options),frappe.set_route(this.data.route))}set_doc_args(){this.card_doc=Object.assign({},{document_type:this.document_type,label:this.label,function:this.function,aggregate_function_based_on:this.aggregate_function_based_on,color:this.color,filters_json:this.stats_filter})}get_settings(e){return this.filters=this.get_filters(),{Custom:{method:this.card_doc.method,args:{filters:this.filters},get_number:i=>this.get_number_for_custom_card(i)},Report:{method:"frappe.desk.query_report.run",args:{report_name:this.card_doc.report_name,filters:this.filters,ignore_prepared_report:1},get_number:i=>this.get_number_for_report_card(i)},"Document Type":{method:"frappe.desk.doctype.number_card.number_card.get_result",args:{doc:this.card_doc,filters:this.filters},get_number:i=>this.get_number_for_doctype_card(i)}}[e]}get_filters(){return frappe.dashboard_utils.get_all_filters(this.card_doc)}async render_card(){this.prepare_actions(),this.set_title(),this.set_loading_state(),this.card_doc.type||(this.card_doc.type="Document Type"),this.settings=this.get_settings(this.card_doc.type),await this.get_data(),this.render_number(),this.render_stats()}set_loading_state(){$(this.body).html(`<div class="number-card-loading text-muted">
			${__("Loading...")}
		</div>`)}async get_data(){return this.data=await frappe.xcall(this.settings.method,this.settings.args),this.settings.get_number(this.data)}get_number_for_custom_card(e){typeof e=="object"?(this.number=e.value,this.set_formatted_number(e)):this.formatted_number=e}get_number_for_doctype_card(e){if(this.number=e,this.card_doc.function!=="Count")return frappe.model.with_doctype(this.card_doc.document_type,()=>{let t=frappe.meta.get_docfield(this.card_doc.document_type,this.card_doc.aggregate_function_based_on);this.set_formatted_number(t)});this.formatted_number=e}get_number_for_report_card(e){let t=this.card_doc.report_field,i=e.result.reduce((l,d)=>(d[t]&&l.push(d[t]),l),[]),s=e.columns.find(l=>l.fieldname==t);this.number=frappe.report_utils.get_result_of_fn(this.card_doc.report_function,i),this.set_formatted_number(s)}set_formatted_number(e){let t=frappe.sys_defaults.country,s=frappe.utils.shorten_number(this.number,t,5).split(" "),l=s[1]||"";s[0]=window.convert_old_to_new_number_format(s[0]);let d=$(frappe.format(s[0],e)).text();this.formatted_number=d+" "+__(l)}render_number(){let e=this.card_doc.color?`style="color: ${this.card_doc.color};"`:"";$(this.body).html(`<div class="widget-content">
			<div class="number" ${e}>${this.formatted_number}</div>
			</div>`)}render_stats(){if(this.card_doc.type!=="Document Type"||!this.card_doc.show_percentage_stats)return;let e="",t="";return this.get_percentage_stats().then(()=>{this.percentage_stat==0||this.percentage_stat==null?t="grey-stat":this.percentage_stat>0?(e=`<span class="indicator-pill-round green">
						${frappe.utils.icon("es-line-arrow-up-right","xs")}
					</span>`,t="green-stat"):(e=`<span class="indicator-pill-round red">
						${frappe.utils.icon("arrow-down-right","xs")}
					</span>`,t="red-stat");let s={Daily:__("since yesterday"),Weekly:__("since last week"),Monthly:__("since last month"),Yearly:__("since last year")}[this.card_doc.stats_time_interval],l=(()=>{if(this.percentage_stat==null)return NaN;let d=this.percentage_stat.split(" "),h=d[1]||"";return Math.abs(d[0])+" "+h})();isNaN(l)||$(this.body).find(".widget-content").append(`<div class="card-stats ${t}">
				<span class="percentage-stat-area">
					${e} ${l} % ${s}
				</span>
			</div>`)})}get_percentage_stats(){return frappe.xcall("frappe.desk.doctype.number_card.number_card.get_percentage_difference",{doc:this.card_doc,filters:this.filters,result:this.number}).then(e=>{e!==void 0&&(this.percentage_stat=frappe.utils.shorten_number(e))})}prepare_actions(){if(this.in_customize_mode)return;let e=[{label:__("Refresh"),action:"action-refresh",handler:()=>{this.render_card()}},{label:__("Edit"),action:"action-edit",handler:()=>{let t=this.number_card_name||this.name;frappe.set_route("Form","Number Card",t)}}];this.set_card_actions(e)}set_card_actions(e){this.card_actions=$(`<div class="card-actions dropdown pull-right">
				<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				...
				</a>
				<ul class="dropdown-menu" style="max-height: 300px; overflow-y: auto;">
					${e.map(t=>`<li class="dropdown-item">
									<a data-action="${t.action}">${t.label}</a>
								</li>`).join("")}
				</ul>
			</div>`),this.card_actions.find("a[data-action]").each((t,i)=>{let s=i.dataset.action;$(i).click(e.find(l=>l.action===s))}),this.action_area.html(this.card_actions)}};var wi=class extends pt{set_title(){$(this.title_field).html(`<div class="number-label">${__(this.card_doc.label)}</div>`)}};frappe.widget.widget_factory.number_card=wi;frappe.provide("frappe.widget.utils");frappe.provide("frappe.dashboards");frappe.provide("frappe.dashboards.chart_sources");var ft=class extends Re{constructor(e){e.shadow=!0,super(e),this.height=this.height||240}get_config(){return{name:this.name,chart_name:this.chart_name,label:this.label,hidden:this.hidden,width:this.width}}refresh(){delete this.dashboard_chart,this.set_body(),this.make_chart()}set_chart_title(){let e=this.widget.width()<600?40:60;this.set_title(e)}set_body(){this.widget.addClass("dashboard-widget-box"),this.width=="Full"&&this.widget.addClass("full-width")}setup_container(){this.body.empty(),this.chart_doc.type=="Heatmap"&&this.setup_heatmap_container(),this.loading=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("Loading...")}</div>`),this.loading.appendTo(this.body),this.empty=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("No Data")}</div>`),this.empty.hide().appendTo(this.body),this.chart_wrapper=$("<div></div>"),this.chart_wrapper.appendTo(this.body),this.$heatmap_legend=null,this.set_chart_title()}setup_heatmap_container(){this.widget.addClass("heatmap-chart"),this.widget.removeClass("full-width").addClass("full-width"),this.width="Full"}set_summary(){this.$summary?this.$summary.empty():(this.$summary=$('<div class="report-summary"></div>').hide(),this.head.after(this.$summary)),this.summary.forEach(e=>{frappe.utils.build_summary_item(e).appendTo(this.$summary)}),this.summary.length&&this.$summary.show()}make_chart(){this.get_settings().then(()=>{if(!this.settings){this.deleted=!0,this.widget.remove();return}this.chart_settings||(this.chart_settings={}),this.setup_container(),this.in_customize_mode||(this.action_area.empty(),this.prepare_chart_actions(),this.chart_doc.timeseries&&this.render_time_series_filters()),frappe.run_serially([()=>this.prepare_chart_object(),()=>this.setup_filter_button(),()=>this.fetch_and_update_chart()])})}render_time_series_filters(){let e=this.get_time_series_filters();frappe.dashboard_utils.render_chart_filters(e,"chart-actions",this.action_area,0)}get_time_series_filters(){let e;return this.chart_doc.type=="Heatmap"?e=[{label:this.chart_settings.heatmap_year||this.chart_doc.heatmap_year,options:frappe.dashboard_utils.get_years_since_creation(frappe.boot.user.creation),action:t=>{this.selected_heatmap_year=t,this.save_chart_config_for_user({heatmap_year:this.selected_heatmap_year}),this.fetch_and_update_chart()}}]:e=[{label:this.chart_settings.time_interval||this.chart_doc.time_interval,options:["Yearly","Quarterly","Monthly","Weekly","Daily"],icon:"calendar",class:"time-interval-filter",action:t=>{this.selected_time_interval=t,this.save_chart_config_for_user({time_interval:this.selected_time_interval}),this.fetch_and_update_chart()}},{label:this.chart_settings.timespan||this.chart_doc.timespan,options:["Select Date Range","Last Year","Last Quarter","Last Month","Last Week"],class:"timespan-filter",action:t=>{this.selected_timespan=t,this.selected_timespan==="Select Date Range"?this.render_date_range_field():(this.selected_from_date=null,this.selected_to_date=null,this.date_field_wrapper&&(this.date_field_wrapper.hide(),this.title_field.show(),this.subtitle_field.show(),this.head.css("flex-direction","row")),this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:null,to_date:null}),this.fetch_and_update_chart())}}],e}fetch_and_update_chart(){this.args={timespan:this.selected_timespan||this.chart_settings.timespan,time_interval:this.selected_time_interval||this.chart_settings.time_interval,from_date:this.selected_from_date||this.chart_settings.from_date,to_date:this.selected_to_date||this.chart_settings.to_date,heatmap_year:this.selected_heatmap_year||this.chart_settings.heatmap_year},this.fetch(this.filters,!0,this.args).then(e=>{this.chart_doc.chart_type=="Report"&&(this.report_result=e,this.summary=e.report_summary,e=this.get_report_chart_data(e)),this.update_chart_object(),this.data=e,this.render()})}render_date_range_field(){(!this.date_field_wrapper||!this.date_field_wrapper.is(":visible"))&&(this.date_field_wrapper=$('<div class="dashboard-date-field pull-right"></div>').insertAfter(this.action_area.find(".timespan-filter")),this.width!=="Full"&&this.widget.width()<700&&(this.title_field.hide(),this.subtitle_field.hide(),this.head.css("flex-direction","row-reverse")),this.date_range_field=frappe.ui.form.make_control({df:{fieldtype:"DateRange",fieldname:"from_date",placeholder:"Date Range",input_class:"input-xs",default:[this.chart_settings.from_date,this.chart_settings.to_date],value:[this.chart_settings.from_date,this.chart_settings.to_date],reqd:1,change:()=>{let e=this.date_range_field.get_value();this.selected_from_date=e[0],this.selected_to_date=e[1],e&&e.length==2&&(this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:this.selected_from_date,to_date:this.selected_to_date}),this.fetch_and_update_chart())}},parent:this.date_field_wrapper,render_input:1}),this.date_range_field.$input.focus())}get_report_chart_data(e){if(e.chart&&this.chart_doc.use_report_chart)return e.chart.data;{let t=[];this.chart_doc.y_axis.map(l=>{t.push(l.y_field)});let i={y_fields:t,x_field:this.chart_doc.x_field,chart_type:this.chart_doc.type,color:this.chart_doc.color},s=e.columns.map(l=>frappe.report_utils.prepare_field_from_column(l));return frappe.report_utils.make_chart_options(s,e,i).data}}prepare_chart_actions(){let e=[{label:__("Refresh"),action:"action-refresh",handler:()=>{delete this.dashboard_chart,this.make_chart()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Dashboard Chart",this.chart_doc.name)}},{label:__("Reset Chart"),action:"action-reset",handler:()=>{this.reset_chart(),delete this.dashboard_chart,this.make_chart()}}];this.chart_doc.document_type?e.push({label:__("{0} List",[this.chart_doc.document_type]),action:"action-list",handler:()=>{frappe.set_route("List",this.chart_doc.document_type)}}):this.chart_doc.chart_type==="Report"&&e.push({label:__("{0} Report",[this.chart_doc.report_name]),action:"action-list",handler:()=>{frappe.set_route("query-report",this.chart_doc.report_name,this.filters)}}),this.set_chart_actions(e)}setup_filter_button(){this.in_customize_mode||(this.is_document_type=this.chart_doc.chart_type!=="Report"&&this.chart_doc.chart_type!=="Custom",this.filter_button=$(`<div class="filter-chart btn btn-xs pull-right">
				${frappe.utils.icon("filter","sm")}
			</div>`),this.filter_button.appendTo(this.action_area),this.is_document_type?(this.filter_group&&(this.filters=this.filter_group.get_filters()),this.create_filter_group_and_add_filters()):this.filter_button.on("click",()=>{let e;frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(t=>{this.is_document_type?e=[{fieldtype:"HTML",fieldname:"filter_area"}]:t?e=t.filter(i=>i.fieldname).map(i=>(Object.assign(i,i.dashboard_config||{}),i)):e=[{fieldtype:"HTML",options:__("No Filters Set")}],this.setup_filter_dialog(e)})}))}setup_filter_dialog(e){let t=this,i=new frappe.ui.Dialog({title:__("Set Filters for {0}",[this.chart_doc.chart_name]),fields:e,primary_action:function(){let s=this.get_values();s&&(this.hide(),t.filters=s,t.save_chart_config_for_user({filters:t.filters}),t.fetch_and_update_chart())},primary_action_label:"Set"});i.show(),this.chart_doc.chart_type=="Report"&&(frappe.query_report=new frappe.views.QueryReport({filters:i.fields_list}),frappe.query_reports[this.chart_doc.report_name].onload&&frappe.query_reports[this.chart_doc.report_name].onload(frappe.query_report)),i.set_values(this.filters)}reset_chart(){this.save_chart_config_for_user(null,1),this.chart_settings={},this.filters=null,this.selected_time_interval=null,this.selected_timespan=null,this.selected_heatmap_year=null}save_chart_config_for_user(e,t=0){Object.assign(this.chart_settings,e),frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.save_chart_config",{reset:t,config:this.chart_settings,chart_name:this.chart_doc.chart_name})}create_filter_group_and_add_filters(){this.filter_group=new frappe.ui.FilterGroup({doctype:this.chart_doc.document_type,parent_doctype:this.chart_doc.parent_document_type,filter_button:this.filter_button,on_change:()=>{this.filters=this.filter_group.get_filters(),this.save_chart_config_for_user({filters:this.filters}),this.fetch_and_update_chart()}}),this.filters&&frappe.model.with_doctype(this.chart_doc.document_type,()=>{this.filter_group.add_filters_to_filter_group(this.filters)})}set_chart_actions(e){this.chart_actions=$(`<div class="chart-actions dropdown pull-right">
			<button data-toggle="dropdown"
				aria-haspopup="true"aria-expanded="false"
				class="btn btn-xs btn-secondary chart-menu"
			>
				<svg class="icon icon-sm">
					<use href="#icon-dot-horizontal">
					</use>
				</svg>
			</button>
			<ul class="dropdown-menu dropdown-menu-right">
				${e.map(t=>`<li><a class="dropdown-item" data-action="${t.action}">${t.label}</a></li>`).join("")}
			</ul>
		</div>
		`),this.chart_actions.find("a[data-action]").each((t,i)=>{let s=i.dataset.action;$(i).click(e.find(l=>l.action===s))}),this.chart_actions.appendTo(this.action_area)}fetch(e,t=!1,i){let s=this.settings.method;return this.chart_doc.chart_type=="Report"?i={report_name:this.chart_doc.report_name,filters:e,ignore_prepared_report:1}:i={chart_name:this.chart_doc.name,filters:e,refresh:t?1:0,time_interval:i&&i.time_interval?i.time_interval:null,timespan:i&&i.timespan?i.timespan:null,from_date:i&&i.from_date?i.from_date:null,to_date:i&&i.to_date?i.to_date:null,heatmap_year:i&&i.heatmap_year?i.heatmap_year:null},frappe.xcall(s,i)}async get_source_doctype(){if(this.chart_doc.document_type)return this.chart_doc.document_type;if(this.chart_doc.chart_type=="Report"&&this.chart_doc.report_name)return await frappe.db.get_value("Report",this.chart_doc.report_name,"ref_doctype").then(e=>e.message.ref_doctype)}async render(){let e=()=>{let t=this.get_chart_args();this.dashboard_chart?this.dashboard_chart.update(this.data):this.dashboard_chart=frappe.utils.make_chart(this.chart_wrapper[0],t)};!this.data||!this.data.labels||!Object.keys(this.data).length?(this.chart_wrapper.hide(),this.loading.hide(),this.$summary&&this.$summary.hide(),this.empty.show()):(this.loading.hide(),this.empty.hide(),this.chart_wrapper.show(),this.chart_doc.document_type=await this.get_source_doctype(),this.chart_doc.document_type?frappe.model.with_doctype(this.chart_doc.document_type,e):e(),this.width=="Full"&&this.summary&&this.set_summary(),this.chart_doc.type=="Heatmap"&&this.render_heatmap_legend())}get_chart_args(){var f,b;let e=this.get_chart_colors(),t,i,s={Line:"line",Bar:"bar",Percentage:"percentage",Pie:"pie",Donut:"donut",Heatmap:"heatmap"},l=["Pie","Donut"].includes(this.chart_doc.type)?6:9,d={data:this.data,type:s[this.chart_doc.type],colors:e,height:this.height,maxSlices:this.chart_doc.number_of_groups||l,axisOptions:{xIsSeries:this.chart_doc.timeseries,shortenYAxisNumbers:1}};if(this.chart_doc.document_type){let y=frappe.get_meta(this.chart_doc.document_type).fields.find(S=>S.fieldname==this.chart_doc.value_based_on);t=y==null?void 0:y.fieldtype,i=y==null?void 0:y.options}if(this.chart_doc.chart_type=="Report"&&((b=(f=this.report_result)==null?void 0:f.chart)==null?void 0:b.fieldtype)&&(t=this.report_result.chart.fieldtype,i=this.report_result.chart.options),d.tooltipOptions={formatTooltipY:v=>frappe.format(v,{fieldtype:t,options:i},{always_show_decimals:!0,inline:!0})},this.chart_doc.type=="Heatmap"){let v=parseInt(this.selected_heatmap_year||this.chart_settings.heatmap_year||this.chart_doc.heatmap_year);d.data.start=new Date(`${v}-01-01`),d.data.end=new Date(`${v+1}-01-01`)}let h=v=>{let y=JSON.parse(v);for(let S in y)typeof d[S]=="object"&&typeof y[S]=="object"?d[S]=Object.assign(d[S],y[S]):d[S]=y[S]};return this.custom_options&&h(this.custom_options),this.chart_doc.custom_options&&h(this.chart_doc.custom_options),d}get_chart_colors(){let e=[];return this.chart_doc.y_axis.length?this.chart_doc.y_axis.map(t=>{e.push(t.color)}):["Line","Bar"].includes(this.chart_doc.type)?e=[this.chart_doc.color||[]]:this.chart_doc.type=="Heatmap"&&(e=[]),e}render_heatmap_legend(){let e,t=i=>{e=JSON.parse(i).colors};this.custom_options&&t(this.custom_options),this.chart_doc.custom_options&&t(this.chart_doc.custom_options),!this.$heatmap_legend&&this.widget.width()>991&&(this.$heatmap_legend=$(`
				<div class="heatmap-legend">
					<ul class="legend-colors">
						<li style="background-color: ${e[0]||"#ebedf0"}"></li>
						<li style="background-color: ${e[1]||"#c6e48b"}"></li>
						<li style="background-color: ${e[2]||"#7bc96f"}"></li>
						<li style="background-color: ${e[3]||"#239a3b"}"></li>
						<li style="background-color: ${e[4]||"#196127"}"></li>
					</ul>
					<div class="legend-label">
						<div style="margin-bottom: 45px">${__("Less")}</div>
						<div>${__("More")}</div>
					</div>
				</div>
				`),this.body.append(this.$heatmap_legend))}update_last_synced(){if(!this.chart_doc.last_synced_on)return;let e=__("Last synced {0}",[comment_when(this.chart_doc.last_synced_on)]);this.subtitle_field.html(e)}update_chart_object(){frappe.db.get_doc("Dashboard Chart",this.chart_doc.name).then(e=>{this.chart_doc=e,this.update_last_synced()})}prepare_chart_object(){return this.chart_doc.type=="Heatmap"&&!this.chart_doc.heatmap_year&&(this.chart_doc.heatmap_year=frappe.dashboard_utils.get_year(frappe.datetime.now_date())),this.set_chart_filters()}set_chart_filters(){let e=this.chart_settings.filters||null,t=frappe.dashboard_utils.get_all_filters(this.chart_doc);return this.chart_doc.chart_type=="Report"?frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(i=>{t=this.update_default_date_filters(i,t),this.filters=frappe.utils.parse_array(e)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(t)}):(this.filters=frappe.utils.parse_array(e)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(t),Promise.resolve())}update_default_date_filters(e,t){return e&&e.map(i=>{["Date","DateRange"].includes(i.fieldtype)&&i.default&&(i.reqd||t[i.fieldname])&&(t[i.fieldname]=i.default)}),t}get_settings(){return frappe.model.with_doc("Dashboard Chart",this.chart_name).then(e=>{if(e)if(this.chart_doc=e,this.chart_doc.chart_type=="Custom"){if(frappe.dashboards.chart_sources[this.chart_doc.source])return this.settings=frappe.dashboards.chart_sources[this.chart_doc.source],Promise.resolve();{let t="frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config";return frappe.xcall(t,{name:this.chart_doc.source}).then(i=>{frappe.dom.eval(i),this.settings=frappe.dashboards.chart_sources[this.chart_doc.source]})}}else return this.chart_doc.chart_type=="Report"?(this.settings={method:"frappe.desk.query_report.run"},Promise.resolve()):(this.settings={method:"frappe.desk.doctype.dashboard_chart.dashboard_chart.get"},Promise.resolve())})}};var Ci=class extends ft{set_chart_title(){this.label=__(this.label||this.name),super.set_chart_title()}};frappe.widget.widget_factory.chart=Ci;frappe.dashboard_utils.render_chart_filters=function(r,e,t,i){r.forEach(s=>{let l="",d="";s.icon&&(l=frappe.utils.icon(s.icon)),s.class&&(d=s.class);let h=`<div class="${e} ${d} btn-group dropdown pull-right">
					<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<button class="btn btn-secondary btn-xs">
			 				${l}
							<span class="filter-label">${__(s.label)}</span>
							${frappe.utils.icon("select","xs")}
						</button>
				</a>`,f;s.fieldnames?f=s.options.map((y,S)=>`<li>
						<a class="dropdown-item" data-fieldname="${s.fieldnames[S]}" selected_item="${y}">${__(y)}</a>
					</li>`).join(""):f=s.options.map(y=>`<li><a class="dropdown-item" selected_item="${y}">${__(y)}</a></li>`).join("");let b=h+`<ul class="dropdown-menu">${f}</ul></div>`,v=$(b);i?v.prependTo(t):v.appendTo(t),v.find(".dropdown-menu").on("click","li a",y=>{let S=$(y.currentTarget),T;S.attr("data-fieldname")&&(T=S.attr("data-fieldname"));let C=S.attr("selected_item");S.parents(`.${e}`).find(".filter-label").text(__(C)),s.action(C,T)})})};frappe.ui.Page=class extends frappe.ui.Page{add_auto_select(e,t,i){return this.add_field({label:e,fieldtype:"Autocomplete",options:t,change:i}).$wrapper.find("input").empty()}};function xi(r,e){return nn(r,e,0,0,null,[],256,0,0,10)}function nn(r,e,t,i,s,l,d,h,f,b){let v=0;if(++f>=b)return[!1,v,l];if(t===r.length||i===e.length)return[!1,v,l];let y=!1,S=[],T=0,C=!0;for(;t<r.length&&i<e.length;){if(r[t].toLowerCase()===e[i].toLowerCase()){if(h>=d)return[!1,v,l];C&&s&&(l=[...s],C=!1);let[L,A,W]=nn(r,e,t,i+1,l,[],d,h,f,b);L&&((!y||A>T)&&(S=[...W],T=A),y=!0),l[h++]=i,++t}++i}let w=t===r.length;if(w){v=100;let L=-5*l[0];L=L<-15?-15:L,v+=L;let A=e.length-h;v+=-1*A;for(let W=0;W<h;W++){let q=l[W];if(W>0){let M=l[W-1];q==M+1&&(v+=25)}if(q>0){let M=e[q-1],k=e[q];M!==M.toUpperCase()&&k!==k.toLowerCase()&&(v+=30),(M=="_"||M==" ")&&(v+=30)}else v+=15}return y&&(!w||T>v)?(l=[...S],v=T,[!0,v,l]):w?[!0,v,l]:[!1,v,l]}return[!1,v,l]}frappe.search.utils.fuzzy_search=function(r="",e="",t=!1){let i=__(e||""),[,s,l]=xi(r,i,t);if(s==0&&frappe.boot.lang!="en"&&i!==e&&(i=e||"",[,s,l]=xi(r,i,t)),!t)return s;if(s==0)return{score:s,item:i};let d=Array(i.length).fill(0);l.forEach(v=>d[v]=1);let h="",f="",b=()=>{if(!f)return"";let v=`<mark>${f}</mark>`;return f="",v};return d.forEach((v,y)=>{v?f+=i[y]:(h+=b(),h+=i[y])}),h+=b(),{score:s,marked_string:h}};frappe.ui.form.ControlLink=class extends frappe.ui.form.ControlLink{make_input(){var e=this;$(`<div class="link-field ui-front" style="position: relative;">
			<input type="text" class="input-with-feedback form-control">
			<span class="link-btn">
				<a class="btn-open no-decoration" title="${__("Open Link")}">
					${frappe.utils.icon("arrow-right","xs")}
				</a>
			</span>
		</div>`).prependTo(this.input_area),this.$input_area=$(this.input_area),this.$input=this.$input_area.find("input"),this.$link=this.$input_area.find(".link-btn"),this.$link_open=this.$link.find(".btn-open"),this.set_input_attributes(),this.$input.on("focus",function(){setTimeout(function(){if(e.$input.val()&&e.get_options()){let t=e.get_options(),i=e.doc?e.doc[e.df.fieldname]:e.$input.attr("data-value"),s=i||e.get_input_value();e.$link.toggle(!0),e.$link_open.attr("href",frappe.utils.get_form_link(t,s))}e.$input.val()||(e.$input.val("").trigger("input"),e.$link.toggle(!1))},500)}),this.$input.on("blur",function(){setTimeout(function(){e.$link.toggle(!1)},500)}),this.$input.attr("data-target",this.df.options),this.input=this.$input.get(0),this.has_input=!0,this.translate_values=!0,this.setup_buttons(),this.setup_awesomeplete(),this.bind_change_event()}setup_awesomeplete(){let e=this;this.$input.cache={},this.awesomplete=new Awesomplete(e.input,{tabSelect:!0,minChars:0,maxItems:99,autoFirst:!0,list:[],replace:function(t){this.input.value=e.get_translated(t.label||t.value)},data:function(t){return{label:e.get_translated(t.label||t.value),value:t.value}},filter:function(){return!0},item:function(t){let i=this.get_item(t.value);i.label||(i.label=i.value);let s=e.get_translated(i.label),l=i.html||"<strong>"+s+"</strong>";return i.description&&(e.is_title_link()||i.value!==i.description)&&(l+='<br><span class="small">'+__(i.description)+"</span>"),$("<li></li>").data("item.autocomplete",i).prop("aria-selected","false").html(`<a><p title="${frappe.utils.escape_html(s)}">${l}</p></a>`).get(0)},sort:function(){return 0}}),this.custom_awesomplete_filter&&this.custom_awesomplete_filter(this.awesomplete),this.$input.on("input",frappe.utils.debounce(function(t){var i=e.get_options();if(!!i){e.$input.cache[i]||(e.$input.cache[i]={});var s=t.target.value;e.$input.cache[i][s]!=null&&(e.awesomplete.list=e.$input.cache[i][s]);var l={txt:s,doctype:i,ignore_user_permissions:e.df.ignore_user_permissions,reference_doctype:e.get_reference_doctype()||""};e.set_custom_query(l),frappe.call({type:"POST",method:"frappe.desk.search.search_link",no_spinner:!0,args:l,callback:function(d){if(!window.Cypress&&!e.$input.is(":focus"))return;d.message=e.merge_duplicates(d.message);let h=e.df.filter_description?e.df.filter_description:l.filters?e.get_filter_description(l.filters):null;if(h&&d.message.push({html:`<span class="text-muted" style="line-height: 1.5">${h}</span>`,value:"",action:()=>{}}),!e.df.only_select){frappe.model.can_create(i)&&d.message.push({html:"<span class='link-option'><i class='fa fa-plus' style='margin-right: 5px;'></i> "+__("Create a new {0}",[__(e.get_options())])+"</span>",label:__("Create a new {0}",[__(e.get_options())]),value:"create_new__link_option",action:e.new_doc});let f=frappe.ui.form.ControlLink.link_options&&frappe.ui.form.ControlLink.link_options(e);f&&(d.message=d.message.concat(f)),locals&&locals.DocType&&d.message.push({html:"<span class='link-option'><i class='fa fa-search' style='margin-right: 5px;'></i> "+__("Advanced Search")+"</span>",label:__("Advanced Search"),value:"advanced_search__link_option",action:e.open_advanced_search})}e.$input.cache[i][s]=d.message,e.awesomplete.list=e.$input.cache[i][s],e.toggle_href(i)}})}},500)),this.$input.on("blur",function(){if(e.selected){e.selected=!1;return}let t=e.get_input_value(),i=e.get_label_value(),s=e.last_value||"",l=e.label||"",d=e.doc?e.doc[e.df.fieldname]:e.$input.attr("data-value"),h=__(d)!=t?t:d;h!==s&&e.parse_validate_and_set_in_model(h,null,i)}),this.$input.on("awesomplete-open",()=>{this.autocomplete_open=!0,e.get_label_value()||e.$link.toggle(!1)}),this.$input.on("awesomplete-close",t=>{this.autocomplete_open=!1,e.get_label_value()||e.$link.toggle(!1)}),this.$input.on("awesomplete-select",function(t){var i=t.originalEvent,s=e.awesomplete.get_item(i.text.value);e.autocomplete_open=!1;let l=9;if(t.keyCode===l)return t.preventDefault(),e.awesomplete.close(),!1;s.action&&(s.value="",s.label="",s.action.apply(e)),e.df.remember_last_selected_value&&(frappe.boot.user.last_selected_values[e.df.options]=s.value),e.parse_validate_and_set_in_model(s.value,null,s.label)}),this.$input.on("awesomplete-selectcomplete",function(t){t.originalEvent.text.value.indexOf("__link_option")!==-1&&e.$input.val("")})}get_filter_description(e){let t=this.get_options(),i=[],s=null;if(frappe.model.with_doctype(t,()=>{s=frappe.get_meta(t)}),Array.isArray(e))i=e;else for(let h in e){let f=e[h];Array.isArray(f)||(f=["=",f]),i.push([h,...f])}i=i.map(h=>h.length===3?[t,...h]:h);function l(h){let f=h[0],b=h[1],v=frappe.meta.get_docfield(f,b),y=v?v.label:frappe.model.unscrub(b);v&&v.fieldtype==="Check"&&(h[3]=h[3]?__("Yes"):__("No")),h[3]&&Array.isArray(h[3])&&h[3].length>5&&(h[3]=h[3].slice(0,5),h[3].push("..."));let S=h[3]==null||h[3]===""?__("empty"):h[3];return[__(y).bold(),__(h[2]),(Array.isArray(h[3])?String(S.map(T=>__(T))):String(__(S))).bold()].join(" ")}let d=i.map(l).join(", ");return __("Filters applied for {0}",[d])}set_formatted_input(e){var t=this;t.$input&&t.$input.attr("data-value",e===void 0?"":e),t.$input&&t.$input.val(t.format_for_input(__(e))),super.set_formatted_input(e)}get_value(){let e=this,t=e.doc?e.doc[e.df.fieldname]:e.$input?e.$input.attr("data-value"):void 0,i=t||e.get_input_value();return this.get_status()==="Write"?this.parse?this.parse(i):i:i||this.value||null}};frappe.ui.form.ControlAutocomplete=class extends frappe.ui.form.ControlAutocomplete{setup_awesomplete(){let e=super.setup_awesomplete()||{};return Object.assign(e,{filter:function(t,i){let s=t.value;return __(t.value)!=t.value&&(s+=__(t.value)),Awesomplete.FILTER_CONTAINS(s,i)}})}set_formatted_input(e){var t=this;e&&t.$input&&t.$input.attr("data-value",e===void 0?"":e),e&&t.$input&&t.$input.val(t.format_for_input(__(e)))}get_value(){let e=this,t=e.$input&&e.$input.attr("data-value")?e.$input.attr("data-value"):e.doc?e.doc[e.df.fieldname]:void 0,i=t||e.get_input_value();return this.get_status()==="Write"?this.parse?this.parse(i):i:i||void 0}get_parsed_value(e){let t=this;if(t.doc){let i=t.$input&&t.$input.attr("data-value")?t.$input.attr("data-value"):t.doc?t.doc[t.df.fieldname]:void 0;e=i||t.get_input_value()}else e=super.get_parsed_value(e);return e}};frappe.ui.FieldSelect=class extends frappe.ui.FieldSelect{init(e){super.init(e),this.awesomplete.filter=function(t,i){if(!i)return;let s=t.label+t.value;return Awesomplete.FILTER_CONTAINS(s,i)}}};frappe.ui.form.add_options=function(r,e){let t=$(r);if(!Array.isArray(e))return t;for(var i=0,s=e.length;i<s;i++){var l=e[i],d=null,h=null;if(!is_null(l)){var f=is_null(l.value),b=is_null(l.label),v=Boolean(l.disabled),y=Boolean(l.selected);if(f&&b)if(l&&typeof l=="string"&&l.includes(";")){let S=l.split(";");d=S[0],h=__(S.slice(-1)[0])}else d=l,h=__(l);else d=f?"":l.value,h=b?__(d):__(l.label)}$("<option>").html(cstr(h)).attr("value",d).prop("disabled",v).prop("selected",y).appendTo(t.get(0))}return t.get(0).selectedIndex=0,t.trigger("select-change"),t};(function(r){r.fn.add_options=function(t){for(var i=0,s=t.length;i<s;i++){var l=t[i],d=null,h=null;if(!is_null(l)){var f=is_null(l.value),b=is_null(l.label),v=Boolean(l.disabled);if(f&&b)if(l&&typeof l=="string"&&l.includes(";")){let y=l.split(";");d=y[0],h=__(y.slice(-1)[0])}else d=l,h=__(l);else d=f?"":l.value,h=b?__(d):__(l.label)}r("<option>").html(cstr(h)).attr("value",d).prop("disabled",v).appendTo(this)}return this.selectedIndex=0,r(this).trigger("select-change"),r(this)},r.fn.set_working=function(){this.prop("disabled",!0)},r.fn.done_working=function(){this.prop("disabled",!1)};let e=r.fn.val;r.fn.val=function(){let t=e.apply(this,arguments);return arguments.length>0&&r(this).trigger("select-change"),t}})(jQuery);frappe.ui.form.ControlDateRange=class extends frappe.ui.form.ControlDateRange{set_date_options(){super.set_date_options();let e="en";frappe.boot.user&&(e=frappe.boot.user.language),$.fn.datepicker.language[e]&&(this.datepicker_options.language=e)}};frappe.ui.form.ControlTable=class extends frappe.ui.form.ControlTable{make(){super.make(),this.$wrapper.off("paste",":text"),this.$wrapper.on("paste",":text",e=>{let t=this.df.fieldname,i=this.grid,s=i.grid_pagination,l=i.grid_rows,d=i.doctype,h=$(e.target).closest(".grid-row").data("name"),f=$(e.target).closest(".form-in-grid").length,b=frappe.utils.get_clipboard_data(e);if(!b||f)return;let v=frappe.utils.csv_to_array(b,"	");if(v.length===1&&v[0].length===1)return;let y=[];if(this.get_field(v[0][0]))v[0].forEach(C=>{y.push(this.get_field(C))}),v.shift();else{let C=l[0].get_visible_columns(),w=!1;C.forEach(L=>{(w||L.fieldname===$(e.target).data("fieldname"))&&(y.push(L.fieldname),w=!0)})}let S=locals[d][h].idx,T=v.length;return v.forEach((C,w)=>{setTimeout(()=>{if(!!C.filter(Boolean).length){S>this.frm.doc[t].length&&this.grid.add_new_row(),S>1&&(S-1)%s.page_length===0&&s.go_to_page(s.page_index+1);let A=l[S-1].doc.name;C.forEach((W,q)=>{let M=y[q];if(M){if(W){let k=frappe.meta.get_field(d,M).fieldtype;W=k&&k==="Text Editor"?W.replace(/[\n\r]/g,"<br>"):W}frappe.model.set_value(d,A,M,W)}}),S++}if(T>=10){let A=w+1;frappe.show_progress(__("Processing"),A,T,null,!0)}},0)}),!1})}};frappe.provide("frappe.form.formatters");frappe.form.formatters.Datetime=function(r){if(r){var e=moment(frappe.datetime.convert_to_user_tz(r));return frappe.boot.sysdefaults.time_zone&&(e=e.tz(frappe.boot.sysdefaults.time_zone)),e.format(frappe.boot.sysdefaults.date_format.toUpperCase()+" HH:mm:ss")}else return""};frappe.form.formatters.Data=function(r,e){return e&&e.options=="URL"?r?`<a href="${r}" title="Open Link" target="_blank">${r}</a>`:void 0:(r=r==null?"":__(r),frappe.form.formatters._apply_custom_formatter(r,e))};frappe.form.formatters.MultiSelect=function(r){if(typeof r=="string")return __(r);if(Array.isArray(r))return r.map(e=>__(e))};var wn=Nn(yn()),oa={headerDropdown:[{label:__("Sort Ascending"),action:function(r){this.sortColumn(r.colIndex,"asc")}},{label:__("Sort Descending"),action:function(r){this.sortColumn(r.colIndex,"desc")}},{label:__("Reset sorting"),action:function(r){this.sortColumn(r.colIndex,"none")}},{label:__("Remove column"),action:function(r){this.removeColumn(r.colIndex)}}]},Vt=class extends wn.default{buildOptions(e){super.buildOptions(e),this.options.headerDropdown=[...oa.headerDropdown,...e.headerDropdown]}},aa=class extends frappe.views.QueryReport{render_datatable(){let e=this.data,t=this.columns.filter(i=>!i.hidden);if(this.raw_data.add_total_row&&(e=e.slice(),e.splice(-1,1)),this.$report.show(),this.datatable&&this.datatable.options&&this.datatable.options.showTotalRow===this.raw_data.add_total_row)this.datatable.options.treeView=this.tree_report,this.datatable.refresh(e,t);else{let i={columns:t,data:e,inlineFilters:!0,treeView:this.tree_report,layout:"fixed",cellHeight:33,showTotalRow:this.raw_data.add_total_row,direction:frappe.utils.is_rtl()?"rtl":"ltr",hooks:{columnTotal:frappe.utils.report_column_total}};this.report_settings.get_datatable_options&&(i=this.report_settings.get_datatable_options(i)),this.datatable=new Vt(this.$report[0],i)}typeof this.report_settings.initial_depth=="number"&&this.datatable.rowmanager.setTreeDepth(this.report_settings.initial_depth),this.report_settings.after_datatable_render&&this.report_settings.after_datatable_render(this.datatable)}};frappe.views.QueryReport=aa;var la=class extends frappe.views.ReportView{setup_datatable(e){this.$datatable_wrapper.empty(),this.datatable=new Vt(this.$datatable_wrapper[0],{columns:this.columns,data:this.get_data(e),getEditor:this.get_editing_object.bind(this),checkboxColumn:!0,inlineFilters:!0,cellHeight:35,direction:frappe.utils.is_rtl()?"rtl":"ltr",events:{onRemoveColumn:t=>{this.remove_column_from_datatable(t)},onSwitchColumn:(t,i)=>{this.switch_column(t,i)},onCheckRow:()=>{let t=this.get_checked_items();this.toggle_actions_menu_button(t.length>0)}},hooks:{columnTotal:frappe.utils.report_column_total},headerDropdown:[{label:__("Add Column"),action:t=>{let i=[],s=this.get_columns_for_picker();i=s[this.doctype].filter(d=>!this.is_column_added(d)).map(d=>({label:__(d.label),value:d.fieldname})),delete s[this.doctype];for(let d in s)s[d].filter(h=>!this.is_column_added(h)).map(h=>({label:__(h.label)+` (${d})`,value:h.fieldname+","+d})).forEach(h=>i.push(h));let l=new frappe.ui.Dialog({title:__("Add Column"),fields:[{label:__("Select Column"),fieldname:"column",fieldtype:"Autocomplete",options:i},{label:__("Insert Column Before {0}",[t.docfield.label.bold()]),fieldname:"insert_before",fieldtype:"Check"}],primary_action:({column:d,insert_before:h})=>{if(!i.map(v=>v.value).includes(d)){frappe.show_alert({message:__("Invalid column"),indicator:"orange"}),l.hide();return}let f=this.doctype;d.includes(",")&&([d,f]=d.split(","));let b=t.colIndex;h&&(b=b-1),this.add_column_to_datatable(d,f,b),l.hide()}});l.show()}}]})}};frappe.views.ReportView=la;var da=class extends frappe.views.GanttView{get required_libs(){return["assets/erpnext_oob/js/lib/gantt/frappe-gantt.css","assets/erpnext_oob/js/lib/gantt/frappe-gantt.min.js"]}};frappe.views.GanttView=da;erpnext.stock.StockController.prototype.show_general_ledger=function(){var r=this;this.frm.doc.docstatus>0&&cur_frm.add_custom_button(__("Accounting Ledger"),function(){frappe.route_options={voucher_no:r.frm.doc.name,from_date:r.frm.doc.posting_date,to_date:moment(r.frm.doc.modified).format("YYYY-MM-DD"),company:r.frm.doc.company,show_cancelled_entries:r.frm.doc.docstatus===2},frappe.set_route("query-report","General Ledger")},__("View"))};})();
/*! Sortable 1.15.0 - MIT | git://github.com/SortableJS/Sortable.git */
//# sourceMappingURL=erpnext_oob.bundle.W2H6M6EG.js.map
