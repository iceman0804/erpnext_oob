(()=>{var Es=Object.create;var es=Object.defineProperty;var Rs=Object.getOwnPropertyDescriptor;var Ds=Object.getOwnPropertyNames;var Is=Object.getPrototypeOf,Ls=Object.prototype.hasOwnProperty;var ts=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var As=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Ds(e))!Ls.call(n,r)&&r!==t&&es(n,r,{get:()=>e[r],enumerable:!(i=Rs(e,r))||i.enumerable});return n};var Ms=(n,e,t)=>(t=n!=null?Es(Is(n)):{},As(e||!n||!n.__esModule?es(t,"default",{value:n,enumerable:!0}):t,n));var ss=ts((Si,$i)=>{(function(n,e){typeof Si=="object"&&typeof $i!="undefined"?$i.exports=e():typeof define=="function"&&define.amd?define(e):(n=n||self).Sortable=e()})(Si,function(){"use strict";function n(s,o){var a,h=Object.keys(s);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(s),o&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable})),h.push.apply(h,a)),h}function e(s){for(var o=1;o<arguments.length;o++){var a=arguments[o]!=null?arguments[o]:{};o%2?n(Object(a),!0).forEach(function(h){var c,f;c=s,h=a[f=h],f in c?Object.defineProperty(c,f,{value:h,enumerable:!0,configurable:!0,writable:!0}):c[f]=h}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(h){Object.defineProperty(s,h,Object.getOwnPropertyDescriptor(a,h))})}return s}function t(s){return(t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(s)}function i(){return(i=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var a,h=arguments[o];for(a in h)Object.prototype.hasOwnProperty.call(h,a)&&(s[a]=h[a])}return s}).apply(this,arguments)}function r(s,o){if(s==null)return{};var a,h=function(m,b){if(m==null)return{};for(var S,R={},D=Object.keys(m),j=0;j<D.length;j++)S=D[j],0<=b.indexOf(S)||(R[S]=m[S]);return R}(s,o);if(Object.getOwnPropertySymbols)for(var c=Object.getOwnPropertySymbols(s),f=0;f<c.length;f++)a=c[f],0<=o.indexOf(a)||Object.prototype.propertyIsEnumerable.call(s,a)&&(h[a]=s[a]);return h}function l(s){return function(o){if(Array.isArray(o))return d(o)}(s)||function(o){if(typeof Symbol!="undefined"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}(s)||function(o,a){if(o){if(typeof o=="string")return d(o,a);var h=Object.prototype.toString.call(o).slice(8,-1);return(h=h==="Object"&&o.constructor?o.constructor.name:h)==="Map"||h==="Set"?Array.from(o):h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?d(o,a):void 0}}(s)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(s,o){(o==null||o>s.length)&&(o=s.length);for(var a=0,h=new Array(o);a<o;a++)h[a]=s[a];return h}function u(s){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(s)}var p=u(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),y=u(/Edge/i),g=u(/firefox/i),v=u(/safari/i)&&!u(/chrome/i)&&!u(/android/i),w=u(/iP(ad|od|hone)/i),ot=u(/chrome/i)&&u(/android/i),k={capture:!1,passive:!1};function C(s,o,a){s.addEventListener(o,a,!p&&k)}function x(s,o,a){s.removeEventListener(o,a,!p&&k)}function L(s,o){if(o&&(o[0]===">"&&(o=o.substring(1)),s))try{if(s.matches)return s.matches(o);if(s.msMatchesSelector)return s.msMatchesSelector(o);if(s.webkitMatchesSelector)return s.webkitMatchesSelector(o)}catch(a){return}}function A(s,o,a,h){if(s){a=a||document;do if(o!=null&&(o[0]!==">"||s.parentNode===a)&&L(s,o)||h&&s===a)return s;while(s!==a&&(s=(c=s).host&&c!==document&&c.host.nodeType?c.host:c.parentNode))}var c;return null}var W,q=/\s+/g;function M(s,o,a){var h;s&&o&&(s.classList?s.classList[a?"add":"remove"](o):(h=(" "+s.className+" ").replace(q," ").replace(" "+o+" "," "),s.className=(h+(a?" "+o:"")).replace(q," ")))}function T(s,o,a){var h=s&&s.style;if(h){if(a===void 0)return document.defaultView&&document.defaultView.getComputedStyle?a=document.defaultView.getComputedStyle(s,""):s.currentStyle&&(a=s.currentStyle),o===void 0?a:a[o];h[o=o in h||o.indexOf("webkit")!==-1?o:"-webkit-"+o]=a+(typeof a=="string"?"":"px")}}function N(s,o){var a="";if(typeof s=="string")a=s;else do var h=T(s,"transform");while(h&&h!=="none"&&(a=h+" "+a),!o&&(s=s.parentNode));var c=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return c&&new c(a)}function oe(s,o,a){if(s){var h=s.getElementsByTagName(o),c=0,f=h.length;if(a)for(;c<f;c++)a(h[c],c);return h}return[]}function re(){var s=document.scrollingElement;return s||document.documentElement}function B(s,o,a,h,c){if(s.getBoundingClientRect||s===window){var f,m,b,S,R,D,j=s!==window&&s.parentNode&&s!==re()?(m=(f=s.getBoundingClientRect()).top,b=f.left,S=f.bottom,R=f.right,D=f.height,f.width):(b=m=0,S=window.innerHeight,R=window.innerWidth,D=window.innerHeight,window.innerWidth);if((o||a)&&s!==window&&(c=c||s.parentNode,!p))do if(c&&c.getBoundingClientRect&&(T(c,"transform")!=="none"||a&&T(c,"position")!=="static")){var z=c.getBoundingClientRect();m-=z.top+parseInt(T(c,"border-top-width")),b-=z.left+parseInt(T(c,"border-left-width")),S=m+f.height,R=b+f.width;break}while(c=c.parentNode);return h&&s!==window&&(h=(o=N(c||s))&&o.a,s=o&&o.d,o&&(S=(m/=s)+(D/=s),R=(b/=h)+(j/=h))),{top:m,left:b,bottom:S,right:R,width:j,height:D}}}function Ne(s,o,a){for(var h=De(s,!0),c=B(s)[o];h;){var f=B(h)[a];if(!(a==="top"||a==="left"?f<=c:c<=f))return h;if(h===re())break;h=De(h,!1)}return!1}function We(s,o,a,h){for(var c=0,f=0,m=s.children;f<m.length;){if(m[f].style.display!=="none"&&m[f]!==I.ghost&&(h||m[f]!==I.dragged)&&A(m[f],a.draggable,s,!1)){if(c===o)return m[f];c++}f++}return null}function Yt(s,o){for(var a=s.lastElementChild;a&&(a===I.ghost||T(a,"display")==="none"||o&&!L(a,o));)a=a.previousElementSibling;return a||null}function J(s,o){var a=0;if(!s||!s.parentNode)return-1;for(;s=s.previousElementSibling;)s.nodeName.toUpperCase()==="TEMPLATE"||s===I.clone||o&&!L(s,o)||a++;return a}function ji(s){var o=0,a=0,h=re();if(s)do var f=N(s),c=f.a,f=f.d;while(o+=s.scrollLeft*c,a+=s.scrollTop*f,s!==h&&(s=s.parentNode));return[o,a]}function De(s,o){if(!s||!s.getBoundingClientRect)return re();var a=s,h=!1;do if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var c=T(a);if(a.clientWidth<a.scrollWidth&&(c.overflowX=="auto"||c.overflowX=="scroll")||a.clientHeight<a.scrollHeight&&(c.overflowY=="auto"||c.overflowY=="scroll")){if(!a.getBoundingClientRect||a===document.body)return re();if(h||o)return a;h=!0}}while(a=a.parentNode);return re()}function Xt(s,o){return Math.round(s.top)===Math.round(o.top)&&Math.round(s.left)===Math.round(o.left)&&Math.round(s.height)===Math.round(o.height)&&Math.round(s.width)===Math.round(o.width)}function Pi(s,o){return function(){var a;W||((a=arguments).length===1?s.call(this,a[0]):s.apply(this,a),W=setTimeout(function(){W=void 0},o))}}function Wi(s,o,a){s.scrollLeft+=o,s.scrollTop+=a}function Ut(s){var o=window.Polymer,a=window.jQuery||window.Zepto;return o&&o.dom?o.dom(s).cloneNode(!0):a?a(s).clone(!0)[0]:s.cloneNode(!0)}function Bi(s,o){T(s,"position","absolute"),T(s,"top",o.top),T(s,"left",o.left),T(s,"width",o.width),T(s,"height",o.height)}function Gt(s){T(s,"position",""),T(s,"top",""),T(s,"left",""),T(s,"width",""),T(s,"height","")}var ae="Sortable"+new Date().getTime();function ws(){var s,o=[];return{captureAnimationState:function(){o=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(a){var h,c;T(a,"display")!=="none"&&a!==I.ghost&&(o.push({target:a,rect:B(a)}),h=e({},o[o.length-1].rect),!a.thisAnimationDuration||(c=N(a,!0))&&(h.top-=c.f,h.left-=c.e),a.fromRect=h)})},addAnimationState:function(a){o.push(a)},removeAnimationState:function(a){o.splice(function(h,c){for(var f in h)if(h.hasOwnProperty(f)){for(var m in c)if(c.hasOwnProperty(m)&&c[m]===h[f][m])return Number(f)}return-1}(o,{target:a}),1)},animateAll:function(a){var h=this;if(!this.options.animation)return clearTimeout(s),void(typeof a=="function"&&a());var c=!1,f=0;o.forEach(function(m){var b=0,S=m.target,R=S.fromRect,D=B(S),j=S.prevFromRect,z=S.prevToRect,H=m.rect,G=N(S,!0);G&&(D.top-=G.f,D.left-=G.e),S.toRect=D,S.thisAnimationDuration&&Xt(j,D)&&!Xt(R,D)&&(H.top-D.top)/(H.left-D.left)==(R.top-D.top)/(R.left-D.left)&&(m=H,G=j,j=z,z=h.options,b=Math.sqrt(Math.pow(G.top-m.top,2)+Math.pow(G.left-m.left,2))/Math.sqrt(Math.pow(G.top-j.top,2)+Math.pow(G.left-j.left,2))*z.animation),Xt(D,R)||(S.prevFromRect=R,S.prevToRect=D,b=b||h.options.animation,h.animate(S,H,D,b)),b&&(c=!0,f=Math.max(f,b),clearTimeout(S.animationResetTimer),S.animationResetTimer=setTimeout(function(){S.animationTime=0,S.prevFromRect=null,S.fromRect=null,S.prevToRect=null,S.thisAnimationDuration=null},b),S.thisAnimationDuration=b)}),clearTimeout(s),c?s=setTimeout(function(){typeof a=="function"&&a()},f):typeof a=="function"&&a(),o=[]},animate:function(a,h,c,f){var m,b;f&&(T(a,"transition",""),T(a,"transform",""),m=(b=N(this.el))&&b.a,b=b&&b.d,m=(h.left-c.left)/(m||1),b=(h.top-c.top)/(b||1),a.animatingX=!!m,a.animatingY=!!b,T(a,"transform","translate3d("+m+"px,"+b+"px,0)"),this.forRepaintDummy=a.offsetWidth,T(a,"transition","transform "+f+"ms"+(this.options.easing?" "+this.options.easing:"")),T(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){T(a,"transition",""),T(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},f))}}}var Be=[],Kt={initializeByDefault:!0},Qe={mount:function(s){for(var o in Kt)!Kt.hasOwnProperty(o)||o in s||(s[o]=Kt[o]);Be.forEach(function(a){if(a.pluginName===s.pluginName)throw"Sortable: Cannot mount plugin ".concat(s.pluginName," more than once")}),Be.push(s)},pluginEvent:function(s,o,a){var h=this;this.eventCanceled=!1,a.cancel=function(){h.eventCanceled=!0};var c=s+"Global";Be.forEach(function(f){o[f.pluginName]&&(o[f.pluginName][c]&&o[f.pluginName][c](e({sortable:o},a)),o.options[f.pluginName]&&o[f.pluginName][s]&&o[f.pluginName][s](e({sortable:o},a)))})},initializePlugins:function(s,o,a,h){for(var c in Be.forEach(function(m){var b=m.pluginName;(s.options[b]||m.initializeByDefault)&&((m=new m(s,o,s.options)).sortable=s,m.options=s.options,s[b]=m,i(a,m.defaults))}),s.options){var f;s.options.hasOwnProperty(c)&&(f=this.modifyOption(s,c,s.options[c]))!==void 0&&(s.options[c]=f)}},getEventProperties:function(s,o){var a={};return Be.forEach(function(h){typeof h.eventProperties=="function"&&i(a,h.eventProperties.call(o[h.pluginName],s))}),a},modifyOption:function(s,o,a){var h;return Be.forEach(function(c){s[c.pluginName]&&c.optionListeners&&typeof c.optionListeners[o]=="function"&&(h=c.optionListeners[o].call(s[c.pluginName],a))}),h}};function Ze(s){var o=s.sortable,a=s.rootEl,h=s.name,c=s.targetEl,f=s.cloneEl,m=s.toEl,b=s.fromEl,S=s.oldIndex,R=s.newIndex,D=s.oldDraggableIndex,j=s.newDraggableIndex,z=s.originalEvent,H=s.putSortable,G=s.extraEventProperties;if(o=o||a&&a[ae]){var P,ee=o.options,s="on"+h.charAt(0).toUpperCase()+h.substr(1);!window.CustomEvent||p||y?(P=document.createEvent("Event")).initEvent(h,!0,!0):P=new CustomEvent(h,{bubbles:!0,cancelable:!0}),P.to=m||a,P.from=b||a,P.item=c||a,P.clone=f,P.oldIndex=S,P.newIndex=R,P.oldDraggableIndex=D,P.newDraggableIndex=j,P.originalEvent=z,P.pullMode=H?H.lastPutMode:void 0;var _e,V=e(e({},G),Qe.getEventProperties(h,o));for(_e in V)P[_e]=V[_e];a&&a.dispatchEvent(P),ee[s]&&ee[s].call(o,P)}}function he(s,o){var a=(h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{}).evt,h=r(h,Cs);Qe.pluginEvent.bind(I)(s,o,e({dragEl:E,parentEl:Q,ghostEl:F,rootEl:X,nextEl:Oe,lastDownEl:Ct,cloneEl:Z,cloneHidden:Ie,dragStarted:tt,putSortable:ce,activeSortable:I.active,originalEvent:a,oldIndex:ze,oldDraggableIndex:et,newIndex:pe,newDraggableIndex:Le,hideGhostForTarget:Gi,unhideGhostForTarget:Ki,cloneNowHidden:function(){Ie=!0},cloneNowShown:function(){Ie=!1},dispatchSortableEvent:function(c){de({sortable:o,name:c,originalEvent:a})}},h))}var Cs=["evt"];function de(s){Ze(e({putSortable:ce,cloneEl:Z,targetEl:E,rootEl:X,oldIndex:ze,oldDraggableIndex:et,newIndex:pe,newDraggableIndex:Le},s))}var E,Q,F,X,Oe,Ct,Z,Ie,ze,pe,et,Le,xt,ce,He,ve,Jt,Qt,zi,qi,tt,qe,it,St,le,Ve=!1,$t=!1,kt=[],st=!1,Tt=!1,Zt=[],ei=!1,Et=[],Rt=typeof document!="undefined",Dt=w,Vi=y||p?"cssFloat":"float",xs=Rt&&!ot&&!w&&"draggable"in document.createElement("div"),Yi=function(){if(Rt){if(p)return!1;var s=document.createElement("x");return s.style.cssText="pointer-events:auto",s.style.pointerEvents==="auto"}}(),Xi=function(R,o){var a=T(R),h=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),c=We(R,0,o),f=We(R,1,o),m=c&&T(c),b=f&&T(f),S=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+B(c).width,R=b&&parseInt(b.marginLeft)+parseInt(b.marginRight)+B(f).width;return a.display==="flex"?a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal":a.display==="grid"?a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal":c&&m.float&&m.float!=="none"?(o=m.float==="left"?"left":"right",!f||b.clear!=="both"&&b.clear!==o?"horizontal":"vertical"):c&&(m.display==="block"||m.display==="flex"||m.display==="table"||m.display==="grid"||h<=S&&a[Vi]==="none"||f&&a[Vi]==="none"&&h<S+R)?"vertical":"horizontal"},Ui=function(s){function o(c,f){return function(m,b,S,R){var D=m.options.group.name&&b.options.group.name&&m.options.group.name===b.options.group.name;return c==null&&(f||D)?!0:c==null||c===!1?!1:f&&c==="clone"?c:typeof c=="function"?o(c(m,b,S,R),f)(m,b,S,R):(b=(f?m:b).options.group.name,c===!0||typeof c=="string"&&c===b||c.join&&-1<c.indexOf(b))}}var a={},h=s.group;h&&t(h)=="object"||(h={name:h}),a.name=h.name,a.checkPull=o(h.pull,!0),a.checkPut=o(h.put),a.revertClone=h.revertClone,s.group=a},Gi=function(){!Yi&&F&&T(F,"display","none")},Ki=function(){!Yi&&F&&T(F,"display","")};Rt&&!ot&&document.addEventListener("click",function(s){if($t)return s.preventDefault(),s.stopPropagation&&s.stopPropagation(),s.stopImmediatePropagation&&s.stopImmediatePropagation(),$t=!1},!0);function Fe(s){if(E){s=s.touches?s.touches[0]:s;var o=(c=s.clientX,f=s.clientY,kt.some(function(b){var S=b[ae].options.emptyInsertThreshold;if(S&&!Yt(b)){var R=B(b),D=c>=R.left-S&&c<=R.right+S,S=f>=R.top-S&&f<=R.bottom+S;return D&&S?m=b:void 0}}),m);if(o){var a,h={};for(a in s)s.hasOwnProperty(a)&&(h[a]=s[a]);h.target=h.rootEl=o,h.preventDefault=void 0,h.stopPropagation=void 0,o[ae]._onDragOver(h)}}var c,f,m}function Ss(s){E&&E.parentNode[ae]._isOutsideThisEl(s.target)}function I(s,o){if(!s||!s.nodeType||s.nodeType!==1)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(s));this.el=s,this.options=o=i({},o),s[ae]=this;var a,h,c={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(s.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Xi(s,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(f,m){f.setData("Text",m.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:I.supportPointer!==!1&&"PointerEvent"in window&&!v,emptyInsertThreshold:5};for(a in Qe.initializePlugins(this,s,c),c)a in o||(o[a]=c[a]);for(h in Ui(o),this)h.charAt(0)==="_"&&typeof this[h]=="function"&&(this[h]=this[h].bind(this));this.nativeDraggable=!o.forceFallback&&xs,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?C(s,"pointerdown",this._onTapStart):(C(s,"mousedown",this._onTapStart),C(s,"touchstart",this._onTapStart)),this.nativeDraggable&&(C(s,"dragover",this),C(s,"dragenter",this)),kt.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[]),i(this,ws())}function It(s,o,a,h,c,f,m,b){var S,R,D=s[ae],j=D.options.onMove;return!window.CustomEvent||p||y?(S=document.createEvent("Event")).initEvent("move",!0,!0):S=new CustomEvent("move",{bubbles:!0,cancelable:!0}),S.to=o,S.from=s,S.dragged=a,S.draggedRect=h,S.related=c||o,S.relatedRect=f||B(o),S.willInsertAfter=b,S.originalEvent=m,s.dispatchEvent(S),R=j?j.call(D,S,m):R}function ti(s){s.draggable=!1}function $s(){ei=!1}function Lt(s){return setTimeout(s,0)}function ii(s){return clearTimeout(s)}I.prototype={constructor:I,_isOutsideThisEl:function(s){this.el.contains(s)||s===this.el||(qe=null)},_getDirection:function(s,o){return typeof this.options.direction=="function"?this.options.direction.call(this,s,o,E):this.options.direction},_onTapStart:function(s){if(s.cancelable){var o=this,a=this.el,h=this.options,c=h.preventOnFilter,f=s.type,m=s.touches&&s.touches[0]||s.pointerType&&s.pointerType==="touch"&&s,b=(m||s).target,S=s.target.shadowRoot&&(s.path&&s.path[0]||s.composedPath&&s.composedPath()[0])||b,R=h.filter;if(function(D){Et.length=0;for(var j=D.getElementsByTagName("input"),z=j.length;z--;){var H=j[z];H.checked&&Et.push(H)}}(a),!E&&!(/mousedown|pointerdown/.test(f)&&s.button!==0||h.disabled)&&!S.isContentEditable&&(this.nativeDraggable||!v||!b||b.tagName.toUpperCase()!=="SELECT")&&!((b=A(b,h.draggable,a,!1))&&b.animated||Ct===b)){if(ze=J(b),et=J(b,h.draggable),typeof R=="function"){if(R.call(this,s,b,this))return de({sortable:o,rootEl:S,name:"filter",targetEl:b,toEl:a,fromEl:a}),he("filter",o,{evt:s}),void(c&&s.cancelable&&s.preventDefault())}else if(R=R&&R.split(",").some(function(D){if(D=A(S,D.trim(),a,!1))return de({sortable:o,rootEl:D,name:"filter",targetEl:b,fromEl:a,toEl:a}),he("filter",o,{evt:s}),!0}))return void(c&&s.cancelable&&s.preventDefault());h.handle&&!A(S,h.handle,a,!1)||this._prepareDragStart(s,m,b)}}},_prepareDragStart:function(s,o,a){var h,c=this,f=c.el,m=c.options,b=f.ownerDocument;a&&!E&&a.parentNode===f&&(h=B(a),X=f,Q=(E=a).parentNode,Oe=E.nextSibling,Ct=a,xt=m.group,He={target:I.dragged=E,clientX:(o||s).clientX,clientY:(o||s).clientY},zi=He.clientX-h.left,qi=He.clientY-h.top,this._lastX=(o||s).clientX,this._lastY=(o||s).clientY,E.style["will-change"]="all",h=function(){he("delayEnded",c,{evt:s}),I.eventCanceled?c._onDrop():(c._disableDelayedDragEvents(),!g&&c.nativeDraggable&&(E.draggable=!0),c._triggerDragStart(s,o),de({sortable:c,name:"choose",originalEvent:s}),M(E,m.chosenClass,!0))},m.ignore.split(",").forEach(function(S){oe(E,S.trim(),ti)}),C(b,"dragover",Fe),C(b,"mousemove",Fe),C(b,"touchmove",Fe),C(b,"mouseup",c._onDrop),C(b,"touchend",c._onDrop),C(b,"touchcancel",c._onDrop),g&&this.nativeDraggable&&(this.options.touchStartThreshold=4,E.draggable=!0),he("delayStart",this,{evt:s}),!m.delay||m.delayOnTouchOnly&&!o||this.nativeDraggable&&(y||p)?h():I.eventCanceled?this._onDrop():(C(b,"mouseup",c._disableDelayedDrag),C(b,"touchend",c._disableDelayedDrag),C(b,"touchcancel",c._disableDelayedDrag),C(b,"mousemove",c._delayedDragTouchMoveHandler),C(b,"touchmove",c._delayedDragTouchMoveHandler),m.supportPointer&&C(b,"pointermove",c._delayedDragTouchMoveHandler),c._dragStartTimer=setTimeout(h,m.delay)))},_delayedDragTouchMoveHandler:function(s){s=s.touches?s.touches[0]:s,Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){E&&ti(E),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var s=this.el.ownerDocument;x(s,"mouseup",this._disableDelayedDrag),x(s,"touchend",this._disableDelayedDrag),x(s,"touchcancel",this._disableDelayedDrag),x(s,"mousemove",this._delayedDragTouchMoveHandler),x(s,"touchmove",this._delayedDragTouchMoveHandler),x(s,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(s,o){o=o||s.pointerType=="touch"&&s,!this.nativeDraggable||o?this.options.supportPointer?C(document,"pointermove",this._onTouchMove):C(document,o?"touchmove":"mousemove",this._onTouchMove):(C(E,"dragend",this),C(X,"dragstart",this._onDragStart));try{document.selection?Lt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(a){}},_dragStarted:function(s,o){var a;Ve=!1,X&&E?(he("dragStarted",this,{evt:o}),this.nativeDraggable&&C(document,"dragover",Ss),a=this.options,s||M(E,a.dragClass,!1),M(E,a.ghostClass,!0),I.active=this,s&&this._appendGhost(),de({sortable:this,name:"start",originalEvent:o})):this._nulling()},_emulateDragOver:function(){if(ve){this._lastX=ve.clientX,this._lastY=ve.clientY,Gi();for(var s=document.elementFromPoint(ve.clientX,ve.clientY),o=s;s&&s.shadowRoot&&(s=s.shadowRoot.elementFromPoint(ve.clientX,ve.clientY))!==o;)o=s;if(E.parentNode[ae]._isOutsideThisEl(s),o)do if(o[ae]&&o[ae]._onDragOver({clientX:ve.clientX,clientY:ve.clientY,target:s,rootEl:o})&&!this.options.dragoverBubble)break;while(o=(s=o).parentNode);Ki()}},_onTouchMove:function(s){if(He){var f=this.options,o=f.fallbackTolerance,a=f.fallbackOffset,h=s.touches?s.touches[0]:s,c=F&&N(F,!0),m=F&&c&&c.a,b=F&&c&&c.d,f=Dt&&le&&ji(le),m=(h.clientX-He.clientX+a.x)/(m||1)+(f?f[0]-Zt[0]:0)/(m||1),b=(h.clientY-He.clientY+a.y)/(b||1)+(f?f[1]-Zt[1]:0)/(b||1);if(!I.active&&!Ve){if(o&&Math.max(Math.abs(h.clientX-this._lastX),Math.abs(h.clientY-this._lastY))<o)return;this._onDragStart(s,!0)}F&&(c?(c.e+=m-(Jt||0),c.f+=b-(Qt||0)):c={a:1,b:0,c:0,d:1,e:m,f:b},c="matrix(".concat(c.a,",").concat(c.b,",").concat(c.c,",").concat(c.d,",").concat(c.e,",").concat(c.f,")"),T(F,"webkitTransform",c),T(F,"mozTransform",c),T(F,"msTransform",c),T(F,"transform",c),Jt=m,Qt=b,ve=h),s.cancelable&&s.preventDefault()}},_appendGhost:function(){if(!F){var s=this.options.fallbackOnBody?document.body:X,o=B(E,!0,Dt,!0,s),a=this.options;if(Dt){for(le=s;T(le,"position")==="static"&&T(le,"transform")==="none"&&le!==document;)le=le.parentNode;le!==document.body&&le!==document.documentElement?(le===document&&(le=re()),o.top+=le.scrollTop,o.left+=le.scrollLeft):le=re(),Zt=ji(le)}M(F=E.cloneNode(!0),a.ghostClass,!1),M(F,a.fallbackClass,!0),M(F,a.dragClass,!0),T(F,"transition",""),T(F,"transform",""),T(F,"box-sizing","border-box"),T(F,"margin",0),T(F,"top",o.top),T(F,"left",o.left),T(F,"width",o.width),T(F,"height",o.height),T(F,"opacity","0.8"),T(F,"position",Dt?"absolute":"fixed"),T(F,"zIndex","100000"),T(F,"pointerEvents","none"),I.ghost=F,s.appendChild(F),T(F,"transform-origin",zi/parseInt(F.style.width)*100+"% "+qi/parseInt(F.style.height)*100+"%")}},_onDragStart:function(s,o){var a=this,h=s.dataTransfer,c=a.options;he("dragStart",this,{evt:s}),I.eventCanceled?this._onDrop():(he("setupClone",this),I.eventCanceled||((Z=Ut(E)).removeAttribute("id"),Z.draggable=!1,Z.style["will-change"]="",this._hideClone(),M(Z,this.options.chosenClass,!1),I.clone=Z),a.cloneId=Lt(function(){he("clone",a),I.eventCanceled||(a.options.removeCloneOnHide||X.insertBefore(Z,E),a._hideClone(),de({sortable:a,name:"clone"}))}),o||M(E,c.dragClass,!0),o?($t=!0,a._loopId=setInterval(a._emulateDragOver,50)):(x(document,"mouseup",a._onDrop),x(document,"touchend",a._onDrop),x(document,"touchcancel",a._onDrop),h&&(h.effectAllowed="move",c.setData&&c.setData.call(a,h,E)),C(document,"drop",a),T(E,"transform","translateZ(0)")),Ve=!0,a._dragStartId=Lt(a._dragStarted.bind(a,o,s)),C(document,"selectstart",a),tt=!0,v&&T(document.body,"user-select","none"))},_onDragOver:function(s){var o,a,h,c,f=this.el,m=s.target,b=this.options,S=b.group,R=I.active,D=xt===S,j=b.sort,z=ce||R,H=this,G=!1;if(!ei){if(s.preventDefault!==void 0&&s.cancelable&&s.preventDefault(),m=A(m,b.draggable,f,!0),ne("dragOver"),I.eventCanceled)return G;if(E.contains(s.target)||m.animated&&m.animatingX&&m.animatingY||H._ignoreWhileAnimating===m)return ge(!1);if($t=!1,R&&!b.disabled&&(D?j||(a=Q!==X):ce===this||(this.lastPutMode=xt.checkPull(this,R,E,s))&&S.checkPut(this,R,E,s))){if(h=this._getDirection(s,m)==="vertical",o=B(E),ne("dragOverValid"),I.eventCanceled)return G;if(a)return Q=X,ke(),this._hideClone(),ne("revert"),I.eventCanceled||(Oe?X.insertBefore(E,Oe):X.appendChild(E)),ge(!0);var P=Yt(f,b.draggable);if(!P||function(ie,ht,U){return U=B(Yt(U.el,U.options.draggable)),ht?ie.clientX>U.right+10||ie.clientX<=U.right&&ie.clientY>U.bottom&&ie.clientX>=U.left:ie.clientX>U.right&&ie.clientY>U.top||ie.clientX<=U.right&&ie.clientY>U.bottom+10}(s,h,this)&&!P.animated){if(P===E)return ge(!1);if((m=P&&f===s.target?P:m)&&(me=B(m)),It(X,f,E,o,m,me,s,!!m)!==!1)return ke(),P&&P.nextSibling?f.insertBefore(E,P.nextSibling):f.appendChild(E),Q=f,je(),ge(!0)}else if(P&&function(ie,ht,U){return U=B(We(U.el,0,U.options,!0)),ht?ie.clientX<U.left-10||ie.clientY<U.top&&ie.clientX<U.right:ie.clientY<U.top-10||ie.clientY<U.bottom&&ie.clientX<U.left}(s,h,this)){var ee=We(f,0,b,!0);if(ee===E)return ge(!1);if(me=B(m=ee),It(X,f,E,o,m,me,s,!1)!==!1)return ke(),f.insertBefore(E,ee),Q=f,je(),ge(!0)}else if(m.parentNode===f){var _e,V,be,me=B(m),$e=E.parentNode!==f,K=(K=E.animated&&E.toRect||o,te=m.animated&&m.toRect||me,Se=(c=h)?K.left:K.top,S=c?K.right:K.bottom,P=c?K.width:K.height,ee=c?te.left:te.top,K=c?te.right:te.bottom,te=c?te.width:te.height,!(Se===ee||S===K||Se+P/2===ee+te/2)),Se=h?"top":"left",P=Ne(m,"top","top")||Ne(E,"top","top"),ee=P?P.scrollTop:void 0;if(qe!==m&&(V=me[Se],st=!1,Tt=!K&&b.invertSwap||$e),(_e=function(Me,ci,Ce,Ee,hi,Ht,Zi,ks){var Te=Ee?Me.clientY:Me.clientX,Ae=Ee?Ce.height:Ce.width,Me=Ee?Ce.top:Ce.left,Ee=Ee?Ce.bottom:Ce.right,Ce=!1;if(!Zi){if(ks&&St<Ae*hi){if(st=!st&&(it===1?Me+Ae*Ht/2<Te:Te<Ee-Ae*Ht/2)?!0:st)Ce=!0;else if(it===1?Te<Me+St:Ee-St<Te)return-it}else if(Me+Ae*(1-hi)/2<Te&&Te<Ee-Ae*(1-hi)/2)return function(Ts){return J(E)<J(Ts)?1:-1}(ci)}return(Ce=Ce||Zi)&&(Te<Me+Ae*Ht/2||Ee-Ae*Ht/2<Te)?Me+Ae/2<Te?1:-1:0}(s,m,me,h,K?1:b.swapThreshold,b.invertedSwapThreshold==null?b.swapThreshold:b.invertedSwapThreshold,Tt,qe===m))!==0)for(var ct=J(E);(be=Q.children[ct-=_e])&&(T(be,"display")==="none"||be===F););if(_e===0||be===m)return ge(!1);it=_e;var te=(qe=m).nextElementSibling,$e=!1,K=It(X,f,E,o,m,me,s,$e=_e===1);if(K!==!1)return K!==1&&K!==-1||($e=K===1),ei=!0,setTimeout($s,30),ke(),$e&&!te?f.appendChild(E):m.parentNode.insertBefore(E,$e?te:m),P&&Wi(P,0,ee-P.scrollTop),Q=E.parentNode,V===void 0||Tt||(St=Math.abs(V-B(m)[Se])),je(),ge(!0)}if(f.contains(E))return ge(!1)}return!1}function ne(ie,ht){he(ie,H,e({evt:s,isOwner:D,axis:h?"vertical":"horizontal",revert:a,dragRect:o,targetRect:me,canSort:j,fromSortable:z,target:m,completed:ge,onMove:function(U,ci){return It(X,f,E,o,U,B(U),s,ci)},changed:je},ht))}function ke(){ne("dragOverAnimationCapture"),H.captureAnimationState(),H!==z&&z.captureAnimationState()}function ge(ie){return ne("dragOverCompleted",{insertion:ie}),ie&&(D?R._hideClone():R._showClone(H),H!==z&&(M(E,(ce||R).options.ghostClass,!1),M(E,b.ghostClass,!0)),ce!==H&&H!==I.active?ce=H:H===I.active&&ce&&(ce=null),z===H&&(H._ignoreWhileAnimating=m),H.animateAll(function(){ne("dragOverAnimationComplete"),H._ignoreWhileAnimating=null}),H!==z&&(z.animateAll(),z._ignoreWhileAnimating=null)),(m===E&&!E.animated||m===f&&!m.animated)&&(qe=null),b.dragoverBubble||s.rootEl||m===document||(E.parentNode[ae]._isOutsideThisEl(s.target),ie||Fe(s)),!b.dragoverBubble&&s.stopPropagation&&s.stopPropagation(),G=!0}function je(){pe=J(E),Le=J(E,b.draggable),de({sortable:H,name:"change",toEl:f,newIndex:pe,newDraggableIndex:Le,originalEvent:s})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){x(document,"mousemove",this._onTouchMove),x(document,"touchmove",this._onTouchMove),x(document,"pointermove",this._onTouchMove),x(document,"dragover",Fe),x(document,"mousemove",Fe),x(document,"touchmove",Fe)},_offUpEvents:function(){var s=this.el.ownerDocument;x(s,"mouseup",this._onDrop),x(s,"touchend",this._onDrop),x(s,"pointerup",this._onDrop),x(s,"touchcancel",this._onDrop),x(document,"selectstart",this)},_onDrop:function(s){var o=this.el,a=this.options;pe=J(E),Le=J(E,a.draggable),he("drop",this,{evt:s}),Q=E&&E.parentNode,pe=J(E),Le=J(E,a.draggable),I.eventCanceled||(st=Tt=Ve=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ii(this.cloneId),ii(this._dragStartId),this.nativeDraggable&&(x(document,"drop",this),x(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),v&&T(document.body,"user-select",""),T(E,"transform",""),s&&(tt&&(s.cancelable&&s.preventDefault(),a.dropBubble||s.stopPropagation()),F&&F.parentNode&&F.parentNode.removeChild(F),(X===Q||ce&&ce.lastPutMode!=="clone")&&Z&&Z.parentNode&&Z.parentNode.removeChild(Z),E&&(this.nativeDraggable&&x(E,"dragend",this),ti(E),E.style["will-change"]="",tt&&!Ve&&M(E,(ce||this).options.ghostClass,!1),M(E,this.options.chosenClass,!1),de({sortable:this,name:"unchoose",toEl:Q,newIndex:null,newDraggableIndex:null,originalEvent:s}),X!==Q?(0<=pe&&(de({rootEl:Q,name:"add",toEl:Q,fromEl:X,originalEvent:s}),de({sortable:this,name:"remove",toEl:Q,originalEvent:s}),de({rootEl:Q,name:"sort",toEl:Q,fromEl:X,originalEvent:s}),de({sortable:this,name:"sort",toEl:Q,originalEvent:s})),ce&&ce.save()):pe!==ze&&0<=pe&&(de({sortable:this,name:"update",toEl:Q,originalEvent:s}),de({sortable:this,name:"sort",toEl:Q,originalEvent:s})),I.active&&(pe!=null&&pe!==-1||(pe=ze,Le=et),de({sortable:this,name:"end",toEl:Q,originalEvent:s}),this.save())))),this._nulling()},_nulling:function(){he("nulling",this),X=E=Q=F=Oe=Z=Ct=Ie=He=ve=tt=pe=Le=ze=et=qe=it=ce=xt=I.dragged=I.ghost=I.clone=I.active=null,Et.forEach(function(s){s.checked=!0}),Et.length=Jt=Qt=0},handleEvent:function(s){switch(s.type){case"drop":case"dragend":this._onDrop(s);break;case"dragenter":case"dragover":E&&(this._onDragOver(s),function(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}(s));break;case"selectstart":s.preventDefault()}},toArray:function(){for(var s,o=[],a=this.el.children,h=0,c=a.length,f=this.options;h<c;h++)A(s=a[h],f.draggable,this.el,!1)&&o.push(s.getAttribute(f.dataIdAttr)||function(m){for(var b=m.tagName+m.className+m.src+m.href+m.textContent,S=b.length,R=0;S--;)R+=b.charCodeAt(S);return R.toString(36)}(s));return o},sort:function(s,o){var a={},h=this.el;this.toArray().forEach(function(c,f){f=h.children[f],A(f,this.options.draggable,h,!1)&&(a[c]=f)},this),o&&this.captureAnimationState(),s.forEach(function(c){a[c]&&(h.removeChild(a[c]),h.appendChild(a[c]))}),o&&this.animateAll()},save:function(){var s=this.options.store;s&&s.set&&s.set(this)},closest:function(s,o){return A(s,o||this.options.draggable,this.el,!1)},option:function(s,o){var a=this.options;if(o===void 0)return a[s];var h=Qe.modifyOption(this,s,o);a[s]=h!==void 0?h:o,s==="group"&&Ui(a)},destroy:function(){he("destroy",this);var s=this.el;s[ae]=null,x(s,"mousedown",this._onTapStart),x(s,"touchstart",this._onTapStart),x(s,"pointerdown",this._onTapStart),this.nativeDraggable&&(x(s,"dragover",this),x(s,"dragenter",this)),Array.prototype.forEach.call(s.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),kt.splice(kt.indexOf(this.el),1),this.el=s=null},_hideClone:function(){Ie||(he("hideClone",this),I.eventCanceled||(T(Z,"display","none"),this.options.removeCloneOnHide&&Z.parentNode&&Z.parentNode.removeChild(Z),Ie=!0))},_showClone:function(s){s.lastPutMode==="clone"?Ie&&(he("showClone",this),I.eventCanceled||(E.parentNode!=X||this.options.group.revertClone?Oe?X.insertBefore(Z,Oe):X.appendChild(Z):X.insertBefore(Z,E),this.options.group.revertClone&&this.animate(E,Z),T(Z,"display",""),Ie=!1)):this._hideClone()}},Rt&&C(document,"touchmove",function(s){(I.active||Ve)&&s.cancelable&&s.preventDefault()}),I.utils={on:C,off:x,css:T,find:oe,is:function(s,o){return!!A(s,o,s,!1)},extend:function(s,o){if(s&&o)for(var a in o)o.hasOwnProperty(a)&&(s[a]=o[a]);return s},throttle:Pi,closest:A,toggleClass:M,clone:Ut,index:J,nextTick:Lt,cancelNextTick:ii,detectDirection:Xi,getChild:We},I.get=function(s){return s[ae]},I.mount=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];(o=o[0].constructor===Array?o[0]:o).forEach(function(h){if(!h.prototype||!h.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(h));h.utils&&(I.utils=e(e({},I.utils),h.utils)),Qe.mount(h)})},I.create=function(s,o){return new I(s,o)};var nt,si,ni,ri,At,rt,se=[],oi=!(I.version="1.15.0");function Mt(){se.forEach(function(s){clearInterval(s.pid)}),se=[]}function Ji(){clearInterval(rt)}var ye,ai=Pi(function(s,o,a,h){if(o.scroll){var c,f=(s.touches?s.touches[0]:s).clientX,m=(s.touches?s.touches[0]:s).clientY,b=o.scrollSensitivity,S=o.scrollSpeed,R=re(),D=!1;si!==a&&(si=a,Mt(),nt=o.scroll,c=o.scrollFn,nt===!0&&(nt=De(a,!0)));var j=0,z=nt;do{var H=z,ne=B(H),G=ne.top,P=ne.bottom,ee=ne.left,_e=ne.right,V=ne.width,be=ne.height,me=void 0,$e=void 0,Se=H.scrollWidth,ct=H.scrollHeight,te=T(H),K=H.scrollLeft,ne=H.scrollTop,$e=H===R?(me=V<Se&&(te.overflowX==="auto"||te.overflowX==="scroll"||te.overflowX==="visible"),be<ct&&(te.overflowY==="auto"||te.overflowY==="scroll"||te.overflowY==="visible")):(me=V<Se&&(te.overflowX==="auto"||te.overflowX==="scroll"),be<ct&&(te.overflowY==="auto"||te.overflowY==="scroll")),K=me&&(Math.abs(_e-f)<=b&&K+V<Se)-(Math.abs(ee-f)<=b&&!!K),ne=$e&&(Math.abs(P-m)<=b&&ne+be<ct)-(Math.abs(G-m)<=b&&!!ne);if(!se[j])for(var ke=0;ke<=j;ke++)se[ke]||(se[ke]={});se[j].vx==K&&se[j].vy==ne&&se[j].el===H||(se[j].el=H,se[j].vx=K,se[j].vy=ne,clearInterval(se[j].pid),K==0&&ne==0||(D=!0,se[j].pid=setInterval(function(){h&&this.layer===0&&I.active._onTouchMove(At);var ge=se[this.layer].vy?se[this.layer].vy*S:0,je=se[this.layer].vx?se[this.layer].vx*S:0;typeof c=="function"&&c.call(I.dragged.parentNode[ae],je,ge,s,At,se[this.layer].el)!=="continue"||Wi(se[this.layer].el,je,ge)}.bind({layer:j}),24))),j++}while(o.bubbleScroll&&z!==R&&(z=De(z,!1)));oi=D}},30),ot=function(b){var o=b.originalEvent,a=b.putSortable,h=b.dragEl,c=b.activeSortable,f=b.dispatchSortableEvent,m=b.hideGhostForTarget,b=b.unhideGhostForTarget;o&&(c=a||c,m(),o=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,o=document.elementFromPoint(o.clientX,o.clientY),b(),c&&!c.el.contains(o)&&(f("spill"),this.onSpill({dragEl:h,putSortable:a})))};function li(){}function di(){}li.prototype={startIndex:null,dragStart:function(s){s=s.oldDraggableIndex,this.startIndex=s},onSpill:function(s){var o=s.dragEl,a=s.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState(),s=We(this.sortable.el,this.startIndex,this.options),s?this.sortable.el.insertBefore(o,s):this.sortable.el.appendChild(o),this.sortable.animateAll(),a&&a.animateAll()},drop:ot},i(li,{pluginName:"revertOnSpill"}),di.prototype={onSpill:function(a){var o=a.dragEl,a=a.putSortable||this.sortable;a.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),a.animateAll()},drop:ot},i(di,{pluginName:"removeOnSpill"});var at,we,Y,lt,Nt,O=[],fe=[],dt=!1,ue=!1,Ye=!1;function Qi(s,o){fe.forEach(function(a,h){h=o.children[a.sortableIndex+(s?Number(h):0)],h?o.insertBefore(a,h):o.appendChild(a)})}function Ot(){O.forEach(function(s){s!==Y&&s.parentNode&&s.parentNode.removeChild(s)})}return I.mount(new function(){function s(){for(var o in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this))}return s.prototype={dragStarted:function(o){o=o.originalEvent,this.sortable.nativeDraggable?C(document,"dragover",this._handleAutoScroll):this.options.supportPointer?C(document,"pointermove",this._handleFallbackAutoScroll):o.touches?C(document,"touchmove",this._handleFallbackAutoScroll):C(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){o=o.originalEvent,this.options.dragOverBubble||o.rootEl||this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?x(document,"dragover",this._handleAutoScroll):(x(document,"pointermove",this._handleFallbackAutoScroll),x(document,"touchmove",this._handleFallbackAutoScroll),x(document,"mousemove",this._handleFallbackAutoScroll)),Ji(),Mt(),clearTimeout(W),W=void 0},nulling:function(){At=si=nt=oi=rt=ni=ri=null,se.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,a){var h,c=this,f=(o.touches?o.touches[0]:o).clientX,m=(o.touches?o.touches[0]:o).clientY,b=document.elementFromPoint(f,m);At=o,a||this.options.forceAutoScrollFallback||y||p||v?(ai(o,this.options,b,a),h=De(b,!0),!oi||rt&&f===ni&&m===ri||(rt&&Ji(),rt=setInterval(function(){var S=De(document.elementFromPoint(f,m),!0);S!==h&&(h=S,Mt()),ai(o,c.options,S,a)},10),ni=f,ri=m)):this.options.bubbleScroll&&De(b,!0)!==re()?ai(o,this.options,De(b,!1),!1):Mt()}},i(s,{pluginName:"scroll",initializeByDefault:!0})}),I.mount(di,li),I.mount(new function(){function s(){this.defaults={swapClass:"sortable-swap-highlight"}}return s.prototype={dragStart:function(o){o=o.dragEl,ye=o},dragOverValid:function(o){var a=o.completed,h=o.target,c=o.onMove,f=o.activeSortable,m=o.changed,b=o.cancel;f.options.swap&&(o=this.sortable.el,f=this.options,h&&h!==o&&(o=ye,ye=c(h)!==!1?(M(h,f.swapClass,!0),h):null,o&&o!==ye&&M(o,f.swapClass,!1)),m(),a(!0),b())},drop:function(o){var a,h,c=o.activeSortable,f=o.putSortable,m=o.dragEl,b=f||this.sortable,S=this.options;ye&&M(ye,S.swapClass,!1),ye&&(S.swap||f&&f.options.swap)&&m!==ye&&(b.captureAnimationState(),b!==c&&c.captureAnimationState(),h=ye,o=(a=m).parentNode,S=h.parentNode,o&&S&&!o.isEqualNode(h)&&!S.isEqualNode(a)&&(f=J(a),m=J(h),o.isEqualNode(S)&&f<m&&m++,o.insertBefore(h,o.children[f]),S.insertBefore(a,S.children[m])),b.animateAll(),b!==c&&c.animateAll())},nulling:function(){ye=null}},i(s,{pluginName:"swap",eventProperties:function(){return{swapItem:ye}}})}),I.mount(new function(){function s(o){for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));o.options.avoidImplicitDeselect||(o.options.supportPointer?C(document,"pointerup",this._deselectMultiDrag):(C(document,"mouseup",this._deselectMultiDrag),C(document,"touchend",this._deselectMultiDrag))),C(document,"keydown",this._checkKeyDown),C(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(h,c){var f="";O.length&&we===o?O.forEach(function(m,b){f+=(b?", ":"")+m.textContent}):f=c.textContent,h.setData("Text",f)}}}return s.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(o){o=o.dragEl,Y=o},delayEnded:function(){this.isMultiDrag=~O.indexOf(Y)},setupClone:function(h){var a=h.sortable,h=h.cancel;if(this.isMultiDrag){for(var c=0;c<O.length;c++)fe.push(Ut(O[c])),fe[c].sortableIndex=O[c].sortableIndex,fe[c].draggable=!1,fe[c].style["will-change"]="",M(fe[c],this.options.selectedClass,!1),O[c]===Y&&M(fe[c],this.options.chosenClass,!1);a._hideClone(),h()}},clone:function(f){var a=f.sortable,h=f.rootEl,c=f.dispatchSortableEvent,f=f.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||O.length&&we===a&&(Qi(!0,h),c("clone"),f()))},showClone:function(c){var a=c.cloneNowShown,h=c.rootEl,c=c.cancel;this.isMultiDrag&&(Qi(!1,h),fe.forEach(function(f){T(f,"display","")}),a(),Nt=!1,c())},hideClone:function(c){var a=this,h=(c.sortable,c.cloneNowHidden),c=c.cancel;this.isMultiDrag&&(fe.forEach(function(f){T(f,"display","none"),a.options.removeCloneOnHide&&f.parentNode&&f.parentNode.removeChild(f)}),h(),Nt=!0,c())},dragStartGlobal:function(o){o.sortable,!this.isMultiDrag&&we&&we.multiDrag._deselectMultiDrag(),O.forEach(function(a){a.sortableIndex=J(a)}),O=O.sort(function(a,h){return a.sortableIndex-h.sortableIndex}),Ye=!0},dragStarted:function(c){var a,h=this,c=c.sortable;this.isMultiDrag&&(this.options.sort&&(c.captureAnimationState(),this.options.animation&&(O.forEach(function(f){f!==Y&&T(f,"position","absolute")}),a=B(Y,!1,!0,!0),O.forEach(function(f){f!==Y&&Bi(f,a)}),dt=ue=!0)),c.animateAll(function(){dt=ue=!1,h.options.animation&&O.forEach(function(f){Gt(f)}),h.options.sort&&Ot()}))},dragOver:function(c){var a=c.target,h=c.completed,c=c.cancel;ue&&~O.indexOf(a)&&(h(!1),c())},revert:function(o){var a,h,c=o.fromSortable,f=o.rootEl,m=o.sortable,b=o.dragRect;1<O.length&&(O.forEach(function(S){m.addAnimationState({target:S,rect:ue?B(S):b}),Gt(S),S.fromRect=b,c.removeAnimationState(S)}),ue=!1,a=!this.options.removeCloneOnHide,h=f,O.forEach(function(S,R){R=h.children[S.sortableIndex+(a?Number(R):0)],R?h.insertBefore(S,R):h.appendChild(S)}))},dragOverCompleted:function(R){var a,h=R.sortable,c=R.isOwner,f=R.insertion,m=R.activeSortable,b=R.parentEl,S=R.putSortable,R=this.options;f&&(c&&m._hideClone(),dt=!1,R.animation&&1<O.length&&(ue||!c&&!m.options.sort&&!S)&&(a=B(Y,!1,!0,!0),O.forEach(function(D){D!==Y&&(Bi(D,a),b.appendChild(D))}),ue=!0),c||(ue||Ot(),1<O.length?(c=Nt,m._showClone(h),m.options.animation&&!Nt&&c&&fe.forEach(function(D){m.addAnimationState({target:D,rect:lt}),D.fromRect=lt,D.thisAnimationDuration=null})):m._showClone(h)))},dragOverAnimationCapture:function(c){var a=c.dragRect,h=c.isOwner,c=c.activeSortable;O.forEach(function(f){f.thisAnimationDuration=null}),c.options.animation&&!h&&c.multiDrag.isMultiDrag&&(lt=i({},a),a=N(Y,!0),lt.top-=a.f,lt.left-=a.e)},dragOverAnimationComplete:function(){ue&&(ue=!1,Ot())},drop:function(o){var a=o.originalEvent,h=o.rootEl,c=o.parentEl,f=o.sortable,m=o.dispatchSortableEvent,b=o.oldIndex,S=o.putSortable,R=S||this.sortable;if(a){var D,j,z,H=this.options,G=c.children;if(!Ye)if(H.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),M(Y,H.selectedClass,!~O.indexOf(Y)),~O.indexOf(Y))O.splice(O.indexOf(Y),1),at=null,Ze({sortable:f,rootEl:h,name:"deselect",targetEl:Y,originalEvent:a});else{if(O.push(Y),Ze({sortable:f,rootEl:h,name:"select",targetEl:Y,originalEvent:a}),a.shiftKey&&at&&f.el.contains(at)){var P=J(at),o=J(Y);if(~P&&~o&&P!==o)for(var ee,_e=P<o?(ee=P,o):(ee=o,P+1);ee<_e;ee++)~O.indexOf(G[ee])||(M(G[ee],H.selectedClass,!0),O.push(G[ee]),Ze({sortable:f,rootEl:h,name:"select",targetEl:G[ee],originalEvent:a}))}else at=Y;we=R}Ye&&this.isMultiDrag&&(ue=!1,(c[ae].options.sort||c!==h)&&1<O.length&&(D=B(Y),j=J(Y,":not(."+this.options.selectedClass+")"),!dt&&H.animation&&(Y.thisAnimationDuration=null),R.captureAnimationState(),dt||(H.animation&&(Y.fromRect=D,O.forEach(function(V){var be;V.thisAnimationDuration=null,V!==Y&&(be=ue?B(V):D,V.fromRect=be,R.addAnimationState({target:V,rect:be}))})),Ot(),O.forEach(function(V){G[j]?c.insertBefore(V,G[j]):c.appendChild(V),j++}),b===J(Y)&&(z=!1,O.forEach(function(V){V.sortableIndex!==J(V)&&(z=!0)}),z&&m("update"))),O.forEach(function(V){Gt(V)}),R.animateAll()),we=R),(h===c||S&&S.lastPutMode!=="clone")&&fe.forEach(function(V){V.parentNode&&V.parentNode.removeChild(V)})}},nullingGlobal:function(){this.isMultiDrag=Ye=!1,fe.length=0},destroyGlobal:function(){this._deselectMultiDrag(),x(document,"pointerup",this._deselectMultiDrag),x(document,"mouseup",this._deselectMultiDrag),x(document,"touchend",this._deselectMultiDrag),x(document,"keydown",this._checkKeyDown),x(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(o){if(!(Ye!==void 0&&Ye||we!==this.sortable||o&&A(o.target,this.options.draggable,this.sortable.el,!1)||o&&o.button!==0))for(;O.length;){var a=O[0];M(a,this.options.selectedClass,!1),O.shift(),Ze({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:a,originalEvent:o})}},_checkKeyDown:function(o){o.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(o){o.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},i(s,{pluginName:"multiDrag",utils:{select:function(o){var a=o.parentNode[ae];a&&a.options.multiDrag&&!~O.indexOf(o)&&(we&&we!==a&&(we.multiDrag._deselectMultiDrag(),we=a),M(o,a.options.selectedClass,!0),O.push(o))},deselect:function(o){var a=o.parentNode[ae],h=O.indexOf(o);a&&a.options.multiDrag&&~h&&(M(o,a.options.selectedClass,!1),O.splice(h,1))}},eventProperties:function(){var o=this,a=[],h=[];return O.forEach(function(c){var f;a.push({multiDragElement:c,index:c.sortableIndex}),f=ue&&c!==Y?-1:ue?J(c,":not(."+o.options.selectedClass+")"):J(c),h.push({multiDragElement:c,index:f})}),{items:l(O),clones:[].concat(fe),oldIndicies:a,newIndicies:h}},optionListeners:{multiDragKey:function(o){return(o=o.toLowerCase())==="ctrl"?o="Control":1<o.length&&(o=o.charAt(0).toUpperCase()+o.substr(1)),o}}})}),I})});var vs=ts((Ma,bs)=>{"use strict";function Os(n){return n&&typeof n=="object"&&"default"in n?n.default:n}var Hs=Os(ss());function _(n,e){return typeof n=="string"?(e||document).querySelector(n):n||null}_.each=(n,e)=>typeof n=="string"?Array.from((e||document).querySelectorAll(n)):n||null;_.create=(n,e)=>{let t=document.createElement(n);for(let i in e){let r=e[i];if(i==="inside")_(r).appendChild(t);else if(i==="around"){let l=_(r);l.parentNode.insertBefore(t,l),t.appendChild(l)}else i==="styles"?typeof r=="object"&&Object.keys(r).map(l=>{t.style[l]=r[l]}):i in t?t[i]=r:t.setAttribute(i,r)}return t};_.on=(n,e,t,i)=>{i?_.delegate(n,e,t,i):(i=t,_.bind(n,e,i))};_.off=(n,e,t)=>{n.removeEventListener(e,t)};_.bind=(n,e,t)=>{e.split(/\s+/).forEach(function(i){n.addEventListener(i,t)})};_.delegate=(n,e,t,i)=>{n.addEventListener(e,function(r){let l=r.target.closest(t);l&&(r.delegatedTarget=l,i.call(this,r,l))})};_.unbind=(n,e)=>{if(n)for(let t in e){let i=e[t];t.split(/\s+/).forEach(function(r){n.removeEventListener(r,i)})}};_.fire=(n,e,t)=>{let i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0);for(let r in t)i[r]=t[r];return n.dispatchEvent(i)};_.data=(n,e)=>{if(!e)return n.dataset;for(let t in e)n.dataset[t]=e[t]};_.style=(n,e)=>{if(typeof e=="string")return _.getStyle(n,e);Array.isArray(n)||(n=[n]),n.map(t=>{for(let i in e)t.style[i]=e[i]})};_.removeStyle=(n,e)=>{Array.isArray(n)||(n=[n]),Array.isArray(e)||(e=[e]),n.map(t=>{for(let i of e)t.style[i]=""})};_.getStyle=(n,e)=>{if(!e)return getComputedStyle(n);let t=getComputedStyle(n)[e];return["width","height"].includes(e)&&(t=parseFloat(t)),t};_.closest=(n,e)=>e?e.matches(n)?e:_.closest(n,e.parentNode):null;_.inViewport=(n,e)=>{let{top:t,left:i,bottom:r,right:l}=n.getBoundingClientRect(),{top:d,left:u,bottom:p,right:y}=e.getBoundingClientRect();return t>=d&&i>=u&&r<=p&&l<=y};_.scrollTop=function(e,t){requestAnimationFrame(()=>{e.scrollTop=t})};_.scrollbarSize=function(){return _.scrollBarSizeValue||(_.scrollBarSizeValue=Fs()),_.scrollBarSizeValue};function Fs(){let n=document.createElement("div");_.style(n,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(n);let e=n.offsetWidth-n.clientWidth;return document.body.removeChild(n),e}_.hasVerticalOverflow=function(n){return n.scrollHeight>n.offsetHeight+10};_.hasHorizontalOverflow=function(n){return n.scrollWidth>n.offsetWidth+10};_.measureTextWidth=function(n){let e=document.createElement("div");return e.style.position="absolute",e.style.visibility="hidden",e.style.height="auto",e.style.width="auto",e.style.whiteSpace="nowrap",e.innerText=n,document.body.appendChild(e),e.clientWidth+1};function js(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Xe=js,Ft=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function jt(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function Ps(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Ws(n,e){return e={exports:{}},n(e,e.exports),e.exports}var Bs=typeof Ft=="object"&&Ft&&Ft.Object===Object&&Ft,zs=Bs,qs=typeof self=="object"&&self&&self.Object===Object&&self,Vs=zs||qs||Function("return this")(),wt=Vs,Ys=function(){return wt.Date.now()},ki=Ys,Xs=wt.Symbol,Pt=Xs,us=Object.prototype,Us=us.hasOwnProperty,Gs=us.toString,_t=Pt?Pt.toStringTag:void 0;function Ks(n){var e=Us.call(n,_t),t=n[_t];try{n[_t]=void 0}catch(r){}var i=Gs.call(n);return e?n[_t]=t:delete n[_t],i}var Js=Ks,Qs=Object.prototype,Zs=Qs.toString;function en(n){return Zs.call(n)}var tn=en,sn="[object Null]",nn="[object Undefined]",ns=Pt?Pt.toStringTag:void 0;function rn(n){return n==null?n===void 0?nn:sn:ns&&ns in Object(n)?Js(n):tn(n)}var ps=rn;function on(n){return n!=null&&typeof n=="object"}var an=on,ln="[object Symbol]";function dn(n){return typeof n=="symbol"||an(n)&&ps(n)==ln}var cn=dn,rs=0/0,hn=/^\s+|\s+$/g,un=/^[-+]0x[0-9a-f]+$/i,pn=/^0b[01]+$/i,fn=/^0o[0-7]+$/i,_n=parseInt;function mn(n){if(typeof n=="number")return n;if(cn(n))return rs;if(Xe(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Xe(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=n.replace(hn,"");var t=pn.test(n);return t||fn.test(n)?_n(n.slice(2),t?2:8):un.test(n)?rs:+n}var os=mn,gn="Expected a function",bn=Math.max,vn=Math.min;function yn(n,e,t){var i,r,l,d,u,p,y=0,g=!1,v=!1,w=!0;if(typeof n!="function")throw new TypeError(gn);e=os(e)||0,Xe(t)&&(g=!!t.leading,v="maxWait"in t,l=v?bn(os(t.maxWait)||0,e):l,w="trailing"in t?!!t.trailing:w);function k(N){var oe=i,re=r;return i=r=void 0,y=N,d=n.apply(re,oe),d}function C(N){return y=N,u=setTimeout(A,e),g?k(N):d}function x(N){var oe=N-p,re=N-y,B=e-oe;return v?vn(B,l-re):B}function L(N){var oe=N-p,re=N-y;return p===void 0||oe>=e||oe<0||v&&re>=l}function A(){var N=ki();if(L(N))return W(N);u=setTimeout(A,x(N))}function W(N){return u=void 0,w&&i?k(N):(i=r=void 0,d)}function q(){u!==void 0&&clearTimeout(u),y=0,i=p=r=u=void 0}function M(){return u===void 0?d:W(ki())}function T(){var N=ki(),oe=L(N);if(i=arguments,r=this,p=N,oe){if(u===void 0)return C(p);if(v)return u=setTimeout(A,e),k(p)}return u===void 0&&(u=setTimeout(A,e)),d}return T.cancel=q,T.flush=M,T}var fs=yn,wn="Expected a function";function Cn(n,e,t){var i=!0,r=!0;if(typeof n!="function")throw new TypeError(wn);return Xe(t)&&(i="leading"in t?!!t.leading:i,r="trailing"in t?!!t.trailing:r),fs(n,e,{leading:i,maxWait:e,trailing:r})}var xn=Cn,Sn="[object AsyncFunction]",$n="[object Function]",kn="[object GeneratorFunction]",Tn="[object Proxy]";function En(n){if(!Xe(n))return!1;var e=ps(n);return e==$n||e==kn||e==Sn||e==Tn}var Rn=En,Dn=wt["__core-js_shared__"],Ti=Dn,as=function(){var n=/[^.]+$/.exec(Ti&&Ti.keys&&Ti.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function In(n){return!!as&&as in n}var Ln=In,An=Function.prototype,Mn=An.toString;function Nn(n){if(n!=null){try{return Mn.call(n)}catch(e){}try{return n+""}catch(e){}}return""}var On=Nn,Hn=/[\\^$.*+?()[\]{}|]/g,Fn=/^\[object .+?Constructor\]$/,jn=Function.prototype,Pn=Object.prototype,Wn=jn.toString,Bn=Pn.hasOwnProperty,zn=RegExp("^"+Wn.call(Bn).replace(Hn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function qn(n){if(!Xe(n)||Ln(n))return!1;var e=Rn(n)?zn:Fn;return e.test(On(n))}var Vn=qn;function Yn(n,e){return n==null?void 0:n[e]}var Xn=Yn;function Un(n,e){var t=Xn(n,e);return Vn(t)?t:void 0}var Fi=Un,Gn=Fi(Object,"create"),yt=Gn;function Kn(){this.__data__=yt?yt(null):{},this.size=0}var Jn=Kn;function Qn(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var Zn=Qn,er="__lodash_hash_undefined__",tr=Object.prototype,ir=tr.hasOwnProperty;function sr(n){var e=this.__data__;if(yt){var t=e[n];return t===er?void 0:t}return ir.call(e,n)?e[n]:void 0}var nr=sr,rr=Object.prototype,or=rr.hasOwnProperty;function ar(n){var e=this.__data__;return yt?e[n]!==void 0:or.call(e,n)}var lr=ar,dr="__lodash_hash_undefined__";function cr(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=yt&&e===void 0?dr:e,this}var hr=cr;function Ge(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}Ge.prototype.clear=Jn;Ge.prototype.delete=Zn;Ge.prototype.get=nr;Ge.prototype.has=lr;Ge.prototype.set=hr;var ls=Ge;function ur(){this.__data__=[],this.size=0}var pr=ur;function fr(n,e){return n===e||n!==n&&e!==e}var _r=fr;function mr(n,e){for(var t=n.length;t--;)if(_r(n[t][0],e))return t;return-1}var Bt=mr,gr=Array.prototype,br=gr.splice;function vr(n){var e=this.__data__,t=Bt(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():br.call(e,t,1),--this.size,!0}var yr=vr;function wr(n){var e=this.__data__,t=Bt(e,n);return t<0?void 0:e[t][1]}var Cr=wr;function xr(n){return Bt(this.__data__,n)>-1}var Sr=xr;function $r(n,e){var t=this.__data__,i=Bt(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}var kr=$r;function Ke(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}Ke.prototype.clear=pr;Ke.prototype.delete=yr;Ke.prototype.get=Cr;Ke.prototype.has=Sr;Ke.prototype.set=kr;var Tr=Ke,Er=Fi(wt,"Map"),Rr=Er;function Dr(){this.size=0,this.__data__={hash:new ls,map:new(Rr||Tr),string:new ls}}var Ir=Dr;function Lr(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}var Ar=Lr;function Mr(n,e){var t=n.__data__;return Ar(e)?t[typeof e=="string"?"string":"hash"]:t.map}var zt=Mr;function Nr(n){var e=zt(this,n).delete(n);return this.size-=e?1:0,e}var Or=Nr;function Hr(n){return zt(this,n).get(n)}var Fr=Hr;function jr(n){return zt(this,n).has(n)}var Pr=jr;function Wr(n,e){var t=zt(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}var Br=Wr;function Je(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}Je.prototype.clear=Ir;Je.prototype.delete=Or;Je.prototype.get=Fr;Je.prototype.has=Pr;Je.prototype.set=Br;var zr=Je,qr="__lodash_hash_undefined__";function Vr(n){return this.__data__.set(n,qr),this}var Yr=Vr;function Xr(n){return this.__data__.has(n)}var Ur=Xr;function Wt(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new zr;++e<t;)this.add(n[e])}Wt.prototype.add=Wt.prototype.push=Yr;Wt.prototype.has=Ur;var Gr=Wt;function Kr(n,e,t,i){for(var r=n.length,l=t+(i?1:-1);i?l--:++l<r;)if(e(n[l],l,n))return l;return-1}var Jr=Kr;function Qr(n){return n!==n}var Zr=Qr;function eo(n,e,t){for(var i=t-1,r=n.length;++i<r;)if(n[i]===e)return i;return-1}var to=eo;function io(n,e,t){return e===e?to(n,e,t):Jr(n,Zr,t)}var so=io;function no(n,e){var t=n==null?0:n.length;return!!t&&so(n,e,0)>-1}var ro=no;function oo(n,e,t){for(var i=-1,r=n==null?0:n.length;++i<r;)if(t(e,n[i]))return!0;return!1}var ao=oo;function lo(n,e){return n.has(e)}var co=lo,ho=Fi(wt,"Set"),Ei=ho;function uo(){}var po=uo;function fo(n){var e=-1,t=Array(n.size);return n.forEach(function(i){t[++e]=i}),t}var _s=fo,_o=1/0,mo=Ei&&1/_s(new Ei([,-0]))[1]==_o?function(n){return new Ei(n)}:po,go=mo,bo=200;function vo(n,e,t){var i=-1,r=ro,l=n.length,d=!0,u=[],p=u;if(t)d=!1,r=ao;else if(l>=bo){var y=e?null:go(n);if(y)return _s(y);d=!1,r=co,p=new Gr}else p=e?[]:u;e:for(;++i<l;){var g=n[i],v=e?e(g):g;if(g=t||g!==0?g:0,d&&v===v){for(var w=p.length;w--;)if(p[w]===v)continue e;e&&p.push(v),u.push(g)}else r(p,v,t)||(p!==u&&p.push(v),u.push(g))}return u}var yo=vo;function wo(n){return n&&n.length?yo(n):[]}var Co=wo;function ms(n){return n.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`)}function Ri(n){return Object.keys(n).map(t=>{let i=ms(t),r=n[t];return r===void 0?"":`data-${i}="${r}" `}).join("").trim()}function ds(n){var e=document.createElement("textarea");e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width="2em",e.style.height="2em",e.style.padding=0,e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",e.value=n,document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(t){console.log("Oops, unable to copy")}document.body.removeChild(e)}function xo(n){return!isNaN(n)}var gs=xn,So=fs;function gt(n,e=null){return(...t)=>new Promise(i=>{setTimeout(()=>{let l=n.apply(e,t);i(l)})})}function qt(n,e,t){let i=t.reduce((r,l)=>(r[l]={get(){return e[l]}},r),{});Object.defineProperties(n,i)}function $o(n){return n!==void 0||n!==null}function ko(n){return!$o(n)}function bt(n){return!isNaN(n)}function To(n){return Array.isArray(n)?n:[n]}function cs(n){return Co(n)}function mt(n,e){return n-e}function hs(n){return n.replace(/<[^>]*>/g,"")}function Eo(n,e){return n&&(Object.keys(e).forEach(t=>{let i=new RegExp(`{(${t})}`,"g");n=n.replace(i,e[t])}),n)}function Ro(n){if(!n)return"";let e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(n).replace(/[&<>"'`=/]/g,t=>e[t]||t)}var Di=class{constructor(e){this.options=e,this.sortRows=gt(this.sortRows,this),this.switchColumn=gt(this.switchColumn,this),this.removeColumn=gt(this.removeColumn,this),this.options.filterRows=gt(this.options.filterRows,this)}init(e,t){e||(e=this.options.data),t&&(this.options.columns=t),this.data=e,this.rowCount=0,this.columns=[],this.rows=[],this.prepareColumns(),this.validateData(this.data),this.rows=this.prepareRows(this.data),this.prepareTreeRows(),this.prepareRowView(),this.prepareNumericColumns()}get currentSort(){return this.columns.find(t=>t.sortOrder!=="none")||{colIndex:-1,sortOrder:"none"}}prepareColumns(){this.columns=[],this.validateColumns(),this.prepareDefaultColumns(),this.prepareHeader()}prepareDefaultColumns(){if(this.options.checkboxColumn&&!this.hasColumnById("_checkbox")){let e={id:"_checkbox",content:this.getCheckboxHTML(),editable:!1,resizable:!1,sortable:!1,focusable:!1,dropdown:!1,width:32};this.columns.push(e)}if(this.options.serialNoColumn&&!this.hasColumnById("_rowIndex")){let e={id:"_rowIndex",content:"",align:"center",editable:!1,resizable:!1,focusable:!1,dropdown:!1};this.columns.push(e)}}prepareHeader(){let e=this.columns.concat(this.options.columns),t={isHeader:1,editable:!0,sortable:!0,resizable:!0,focusable:!0,dropdown:!0,width:null,format:i=>i==null?"":i+""};this.columns=e.map((i,r)=>this.prepareCell(i,r)).map(i=>Object.assign({},t,i)).map(i=>(i.content=i.content||i.name||"",i.id=i.id||i.content,i))}prepareCell(e,t){let i={content:"",sortOrder:"none",colIndex:t,column:this.columns[t]};return e!==null&&typeof e=="object"?Object.assign(i,e):i.content=e,i}prepareNumericColumns(){let e=this.getRow(0);!e||(this.columns=this.columns.map((t,i)=>{let r=e[i].content;return!t.align&&xo(r)&&(t.align="right"),t}))}prepareRows(e){return e.map((t,i)=>{let r=this._getNextRowCount(),l=[],d={rowIndex:r};if(Array.isArray(t))for(this.options.checkboxColumn&&l.push(this.getCheckboxHTML()),this.options.serialNoColumn&&l.push(r+1+""),l=l.concat(t);l.length<this.columns.length;)l.push("");else{for(let u of this.columns)u.id==="_checkbox"?l.push(this.getCheckboxHTML()):u.id==="_rowIndex"?l.push(r+1+""):l.push(t[u.id]);d.indent=t.indent||0}return this.prepareRow(l,d)})}prepareTreeRows(){this.rows.forEach((e,t)=>{if(bt(e.meta.indent)){let i=this.getRow(t+1);e.meta.isLeaf=!i||ko(i.meta.indent)||i.meta.indent<=e.meta.indent,e.meta.isTreeNodeClose=!1}})}prepareRowView(){this.rowViewOrder=this.rows.map(e=>e.meta.rowIndex)}prepareRow(e,t){let i={rowIndex:t.rowIndex,indent:t.indent};return e=e.map((r,l)=>this.prepareCell(r,l)).map(r=>Object.assign({},i,r)),e.meta=t,e}validateColumns(){let e=this.options.columns;if(!Array.isArray(e))throw new vt("`columns` must be an array");e.forEach((t,i)=>{if(typeof t!="string"&&typeof t!="object")throw new vt(`column "${i}" must be a string or an object`)})}validateData(e){if(Array.isArray(e)&&(e.length===0||Array.isArray(e[0])||typeof e[0]=="object"))return!0;throw new vt("`data` must be an array of arrays or objects")}appendRows(e){this.validateData(e),this.rows=this.rows.concat(this.prepareRows(e)),this.prepareTreeRows(),this.prepareRowView()}sortRows(e,t="none"){e=+e,this.getColumns().map(i=>{i.colIndex===e?i.sortOrder=t:i.sortOrder="none"}),this._sortRows(e,t)}_sortRows(e,t){if(this.currentSort.colIndex===e&&(this.currentSort.sortOrder==="asc"&&t==="desc"||this.currentSort.sortOrder==="desc"&&t==="asc")){this.reverseArray(this.rowViewOrder),this.currentSort.sortOrder=t;return}if(this.rowViewOrder.sort((i,r)=>{let l=i,d=r,u=this.getCell(e,i).content,p=this.getCell(e,r).content;if(u=u==null?"":u,p=p==null?"":p,t==="none")return l-d;if(t==="asc"){if(u<p)return-1;if(u>p)return 1;if(u===p)return 0}else if(t==="desc"){if(u<p)return 1;if(u>p)return-1;if(u===p)return 0}return 0}),this.hasColumnById("_rowIndex")){let i=this.getColumnIndexById("_rowIndex");this.rows.forEach((r,l)=>{let d=this.rowViewOrder.indexOf(l),u=r[i];u.content=d+1+""})}}reverseArray(e){let t=null,i=null,r=e.length;for(t=0,i=r-1;t<i;t+=1,i-=1){let l=e[t];e[t]=e[i],e[i]=l}}switchColumn(e,t){let i=this.columns[e];this.columns[e]=this.columns[t],this.columns[t]=i,this.columns[e].colIndex=e,this.columns[t].colIndex=t,this.rows.forEach(r=>{let l=Object.assign({},r[e],{colIndex:t}),d=Object.assign({},r[t],{colIndex:e});r[t]=l,r[e]=d})}removeColumn(e){e=+e;let t=r=>r.colIndex!==e,i=(r,l)=>Object.assign({},r,{colIndex:l});this.columns=this.columns.filter(t).map(i),this.rows.forEach(r=>{r.splice(e,1),r.forEach((l,d)=>{l.colIndex=d})})}updateRow(e,t){e.length<this.columns.length&&(this.hasColumnById("_rowIndex")&&(e=[t+1+""].concat(e)),this.hasColumnById("_checkbox")&&(e=['<input type="checkbox" />'].concat(e)));let i=this.prepareRow(e,{rowIndex:t}),r=this.rows.findIndex(l=>l[0].rowIndex===t);return this.rows[r]=i,i}updateCell(e,t,i){let r;typeof e=="object"&&(r=e,e=r.colIndex,t=r.rowIndex,i=r),r=this.getCell(e,t);for(let l in i){let d=i[l];d!==void 0&&(r[l]=d)}return r}updateColumn(e,t){let i=this.getColumn(e);for(let r in t){let l=t[r];l!==void 0&&(i[r]=l)}return i}filterRows(e){return this.options.filterRows(this.rows,e,this).then(t=>(t||(t=this.getAllRowIndices()),t.then||(t=Promise.resolve(t)),t.then(i=>(this._filteredRows=i,{rowsToHide:this.getAllRowIndices().filter(l=>!i.includes(l)),rowsToShow:i}))))}getFilteredRowIndices(){return this._filteredRows||this.getAllRowIndices()}getAllRowIndices(){return this.rows.map(e=>e.meta.rowIndex)}getRowCount(){return this.rowCount}_getNextRowCount(){let e=this.rowCount;return this.rowCount++,e}getRows(e,t){return this.rows.slice(e,t)}getRowsForView(e,t){return this.rowViewOrder.map(r=>this.rows[r]).slice(e,t)}getColumns(e){let t=this.columns;return e&&(t=t.slice(this.getStandardColumnCount())),t}getStandardColumnCount(){return this.options.checkboxColumn&&this.options.serialNoColumn?2:this.options.checkboxColumn||this.options.serialNoColumn?1:0}getColumnCount(e){let t=this.columns.length;return e&&(t=t-this.getStandardColumnCount()),t}getColumn(e){return e=+e,e<0&&(e=this.columns.length+e),this.columns.find(t=>t.colIndex===e)}getColumnById(e){return this.columns.find(t=>t.id===e)}getRow(e){return e=+e,this.rows[e]}getCell(e,t){return t=+t,e=+e,this.getRow(t)[e]}getChildren(e){e=+e;let t=this.getRow(e).meta.indent,i=[];for(let r=e+1;r<this.rowCount;r++){let l=this.getRow(r);if(!isNaN(l.meta.indent)&&(l.meta.indent>t&&i.push(r),l.meta.indent===t))break}return i}getImmediateChildren(e){e=+e;let t=this.getRow(e).meta.indent,i=[],r=t+1;for(let l=e+1;l<this.rowCount;l++){let d=this.getRow(l);if(!(isNaN(d.meta.indent)||d.meta.indent>r)&&(d.meta.indent===r&&i.push(l),d.meta.indent===t))break}return i}get(){return{columns:this.columns,rows:this.rows}}getData(e){return this.data[e]}hasColumn(e){return Boolean(this.columns.find(t=>t.content===e))}hasColumnById(e){return Boolean(this.columns.find(t=>t.id===e))}getColumnIndex(e){return this.columns.findIndex(t=>t.content===e)}getColumnIndexById(e){return this.columns.findIndex(t=>t.id===e)}getCheckboxHTML(){return'<input type="checkbox" />'}},vt=class extends TypeError{},Ii={chevronDown:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>'},Ue=class{constructor(e){this.instance=e,qt(this,this.instance,["wrapper","options","style","header","bodyScrollable","columnmanager","rowmanager","datamanager","keyboard"]),this.bindEvents()}bindEvents(){this.bindFocusCell(),this.bindEditCell(),this.bindKeyboardSelection(),this.bindCopyCellContents(),this.bindMouseEvents(),this.bindTreeEvents()}bindFocusCell(){this.bindKeyboardNav()}bindEditCell(){this.$editingCell=null,_.on(this.bodyScrollable,"dblclick",".dt-cell",(e,t)=>{this.activateEditing(t)}),this.keyboard.on("enter",()=>{this.$focusedCell&&!this.$editingCell?this.activateEditing(this.$focusedCell):this.$editingCell&&this.deactivateEditing()})}bindKeyboardNav(){let e=t=>{if(!this.$focusedCell||this.$editingCell)return!1;let i=this.$focusedCell,{rowIndex:r,colIndex:l}=_.data(i);return t==="left"?i=this.getLeftMostCell$(r):t==="right"?i=this.getRightMostCell$(r):t==="up"?i=this.getTopMostCell$(l):t==="down"&&(i=this.getBottomMostCell$(l)),this.focusCell(i),!0};["left","right","up","down","tab","shift+tab"].map(t=>this.keyboard.on(t,()=>this.focusCellInDirection(t))),["left","right","up","down"].map(t=>this.keyboard.on(`ctrl+${t}`,()=>e(t))),this.keyboard.on("esc",()=>{this.deactivateEditing(!1),this.columnmanager.toggleFilter(!1)}),this.options.inlineFilters&&(this.keyboard.on("ctrl+f",t=>{let i=_.closest(".dt-cell",t.target),{colIndex:r}=_.data(i);return this.activateFilter(r),!0}),_.on(this.header,"focusin",".dt-filter",()=>{this.unfocusCell(this.$focusedCell)}))}bindKeyboardSelection(){let e=t=>{let i=this.getSelectionCursor();return t==="left"?i=this.getLeftCell$(i):t==="right"?i=this.getRightCell$(i):t==="up"?i=this.getAboveCell$(i):t==="down"&&(i=this.getBelowCell$(i)),i};["left","right","up","down"].map(t=>this.keyboard.on(`shift+${t}`,()=>this.selectArea(e(t))))}bindCopyCellContents(){this.keyboard.on("ctrl+c",()=>{let e=this.copyCellContents(this.$focusedCell,this.$selectionCursor),t=this.instance.translate("{count} cells copied",{count:e});e&&this.instance.showToastMessage(t,2)}),this.options.pasteFromClipboard&&this.keyboard.on("ctrl+v",e=>(this.instance.pasteTarget.focus(),setTimeout(()=>{let t=this.instance.pasteTarget.value;this.instance.pasteTarget.value="",this.pasteContentInCell(t)},10),!1))}bindMouseEvents(){let e=null;_.on(this.bodyScrollable,"mousedown",".dt-cell",i=>{e=!0,this.focusCell(_(i.delegatedTarget))}),_.on(this.bodyScrollable,"mouseup",()=>{e=!1});let t=i=>{!e||this.selectArea(_(i.delegatedTarget))};_.on(this.bodyScrollable,"mousemove",".dt-cell",gs(t,50))}bindTreeEvents(){_.on(this.bodyScrollable,"click",".dt-tree-node__toggle",(e,t)=>{let i=_.closest(".dt-cell",t),{rowIndex:r}=_.data(i);i.classList.contains("dt-cell--tree-close")?this.rowmanager.openSingleNode(r):this.rowmanager.closeSingleNode(r)})}focusCell(e,{skipClearSelection:t=0,skipDOMFocus:i=0,skipScrollToCell:r=0}={}){if(!e||e===this.$editingCell)return;let{colIndex:l,isHeader:d}=_.data(e);d||this.columnmanager.getColumn(l).focusable===!1||(r||this.scrollToCell(e),this.deactivateEditing(),t||this.clearSelection(),this.$focusedCell&&this.$focusedCell.classList.remove("dt-cell--focus"),this.$focusedCell=e,e.classList.add("dt-cell--focus"),i||e.focus(),this.highlightRowColumnHeader(e))}unfocusCell(e){!e||(e.classList.remove("dt-cell--focus"),this.$focusedCell=null,this.lastHeaders&&this.lastHeaders.forEach(t=>t&&t.classList.remove("dt-cell--highlight")))}highlightRowColumnHeader(e){let{colIndex:t,rowIndex:i}=_.data(e),r=this.datamanager.getColumnIndexById("_rowIndex"),l=`.dt-cell--header-${t}`,d=`.dt-cell--${r}-${i}`;this.lastHeaders&&this.lastHeaders.forEach(y=>y&&y.classList.remove("dt-cell--highlight"));let u=_(l,this.wrapper),p=_(d,this.wrapper);this.lastHeaders=[u,p],this.lastHeaders.forEach(y=>y&&y.classList.add("dt-cell--highlight"))}selectAreaOnClusterChanged(){if(!(this.$focusedCell&&this.$selectionCursor))return;let{colIndex:e,rowIndex:t}=_.data(this.$selectionCursor),i=this.getCell$(e,t);if(!i||i===this.$selectionCursor)return;let r=_.data(this.$focusedCell);this.$focusedCell=this.getCell$(r.colIndex,r.rowIndex),this.selectArea(i)}focusCellOnClusterChanged(){if(!this.$focusedCell)return;let{colIndex:e,rowIndex:t}=_.data(this.$focusedCell),i=this.getCell$(e,t);!i||this.focusCell(i,{skipClearSelection:1,skipDOMFocus:1,skipScrollToCell:1})}selectArea(e){!this.$focusedCell||this._selectArea(this.$focusedCell,e)&&(this.$selectionCursor=e)}_selectArea(e,t){if(e===t)return!1;let i=this.getCellsInRange(e,t);return i?(this.clearSelection(),this._selectedCells=i.map(r=>this.getCell$(...r)),requestAnimationFrame(()=>{this._selectedCells.map(r=>r.classList.add("dt-cell--highlight"))}),!0):!1}getCellsInRange(e,t){let i,r,l,d;if(typeof e=="number")[i,r,l,d]=arguments;else if(typeof e=="object"){if(!(e&&t))return!1;let v=_.data(e),w=_.data(t);i=+v.colIndex,r=+v.rowIndex,l=+w.colIndex,d=+w.rowIndex}if(r>d&&([r,d]=[d,r]),i>l&&([i,l]=[l,i]),this.isStandardCell(i)||this.isStandardCell(l))return!1;let u=[],p=i,y=r,g=[];for(;y<=d;)g.push(y),y+=1;return g.map(v=>{for(;p<=l;)u.push([p,v]),p++;p=i}),u}clearSelection(){(this._selectedCells||[]).forEach(e=>e.classList.remove("dt-cell--highlight")),this._selectedCells=[],this.$selectionCursor=null}getSelectionCursor(){return this.$selectionCursor||this.$focusedCell}activateEditing(e){this.focusCell(e);let{rowIndex:t,colIndex:i}=_.data(e),r=this.columnmanager.getColumn(i);if(r&&(r.editable===!1||r.focusable===!1))return;let l=this.getCell(i,t);if(l&&l.editable===!1)return;if(this.$editingCell){let{_rowIndex:p,_colIndex:y}=_.data(this.$editingCell);if(t===p&&i===y)return}this.$editingCell=e,e.classList.add("dt-cell--editing");let d=_(".dt-cell__edit",e);d.innerHTML="";let u=this.getEditor(i,t,l.content,d);u&&(this.currentCellEditor=u,u.initValue(l.content,t,r))}deactivateEditing(e=!0){e&&this.submitEditing(),this.$focusedCell&&this.$focusedCell.focus(),this.$editingCell&&(this.$editingCell.classList.remove("dt-cell--editing"),this.$editingCell=null)}getEditor(e,t,i,r){let l=this.datamanager.getColumn(e),d=this.datamanager.getRow(t),u=this.datamanager.getData(t),p=this.options.getEditor?this.options.getEditor(e,t,i,r,l,d,u):this.getDefaultEditor(r);return p===!1?!1:(p===void 0&&(p=this.getDefaultEditor(r)),p)}getDefaultEditor(e){let t=_.create("input",{class:"dt-input",type:"text",inside:e});return{initValue(i){t.focus(),t.value=i},getValue(){return t.value},setValue(i){t.value=i}}}submitEditing(){let e=Promise.resolve();if(!this.$editingCell)return e;let t=this.$editingCell,{rowIndex:i,colIndex:r}=_.data(t),l=this.datamanager.getColumn(r);if(t){let d=this.currentCellEditor;if(d){let u=d.getValue();u.then||(u=Promise.resolve(u)),e=u.then(p=>{let y=this.getCell(r,i).content;if(y===p)return!1;let g=d.setValue(p,i,l);return this.updateCell(r,i,p,!0),t.focus(),g&&g.then&&g.catch(v=>{console.log(v),this.updateCell(r,i,y)}),g})}}return this.currentCellEditor=null,e}copyCellContents(e,t){if(!t&&e){let{colIndex:d,rowIndex:u}=_.data(e),p=this.getCell(d,u);return ds(p.content),1}let i=this.getCellsInRange(e,t);if(!i)return 0;let r=i.map(d=>this.getCell(...d)).reduce((d,u)=>{let p=u.rowIndex;return d[p]=d[p]||[],d[p].push(u.content),d},[]),l=r.map(d=>d.join("	")).join(`
`);return ds(l),r.reduce((d,u)=>d+u.length,0)}pasteContentInCell(e){if(!this.$focusedCell)return;let t=e.split(`
`).map(d=>d.split("	")).filter(d=>d.length&&d.every(u=>u)),{colIndex:i,rowIndex:r}=_.data(this.$focusedCell),l={colIndex:+i,rowIndex:+r};t.forEach((d,u)=>{let p=u+l.rowIndex;d.forEach((y,g)=>{let v=g+l.colIndex;this.updateCell(v,p,y,!0)})})}activateFilter(e){this.columnmanager.toggleFilter(),this.columnmanager.focusFilter(e),this.columnmanager.isFilterShown||this.$focusedCell&&this.$focusedCell.focus()}updateCell(e,t,i,r=!1){let l=this.datamanager.updateCell(e,t,{content:i});this.refreshCell(l,r)}refreshCell(e,t=!1){let i=_(this.selector(e.colIndex,e.rowIndex),this.bodyScrollable);i.innerHTML=this.getCellContent(e,t)}toggleTreeButton(e,t){let i=this.columnmanager.getFirstColumnIndex(),r=this.getCell$(i,e);r&&r.classList[t?"remove":"add"]("dt-cell--tree-close")}isStandardCell(e){return e<this.columnmanager.getFirstColumnIndex()}focusCellInDirection(e){if(!this.$focusedCell||this.$editingCell&&["left","right","up","down"].includes(e))return!1;this.$editingCell&&["tab","shift+tab"].includes(e)&&this.deactivateEditing();let t=this.$focusedCell;if(e==="left"||e==="shift+tab"?t=this.getLeftCell$(t):e==="right"||e==="tab"?t=this.getRightCell$(t):e==="up"?t=this.getAboveCell$(t):e==="down"&&(t=this.getBelowCell$(t)),!t)return!1;let{colIndex:i}=_.data(t);if(!this.columnmanager.getColumn(i).focusable){let l=this.$focusedCell;this.unfocusCell(l),this.$focusedCell=t;let d=this.focusCellInDirection(e);return d||this.focusCell(l),d}return this.focusCell(t),!0}getCell$(e,t){return _(this.selector(e,t),this.bodyScrollable)}getAboveCell$(e){let{colIndex:t}=_.data(e),i=e.parentElement.previousElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.previousElementSibling;return i?_(`.dt-cell--col-${t}`,i):e}getBelowCell$(e){let{colIndex:t}=_.data(e),i=e.parentElement.nextElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.nextElementSibling;return i?_(`.dt-cell--col-${t}`,i):e}getLeftCell$(e){return e.previousElementSibling}getRightCell$(e){return e.nextElementSibling}getLeftMostCell$(e){return this.getCell$(this.columnmanager.getFirstColumnIndex(),e)}getRightMostCell$(e){return this.getCell$(this.columnmanager.getLastColumnIndex(),e)}getTopMostCell$(e){return this.getCell$(e,this.rowmanager.getFirstRowIndex())}getBottomMostCell$(e){return this.getCell$(e,this.rowmanager.getLastRowIndex())}getCell(e,t){return this.instance.datamanager.getCell(e,t)}getRowHeight(){return _.style(_(".dt-row",this.bodyScrollable),"height")}scrollToCell(e){if(_.inViewport(e,this.bodyScrollable))return!1;let{rowIndex:t}=_.data(e);return this.rowmanager.scrollToRow(t),!1}getRowCountPerPage(){return Math.ceil(this.instance.getViewportHeight()/this.getRowHeight())}getCellHTML(e){let{rowIndex:t,colIndex:i,isHeader:r,isFilter:l,isTotalRow:d}=e,u=Ri({rowIndex:t,colIndex:i,isHeader:r,isFilter:l,isTotalRow:d}),p=this.datamanager.getRow(t),y=!(r||l||d);return`
            <div class="${["dt-cell","dt-cell--col-"+i,y?`dt-cell--${i}-${t}`:"",y?"dt-cell--row-"+t:"",r?"dt-cell--header":"",r?`dt-cell--header-${i}`:"",l?"dt-cell--filter":"",y&&p&&p.meta.isTreeNodeClose?"dt-cell--tree-close":""].join(" ")}" ${u} tabindex="0">
                ${this.getCellContent(e)}
            </div>
        `}getCellContent(e,t=!1){let{isHeader:i,isFilter:r,colIndex:l}=e,u=!i&&e.editable!==!1?this.getEditCellHTML(l):"",y=i&&e.sortable!==!1?`<span class="sort-indicator">
                ${this.options.sortIndicator[e.sortOrder]}
            </span>`:"",v=i&&e.resizable!==!1?'<span class="dt-cell__resize-handle"></span>':"",k=i&&e.dropdown!==!1?this.columnmanager.getDropdownHTML():"",C=Ue.getCustomCellFormatter(e),x;if(i||r||!C)x=e.content;else if(!e.html||t){let M=this.datamanager.getRow(e.rowIndex),T=this.datamanager.getData(e.rowIndex);x=C(e.content,M,e.column,T)}else x=e.html;if(e.html=x,this.options.treeView&&!(i||r)&&e.indent!==void 0){let M=this.datamanager.getRow(e.rowIndex+1),T=M&&M.meta.indent>e.indent,N=20,oe="px";if(this.datamanager.getColumnIndexById("_rowIndex")+1===e.colIndex){let B=(e.indent||0)*N,Ne=T?`<span class="dt-tree-node__toggle" style="left: ${B-N}${oe}">
                        <span class="icon-open">${Ii.chevronDown}</span>
                        <span class="icon-close">${Ii.chevronRight}</span>
                    </span>`:"";x=`<span class="dt-tree-node" style="padding-left: ${B}${oe}">
                    ${Ne}
                    <span>${x}</span>
                </span>`}}let A=`
            <div class="${["dt-cell__content",i?`dt-cell__content--header-${l}`:`dt-cell__content--col-${l}`].join(" ")}">
                ${x}
                ${y}
                ${v}
                ${k}
            </div>
            ${u}
        `,W=document.createElement("div");W.innerHTML=x;let q=W.textContent;return q=q.replace(/\s+/g," ").trim(),A=A.replace(">",` title="${Ro(q)}">`),A}getEditCellHTML(e){return`<div class="dt-cell__edit dt-cell__edit--col-${e}"></div>`}selector(e,t){return`.dt-cell--${e}-${t}`}static getCustomCellFormatter(e){return e.format||e.column&&e.column.format||null}},Li=class{constructor(e){this.instance=e,qt(this,this.instance,["options","fireEvent","header","datamanager","cellmanager","style","wrapper","rowmanager","bodyScrollable","bodyRenderer"]),this.bindEvents()}renderHeader(){this.header.innerHTML="<div></div>",this.refreshHeader()}refreshHeader(){let e=this.datamanager.getColumns();_("div",this.header).innerHTML=this.getHeaderHTML(e),this.$filterRow=_(".dt-row-filter",this.header),this.$filterRow&&_.style(this.$filterRow,{display:"none"}),this.$columnMap=[],this.bindMoveColumn()}getHeaderHTML(e){let t=this.rowmanager.getRowHTML(e,{isHeader:1});return this.options.inlineFilters&&(t+=this.rowmanager.getRowHTML(e,{isFilter:1})),t}bindEvents(){this.bindDropdown(),this.bindResizeColumn(),this.bindPerfectColumnWidth(),this.bindFilter()}bindDropdown(){let e=".dt-dropdown__toggle",t=".dt-dropdown__list";this.instance.dropdownContainer.innerHTML=this.getDropdownListHTML(),this.$dropdownList=this.instance.dropdownContainer.firstElementChild,_.on(this.header,"click",e,d=>{this.openDropdown(d)});let i=d=>{let u=[e,e+" *",t,t+" *"].join(",");d.target.matches(u)||l()};_.on(document.body,"click",i),document.addEventListener("scroll",l,!0),this.instance.on("onDestroy",()=>{_.off(document.body,"click",i),_.off(document,"scroll",l)}),_.on(this.$dropdownList,"click",".dt-dropdown__list-item",(d,u)=>{if(!this._dropdownActiveColIndex)return;let p=this.options.headerDropdown,{index:y}=_.data(u),g=this._dropdownActiveColIndex,v=p[y].action;v&&v.call(this.instance,this.getColumn(g)),this.hideDropdown()});let r=this;function l(d){r.hideDropdown()}this.hideDropdown()}openDropdown(e){this._dropdownWidth||(_.style(this.$dropdownList,{display:""}),this._dropdownWidth=_.style(this.$dropdownList,"width")),_.style(this.$dropdownList,{display:"",left:e.clientX-this._dropdownWidth+4+"px",top:e.clientY+4+"px"});let t=_.closest(".dt-cell",e.target),{colIndex:i}=_.data(t);this._dropdownActiveColIndex=i}hideDropdown(){_.style(this.$dropdownList,{display:"none"}),this._dropdownActiveColIndex=null}bindResizeColumn(){let e=!1,t,i,r;_.on(this.header,"mousedown",".dt-cell .dt-cell__resize-handle",(u,p)=>{document.body.classList.add("dt-resize"),t=p.parentNode.parentNode;let{colIndex:g}=_.data(t),v=this.getColumn(g);v&&v.resizable===!1||(e=!0,i=_.style(_(".dt-cell__content",t),"width"),r=u.pageX)});let l=u=>{if(document.body.classList.remove("dt-resize"),!t)return;e=!1;let{colIndex:p}=_.data(t);this.setColumnWidth(p),this.style.setBodyStyle(),t=null};_.on(document.body,"mouseup",l),this.instance.on("onDestroy",()=>{_.off(document.body,"mouseup",l)});let d=u=>{if(!e)return;let p=u.pageX-r;this.options.direction==="rtl"&&(p=-1*p);let y=i+p,{colIndex:g}=_.data(t);this.options.minimumColumnWidth>y||(this.datamanager.updateColumn(g,{width:y}),this.setColumnHeaderWidth(g))};_.on(document.body,"mousemove",d),this.instance.on("onDestroy",()=>{_.off(document.body,"mousemove",d)})}bindPerfectColumnWidth(){_.on(this.header,"dblclick",".dt-cell .dt-cell__resize-handle",(e,t)=>{let i=t.parentNode.parentNode,{colIndex:r}=_.data(i),l=this.bodyRenderer.visibleRows.map(x=>x[r]).reduce((x,L)=>x.content.length>L.content.length?x:L),d=this.cellmanager.getCellHTML(l),u=document.createElement("div");u.innerHTML=d;let p=u.querySelector(".dt-cell__content").textContent,{borderLeftWidth:y,borderRightWidth:g,paddingLeft:v,paddingRight:w}=_.getStyle(this.bodyScrollable.querySelector(".dt-cell__content")),k=[y,g,v,w].map(parseFloat).reduce((x,L)=>x+L),C=_.measureTextWidth(p)+k;this.datamanager.updateColumn(r,{width:C}),this.setColumnHeaderWidth(r),this.setColumnWidth(r)})}bindMoveColumn(){if(this.options.disableReorderColumn)return;let e=_(".dt-row",this.header);this.sortable=Hs.create(e,{onEnd:t=>{let{oldIndex:i,newIndex:r}=t,l=t.item,{colIndex:d}=_.data(l);+d!==r&&this.switchColumn(i,r)},preventOnFilter:!1,filter:".dt-cell__resize-handle, .dt-dropdown",chosenClass:"dt-cell--dragging",animation:150})}sortColumn(e,t){this.instance.freeze(),this.sortRows(e,t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onSortColumn",this.getColumn(e))})}removeColumn(e){let t=this.getColumn(e);this.instance.freeze(),this.datamanager.removeColumn(e).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onRemoveColumn",t)})}switchColumn(e,t){this.instance.freeze(),this.datamanager.switchColumn(e,t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>{this.setColumnWidth(e),this.setColumnWidth(t),this.instance.unfreeze()}).then(()=>{this.fireEvent("onSwitchColumn",this.getColumn(e),this.getColumn(t))})}toggleFilter(e){if(!this.options.inlineFilters)return;let t;e===void 0?t=!this.isFilterShown:t=e,t?_.style(this.$filterRow,{display:""}):_.style(this.$filterRow,{display:"none"}),this.isFilterShown=t,this.style.setBodyStyle()}focusFilter(e){if(!this.isFilterShown)return;_(`.dt-cell--col-${e} .dt-filter`,this.$filterRow).focus()}bindFilter(){if(!this.options.inlineFilters)return;let e=t=>{this.applyFilter(this.getAppliedFilters())};_.on(this.header,"keydown",".dt-filter",So(e,300))}applyFilter(e){this.datamanager.filterRows(e).then(({rowsToShow:t})=>{this.rowmanager.showRows(t)})}getAppliedFilters(){let e={};return _.each(".dt-filter",this.header).map(t=>{let i=t.value;i&&(e[t.dataset.colIndex]=i)}),e}applyDefaultSortOrder(){let e=this.getColumns().filter(t=>t.sortOrder!=="none");if(e.length===1){let t=e[0];this.sortColumn(t.colIndex,t.sortOrder)}}sortRows(e,t){return this.datamanager.sortRows(e,t)}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}setColumnWidth(e,t){e=+e;let i=t||this.getColumn(e).width,r=[`.dt-cell__content--col-${e}`,`.dt-cell__edit--col-${e}`].join(", "),l={width:i+"px"};this.style.setStyle(r,l)}setColumnHeaderWidth(e){e=+e,this.$columnMap=this.$columnMap||[];let t=`.dt-cell__content--header-${e}`,{width:i}=this.getColumn(e),r=this.$columnMap[e];r||(r=this.header.querySelector(t),this.$columnMap[e]=r),r.style.width=i+"px"}getColumnMinWidth(e){return e=+e,this.getColumn(e).minWidth||24}getFirstColumnIndex(){return this.datamanager.getColumnIndexById("_rowIndex")+1}getHeaderCell$(e){return _(`.dt-cell--header-${e}`,this.header)}getLastColumnIndex(){return this.datamanager.getColumnCount()-1}getDropdownHTML(){let{dropdownButton:e}=this.options;return`
            <div class="dt-dropdown">
                <div class="dt-dropdown__toggle">${e}</div>
            </div>
      `}getDropdownListHTML(){let{headerDropdown:e}=this.options;return`
            <div class="dt-dropdown__list">
            ${e.map((t,i)=>`
                <div class="dt-dropdown__list-item" data-index="${i}">${t.label}</div>
            `).join("")}
            </div>
        `}},Ai=class{constructor(e){this.instance=e,qt(this,this.instance,["options","fireEvent","wrapper","bodyScrollable","bodyRenderer","style"]),this.bindEvents(),this.refreshRows=gt(this.refreshRows,this)}get datamanager(){return this.instance.datamanager}get cellmanager(){return this.instance.cellmanager}bindEvents(){this.bindCheckbox()}bindCheckbox(){!this.options.checkboxColumn||(this.checkMap=[],_.on(this.wrapper,"click",'.dt-cell--col-0 [type="checkbox"]',(e,t)=>{let i=t.closest(".dt-cell"),{rowIndex:r,isHeader:l}=_.data(i),d=t.checked;l?this.checkAll(d):this.checkRow(r,d)}))}refreshRows(){this.instance.renderBody(),this.instance.setDimensions()}refreshRow(e,t){this.datamanager.updateRow(e,t).forEach(r=>{this.cellmanager.refreshCell(r,!0)})}getCheckedRows(){if(!this.checkMap)return[];let e=[];for(let t in this.checkMap)this.checkMap[t]===1&&e.push(t);return e}highlightCheckedRows(){this.getCheckedRows().map(e=>this.checkRow(e,!0))}checkRow(e,t){let i=t?1:0,r=l=>`.dt-cell--0-${l} [type="checkbox"]`;this.checkMap[e]=i,_.each(r(e),this.bodyScrollable).map(l=>{l.checked=t}),this.highlightRow(e,t),this.showCheckStatus(),this.fireEvent("onCheckRow",this.datamanager.getRow(e))}checkAll(e){let t=e?1:0;e?this.datamanager._filteredRows?this.datamanager._filteredRows.forEach(i=>{this.checkRow(i,e)}):this.checkMap=Array.from(Array(this.getTotalRows())).map(i=>t):this.checkMap=[],_.each('.dt-cell--col-0 [type="checkbox"]',this.bodyScrollable).map(i=>{i.checked=e}),this.highlightAll(e),this.showCheckStatus(),this.fireEvent("onCheckRow")}showCheckStatus(){if(!this.options.checkedRowStatus)return;let t=this.getCheckedRows().length;if(t>0){let i=this.instance.translate("{count} rows selected",{count:t});this.bodyRenderer.showToastMessage(i)}else this.bodyRenderer.clearToastMessage()}highlightRow(e,t=!0){let i=this.getRow$(e);if(!!i){if(!t&&this.bodyScrollable.classList.contains("dt-scrollable--highlight-all")){i.classList.add("dt-row--unhighlight");return}t&&i.classList.contains("dt-row--unhighlight")&&i.classList.remove("dt-row--unhighlight"),this._highlightedRows=this._highlightedRows||{},t?(i.classList.add("dt-row--highlight"),this._highlightedRows[e]=i):(i.classList.remove("dt-row--highlight"),delete this._highlightedRows[e])}}highlightAll(e=!0){if(e)this.bodyScrollable.classList.add("dt-scrollable--highlight-all");else{this.bodyScrollable.classList.remove("dt-scrollable--highlight-all");for(let t in this._highlightedRows)this._highlightedRows[t].classList.remove("dt-row--highlight");this._highlightedRows={}}}showRows(e){e=To(e);let t=e.map(i=>this.datamanager.getRow(i));this.bodyRenderer.renderRows(t)}showAllRows(){let e=this.datamanager.getAllRowIndices();this.showRows(e)}getChildrenToShowForNode(e){let t=this.datamanager.getRow(e);return t.meta.isTreeNodeClose=!1,this.datamanager.getImmediateChildren(e)}openSingleNode(e){let t=this.getChildrenToShowForNode(e),i=this.bodyRenderer.visibleRowIndices,r=cs([...t,...i]).sort(mt);this.showRows(r)}getChildrenToHideForNode(e){let t=this.datamanager.getRow(e);t.meta.isTreeNodeClose=!0;let i=this.datamanager.getChildren(e);return i.forEach(r=>{let l=this.datamanager.getRow(r);l.meta.isLeaf||(l.meta.isTreeNodeClose=!0)}),i}closeSingleNode(e){let t=this.getChildrenToHideForNode(e),r=this.bodyRenderer.visibleRowIndices.filter(l=>!t.includes(l)).sort(mt);this.showRows(r)}expandAllNodes(){let i=this.datamanager.getRows().filter(d=>!d.meta.isLeaf).map(d=>this.getChildrenToShowForNode(d.meta.rowIndex)).flat(),r=this.bodyRenderer.visibleRowIndices,l=cs([...i,...r]).sort(mt);this.showRows(l)}collapseAllNodes(){let i=this.datamanager.getRows().filter(d=>d.meta.indent===0).map(d=>this.getChildrenToHideForNode(d.meta.rowIndex)).flat(),l=this.bodyRenderer.visibleRowIndices.filter(d=>!i.includes(d)).sort(mt);this.showRows(l)}setTreeDepth(e){let t=this.datamanager.getRows(),i=t.filter(u=>u.meta.indent<e),r=t.filter(u=>u.meta.indent>=e),l=r.filter(u=>u.meta.indent>e);r.forEach(u=>{u.meta.isLeaf||(u.meta.isTreeNodeClose=!0)}),i.forEach(u=>{u.meta.isLeaf||(u.meta.isTreeNodeClose=!1)});let d=t.filter(u=>!l.includes(u)).map(u=>u.meta.rowIndex).sort(mt);this.showRows(d)}getRow$(e){return _(this.selector(e),this.bodyScrollable)}getTotalRows(){return this.datamanager.getRowCount()}getFirstRowIndex(){return 0}getLastRowIndex(){return this.datamanager.getRowCount()-1}scrollToRow(e){e=+e,this._lastScrollTo=this._lastScrollTo||0;let t=this.getRow$(e);if(_.inViewport(t,this.bodyScrollable))return;let{height:i}=t.getBoundingClientRect(),{top:r,bottom:l}=this.bodyScrollable.getBoundingClientRect(),d=Math.floor((l-r)/i),u=0;e>this._lastScrollTo?u=i*(e+1-d):u=i*(e+1-1),this._lastScrollTo=e,_.scrollTop(this.bodyScrollable,u)}getRowHTML(e,t){let i=Ri(t),r=t.rowIndex;return t.isFilter&&(e=e.map(l=>Object.assign({},l,{content:this.getFilterInput({colIndex:l.colIndex,name:l.name}),isFilter:1,isHeader:void 0,editable:!1})),r="filter"),t.isHeader&&(r="header"),`
            <div class="dt-row dt-row-${r}" ${i}>
                ${e.map(l=>this.cellmanager.getCellHTML(l)).join("")}
            </div>
        `}getFilterInput(e){let t=`title="Filter based on ${e.name||"Index"}"`;return`<input class="dt-filter dt-input" type="text" ${Ri(e)} tabindex="1"
            ${e.colIndex===0?"disabled":t} />`}selector(e){return`.dt-row-${e}`}},Do=Ws(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,r,l){function d(y,g){if(!r[y]){if(!i[y]){var v=typeof jt=="function"&&jt;if(!g&&v)return v(y,!0);if(u)return u(y,!0);var w=new Error("Cannot find module '"+y+"'");throw w.code="MODULE_NOT_FOUND",w}var k=r[y]={exports:{}};i[y][0].call(k.exports,function(C){var x=i[y][1][C];return d(x||C)},k,k.exports,t,i,r,l)}return r[y].exports}for(var u=typeof jt=="function"&&jt,p=0;p<l.length;p++)d(l[p]);return d}({1:[function(t,i,r){Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function g(v,w){for(var k=0;k<w.length;k++){var C=w[k];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(v,C.key,C)}}return function(v,w,k){return w&&g(v.prototype,w),k&&g(v,k),v}}();function d(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}var u={width:"100%",height:"100%"},p=function(v){return Number(v)===Number(v)},y=function(){l(g,null,[{key:"create",value:function(w,k){return new g(w,k)}},{key:"mergeStyle",value:function(w,k){for(var C in k)w.style[C]!==k[C]&&(w.style[C]=k[C])}},{key:"getMaxBrowserHeight",value:function(){var w=document.createElement("div"),k=document.createElement("div");g.mergeStyle(w,{position:"absolute",height:"1px",opacity:0}),g.mergeStyle(k,{height:"1e7px"}),w.appendChild(k),document.body.appendChild(w);var C=k.offsetHeight;return document.body.removeChild(w),C}}]);function g(v,w){var k=this;d(this,g),this._config={},this._lastRepaint=null,this._maxElementHeight=g.getMaxBrowserHeight(),this.refresh(v,w);var C=this._config,x=function L(){var A=k._getScrollPosition(),W=k._lastRepaint;if(k._renderAnimationFrame=window.requestAnimationFrame(L),A!==W&&(!W||Math.abs(A-W)>k._averageHeight)){var q=k._renderChunk();k._lastRepaint=A,q!==!1&&typeof C.afterRender=="function"&&C.afterRender()}};x()}return l(g,[{key:"destroy",value:function(){window.cancelAnimationFrame(this._renderAnimationFrame)}},{key:"refresh",value:function(w,k){var C=this;if(Object.assign(this._config,u,k),!w||w.nodeType!==1)throw new Error("HyperList requires a valid DOM Node container");this._element=w;var x=this._config,L=this._scroller||x.scroller||document.createElement(x.scrollerTagName||"tr");if(typeof x.useFragment!="boolean"&&(this._config.useFragment=!0),!x.generate)throw new Error("Missing required `generate` function");if(!p(x.total))throw new Error("Invalid required `total` value, expected number");if(!Array.isArray(x.itemHeight)&&!p(x.itemHeight))throw new Error("\n        Invalid required `itemHeight` value, expected number or array\n      ".trim());p(x.itemHeight)?this._itemHeights=Array(x.total).fill(x.itemHeight):this._itemHeights=x.itemHeight,Object.keys(u).filter(function(T){return T in x}).forEach(function(T){var N=x[T],oe=p(N),re=oe?!1:N.slice(-1)==="%";if(N&&typeof N!="string"&&typeof N!="number"){var B="Invalid optional `"+T+"`, expected string or number";throw new Error(B)}else oe&&(x[T]=N+"px");if(T==="height"){var Ne=oe?N:parseInt(N.replace(/px|%/,""),10);re?C._containerHeight=window.innerHeight*Ne/100:C._containerHeight=p(N)?N:Ne}});var A={width:""+x.width,height:""+x.height,overflow:"auto",position:"relative"};g.mergeStyle(w,A);var W=x.itemHeight*x.total,q=this._maxElementHeight;W>q&&console.warn(["HyperList: The maximum element height",q+"px has","been exceeded; please reduce your item height."].join(" "));var M={opacity:"0",position:"absolute",width:"1px",height:W+"px"};g.mergeStyle(L,M),this._scroller||w.appendChild(L),this._scroller=L,this._scrollHeight=this._computeScrollHeight(),this._itemPositions=this._itemPositions||Array(x.total).fill(0),this._computePositions(0),this._renderChunk(this._lastRepaint!==null),typeof x.afterRender=="function"&&x.afterRender()}},{key:"_getRow",value:function(w){var k=this._config,C=k.generate(w),x=C.height;if(x!==void 0&&p(x)?(C=C.element,x!==this._itemHeights&&(this._itemHeights[w]=x,this._computePositions(w),this._scrollHeight=this._computeScrollHeight(w))):x=this._itemHeights[w],!C||C.nodeType!==1)throw new Error("Generator did not return a DOM Node for index: "+w);var L=C.getAttribute("class")||"";C.setAttribute("class",L+" "+(k.rowClassName||"vrow"));var A=this._itemPositions[w];return g.mergeStyle(C,{position:"absolute",top:A+"px"}),C}},{key:"_getScrollPosition",value:function(){var w=this._config;return typeof w.overrideScrollPosition=="function"?w.overrideScrollPosition():this._element.scrollTop}},{key:"_renderChunk",value:function(w){var k=this._config,C=this._element,x=this._getScrollPosition(),L=k.total,A=k.reverse?this._getReverseFrom(x):this._getFrom(x)-1;if((A<0||A-this._screenItemsLen<0)&&(A=0),!w&&this._lastFrom===A)return!1;this._lastFrom=A;var W=A+this._cachedItemsLen;(W>L||W+this._cachedItemsLen>L)&&(W=L);var q=k.useFragment?document.createDocumentFragment():[],M=this._scroller;q[k.useFragment?"appendChild":"push"](M);for(var T=A;T<W;T++){var N=this._getRow(T);q[k.useFragment?"appendChild":"push"](N)}if(k.applyPatch)return k.applyPatch(C,q);C.innerHTML="",C.appendChild(q)}},{key:"_computePositions",value:function(){var w=arguments.length<=0||arguments[0]===void 0?1:arguments[0],k=this._config,C=k.total,x=k.reverse;w<1&&!x&&(w=1);for(var L=w;L<C;L++)x?L===0?this._itemPositions[0]=this._scrollHeight-this._itemHeights[0]:this._itemPositions[L]=this._itemPositions[L-1]-this._itemHeights[L]:this._itemPositions[L]=this._itemHeights[L-1]+this._itemPositions[L-1]}},{key:"_computeScrollHeight",value:function(){var w=this,k=this._config,C=k.total,x=this._itemHeights.reduce(function(M,T){return M+T},0);g.mergeStyle(this._scroller,{opacity:0,position:"absolute",width:"1px",height:x+"px"});var L=this._itemHeights.slice(0).sort(function(M,T){return M-T}),A=Math.floor(C/2),W=C%2===0?(L[A]+L[A-1])/2:L[A],q=this._element.clientHeight?this._element.clientHeight:this._containerHeight;return this._screenItemsLen=Math.ceil(q/W),this._containerHeight=q,this._cachedItemsLen=Math.max(this._cachedItemsLen||0,this._screenItemsLen*3),this._averageHeight=W,k.reverse&&window.requestAnimationFrame(function(){w._element.scrollTop=x}),x}},{key:"_getFrom",value:function(w){for(var k=0;this._itemPositions[k]<w;)k++;return k}},{key:"_getReverseFrom",value:function(w){for(var k=this._config.total-1;k>0&&this._itemPositions[k]<w+this._containerHeight;)k--;return k}}]),g}();r.default=y,i.exports=r.default},{}]},{},[1])(1)})}),Io=Ps(Do),Mi=class{constructor(e){this.instance=e,this.options=e.options,this.datamanager=e.datamanager,this.rowmanager=e.rowmanager,this.cellmanager=e.cellmanager,this.bodyScrollable=e.bodyScrollable,this.footer=this.instance.footer,this.log=e.log}renderRows(e){if(this.visibleRows=e,this.visibleRowIndices=e.map(l=>l.meta.rowIndex),e.length===0){this.bodyScrollable.innerHTML=this.getNoDataHTML();return}let t=this.datamanager.rowViewOrder.map(l=>this.visibleRowIndices.includes(l)?l:null).filter(l=>l!==null),i=getComputedStyle(this.bodyScrollable),r={width:i.width,height:i.height,itemHeight:this.options.cellHeight,total:e.length,generate:l=>{let d=document.createElement("div"),u=t[l],p=this.datamanager.getRow(u),y=this.rowmanager.getRowHTML(p,p.meta);return d.innerHTML=y,d.children[0]},afterRender:()=>{this.restoreState()}};this.hyperlist?this.hyperlist.refresh(this.bodyScrollable,r):this.hyperlist=new Io(this.bodyScrollable,r),this.renderFooter()}render(){let e=this.datamanager.getRowsForView();this.renderRows(e),this.instance.setDimensions()}renderFooter(){if(!this.options.showTotalRow)return;let e=this.getTotalRow(),t=this.rowmanager.getRowHTML(e,{isTotalRow:1,rowIndex:"totalRow"});this.footer.innerHTML=t}getTotalRow(){return this.datamanager.getColumns().map(r=>{let l=null;return["_rowIndex","_checkbox"].includes(r.id)&&(l=""),{content:l,isTotalRow:1,colIndex:r.colIndex,column:r}}).map((r,l)=>{if(r.content==="")return r;if(this.options.hooks.columnTotal){let d=this.visibleRows.map(p=>p[l].content),u=this.options.hooks.columnTotal.call(this.instance,d,r);if(u!=null)return r.content=u,r}return r.content=this.visibleRows.reduce((d,u)=>{let p=u[l];return typeof p.content=="number"?(d==null&&(d=0),d+p.content):d},r.content),r})}restoreState(){this.rowmanager.highlightCheckedRows(),this.cellmanager.selectAreaOnClusterChanged(),this.cellmanager.focusCellOnClusterChanged()}showToastMessage(e,t){this.instance.toastMessage.innerHTML=this.getToastMessageHTML(e),t&&setTimeout(()=>{this.clearToastMessage()},t*1e3)}clearToastMessage(){this.instance.toastMessage.innerHTML=""}getNoDataHTML(){return`<div class="dt-scrollable__no-data">${this.options.noDataMessage}</div>`}getToastMessageHTML(e){return`<span class="dt-toast__message">${e}</span>`}},Ni=class{constructor(e){this.instance=e,qt(this,this.instance,["options","datamanager","columnmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer"]),this.scopeClass="dt-instance-"+e.constructor.instances,e.datatableWrapper.classList.add(this.scopeClass);let t=document.createElement("style");e.wrapper.insertBefore(t,e.datatableWrapper),this.styleEl=t,this.bindResizeWindow(),this.bindScrollHeader()}get stylesheet(){return this.styleEl.sheet}bindResizeWindow(){this.onWindowResize=this.onWindowResize.bind(this),this.onWindowResize=gs(this.onWindowResize,300),this.options.layout==="fluid"&&_.on(window,"resize",this.onWindowResize)}bindScrollHeader(){this._settingHeaderPosition=!1,_.on(this.bodyScrollable,"scroll",e=>{this._settingHeaderPosition||(this._settingHeaderPosition=!0,requestAnimationFrame(()=>{let t=-e.target.scrollLeft;_.style(this.header,{transform:`translateX(${t}px)`}),_.style(this.footer,{transform:`translateX(${t}px)`}),this._settingHeaderPosition=!1}))})}onWindowResize(){this.distributeRemainingWidth(),this.refreshColumnWidth(),this.setBodyStyle()}destroy(){this.styleEl.remove(),_.off(window,"resize",this.onWindowResize)}setStyle(e,t){if(e.includes(",")){e.split(",").map(d=>d.trim()).forEach(d=>{this.setStyle(d,t)});return}if(e=e.trim(),!e)return;this._styleRulesMap=this._styleRulesMap||{};let i=this._getPrefixedSelector(e);this._styleRulesMap[i]&&(this.removeStyle(e),t=Object.assign({},this._styleRulesMap[i],t));let r=this._getRuleString(t),l=`${i} { ${r} }`;this._styleRulesMap[i]=t,this.stylesheet.insertRule(l)}removeStyle(e){if(e.includes(",")){e.split(",").map(r=>r.trim()).forEach(r=>{this.removeStyle(r)});return}if(e=e.trim(),!e)return;let t=this._getPrefixedSelector(e),i=Array.from(this.stylesheet.cssRules).findIndex(r=>r.selectorText===t);i!==-1&&this.stylesheet.deleteRule(i)}_getPrefixedSelector(e){return`.${this.scopeClass} ${e}`}_getRuleString(e){return Object.keys(e).map(t=>{let i=t;return t.includes("-")||(i=ms(t)),`${i}:${e[t]};`}).join("")}setDimensions(){this.setCellHeight(),this.setupMinWidth(),this.setupNaturalColumnWidth(),this.setupColumnWidth(),this.distributeRemainingWidth(),this.setColumnStyle(),this.setBodyStyle()}setCellHeight(){this.setStyle(".dt-cell",{height:this.options.cellHeight+"px"})}setupMinWidth(){_.each(".dt-cell--header",this.header).map(e=>{let{colIndex:t}=_.data(e),i=this.getColumn(t);if(!i.minWidth){let r=_.style(_(".dt-cell__content",e),"width");i.minWidth=r}})}setupNaturalColumnWidth(){!_(".dt-row")||(_.each(".dt-row-header .dt-cell",this.header).map(e=>{let{colIndex:t}=_.data(e),i=this.datamanager.getColumn(t),r=_.style(_(".dt-cell__content",e),"width");typeof r=="number"&&r>=this.options.minimumColumnWidth?i.naturalWidth=r:i.naturalWidth=this.options.minimumColumnWidth}),_.each(".dt-row-0 .dt-cell",this.bodyScrollable).map(e=>{let{colIndex:t}=_.data(e),i=this.datamanager.getColumn(t),r=_.style(_(".dt-cell__content",e),"width");typeof r=="number"&&r>=i.naturalWidth?i.naturalWidth=r:i.naturalWidth=i.naturalWidth}))}setupColumnWidth(){if(this.options.layout==="ratio"){let e=_.style(this.datatableWrapper,"width");if(this.options.serialNoColumn){let r=this.datamanager.getColumnById("_rowIndex");e=e-r.width-1}if(this.options.checkboxColumn){let r=this.datamanager.getColumnById("_checkbox");e=e-r.width-1}let t=this.datamanager.getColumns().map(r=>r.id==="_rowIndex"||r.id==="_checkbox"?0:(r.width||(r.width=1),r.ratioWidth=parseInt(r.width,10),r.ratioWidth)).reduce((r,l)=>r+l),i=e/t;this.datamanager.getColumns().map(r=>{r.id==="_rowIndex"||r.id==="_checkbox"||(r.width=Math.floor(i*r.ratioWidth)-1)})}else this.datamanager.getColumns().map(e=>{e.width||(e.width=e.naturalWidth),e.id==="_rowIndex"&&(e.width=this.getRowIndexColumnWidth()),e.width<this.options.minimumColumnWidth&&(e.width=this.options.minimumColumnWidth)})}distributeRemainingWidth(){if(this.options.layout!=="fluid")return;let e=_.style(this.instance.datatableWrapper,"width"),t=_(".dt-row",this.bodyScrollable),i=e;if(t)i=_.style(t,"width");else{let d=_(".dt-row",this.instance.header);i=Array.from(d.children).map(p=>p.offsetWidth).reduce((p,y)=>p+y,0)}let r=this.datamanager.getColumns().filter(d=>d.resizable),l=(e-i)/r.length;r.map(d=>{let u=_.style(this.getColumnHeaderElement(d.colIndex),"width"),p=Math.floor(u+l)-2;this.datamanager.updateColumn(d.colIndex,{width:p})})}setColumnStyle(){this.datamanager.getColumns().map(e=>{e.align||(e.align="left"),["left","center","right"].includes(e.align)||(e.align="left"),this.setStyle(`.dt-cell--col-${e.colIndex}`,{"text-align":e.align}),this.columnmanager.setColumnHeaderWidth(e.colIndex),this.columnmanager.setColumnWidth(e.colIndex)})}refreshColumnWidth(){this.datamanager.getColumns().map(e=>{this.columnmanager.setColumnHeaderWidth(e.colIndex),this.columnmanager.setColumnWidth(e.colIndex)})}setBodyStyle(){let e=_.style(this.datatableWrapper,"width"),t=_(".dt-row",this.bodyScrollable);if(!t)return;let i=_.style(t,"width"),r=e>i?i:e;_.style(this.bodyScrollable,{width:r+"px"}),_.removeStyle(this.bodyScrollable,"height");let l=_.getStyle(this.bodyScrollable,"height"),d=(this.bodyRenderer.hyperlist||{})._scrollHeight||1/0,u=_.hasHorizontalOverflow(this.bodyScrollable),p;d<l&&(p=d,u&&(p+=_.scrollbarSize()),_.style(this.bodyScrollable,{height:p+"px"})),this.bodyScrollable.scrollHeight-this.bodyScrollable.offsetHeight<_.scrollbarSize()&&_.style(this.bodyScrollable,{overflowY:"hidden"}),this.options.layout==="fluid"&&_.style(this.bodyScrollable,{overflowX:"hidden"})}getColumnHeaderElement(e){return e=+e,e<0?null:_(`.dt-cell--col-${e}`,this.header)}getRowIndexColumnWidth(){let e=this.datamanager.getRowCount(),t=22;return _.measureTextWidth(e+"")+t}},Lo={13:"enter",91:"meta",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",9:"tab",27:"esc",67:"c",70:"f",86:"v"},Oi=class{constructor(e){this.listeners={},_.on(e,"keydown",this.handler.bind(this))}handler(e){let t=Lo[e.keyCode];e.shiftKey&&t!=="shift"&&(t="shift+"+t),(e.ctrlKey&&t!=="ctrl"||e.metaKey&&t!=="meta")&&(t="ctrl+"+t);let i=this.listeners[t];if(i&&i.length>0)for(let r of i){let l=r(e);(l===void 0||l===!0)&&e.preventDefault()}}on(e,t){e.split(",").map(r=>r.trim()).map(r=>{this.listeners[r]=this.listeners[r]||[],this.listeners[r].push(t)})}},Ao={"Sort Ascending":"Sort Ascending","Sort Descending":"Sort Descending","Reset sorting":"Reset sorting","Remove column":"Remove column","No Data":"No Data","{count} cells copied":{1:"{count} cell copied",default:"{count} cells copied"},"{count} rows selected":{1:"{count} row selected",default:"{count} rows selected"}},Mo={"Sort Ascending":"Aufsteigend sortieren","Sort Descending":"Absteigend sortieren","Reset sorting":"Sortierung zur\xFCcksetzen","Remove column":"Spalte entfernen","No Data":"Keine Daten","{count} cells copied":{1:"{count} Zelle kopiert",default:"{count} Zellen kopiert"},"{count} rows selected":{1:"{count} Zeile ausgew\xE4hlt",default:"{count} Zeilen ausgew\xE4hlt"}},No={"Sort Ascending":"Trier par ordre croissant","Sort Descending":"Trier par ordre d\xE9croissant","Reset sorting":"R\xE9initialiser le tri","Remove column":"Supprimer colonne","No Data":"Pas de donn\xE9es","{count} cells copied":{1:"{count} cellule copi\xE9e",default:"{count} cellules copi\xE9es"},"{count} rows selected":{1:"{count} ligne s\xE9lectionn\xE9e",default:"{count} lignes s\xE9lectionn\xE9es"}},Oo={"Sort Ascending":"Ordinamento ascendente","Sort Descending":"Ordinamento decrescente","Reset sorting":"Azzeramento ordinamento","Remove column":"Rimuovi colonna","No Data":"Nessun dato","{count} cells copied":{1:"Copiato {count} cella",default:"{count} celle copiate"},"{count} rows selected":{1:"{count} linea selezionata",default:"{count} linee selezionate"}};function Ho(){return{en:Ao,de:Mo,fr:No,it:Oo}}var Hi=class{constructor(e){this.language=e,this.translations=Ho()}addTranslations(e){this.translations=Object.assign(this.translations,e)}translate(e,t){let i=this.translations[this.language]&&this.translations[this.language][e]||e;return typeof i=="object"&&(i=t&&t.count?this.getPluralizedTranslation(i,t.count):e),Eo(i,t||{})}getPluralizedTranslation(e,t){return e[t]||e.default}};function Fo(n,e,t){let i=[];if(Object.keys(e).length===0)return n.map(r=>r.meta.rowIndex);for(let r in e){let l=e[r],u=(i.length?i.map(g=>n[g]):n).map(g=>g[r]),p=Po(l),y=jo(n,t,p);y?i=y(p.text,u):i=u.map(g=>g.rowIndex)}return i}function jo(n,e,t){let i=p=>{let y=Ue.getCustomCellFormatter(p),g=n[p.rowIndex];return e&&e.data&&e.data.length&&(g=e.data[p.rowIndex]),y&&p.content?(p.html=y(p.content,n[p.rowIndex],p.column,g,t),hs(p.html)):p.content||""},r=p=>String(hs(p.html||"")||i(p)).toLowerCase(),l=p=>parseFloat(p.content),d=(p,y)=>{if(p.column.compareValue){let v=p.column.compareValue(p,y);if(v&&Array.isArray(v))return v}let g=l(p);return isNaN(g)?[r(p),y]:[g,y]};return{contains(p,y){return y.filter(g=>{let v=r(g),w=(p||"").toLowerCase();return!w||v.includes(w)}).map(g=>g.rowIndex)},greaterThan(p,y){return y.filter(g=>{let[v,w]=d(g,p);return v>w}).map(g=>g.rowIndex)},lessThan(p,y){return y.filter(g=>{let[v,w]=d(g,p);return v<w}).map(g=>g.rowIndex)},equals(p,y){return y.filter(g=>parseFloat(g.content)===p).map(g=>g.rowIndex)},notEquals(p,y){return y.filter(g=>parseFloat(g.content)!==p).map(g=>g.rowIndex)},range(p,y){return y.filter(g=>{let v=d(g,p[0]),w=d(g,p[1]),k=v[0];return k>=v[1]&&k<=w[1]}).map(g=>g.rowIndex)},containsNumber(p,y){return y.filter(g=>{let v=parseFloat(p,10),w=p,k=l(g),C=r(g);return v===k||C.includes(w)}).map(g=>g.rowIndex)}}[t.type]}function Po(n=""){if(n.length===0)return{};let e=n;return[">","<","="].includes(e[0])?e=n.slice(1):e.startsWith("!=")&&(e=n.slice(2)),n.startsWith(">")&&e?{type:"greaterThan",text:e.trim()}:n.startsWith("<")&&e?{type:"lessThan",text:e.trim()}:n.startsWith("=")&&bt(e)?{type:"equals",text:Number(n.slice(1).trim())}:bt(e)?{type:"containsNumber",text:e}:n.startsWith("!=")&&bt(e)?{type:"notEquals",text:Number(n.slice(2).trim())}:n.split(":").length===2&&n.split(":").every(t=>bt(t.trim()))?(e=n.split(":"),{type:"range",text:e.map(t=>t.trim())}):{type:"contains",text:e.toLowerCase()}}function Wo(n){return{columns:[],data:[],dropdownButton:Ii.chevronDown,headerDropdown:[{label:n.translate("Sort Ascending"),action:function(e){this.sortColumn(e.colIndex,"asc")}},{label:n.translate("Sort Descending"),action:function(e){this.sortColumn(e.colIndex,"desc")}},{label:n.translate("Reset sorting"),action:function(e){this.sortColumn(e.colIndex,"none")}},{label:n.translate("Remove column"),action:function(e){this.removeColumn(e.colIndex)}}],events:{onRemoveColumn(e){},onSwitchColumn(e,t){},onSortColumn(e){},onCheckRow(e){},onDestroy(){}},hooks:{columnTotal:null},sortIndicator:{asc:"\u2191",desc:"\u2193",none:""},overrideComponents:{},filterRows:Fo,freezeMessage:"",getEditor:null,serialNoColumn:!0,checkboxColumn:!1,clusterize:!0,logs:!1,layout:"fixed",noDataMessage:n.translate("No Data"),cellHeight:40,minimumColumnWidth:30,inlineFilters:!1,treeView:!1,checkedRowStatus:!0,dynamicRowHeight:!1,pasteFromClipboard:!1,showTotalRow:!1,direction:"ltr",disableReorderColumn:!1}}var Bo={DataManager:Di,CellManager:Ue,ColumnManager:Li,RowManager:Ai,BodyRenderer:Mi,Style:Ni,Keyboard:Oi},Pe=class{constructor(e,t){if(Pe.instances++,typeof e=="string"&&(e=document.querySelector(e)),this.wrapper=e,!(this.wrapper instanceof HTMLElement))throw new Error("Invalid argument given for `wrapper`");this.initializeTranslations(t),this.setDefaultOptions(),this.buildOptions(t),this.prepare(),this.initializeComponents(),this.options.data&&(this.refresh(),this.columnmanager.applyDefaultSortOrder())}initializeTranslations(e){this.language=e.language||"en",this.translationManager=new Hi(this.language),e.translations&&this.translationManager.addTranslations(e.translations)}setDefaultOptions(){this.DEFAULT_OPTIONS=Wo(this)}buildOptions(e){this.options=this.options||{},this.options=Object.assign({},this.DEFAULT_OPTIONS,this.options||{},e),e.headerDropdown=e.headerDropdown||[],this.options.headerDropdown=[...this.DEFAULT_OPTIONS.headerDropdown,...e.headerDropdown],this.events=Object.assign({},this.DEFAULT_OPTIONS.events,this.options.events||{},e.events||{}),this.fireEvent=this.fireEvent.bind(this)}prepare(){this.prepareDom(),this.unfreeze()}initializeComponents(){let e=Object.assign({},Bo,this.options.overrideComponents),{Style:t,Keyboard:i,DataManager:r,RowManager:l,ColumnManager:d,CellManager:u,BodyRenderer:p}=e;this.style=new t(this),this.keyboard=new i(this.wrapper),this.datamanager=new r(this.options),this.rowmanager=new l(this),this.columnmanager=new d(this),this.cellmanager=new u(this),this.bodyRenderer=new p(this)}prepareDom(){this.wrapper.innerHTML=`
            <div class="datatable" dir="${this.options.direction}">
                <div class="dt-header"></div>
                <div class="dt-scrollable"></div>
                <div class="dt-footer"></div>
                <div class="dt-freeze">
                    <span class="dt-freeze__message">
                        ${this.options.freezeMessage}
                    </span>
                </div>
                <div class="dt-toast"></div>
                <div class="dt-dropdown-container"></div>
                <textarea class="dt-paste-target"></textarea>
            </div>
        `,this.datatableWrapper=_(".datatable",this.wrapper),this.header=_(".dt-header",this.wrapper),this.footer=_(".dt-footer",this.wrapper),this.bodyScrollable=_(".dt-scrollable",this.wrapper),this.freezeContainer=_(".dt-freeze",this.wrapper),this.toastMessage=_(".dt-toast",this.wrapper),this.pasteTarget=_(".dt-paste-target",this.wrapper),this.dropdownContainer=_(".dt-dropdown-container",this.wrapper)}refresh(e,t){this.datamanager.init(e,t),this.render(),this.setDimensions()}destroy(){this.wrapper.innerHTML="",this.style.destroy(),this.fireEvent("onDestroy")}appendRows(e){this.datamanager.appendRows(e),this.rowmanager.refreshRows()}refreshRow(e,t){this.rowmanager.refreshRow(e,t)}render(){this.renderHeader(),this.renderBody()}renderHeader(){this.columnmanager.renderHeader()}renderBody(){this.bodyRenderer.render()}setDimensions(){this.style.setDimensions()}showToastMessage(e,t){this.bodyRenderer.showToastMessage(e,t)}clearToastMessage(){this.bodyRenderer.clearToastMessage()}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}getRows(){return this.datamanager.getRows()}getCell(e,t){return this.datamanager.getCell(e,t)}getColumnHeaderElement(e){return this.columnmanager.getColumnHeaderElement(e)}getViewportHeight(){return this.viewportHeight||(this.viewportHeight=_.style(this.bodyScrollable,"height")),this.viewportHeight}sortColumn(e,t){this.columnmanager.sortColumn(e,t)}removeColumn(e){this.columnmanager.removeColumn(e)}scrollToLastColumn(){this.datatableWrapper.scrollLeft=9999}freeze(){_.style(this.freezeContainer,{display:""})}unfreeze(){_.style(this.freezeContainer,{display:"none"})}updateOptions(e){this.buildOptions(e)}fireEvent(e,...t){let i=[...this._internalEventHandlers[e]||[],this.events[e]].filter(Boolean);for(let r of i)r.apply(this,t)}on(e,t){this._internalEventHandlers=this._internalEventHandlers||{},this._internalEventHandlers[e]=this._internalEventHandlers[e]||[],this._internalEventHandlers[e].push(t)}log(){this.options.logs&&console.log.apply(console,arguments)}translate(e,t){return this.translationManager.translate(e,t)}};Pe.instances=0;var zo="frappe-datatable",qo="0.0.0-development",Vo="A modern datatable library for the web",Yo="dist/frappe-datatable.cjs.js",Xo="dist/frappe-datatable.min.js",Uo="dist/frappe-datatable.min.js",Go={start:"yarn run dev",build:"rollup -c && NODE_ENV=production rollup -c",dev:"rollup -c -w","cy:server":"http-server -p 8989","cy:open":"cypress open","cy:run":"cypress run",test:"start-server-and-test cy:server http://localhost:8989 cy:run","test-local":"start-server-and-test cy:server http://localhost:8989 cy:open","travis-deploy-once":"travis-deploy-once","semantic-release":"semantic-release",lint:"eslint src","lint-and-build":"yarn lint && yarn build",commit:"npx git-cz"},Ko=["dist","src"],Jo={autoprefixer:"^9.0.0",chai:"3.5.0",cypress:"^9.2.0","cz-conventional-changelog":"^2.1.0",deepmerge:"^2.0.1",eslint:"^5.0.1","eslint-config-airbnb":"^16.1.0","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.11.0","http-server":"^0.11.1",mocha:"3.3.0","postcss-custom-properties":"^7.0.0","postcss-nested":"^3.0.0",rollup:"^0.59.4","rollup-plugin-commonjs":"^8.3.0","rollup-plugin-eslint":"^4.0.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.3","rollup-plugin-postcss":"^1.2.8","rollup-plugin-uglify-es":"^0.0.1","semantic-release":"^17.1.1","start-server-and-test":"^1.4.1","travis-deploy-once":"^5.0.1"},Qo={type:"git",url:"https://github.com/frappe/datatable.git"},Zo=["datatable","data","grid","table"],ea="Faris Ansari",ta="MIT",ia={url:"https://github.com/frappe/datatable/issues"},sa="https://frappe.io/datatable",na={hyperlist:"^1.0.0-beta",lodash:"^4.17.5",sortablejs:"^1.7.0"},ra={commitizen:{path:"cz-conventional-changelog"}},oa={name:zo,version:qo,description:Vo,main:Yo,unpkg:Xo,jsdelivr:Uo,scripts:Go,files:Ko,devDependencies:Jo,repository:Qo,keywords:Zo,author:ea,license:ta,bugs:ia,homepage:sa,dependencies:na,config:ra};Pe.__version__=oa.version;bs.exports=Pe});jQuery.event.special.touchstart={setup:function(n,e,t){this.addEventListener&&this.addEventListener("touchstart",t,{passive:!0})}};jQuery.event.special.touchend={setup:function(n,e,t){this.addEventListener&&this.addEventListener("touchend",t,{passive:!0})}};jQuery.event.special.touchmove={setup:function(n,e,t){this.addEventListener&&this.addEventListener("touchmove",t,{passive:!0})}};$(document).on("app_ready",function(){document.referrer.endsWith("/login")&&frappe.call({method:"erpnext_oob.utils.get_user_default",callback:function(n){n.message&&n.message.forEach(function(e){var t=e.setting_key.toLowerCase().replaceAll(" ","_");frappe.defaults.set_user_default_local(t,e.setting_value)})}})});$(document).bind("toolbar_setup",function(){});frappe.views.Calendar=class extends frappe.views.Calendar{setup_options(e){super.setup_options(e),this.cal_options.locale=="zh"&&(this.cal_options.locale="zh-cn")}};var ha=class extends frappe.views.ListView{get_column_html(e,t){if(e.type==="Status")return`
				<div class="list-row-col hidden-xs ellipsis">
					${this.get_indicator_html(t)}
				</div>
			`;let i=e.df||{},r=i.label,l=i.fieldname,d=t[l]||"",u=()=>i.fieldtype==="Code"?d:i.fieldtype==="Percent"?`<div class="progress level" style="margin: 0px;">
						<div class="progress-bar progress-bar-success" role="progressbar"
							aria-valuenow="${d}"
							aria-valuemin="0" aria-valuemax="100" style="width: ${Math.round(d)}%;">
						</div>
					</div>`:frappe.format(d,i,null,t),p=()=>{let k,C;return this.settings.formatters&&this.settings.formatters[l]?C=this.settings.formatters[l](d,i,t):i.fieldtype=="Text Editor"||i.fetch_from&&["Text","Small Text"].includes(i.fieldtype)?C=strip_html(d):C=typeof d=="string"?frappe.utils.escape_html(d):d,i.fieldtype==="Image"?k=i.options?`<img src="${t[i.options]}" style="max-height: 30px; max-width: 100%;">`:`<div class="missing-image small">
						<span class="octicon octicon-circle-slash"></span>
					</div>`:i.fieldtype==="Select"?k=`<span class="filterable indicator ${frappe.utils.guess_colour(C)} ellipsis"
					data-filter="${l},=,${d}">
					${__(C)}
				</span>`:i.fieldtype==="Link"?k=`<a class="filterable text-muted ellipsis"
					data-filter="${l},=,${d}">
					${__(C)}
				</a>`:["Text Editor","Text","Small Text","HTML Editor"].includes(i.fieldtype)?k=`<span class="text-muted ellipsis">
					${__(C)}
				</span>`:k=`<a class="filterable text-muted ellipsis"
					data-filter="${l},=,${d}">
					${u()}
				</a>`,`<span class="ellipsis"
				title="${__(r)}: ${__(C)}">
				${k}
			</span>`},g=["list-row-col ellipsis",{Subject:"list-subject level",Field:"hidden-xs"}[e.type],frappe.model.is_numeric_field(i)?"text-right":""].join(" "),w={Subject:this.get_subject_html(t),Field:p()}[e.type];return`
			<div class="${g}">
				${w}
			</div>
		`}get_subject_html(e){let t=frappe.session.user,i=this.columns[0].df,r=e[i.fieldname]||e.name,l=strip_html(r.toString()),d=frappe.utils.escape_html(l),u=JSON.parse(e._liked_by||"[]"),p=u.includes(t)?"liked-by":"text-extra-muted not-liked",y=JSON.parse(e._seen||"[]").includes(t)?"":"bold";return`
			<input class="level-item list-row-checkbox hidden-xs" type="checkbox" data-name="${escape(e.name)}">
			<span class="level-item" style="margin-bottom: 1px;">
				<i class="octicon octicon-heart like-action ${p}"
					data-name="${e.name}" data-doctype="${this.doctype}"
					data-liked-by="${encodeURI(e._liked_by)||"[]"}"
				>
				</i>
				<span class="likes-count">
					${u.length>99?__("99")+"+":__(u.length||"")}
				</span>
			</span>
			<span class="level-item ${y} ellipsis" title="${__(d)}">
				<a class="ellipsis" href="${this.get_form_link(e)}" title="${__(d)}" data-doctype="${this.doctype}" data-name="${e.name}">
				${__(l)}
				</a>
			</span>
		`}};frappe.model.with_doctype("Print Format");frappe.views.ListView=class extends frappe.views.ListView{render(){this.render_list(),this.set_rows_as_checked(),this.on_row_checked(),this.render_total(),this.render_count()}render_total(){if(this.columns.filter(e=>e.type==="Field"&&e.df&&["Int","Float","Currency"].includes(e.df.fieldtype)).length){let e=this.get_total_html();this.$result.find(".list-row-total").remove(),this.$result.append(e)}}get_total_html(){if(!this.columns)return;let e=this.columns.map(t=>{let i=["list-row-col ellipsis",t.type=="Subject"?"list-subject level":"hidden-xs",t.type=="Tag"?"tag-col hide":"",frappe.model.is_numeric_field(t.df)?"text-right":""].join(" "),r="";if(t.type==="Subject")r=`
			<input class="level-item list-check-all" type="checkbox"
			  title="${__("Select All")}">
			  <span class="level-item"><b>${__("Total")}</b></span>`;else if(t.type==="Field"&&t.df&&["Int","Float","Currency"].includes(t.df.fieldtype)){let l=this.data.reduce((d,u)=>d+(u[t.df.fieldname]||0),0);r=`<span>${frappe.format(l,t.df)}</span>`}return`
		  <div class="${i}">
			${r}
		  </div>
		`}).join("");return this.get_total_html_skeleton(e,'<span class="list-count"></span>')}get_total_html_skeleton(e="",t=""){return`
		<footer class="level list-row-head list-row-total text-muted">
		  <div class="level-left list-header-subject">
			${e}
		  </div>
		  <div class="level-right">
			${t}
		  </div>
		</footer>
	  `}};var Ns=String.prototype.plural;String.prototype.plural=function(n){return frappe.boot.lang==="zh"?this:Ns.call(this,n)};var xe=class{constructor(e){Object.assign(this,e),this.editing=Boolean(this.values&&Object.keys(this.values).length)}make(){this.make_dialog(),this.setup_dialog_events(),this.dialog.show(),window.cur_dialog=this.dialog,this.editing&&this.set_default_values()}make_dialog(){this.dialog=new frappe.ui.Dialog({title:this.get_title(),fields:this.get_fields(),primary_action:e=>{e=this.process_data(e),!this.editing&&!e.name&&(e.name=`${this.type}-${this.label}-${frappe.utils.get_random(20)}`),this.dialog.hide(),this.primary_action(e)},primary_action_label:this.primary_action_label||__("Add")})}get_title(){let e=this.editing?"Edit":"Add",t=e=e+" "+frappe.model.unscrub(this.type);return __(t)}get_fields(){}set_default_values(){return this.dialog.set_values(this.values)}process_data(e){return e}setup_dialog_events(){}hide_field(e){this.dialog.set_df_property(e,"hidden",!0)}show_field(e){this.dialog.set_df_property(e,"hidden",!1)}setup_filter(e){this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group);let t=this.dialog.get_field("filter_area_loading").$wrapper;$(`<span class="text-muted">${__("Loading Filters...")}</span>`).appendTo(t),this.filters=[],this.generate_filter_from_json&&this.generate_filter_from_json(),this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:e,on_change:()=>{}}),frappe.model.with_doctype(e,()=>{this.filter_group.add_filters_to_filter_group(this.filters),this.hide_field("filter_area_loading"),this.show_field("filter_area")})}},ui=class extends xe{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"chart_name",label:"Chart Name",options:"Dashboard Chart",reqd:1},{fieldtype:"Data",fieldname:"label",label:"Label"}]}process_data(e){return e.label=e.label?e.label:e.chart_name,e}},pi=class extends xe{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"document_type",label:"DocType",options:"DocType",reqd:1,onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.document_type&&this.setup_filter(this.document_type)},get_query:()=>({filters:{issingle:0,istable:0}})},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Section Break",fieldname:"filter_section",label:__("Add Filters"),depends_on:"eval: doc.document_type"},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area"}]}generate_filter_from_json(){this.values&&this.values.quick_list_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.quick_list_filter,this.values.document_type))}process_data(e){if(this.filter_group){let t=this.filter_group.get_filters();e.quick_list_filter=JSON.stringify(t)}return e.label=e.label?e.label:e.document_type,e}},fi=class extends xe{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"onboarding_name",label:"Onboarding Name",options:"Module Onboarding",reqd:1}]}},_i=class extends xe{constructor(e){super(e)}get_fields(){let e=this;return[{fieldtype:"Data",fieldname:"label",label:__("Label")},{fieldtype:"HTML Editor",fieldname:"description",label:__("Description"),max_height:"7rem"},{fieldname:"links",fieldtype:"Table",label:__("Card Links"),editable_grid:1,data:e.values?JSON.parse(e.values.links):[],get_data:()=>e.values?JSON.parse(e.values.links):[],fields:[{fieldname:"link_type",fieldtype:"Select",in_list_view:1,label:"Link Type",reqd:1,options:["DocType","Page","Report"]},{fieldname:"link_to",fieldtype:"Dynamic Link",in_list_view:1,label:"Link To",reqd:1,get_options:t=>t.doc.link_type,get_query:function(t){if(t.link_type=="DocType")return{filters:{istable:0}}}},{fieldname:"label",fieldtype:"Data",in_list_view:1,label:"Label"},{fieldname:"icon",fieldtype:"Icon",label:"Icon"},{fieldname:"column_break_7",fieldtype:"Column Break"},{fieldname:"dependencies",fieldtype:"Data",label:"Dependencies"},{fieldname:"only_for",fieldtype:"Link",label:"Only for",options:"Country"},{default:"0",fieldname:"onboard",fieldtype:"Check",label:"Onboard"},{default:"0",fieldname:"is_query_report",fieldtype:"Check",label:"Is Query Report"}]}]}process_data(e){let t="";return e.links?e.links.map((i,r)=>{let l=r+1;i.link_type||(t=__("Following fields have missing values")+": <br><br><ul>",t+=`<li>${__("Link Type in Row")} ${l}</li>`),i.link_to||(t+=`<li>${__("Link To in Row")} ${l}</li>`),i.label=i.label?i.label:i.link_to}):t=__("You must add atleast one link."),t&&(t+="</ul>",frappe.throw({message:__(t),title:__("Missing Values Required"),indicator:"orange"})),e.label=e.label?e.label:e.chart_name,e}},mi=class extends xe{constructor(e){super(e)}hide_filters(){this.hide_field("count_section_break"),this.hide_field("filters_section_break")}show_filters(){this.show_field("count_section_break"),this.show_field("filters_section_break")}get_fields(){return[{fieldtype:"Select",fieldname:"type",label:"Type",reqd:1,options:`DocType
Report
Page
Dashboard
URL`,onchange:()=>{this.dialog.get_value("type")=="DocType"?this.dialog.fields_dict.link_to.get_query=()=>({query:"frappe.core.report.permitted_documents_for_user.permitted_documents_for_user.query_doctypes",filters:{user:frappe.session.user,include_single_doctypes:!0}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Dynamic Link",fieldname:"link_to",label:"Link To",options:"type",onchange:()=>{let e=this.dialog.get_value("link_to");e&&this.dialog.get_value("type")=="DocType"?frappe.model.with_doctype(e,async()=>{var l;let t=frappe.get_meta(e);e&&frappe.boot.single_types.includes(e)?this.hide_filters():e&&(this.setup_filter(e),this.show_filters());let i=["List","Report Builder","Dashboard","New"];t.is_tree===1&&i.push("Tree"),frappe.boot.calendars.includes(e)&&i.push("Calendar");let r=await frappe.db.get_value("Kanban Board",{reference_doctype:e},"name");(l=r==null?void 0:r.message)!=null&&l.name&&i.push("Kanban"),this.dialog.set_df_property("doc_view","options",i.join(`
`))}):this.hide_filters()},depends_on:e=>e.type!="URL",mandatory_depends_on:e=>e.type!="URL"},{fieldtype:"Data",fieldname:"url",label:"URL",default:"",depends_on:e=>e.type=="URL",mandatory_depends_on:e=>e.type=="URL"},{fieldtype:"Select",fieldname:"doc_view",label:"DocType View",options:`List
Report Builder
Dashboard
Tree
New
Calendar
Kanban`,description:__("Which view of the associated DocType should this shortcut take you to?"),default:"List",depends_on:e=>{if(this.dialog){let t=this.dialog.get_value("link_to"),i=frappe.boot.single_types.includes(t);return t&&e.type=="DocType"&&!i}return!1},onchange:()=>{this.dialog.get_value("doc_view")=="Kanban"?this.dialog.fields_dict.kanban_board.get_query=()=>({filters:{reference_doctype:this.dialog.get_value("link_to")}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Link",fieldname:"kanban_board",label:"Kanban Board",options:"Kanban Board",depends_on:()=>{var t;return((t=this.dialog)==null?void 0:t.get_value("doc_view"))=="Kanban"},mandatory_depends_on:()=>{var t;return((t=this.dialog)==null?void 0:t.get_value("doc_view"))=="Kanban"}},{fieldtype:"Section Break",fieldname:"filters_section_break",label:__("Count Filter"),hidden:1},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"count_section_break",label:__("Count Customizations"),hidden:1},{fieldtype:"Select",fieldname:"color",label:__("Color"),options:["Grey","Green","Red","Orange","Pink","Yellow","Blue","Cyan"],default:"Grey",input_class:"color-select",onchange:()=>{let e=this.dialog.fields_dict.color.value.toLowerCase(),t=this.dialog.fields_dict.color.$input;t.parent().find(".color-box").get(0)||$('<div class="color-box"></div>').insertBefore(t.get(0)),t.parent().find(".color-box").get(0).style.backgroundColor=`var(--text-on-${e})`}},{fieldtype:"Column Break",fieldname:"column_break_3"},{fieldtype:"Data",fieldname:"format",label:__("Format"),description:__("For Example: {} Open")}]}set_default_values(){super.set_default_values().then(()=>{this.dialog.fields_dict.link_to.df.onchange()})}generate_filter_from_json(){this.values&&this.values.stats_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.stats_filter,this.values.link_to))}process_data(e){if(this.dialog.get_value("type")=="DocType"&&this.filter_group){let t=this.filter_group.get_filters();e.stats_filter=JSON.stringify(t)}if(e.label=e.label?e.label:frappe.model.unscrub(e.link_to),e.url){let t=e.url;e.url.startsWith("/")&&(t=frappe.urllib.get_base_url()+e.url),!validate_url(t)&&frappe.throw({message:__("<b>{0}</b> is not a valid URL",[e.url]),title:__("Invalid URL"),indicator:"red"}),e.label||(e.label="No Label (URL)")}return e}},gi=class extends xe{constructor(e){super(e)}get_fields(){let e;return this.for_workspace?[{fieldtype:"Link",fieldname:"number_card_name",label:__("Number Card"),options:"Number Card",reqd:1,get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}})},{fieldtype:"Data",fieldname:"label",label:__("Label")}]:(e=[{fieldtype:"Select",label:__("Choose Existing Card or create New Card"),fieldname:"new_or_existing",options:["New Card","Existing Card"]},{fieldtype:"Link",fieldname:"card",label:__("Number Cards"),options:"Number Card",get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}}),depends_on:'eval: doc.new_or_existing == "Existing Card"'},{fieldtype:"Section Break",fieldname:"sb_1",depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Label"),fieldname:"label",fieldtype:"Data",mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Doctype"),fieldname:"document_type",fieldtype:"Link",options:"DocType",onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.set_aggregate_function_fields(this.dialog.get_values()),this.setup_filter(this.document_type)},hidden:1},{label:__("Color"),fieldname:"color",fieldtype:"Color"},{fieldtype:"Column Break",fieldname:"cb_1"},{label:__("Function"),fieldname:"function",fieldtype:"Select",options:["Count","Sum","Average","Minimum","Maximum"],mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Function Based On"),fieldname:"aggregate_function_based_on",fieldtype:"Select",depends_on:"eval: doc.function !== 'Count'",mandatory_depends_on:'eval: doc.function !== "Count" && doc.new_or_existing == "New Card"'},{fieldtype:"Section Break",fieldname:"sb_1",label:__("Add Filters"),depends_on:'eval: doc.new_or_existing == "New Card"'},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"sb_1"}],e)}setup_dialog_events(){!this.document_type&&!this.for_workspace&&(this.default_values&&this.default_values.doctype?(this.document_type=this.default_values.doctype,this.setup_filter(this.default_values.doctype),this.set_aggregate_function_fields()):this.show_field("document_type"))}set_aggregate_function_fields(){let e=[];this.document_type&&frappe.get_meta(this.document_type)&&frappe.get_meta(this.document_type).fields.map(t=>{if(frappe.model.numeric_fieldtypes.includes(t.fieldtype)){if(t.fieldtype=="Currency"&&(!t.options||t.options!=="Company:company:default_currency"))return;e.push({label:t.label,value:t.fieldname})}}),this.dialog.set_df_property("aggregate_function_based_on","options",e)}process_data(e){return this.for_workspace?(e.label=e.label?e.label:e.number_card_name,e):(e.new_or_existing=="Existing Card"&&(e.name=e.card),e.stats_filter=this.filter_group&&JSON.stringify(this.filter_group.get_filters()),e.document_type=this.document_type,e)}},bi=class extends xe{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"custom_block_name",label:"Custom Block Name",options:"Custom HTML Block",reqd:1,get_query:()=>({query:"frappe.desk.doctype.custom_html_block.custom_html_block.get_custom_blocks_for_user"})}]}};function vi(n){return{chart:ui,shortcut:mi,links:_i,onboarding:fi,quick_list:pi,number_card:gi,custom_block:bi}[n]||xe}var Re=class{constructor(e){Object.assign(this,e),this.make()}refresh(){this.set_title(),this.set_actions(),this.set_body(),this.setup_events(),this.set_footer()}get_config(){return{name:this.name,label:this.label}}customize(e){if(this.in_customize_mode=!0,this.action_area.empty(),e.allow_sorting&&frappe.utils.add_custom_button(frappe.utils.icon("es-line-drag","xs"),null,"drag-handle",__("Drag"),null,this.action_area),e.allow_hiding){this.hidden&&(this.widget.removeClass("hidden"),this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5));let t=this.hidden?"fa fa-eye":"fa fa-eye-slash",i=this.hidden?__("Show"):__("Hide");frappe.utils.add_custom_button(`<i class="${t}" aria-hidden="true"></i>`,()=>this.hide_or_show(),"show-or-hide-button",i,null,this.action_area),this.show_or_hide_button=this.action_area.find(".show-or-hide-button")}e.allow_edit&&frappe.utils.add_custom_button(frappe.utils.icon("es-line-edit-alt","xs"),()=>this.edit(),"edit-button",__("Edit"),null,this.action_area)}make(){this.make_widget(),this.widget.appendTo(this.container)}make_widget(){this.widget=$(`<div class="widget" data-widget-name="${this.name?this.name:""}">
			<div class="widget-head">
				<div class="widget-label">
					<div class="widget-title"></div>
					<div class="widget-subtitle"></div>
				</div>
				<div class="widget-control"></div>
			</div>
			<div class="widget-body"></div>
			<div class="widget-footer"></div>
		</div>`),this.title_field=this.widget.find(".widget-title"),this.subtitle_field=this.widget.find(".widget-subtitle"),this.body=this.widget.find(".widget-body"),this.action_area=this.widget.find(".widget-control"),this.head=this.widget.find(".widget-head"),this.footer=this.widget.find(".widget-footer"),this.refresh()}set_title(e){let t=this.title||this.label||this.name,i=e?frappe.ellipsis(t,e):t;this.title_field[0].innerHTML=`<span class="ellipsis" title="${i}">${i}</span>`,e&&this.title_field[0].setAttribute("title",this.title||this.label),this.subtitle&&this.subtitle_field.html(this.subtitle)}delete(e=!0,t=!1){let i=r=>{this.widget.remove(),!t&&this.options.on_delete&&this.options.on_delete(this.name,r)};e?(this.widget.addClass("zoom-out"),setTimeout(()=>{i(!0)},300)):i(!1)}edit(){var t;let e=vi(this.widget_type);this.edit_dialog=new e({for_workspace:(t=this.options)==null?void 0:t.for_workspace,label:this.label,type:this.widget_type,values:this.get_config(),primary_action:i=>{Object.assign(this,i),i.name=this.name,this.new=!0,this.refresh(),this.options.on_edit&&this.options.on_edit(i)},primary_action_label:__("Save")}),this.edit_dialog.make()}toggle_width(){this.width=="Full"?(this.widget.removeClass("full-width"),this.width=null,this.refresh()):(this.widget.addClass("full-width"),this.width="Full",this.refresh());let e=this.width=="Full"?__("Collapse"):__("Expand");this.resize_button.attr("title",e)}hide_or_show(){this.hidden?(this.body.css("opacity",1),this.title_field.css("opacity",1),this.footer.css("opacity",1),this.hidden=!1):(this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5),this.hidden=!0),this.show_or_hide_button.empty();let e=this.hidden?"fa fa-eye":"fa fa-eye-slash",t=this.hidden?__("Show"):__("Hide");$(`<i class="${e}" aria-hidden="true" title="${t}"></i>`).appendTo(this.show_or_hide_button)}setup_events(){}set_actions(){}set_body(){}set_footer(){}};frappe.provide("frappe.utils");var ut=class extends Re{async refresh(){frappe.utils.load_video_player(),this.new&&await this.get_onboarding_data(),this.set_title(),this.set_actions(),this.set_body(),this.setup_events()}get_config(){return{label:this.onboarding_name}}make_body(){this.body.empty(),this.steps_wrapper=$('<div class="onboarding-steps-wrapper"></div>').appendTo(this.body),this.step_preview=$(`<div class="onboarding-step-preview">
			<div class="onboarding-step-body"></div>
			<div class="onboarding-step-footer"></div>
		</div>`).appendTo(this.body),this.step_body=this.step_preview.find(".onboarding-step-body"),this.step_footer=this.step_preview.find(".onboarding-step-footer"),this.steps.forEach((t,i)=>{this.add_step(t,i)});let e=this.steps.findIndex(t=>!t.is_skipped&&!t.is_complete);e==-1&&(e=0),this.show_step(this.steps[e])}add_step(e,t){let i="pending";e.is_skipped&&(i="skipped"),e.is_complete&&(i="complete");let r=$(`<a class="onboarding-step ${i}">
				<div class="step-title">
					<div class="step-index step-pending">${frappe.utils.icon("es-line-success","md","","","step-icon")}</div>
					<div class="step-index step-skipped">${frappe.utils.icon("es-line-close-circle","md","","--icon-stroke: var(--gray-600);","step-icon")}</div>
					<div class="step-index step-complete">${frappe.utils.icon("es-solid-success","md","","","step-icon")}</div>
					<div class="step-text">${__(e.title)}</div>
				</div>
			</a>`);if(e.$step=r,!e.is_complete&&!e.is_skipped){let l=$(`<div class="step-skip">${__("Skip")}</div>`);l.appendTo(r),l.on("click",()=>{this.skip_step(e),event.stopPropagation()})}return r.on("click",()=>this.show_step(e)),r.appendTo(this.steps_wrapper),r}show_step(e){this.active_step&&this.active_step.$step.removeClass("active"),e.$step.addClass("active"),this.active_step=e;let t={"Watch Video":d=>this.show_video(d),"Create Entry":d=>{d.is_complete?frappe.set_route(`/app/List/${d.reference_document}`):d.show_full_form?this.create_entry(d):this.show_quick_entry(d)},"Show Form Tour":d=>this.show_form_tour(d),"Update Settings":d=>this.update_settings(d),"View Report":d=>this.open_report(d),"Go to Page":d=>this.go_to_page(d)},i=()=>{this.step_body.empty(),this.step_footer.empty(),r(),e.intro_video_url?$(`<button class="btn btn-default btn-sm">${__("Watch Tutorial")}</button>`).appendTo(this.step_footer).on("click",l):$(`<button class="btn btn-default btn-sm">${__(e.action_label||e.action)}</button>`).appendTo(this.step_footer).on("click",()=>t[e.action](e))},r=()=>{let d=e.description?frappe.markdown(e.description):`<h1>${__(e.title)}</h1>`;e.action==="Create Entry"&&(d+=`<p>
					<a href='/app/${frappe.router.slug(e.reference_document)}'>
						${__("Show {0} List",[__(e.reference_document)])}</a>
				</p>`),this.step_body.html(d)},l=()=>{this.step_body.empty(),this.step_footer.empty();let d=$(`<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="${e.intro_video_url}"></div>`);d.appendTo(this.step_body);let u=new frappe.Plyr(d[0],{hideControls:!0,resetOnEnd:!0});$(`<button class="btn btn-primary btn-sm">${__(e.action_label||e.action)}</button>`).appendTo(this.step_footer).on("click",()=>{u.pause(),t[e.action](e)}),$(window).one("hashchange",()=>{u.pause()}),$(`<button class="btn btn-secondary ml-2 btn-sm">${__("Back")}</button>`).appendTo(this.step_footer).on("click",i)};i()}go_to_page(e){this.mark_complete(e),frappe.set_route(e.path).then(()=>{let t=e.callback_message||__("You can continue with the onboarding after exploring this page"),i=e.callback_title||__("Awesome Work"),r=frappe.msgprint({message:t,title:i,primary_action:{action:()=>{r.hide()},label:()=>__("Continue")},wide:!0})})}open_report(e){let t=frappe.utils.generate_route({name:e.reference_report,type:"report",is_query_report:e.report_type!=="Report Builder",doctype:e.report_reference_doctype}),i=frappe.get_route();frappe.set_route(t).then(()=>{let r=frappe.msgprint({message:__(e.report_description),title:__(e.reference_report),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(e)}),r.hide()},label:()=>__("Continue")},secondary_action:{action:()=>{r.hide(),frappe.set_route(i).then(()=>{this.mark_complete(e)})},label:__("Go Back")}});frappe.msg_dialog.custom_onhide=()=>this.mark_complete(e)})}show_form_tour(e){let t;e.is_single?t=frappe.router.slug(e.reference_document):t=`${frappe.router.slug(e.reference_document)}/new`;let i=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=r=>{let l=()=>{let u=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Onboarding complete"),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(e)}),u.hide()},label:()=>__("Continue")}})},d=e.form_tour;r.tour.init({tour_name:d,on_finish:l}).then(()=>r.tour.start())},frappe.set_route(t)}update_settings(e){let t=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=i=>{i.scroll_to_field(e.field),i.doc.__unsaved=!0},frappe.route_hooks.after_save=i=>{let r=!1,l={},d=i.doc[e.field],u=null;d&&e.value_to_validate=="%"&&(r=!0),d==e.value_to_validate&&(r=!0),cstr(d)==cstr(e.value_to_validate)&&(r=!0),r?(l.message=__("Let's take you back to onboarding"),l.title=__("Action Complete"),l.primary_action={action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")},u=()=>l.primary_action.action()):(l.message=__("Looks like you didn't change the value"),l.title=__("Try Again"),l.secondary_action={action:()=>frappe.set_route(t),label:__("Go Back")},l.primary_action={action:()=>{frappe.set_route(t).then(()=>{setTimeout(()=>{this.skip_step(e)},300)})},label:__("Skip Step")},u=()=>l.secondary_action.action()),frappe.msgprint(l),frappe.msg_dialog.custom_onhide=()=>u()},frappe.set_route("Form",e.reference_document)}async create_entry(e){let t=frappe.get_route(),i=await this.get_first_document(e.reference_document);frappe.route_hooks={},frappe.route_hooks.after_load=l=>{let d=()=>{frappe.msgprint({message:__("Awesome, now try making an entry yourself"),title:__("Document Saved"),primary_action:{action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(e)}},u=e.form_tour;l.tour.init({tour_name:u,on_finish:d}).then(()=>l.tour.start())};let r=()=>{frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Action Complete"),primary_action:{action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(e)}};e.is_submittable?(frappe.route_hooks.after_save=()=>{frappe.msgprint({message:__("Submit this document to complete this step."),title:__("Document Saved")})},frappe.route_hooks.after_submit=r):frappe.route_hooks.after_save=r,frappe.set_route("Form",e.reference_document,i)}show_quick_entry(e){let t=frappe.get_route_str();frappe.ui.form.make_quick_entry(e.reference_document,()=>{if(frappe.get_route_str()!=t){let i=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Document Saved"),primary_action:{action:()=>{i.hide(),frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}});frappe.msg_dialog.custom_onhide=()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})}}else frappe.show_alert(__("Document Saved")+"<br>"+__("Let us continue with the onboarding")),this.mark_complete(e)},null,null,!0)}show_video(e){frappe.help.show_video(e.video_url,e.title),this.mark_complete(e)}mark_complete(e){let t=e.$step,i=()=>{e.is_complete=!0,t.removeClass("skipped"),t.addClass("complete")};this.update_step_status(e,"is_complete",1,i),this.activate_next_step(e)}skip_step(e){let t=e.$step,i=()=>{e.is_skipped=!0,t.removeClass("complete"),t.removeClass("pending"),t.addClass("skipped")};this.update_step_status(e,"is_skipped",1,i),this.activate_next_step(e)}activate_next_step(e){let t=this.steps.findIndex(r=>r==e),i=this.steps[t+1];!i||this.show_step(i)}update_step_status(e,t,i,r){let l={is_complete:"complete",is_skipped:"skipped"};frappe.route_hooks={},frappe.call("frappe.desk.desktop.update_onboarding_step",{name:e.name,field:t,value:i}).then(()=>{r(),e.$step.removeClass("pending").removeClass("complete").removeClass("skipped").addClass(l[t]),this.steps.filter(u=>!(u.is_complete||u.is_skipped)).length==0&&this.show_success()})}show_success(){let e=this.success||__("You seem good to go!"),t=this.success_state_image||"/assets/frappe/images/ui-states/success-color.png",i="";this.docs_url&&(i=__('Congratulations on completing the module setup. If you want to learn more you can refer to the documentation <a target="_blank" href="{0}">here</a>.',[this.docs_url]));let r=$(`<div class="text-center onboarding-success">
					<img src="${t}" alt="Success State" class="zoom-in success-state">
					<h3>${e}</h3>
					<div class="text-muted">${i}</div>
					<button class="btn btn-primary btn-sm">${__("Continue")}</button>
			</div>
		`);r.find(".btn").on("click",()=>this.delete()),this.step_preview.empty(),r.appendTo(this.step_preview)}set_body(){this.widget.addClass("onboarding-widget-box"),this.is_dismissed()?this.widget.hide():this.make_body()}is_dismissed(){if(this.in_customize_mode)return!1;let e=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");if(Object.keys(e).includes(this.title)){let t=new Date(e[this.title]),i=new Date;return frappe.datetime.get_hour_diff(i,t)<24}return!1}set_actions(){if(this.in_customize_mode)return;this.action_area.empty();let e=$(`<div class="btn btn-sm btn-secondary small" style="cursor:pointer;">${__("Dismiss",null,"Stop showing the onboarding widget.")}</div>`);e.on("click",()=>{let t=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");t[this.title]=frappe.datetime.now_datetime(),localStorage.setItem("dismissed-onboarding",JSON.stringify(t)),this.delete(!0,!0),this.widget.closest(".ce-block").hide(),frappe.telemetry.capture("dismissed_"+frappe.scrub(this.title),"frappe_onboarding")}),e.appendTo(this.action_area)}get_onboarding_data(){return frappe.model.with_doc("Module Onboarding",this.onboarding_name).then(e=>{if(e){this.onboarding_doc=e,this.label=e.label,this.title=e.title||__("Let's Get Started"),this.subtitle=e.subtitle,this.success=e.success,this.docs_url=e.docs_url,this.user_can_dismiss=e.user_can_dismiss;let t="frappe.desk.doctype.onboarding_step.onboarding_step.get_onboarding_steps";return frappe.xcall(t,{ob_steps:e.steps}).then(i=>{this.steps=i})}})}async get_first_document(e){let{message:t}=await frappe.db.get_value("Form Tour",{reference_doctype:e},["first_document"]),i;return t.first_document&&await frappe.db.get_list(e,{order_by:"creation"}).then(r=>{Array.isArray(r)&&r.length&&(i=r[0].name)}),i||"new"}};var yi=class extends ut{show_step(e){e.description=__(e.description),e.title=__(e.title),super.show_step(e)}};frappe.widget.widget_factory.onboarding=yi;frappe.provide("frappe.utils");var pt=class extends Re{constructor(e){e.shadow=!0,super(e)}get_config(){return{name:this.name,number_card_name:this.number_card_name,label:this.label,color:this.color,hidden:this.hidden}}refresh(){this.set_body()}set_body(){this.widget.addClass("number-widget-box"),this.make_card()}make_card(){frappe.model.with_doc("Number Card",this.number_card_name||this.name).then(e=>{if(e)this.card_doc=e,this.render_card();else if(this.document_type)frappe.run_serially([()=>this.create_number_card(),()=>this.render_card()]);else{this.delete(!1);return}this.set_events()})}create_number_card(){return this.set_doc_args(),frappe.xcall("frappe.desk.doctype.number_card.number_card.create_number_card",{args:this.card_doc}).then(e=>{this.name=e.name,this.card_doc=e,this.widget.attr("data-widget-name",this.name)})}set_events(){$(this.body).click(()=>{this.in_customize_mode||this.set_route()})}set_route(){if(this.card_doc.type==="Custom"){this.set_route_for_custom_card();return}let e=this.card_doc.type!=="Report",t=e?this.card_doc.document_type:this.card_doc.report_name,i=frappe.utils.generate_route({name:t,type:e?"doctype":"report",is_query_report:!e});if(e){let r=JSON.parse(this.card_doc.filters_json);frappe.route_options=r.reduce((l,d)=>Object.assign(l,{[`${d[0]}.${d[1]}`]:[d[2],d[3]]}),{})}frappe.set_route(i)}set_route_for_custom_card(){var e;!((e=this.data)!=null&&e.route)||(this.data.route_options&&(frappe.route_options=this.data.route_options),frappe.set_route(this.data.route))}set_doc_args(){this.card_doc=Object.assign({},{document_type:this.document_type,label:this.label,function:this.function,aggregate_function_based_on:this.aggregate_function_based_on,color:this.color,filters_json:this.stats_filter})}get_settings(e){return this.filters=this.get_filters(),{Custom:{method:this.card_doc.method,args:{filters:this.filters},get_number:i=>this.get_number_for_custom_card(i)},Report:{method:"frappe.desk.query_report.run",args:{report_name:this.card_doc.report_name,filters:this.filters,ignore_prepared_report:1},get_number:i=>this.get_number_for_report_card(i)},"Document Type":{method:"frappe.desk.doctype.number_card.number_card.get_result",args:{doc:this.card_doc,filters:this.filters},get_number:i=>this.get_number_for_doctype_card(i)}}[e]}get_filters(){return frappe.dashboard_utils.get_all_filters(this.card_doc)}async render_card(){this.prepare_actions(),this.set_title(),this.set_loading_state(),this.card_doc.type||(this.card_doc.type="Document Type"),this.settings=this.get_settings(this.card_doc.type),await this.get_data(),this.render_number(),this.render_stats()}set_loading_state(){$(this.body).html(`<div class="number-card-loading text-muted">
			${__("Loading...")}
		</div>`)}async get_data(){return this.data=await frappe.xcall(this.settings.method,this.settings.args),this.settings.get_number(this.data)}get_number_for_custom_card(e){typeof e=="object"?(this.number=e.value,this.set_formatted_number(e)):this.formatted_number=e}get_number_for_doctype_card(e){if(this.number=e,this.card_doc.function!=="Count")return frappe.model.with_doctype(this.card_doc.document_type,()=>{let t=frappe.meta.get_docfield(this.card_doc.document_type,this.card_doc.aggregate_function_based_on);this.set_formatted_number(t)});this.formatted_number=e}get_number_for_report_card(e){let t=this.card_doc.report_field,i=e.result.reduce((l,d)=>(d[t]&&l.push(d[t]),l),[]),r=e.columns.find(l=>l.fieldname==t);this.number=frappe.report_utils.get_result_of_fn(this.card_doc.report_function,i),this.set_formatted_number(r,this._generate_common_doc(e.result))}set_formatted_number(e,t){let i=frappe.sys_defaults.country,l=frappe.utils.shorten_number(this.number,i,5).split(" "),d=l[1]||"";l[0]=window.convert_old_to_new_number_format(l[0]);let u=$(frappe.format(l[0],e,null,t)).text();this.formatted_number=u+" "+__(d)}_generate_common_doc(e){if(!e||!e.length)return{};let t=Object.assign({},e[0]);return e.forEach(i=>{if(!Array.isArray(i))for(let[r,l]of Object.entries(t))l!==i[r]&&delete t[r]}),t}render_number(){let e=this.card_doc.color?`style="color: ${this.card_doc.color};"`:"";$(this.body).html(`<div class="widget-content">
			<div class="number" ${e}>${this.formatted_number}</div>
			</div>`)}render_stats(){if(this.card_doc.type!=="Document Type"||!this.card_doc.show_percentage_stats)return;let e="",t="";return this.get_percentage_stats().then(()=>{this.percentage_stat==0||this.percentage_stat==null?t="grey-stat":this.percentage_stat>0?(e=`<span class="indicator-pill-round green">
						${frappe.utils.icon("es-line-arrow-up-right","xs")}
					</span>`,t="green-stat"):(e=`<span class="indicator-pill-round red">
						${frappe.utils.icon("arrow-down-right","xs")}
					</span>`,t="red-stat");let r={Daily:__("since yesterday"),Weekly:__("since last week"),Monthly:__("since last month"),Yearly:__("since last year")}[this.card_doc.stats_time_interval],l=(()=>{if(this.percentage_stat==null)return NaN;let d=this.percentage_stat.split(" "),u=d[1]||"";return Math.abs(d[0])+" "+u})();isNaN(l)||$(this.body).find(".widget-content").append(`<div class="card-stats ${t}">
				<span class="percentage-stat-area">
					${e} ${l} % ${r}
				</span>
			</div>`)})}get_percentage_stats(){return frappe.xcall("frappe.desk.doctype.number_card.number_card.get_percentage_difference",{doc:this.card_doc,filters:this.filters,result:this.number}).then(e=>{e!==void 0&&(this.percentage_stat=frappe.utils.shorten_number(e))})}prepare_actions(){if(this.in_customize_mode)return;let e=[{label:__("Refresh"),action:"action-refresh",handler:()=>{this.render_card()}},{label:__("Edit"),action:"action-edit",handler:()=>{let t=this.number_card_name||this.name;frappe.set_route("Form","Number Card",t)}}];this.set_card_actions(e)}set_card_actions(e){this.card_actions=$(`<div class="card-actions dropdown pull-right">
				<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				...
				</a>
				<ul class="dropdown-menu" style="max-height: 300px; overflow-y: auto;">
					${e.map(t=>`<li class="dropdown-item">
									<a data-action="${t.action}">${t.label}</a>
								</li>`).join("")}
				</ul>
			</div>`),this.card_actions.find("a[data-action]").each((t,i)=>{let r=i.dataset.action;$(i).click(e.find(l=>l.action===r))}),this.action_area.html(this.card_actions)}};var wi=class extends pt{set_title(){$(this.title_field).html(`<div class="number-label">${__(this.card_doc.label)}</div>`)}};frappe.widget.widget_factory.number_card=wi;frappe.provide("frappe.widget.utils");frappe.provide("frappe.dashboards");frappe.provide("frappe.dashboards.chart_sources");var ft=class extends Re{constructor(e){e.shadow=!0,super(e),this.height=this.height||240}get_config(){return{name:this.name,chart_name:this.chart_name,label:this.label,hidden:this.hidden,width:this.width}}refresh(){delete this.dashboard_chart,this.set_body(),this.make_chart()}set_chart_title(){let e=this.widget.width()<600?40:60;this.set_title(e)}set_body(){this.widget.addClass("dashboard-widget-box"),this.width=="Full"&&this.widget.addClass("full-width")}setup_container(){this.body.empty(),this.chart_doc.type=="Heatmap"&&this.setup_heatmap_container(),this.loading=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("Loading...")}</div>`),this.loading.appendTo(this.body),this.empty=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("No Data")}</div>`),this.empty.hide().appendTo(this.body),this.chart_wrapper=$("<div></div>"),this.chart_wrapper.appendTo(this.body),this.$heatmap_legend=null,this.set_chart_title()}setup_heatmap_container(){this.widget.addClass("heatmap-chart"),this.widget.removeClass("full-width").addClass("full-width"),this.width="Full"}set_summary(){this.$summary?this.$summary.empty():(this.$summary=$('<div class="report-summary"></div>').hide(),this.head.after(this.$summary)),this.summary.forEach(e=>{frappe.utils.build_summary_item(e).appendTo(this.$summary)}),this.summary.length&&this.$summary.show()}make_chart(){this.get_settings().then(()=>{if(!this.settings){this.deleted=!0,this.widget.remove();return}this.chart_settings||(this.chart_settings={}),this.setup_container(),this.in_customize_mode||(this.action_area.empty(),this.prepare_chart_actions(),this.chart_doc.timeseries&&this.render_time_series_filters()),frappe.run_serially([()=>this.prepare_chart_object(),()=>this.setup_filter_button(),()=>this.fetch_and_update_chart()])})}render_time_series_filters(){let e=this.get_time_series_filters();frappe.dashboard_utils.render_chart_filters(e,"chart-actions",this.action_area,0)}get_time_series_filters(){let e;return this.chart_doc.type=="Heatmap"?e=[{label:this.chart_settings.heatmap_year||this.chart_doc.heatmap_year,options:frappe.dashboard_utils.get_years_since_creation(frappe.boot.user.creation),action:t=>{this.selected_heatmap_year=t,this.save_chart_config_for_user({heatmap_year:this.selected_heatmap_year}),this.fetch_and_update_chart()}}]:e=[{label:this.chart_settings.time_interval||this.chart_doc.time_interval,options:["Yearly","Quarterly","Monthly","Weekly","Daily"],icon:"calendar",class:"time-interval-filter",action:t=>{this.selected_time_interval=t,this.save_chart_config_for_user({time_interval:this.selected_time_interval}),this.fetch_and_update_chart()}},{label:this.chart_settings.timespan||this.chart_doc.timespan,options:["Select Date Range","Last Year","Last Quarter","Last Month","Last Week"],class:"timespan-filter",action:t=>{this.selected_timespan=t,this.selected_timespan==="Select Date Range"?this.render_date_range_field():(this.selected_from_date=null,this.selected_to_date=null,this.date_field_wrapper&&(this.date_field_wrapper.hide(),this.title_field.show(),this.subtitle_field.show(),this.head.css("flex-direction","row")),this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:null,to_date:null}),this.fetch_and_update_chart())}}],e}fetch_and_update_chart(){this.args={timespan:this.selected_timespan||this.chart_settings.timespan,time_interval:this.selected_time_interval||this.chart_settings.time_interval,from_date:this.selected_from_date||this.chart_settings.from_date,to_date:this.selected_to_date||this.chart_settings.to_date,heatmap_year:this.selected_heatmap_year||this.chart_settings.heatmap_year},this.fetch(this.filters,!0,this.args).then(e=>{this.chart_doc.chart_type=="Report"&&(this.report_result=e,this.summary=e.report_summary,e=this.get_report_chart_data(e)),this.update_chart_object(),this.data=e,this.render()})}render_date_range_field(){(!this.date_field_wrapper||!this.date_field_wrapper.is(":visible"))&&(this.date_field_wrapper=$('<div class="dashboard-date-field pull-right"></div>').insertAfter(this.action_area.find(".timespan-filter")),this.width!=="Full"&&this.widget.width()<700&&(this.title_field.hide(),this.subtitle_field.hide(),this.head.css("flex-direction","row-reverse")),this.date_range_field=frappe.ui.form.make_control({df:{fieldtype:"DateRange",fieldname:"from_date",placeholder:"Date Range",input_class:"input-xs",default:[this.chart_settings.from_date,this.chart_settings.to_date],value:[this.chart_settings.from_date,this.chart_settings.to_date],reqd:1,change:()=>{let e=this.date_range_field.get_value();this.selected_from_date=e[0],this.selected_to_date=e[1],e&&e.length==2&&(this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:this.selected_from_date,to_date:this.selected_to_date}),this.fetch_and_update_chart())}},parent:this.date_field_wrapper,render_input:1}),this.date_range_field.$input.focus())}get_report_chart_data(e){if(e.chart&&this.chart_doc.use_report_chart)return e.chart.data;{let t=[];this.chart_doc.y_axis.map(l=>{t.push(l.y_field)});let i={y_fields:t,x_field:this.chart_doc.x_field,chart_type:this.chart_doc.type,color:this.chart_doc.color},r=e.columns.map(l=>frappe.report_utils.prepare_field_from_column(l));return frappe.report_utils.make_chart_options(r,e,i).data}}prepare_chart_actions(){let e=[{label:__("Refresh"),action:"action-refresh",handler:()=>{delete this.dashboard_chart,this.make_chart()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Dashboard Chart",this.chart_doc.name)}},{label:__("Reset Chart"),action:"action-reset",handler:()=>{this.reset_chart(),delete this.dashboard_chart,this.make_chart()}}];this.chart_doc.document_type?e.push({label:__("{0} List",[this.chart_doc.document_type]),action:"action-list",handler:()=>{frappe.set_route("List",this.chart_doc.document_type)}}):this.chart_doc.chart_type==="Report"&&e.push({label:__("{0} Report",[this.chart_doc.report_name]),action:"action-list",handler:()=>{frappe.set_route("query-report",this.chart_doc.report_name,this.filters)}}),this.set_chart_actions(e)}setup_filter_button(){this.in_customize_mode||(this.is_document_type=this.chart_doc.chart_type!=="Report"&&this.chart_doc.chart_type!=="Custom",this.filter_button=$(`<div class="filter-chart btn btn-xs pull-right">
				${frappe.utils.icon("filter","sm")}
			</div>`),this.filter_button.appendTo(this.action_area),this.is_document_type?(this.filter_group&&(this.filters=this.filter_group.get_filters()),this.create_filter_group_and_add_filters()):this.filter_button.on("click",()=>{let e;frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(t=>{this.is_document_type?e=[{fieldtype:"HTML",fieldname:"filter_area"}]:t?e=t.filter(i=>i.fieldname).map(i=>(Object.assign(i,i.dashboard_config||{}),i)):e=[{fieldtype:"HTML",options:__("No Filters Set")}],this.setup_filter_dialog(e)})}))}setup_filter_dialog(e){let t=this,i=new frappe.ui.Dialog({title:__("Set Filters for {0}",[this.chart_doc.chart_name]),fields:e,primary_action:function(){let r=this.get_values();r&&(this.hide(),t.filters=r,t.save_chart_config_for_user({filters:t.filters}),t.fetch_and_update_chart())},primary_action_label:"Set"});i.show(),this.chart_doc.chart_type=="Report"&&(frappe.query_report=new frappe.views.QueryReport({filters:i.fields_list}),frappe.query_reports[this.chart_doc.report_name].onload&&frappe.query_reports[this.chart_doc.report_name].onload(frappe.query_report)),i.set_values(this.filters)}reset_chart(){this.save_chart_config_for_user(null,1),this.chart_settings={},this.filters=null,this.selected_time_interval=null,this.selected_timespan=null,this.selected_heatmap_year=null}save_chart_config_for_user(e,t=0){Object.assign(this.chart_settings,e),frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.save_chart_config",{reset:t,config:this.chart_settings,chart_name:this.chart_doc.chart_name})}create_filter_group_and_add_filters(){this.filter_group=new frappe.ui.FilterGroup({doctype:this.chart_doc.document_type,parent_doctype:this.chart_doc.parent_document_type,filter_button:this.filter_button,on_change:()=>{this.filters=this.filter_group.get_filters(),this.save_chart_config_for_user({filters:this.filters}),this.fetch_and_update_chart()}}),this.filters&&frappe.model.with_doctype(this.chart_doc.document_type,()=>{this.filter_group.add_filters_to_filter_group(this.filters)})}set_chart_actions(e){this.chart_actions=$(`<div class="chart-actions dropdown pull-right">
			<button data-toggle="dropdown"
				aria-haspopup="true"aria-expanded="false"
				class="btn btn-xs btn-secondary chart-menu"
			>
				<svg class="icon icon-sm">
					<use href="#icon-dot-horizontal">
					</use>
				</svg>
			</button>
			<ul class="dropdown-menu dropdown-menu-right">
				${e.map(t=>`<li><a class="dropdown-item" data-action="${t.action}">${t.label}</a></li>`).join("")}
			</ul>
		</div>
		`),this.chart_actions.find("a[data-action]").each((t,i)=>{let r=i.dataset.action;$(i).click(e.find(l=>l.action===r))}),this.chart_actions.appendTo(this.action_area)}fetch(e,t=!1,i){let r=this.settings.method;return this.chart_doc.chart_type=="Report"?i={report_name:this.chart_doc.report_name,filters:e,ignore_prepared_report:1}:i={chart_name:this.chart_doc.name,filters:e,refresh:t?1:0,time_interval:i&&i.time_interval?i.time_interval:null,timespan:i&&i.timespan?i.timespan:null,from_date:i&&i.from_date?i.from_date:null,to_date:i&&i.to_date?i.to_date:null,heatmap_year:i&&i.heatmap_year?i.heatmap_year:null},frappe.xcall(r,i)}async get_source_doctype(){if(this.chart_doc.document_type)return this.chart_doc.document_type;if(this.chart_doc.chart_type=="Report"&&this.chart_doc.report_name)return await frappe.db.get_value("Report",this.chart_doc.report_name,"ref_doctype").then(e=>e.message.ref_doctype)}async render(){let e=()=>{let t=this.get_chart_args();this.dashboard_chart?this.dashboard_chart.update(this.data):this.dashboard_chart=frappe.utils.make_chart(this.chart_wrapper[0],t)};!this.data||!this.data.labels||!Object.keys(this.data).length?(this.chart_wrapper.hide(),this.loading.hide(),this.$summary&&this.$summary.hide(),this.empty.show()):(this.loading.hide(),this.empty.hide(),this.chart_wrapper.show(),this.chart_doc.document_type=await this.get_source_doctype(),this.chart_doc.document_type?frappe.model.with_doctype(this.chart_doc.document_type,e):e(),this.width=="Full"&&this.summary&&this.set_summary(),this.chart_doc.type=="Heatmap"&&this.render_heatmap_legend())}get_chart_args(){var p,y;let e=this.get_chart_colors(),t,i,r={Line:"line",Bar:"bar",Percentage:"percentage",Pie:"pie",Donut:"donut",Heatmap:"heatmap"},l=["Pie","Donut"].includes(this.chart_doc.type)?6:9,d={data:this.data,type:r[this.chart_doc.type],colors:e,height:this.height,maxSlices:this.chart_doc.number_of_groups||l,axisOptions:{xIsSeries:this.chart_doc.timeseries,shortenYAxisNumbers:1}};if(this.chart_doc.document_type){let v=frappe.get_meta(this.chart_doc.document_type).fields.find(w=>w.fieldname==this.chart_doc.value_based_on);t=v==null?void 0:v.fieldtype,i=v==null?void 0:v.options}if(this.chart_doc.chart_type=="Report"&&((y=(p=this.report_result)==null?void 0:p.chart)==null?void 0:y.fieldtype)&&(t=this.report_result.chart.fieldtype,i=this.report_result.chart.options),d.tooltipOptions={formatTooltipY:g=>frappe.format(g,{fieldtype:t,options:i},{always_show_decimals:!0,inline:!0})},this.chart_doc.type=="Heatmap"){let g=parseInt(this.selected_heatmap_year||this.chart_settings.heatmap_year||this.chart_doc.heatmap_year);d.data.start=new Date(`${g}-01-01`),d.data.end=new Date(`${g+1}-01-01`)}let u=g=>{let v=JSON.parse(g);for(let w in v)typeof d[w]=="object"&&typeof v[w]=="object"?d[w]=Object.assign(d[w],v[w]):d[w]=v[w]};return this.custom_options&&u(this.custom_options),this.chart_doc.custom_options&&u(this.chart_doc.custom_options),d}get_chart_colors(){let e=[];return this.chart_doc.y_axis.length?this.chart_doc.y_axis.map(t=>{e.push(t.color)}):["Line","Bar"].includes(this.chart_doc.type)?e=[this.chart_doc.color||[]]:this.chart_doc.type=="Heatmap"&&(e=[]),e}render_heatmap_legend(){let e,t=i=>{e=JSON.parse(i).colors};this.custom_options&&t(this.custom_options),this.chart_doc.custom_options&&t(this.chart_doc.custom_options),!this.$heatmap_legend&&this.widget.width()>991&&(this.$heatmap_legend=$(`
				<div class="heatmap-legend">
					<ul class="legend-colors">
						<li style="background-color: ${e[0]||"#ebedf0"}"></li>
						<li style="background-color: ${e[1]||"#c6e48b"}"></li>
						<li style="background-color: ${e[2]||"#7bc96f"}"></li>
						<li style="background-color: ${e[3]||"#239a3b"}"></li>
						<li style="background-color: ${e[4]||"#196127"}"></li>
					</ul>
					<div class="legend-label">
						<div style="margin-bottom: 45px">${__("Less")}</div>
						<div>${__("More")}</div>
					</div>
				</div>
				`),this.body.append(this.$heatmap_legend))}update_last_synced(){if(!this.chart_doc.last_synced_on)return;let e=__("Last synced {0}",[comment_when(this.chart_doc.last_synced_on)]);this.subtitle_field.html(e)}update_chart_object(){frappe.db.get_doc("Dashboard Chart",this.chart_doc.name).then(e=>{this.chart_doc=e,this.update_last_synced()})}prepare_chart_object(){return this.chart_doc.type=="Heatmap"&&!this.chart_doc.heatmap_year&&(this.chart_doc.heatmap_year=frappe.dashboard_utils.get_year(frappe.datetime.now_date())),this.set_chart_filters()}set_chart_filters(){let e=this.chart_settings.filters||null,t=frappe.dashboard_utils.get_all_filters(this.chart_doc);return this.chart_doc.chart_type=="Report"?frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(i=>{t=this.update_default_date_filters(i,t),this.filters=frappe.utils.parse_array(e)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(t)}):(this.filters=frappe.utils.parse_array(e)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(t),Promise.resolve())}update_default_date_filters(e,t){return e&&e.map(i=>{["Date","DateRange"].includes(i.fieldtype)&&i.default&&(i.reqd||t[i.fieldname])&&(t[i.fieldname]=i.default)}),t}get_settings(){return frappe.model.with_doc("Dashboard Chart",this.chart_name).then(e=>{if(e)if(this.chart_doc=e,this.chart_doc.chart_type=="Custom"){if(frappe.dashboards.chart_sources[this.chart_doc.source])return this.settings=frappe.dashboards.chart_sources[this.chart_doc.source],Promise.resolve();{let t="frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config";return frappe.xcall(t,{name:this.chart_doc.source}).then(i=>{frappe.dom.eval(i),this.settings=frappe.dashboards.chart_sources[this.chart_doc.source]})}}else return this.chart_doc.chart_type=="Report"?(this.settings={method:"frappe.desk.query_report.run"},Promise.resolve()):(this.settings={method:"frappe.desk.doctype.dashboard_chart.dashboard_chart.get"},Promise.resolve())})}};var Ci=class extends ft{set_chart_title(){this.label=__(this.label||this.name),super.set_chart_title()}};frappe.widget.widget_factory.chart=Ci;frappe.dashboard_utils.render_chart_filters=function(n,e,t,i){n.forEach(r=>{let l="",d="";r.icon&&(l=frappe.utils.icon(r.icon)),r.class&&(d=r.class);let u=`<div class="${e} ${d} btn-group dropdown pull-right">
					<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<button class="btn btn-secondary btn-xs">
			 				${l}
							<span class="filter-label">${__(r.label)}</span>
							${frappe.utils.icon("select","xs")}
						</button>
				</a>`,p;r.fieldnames?p=r.options.map((v,w)=>`<li>
						<a class="dropdown-item" data-fieldname="${r.fieldnames[w]}" selected_item="${v}">${__(v)}</a>
					</li>`).join(""):p=r.options.map(v=>`<li><a class="dropdown-item" selected_item="${v}">${__(v)}</a></li>`).join("");let y=u+`<ul class="dropdown-menu">${p}</ul></div>`,g=$(y);i?g.prependTo(t):g.appendTo(t),g.find(".dropdown-menu").on("click","li a",v=>{let w=$(v.currentTarget),k;w.attr("data-fieldname")&&(k=w.attr("data-fieldname"));let C=w.attr("selected_item");w.parents(`.${e}`).find(".filter-label").text(__(C)),r.action(C,k)})})};frappe.ui.Page=class extends frappe.ui.Page{add_auto_select(e,t,i){return this.add_field({label:e,fieldtype:"Autocomplete",options:t,change:i}).$wrapper.find("input").empty()}};function xi(n,e){return is(n,e,0,0,null,[],256,0,0,10)}function is(n,e,t,i,r,l,d,u,p,y){let g=0;if(++p>=y)return[!1,g,l];if(t===n.length||i===e.length)return[!1,g,l];let v=!1,w=[],k=0,C=!0;for(;t<n.length&&i<e.length;){if(n[t].toLowerCase()===e[i].toLowerCase()){if(u>=d)return[!1,g,l];C&&r&&(l=[...r],C=!1);let[L,A,W]=is(n,e,t,i+1,l,[],d,u,p,y);L&&((!v||A>k)&&(w=[...W],k=A),v=!0),l[u++]=i,++t}++i}let x=t===n.length;if(x){g=100;let L=-5*l[0];L=L<-15?-15:L,g+=L;let A=e.length-u;g+=-1*A;for(let W=0;W<u;W++){let q=l[W];if(W>0){let M=l[W-1];q==M+1&&(g+=25)}if(q>0){let M=e[q-1],T=e[q];M!==M.toUpperCase()&&T!==T.toLowerCase()&&(g+=30),(M=="_"||M==" ")&&(g+=30)}else g+=15}return v&&(!x||k>g)?(l=[...w],g=k,[!0,g,l]):x?[!0,g,l]:[!1,g,l]}return[!1,g,l]}frappe.search.utils.fuzzy_search=function(n="",e="",t=!1){let i=__(e||""),[,r,l]=xi(n,i,t);if(r==0&&frappe.boot.lang!="en"&&i!==e&&(i=e||"",[,r,l]=xi(n,i,t)),!t)return r;if(r==0)return{score:r,item:i};let d=Array(i.length).fill(0);l.forEach(g=>d[g]=1);let u="",p="",y=()=>{if(!p)return"";let g=`<mark>${p}</mark>`;return p="",g};return d.forEach((g,v)=>{g?p+=i[v]:(u+=y(),u+=i[v])}),u+=y(),{score:r,marked_string:u}};frappe.ui.form.ControlLink=class extends frappe.ui.form.ControlLink{make_input(){var e=this;$(`<div class="link-field ui-front" style="position: relative;">
			<input type="text" class="input-with-feedback form-control">
			<span class="link-btn">
				<a class="btn-open no-decoration" title="${__("Open Link")}">
					${frappe.utils.icon("arrow-right","xs")}
				</a>
			</span>
		</div>`).prependTo(this.input_area),this.$input_area=$(this.input_area),this.$input=this.$input_area.find("input"),this.$link=this.$input_area.find(".link-btn"),this.$link_open=this.$link.find(".btn-open"),this.set_input_attributes(),this.$input.on("focus",function(){setTimeout(function(){if(e.$input.val()&&e.get_options()){let t=e.get_options(),i=e.doc?e.doc[e.df.fieldname]:e.$input.attr("data-value"),r=i||e.get_input_value();e.$link.toggle(!0),e.$link_open.attr("href",frappe.utils.get_form_link(t,r))}e.$input.val()||(e.$input.val("").trigger("input"),e.$link.toggle(!1))},500)}),this.$input.on("blur",function(){setTimeout(function(){e.$link.toggle(!1)},500)}),this.$input.attr("data-target",this.df.options),this.input=this.$input.get(0),this.has_input=!0,this.translate_values=!0,this.setup_buttons(),this.setup_awesomeplete(),this.bind_change_event()}setup_awesomeplete(){let e=this;this.$input.cache={},this.awesomplete=new Awesomplete(e.input,{tabSelect:!0,minChars:0,maxItems:99,autoFirst:!0,list:[],replace:function(t){this.input.value=e.get_translated(t.label||t.value)},data:function(t){return{label:e.get_translated(t.label||t.value),value:t.value}},filter:function(){return!0},item:function(t){let i=this.get_item(t.value);i.label||(i.label=i.value);let r=e.get_translated(i.label),l=i.html||"<strong>"+r+"</strong>";return i.description&&(e.is_title_link()||i.value!==i.description)&&(l+='<br><span class="small">'+__(i.description)+"</span>"),$("<li></li>").data("item.autocomplete",i).prop("aria-selected","false").html(`<a><p title="${frappe.utils.escape_html(r)}">${l}</p></a>`).get(0)},sort:function(){return 0}}),this.custom_awesomplete_filter&&this.custom_awesomplete_filter(this.awesomplete),this.$input.on("input",frappe.utils.debounce(function(t){var i=e.get_options();if(!!i){e.$input.cache[i]||(e.$input.cache[i]={});var r=t.target.value;e.$input.cache[i][r]!=null&&(e.awesomplete.list=e.$input.cache[i][r]);var l={txt:r,doctype:i,ignore_user_permissions:e.df.ignore_user_permissions,reference_doctype:e.get_reference_doctype()||""};e.set_custom_query(l),frappe.call({type:"POST",method:"frappe.desk.search.search_link",no_spinner:!0,args:l,callback:function(d){if(!window.Cypress&&!e.$input.is(":focus"))return;d.message=e.merge_duplicates(d.message);let u=e.df.filter_description?e.df.filter_description:l.filters?e.get_filter_description(l.filters):null;if(u&&d.message.push({html:`<span class="text-muted" style="line-height: 1.5">${u}</span>`,value:"",action:()=>{}}),!e.df.only_select){frappe.model.can_create(i)&&d.message.push({html:"<span class='link-option'><i class='fa fa-plus' style='margin-right: 5px;'></i> "+__("Create a new {0}",[__(e.get_options())])+"</span>",label:__("Create a new {0}",[__(e.get_options())]),value:"create_new__link_option",action:e.new_doc});let p=frappe.ui.form.ControlLink.link_options&&frappe.ui.form.ControlLink.link_options(e);p&&(d.message=d.message.concat(p)),locals&&locals.DocType&&d.message.push({html:"<span class='link-option'><i class='fa fa-search' style='margin-right: 5px;'></i> "+__("Advanced Search")+"</span>",label:__("Advanced Search"),value:"advanced_search__link_option",action:e.open_advanced_search})}e.$input.cache[i][r]=d.message,e.awesomplete.list=e.$input.cache[i][r],e.toggle_href(i)}})}},500)),this.$input.on("blur",function(){if(e.selected){e.selected=!1;return}let t=e.get_input_value(),i=e.get_label_value(),r=e.last_value||"",l=e.label||"",d=e.doc?e.doc[e.df.fieldname]:e.$input.attr("data-value"),u=__(d)!=t?t:d;u!==r&&e.parse_validate_and_set_in_model(u,null,i)}),this.$input.on("awesomplete-open",()=>{this.autocomplete_open=!0,e.get_label_value()||e.$link.toggle(!1)}),this.$input.on("awesomplete-close",t=>{this.autocomplete_open=!1,e.get_label_value()||e.$link.toggle(!1)}),this.$input.on("awesomplete-select",function(t){var i=t.originalEvent,r=e.awesomplete.get_item(i.text.value);e.autocomplete_open=!1;let l=9;if(t.keyCode===l)return t.preventDefault(),e.awesomplete.close(),!1;r.action&&(r.value="",r.label="",r.action.apply(e)),e.df.remember_last_selected_value&&(frappe.boot.user.last_selected_values[e.df.options]=r.value),e.parse_validate_and_set_in_model(r.value,null,r.label)}),this.$input.on("awesomplete-selectcomplete",function(t){t.originalEvent.text.value.indexOf("__link_option")!==-1&&e.$input.val("")})}get_filter_description(e){let t=this.get_options(),i=[],r=null;if(frappe.model.with_doctype(t,()=>{r=frappe.get_meta(t)}),Array.isArray(e))i=e;else for(let u in e){let p=e[u];Array.isArray(p)||(p=["=",p]),i.push([u,...p])}i=i.map(u=>u.length===3?[t,...u]:u);function l(u){let p=u[0],y=u[1],g=frappe.meta.get_docfield(p,y),v=g?g.label:frappe.model.unscrub(y);g&&g.fieldtype==="Check"&&(u[3]=u[3]?__("Yes"):__("No")),u[3]&&Array.isArray(u[3])&&u[3].length>5&&(u[3]=u[3].slice(0,5),u[3].push("..."));let w=u[3]==null||u[3]===""?__("empty"):u[3];return[__(v).bold(),__(u[2]),(Array.isArray(u[3])?String(w.map(k=>__(k))):String(__(w))).bold()].join(" ")}let d=i.map(l).join(", ");return __("Filters applied for {0}",[d])}set_formatted_input(e){var t=this;t.$input&&t.$input.attr("data-value",e===void 0?"":e),t.$input&&t.$input.val(t.format_for_input(__(e))),super.set_formatted_input(e)}get_value(){let e=this,t=e.doc?e.doc[e.df.fieldname]:e.$input?e.$input.attr("data-value"):void 0,i=t||e.get_input_value();return this.get_status()==="Write"?this.parse?this.parse(i):i:i||this.value||null}};frappe.ui.form.ControlAutocomplete=class extends frappe.ui.form.ControlAutocomplete{setup_awesomplete(){let e=super.setup_awesomplete()||{};return Object.assign(e,{filter:function(t,i){let r=t.value;return __(t.value)!=t.value&&(r+=__(t.value)),Awesomplete.FILTER_CONTAINS(r,i)}})}set_formatted_input(e){var t=this;e&&t.$input&&t.$input.attr("data-value",e===void 0?"":e),e&&t.$input&&t.$input.val(t.format_for_input(__(e)))}get_value(){let e=this,t=e.$input&&e.$input.attr("data-value")?e.$input.attr("data-value"):e.doc?e.doc[e.df.fieldname]:void 0,i=t||e.get_input_value();return this.get_status()==="Write"?this.parse?this.parse(i):i:i||void 0}get_parsed_value(e){let t=this;if(t.doc){let i=t.$input&&t.$input.attr("data-value")?t.$input.attr("data-value"):t.doc?t.doc[t.df.fieldname]:void 0;e=i||t.get_input_value()}else e=super.get_parsed_value(e);return e}};frappe.ui.FieldSelect=class extends frappe.ui.FieldSelect{init(e){super.init(e),this.awesomplete.filter=function(t,i){if(!i)return;let r=t.label+t.value;return Awesomplete.FILTER_CONTAINS(r,i)}}};frappe.ui.form.add_options=function(n,e){let t=$(n);if(!Array.isArray(e))return t;for(var i=0,r=e.length;i<r;i++){var l=e[i],d=null,u=null;if(!is_null(l)){var p=is_null(l.value),y=is_null(l.label),g=Boolean(l.disabled),v=Boolean(l.selected);if(p&&y)if(l&&typeof l=="string"&&l.includes(";")){let w=l.split(";");d=w[0],u=__(w.slice(-1)[0])}else d=l,u=__(l);else d=p?"":l.value,u=y?__(d):__(l.label)}$("<option>").html(cstr(u)).attr("value",d).prop("disabled",g).prop("selected",v).appendTo(t.get(0))}return t.get(0).selectedIndex=0,t.trigger("select-change"),t};(function(n){n.fn.add_options=function(t){for(var i=0,r=t.length;i<r;i++){var l=t[i],d=null,u=null;if(!is_null(l)){var p=is_null(l.value),y=is_null(l.label),g=Boolean(l.disabled);if(p&&y)if(l&&typeof l=="string"&&l.includes(";")){let v=l.split(";");d=v[0],u=__(v.slice(-1)[0])}else d=l,u=__(l);else d=p?"":l.value,u=y?__(d):__(l.label)}n("<option>").html(cstr(u)).attr("value",d).prop("disabled",g).appendTo(this)}return this.selectedIndex=0,n(this).trigger("select-change"),n(this)},n.fn.set_working=function(){this.prop("disabled",!0)},n.fn.done_working=function(){this.prop("disabled",!1)};let e=n.fn.val;n.fn.val=function(){let t=e.apply(this,arguments);return arguments.length>0&&n(this).trigger("select-change"),t}})(jQuery);frappe.ui.form.ControlDateRange=class extends frappe.ui.form.ControlDateRange{set_date_options(){super.set_date_options();let e="en";frappe.boot.user&&(e=frappe.boot.user.language),$.fn.datepicker.language[e]&&(this.datepicker_options.language=e)}};frappe.ui.form.ControlTable=class extends frappe.ui.form.ControlTable{make(){super.make(),this.$wrapper.off("paste",":text"),this.$wrapper.on("paste",":text",e=>{let t=this.df.fieldname,i=this.grid,r=i.grid_pagination,l=i.grid_rows,d=i.doctype,u=$(e.target).closest(".grid-row").data("name"),p=$(e.target).closest(".form-in-grid").length,y=frappe.utils.get_clipboard_data(e);if(!y||p)return;let g=frappe.utils.csv_to_array(y,"	");if(g.length===1&&g[0].length===1)return;let v=[];if(this.get_field(g[0][0]))g[0].forEach(C=>{v.push(this.get_field(C))}),g.shift();else{let C=l[0].get_visible_columns(),x=!1;C.forEach(L=>{(x||L.fieldname===$(e.target).data("fieldname"))&&(v.push(L.fieldname),x=!0)})}let w=locals[d][u].idx,k=g.length;return g.forEach((C,x)=>{setTimeout(()=>{if(!!C.filter(Boolean).length){w>this.frm.doc[t].length&&this.grid.add_new_row(),w>1&&(w-1)%r.page_length===0&&r.go_to_page(r.page_index+1);let A=l[w-1].doc.name;C.forEach((W,q)=>{let M=v[q];if(M){if(W){let T=frappe.meta.get_field(d,M).fieldtype;W=T&&T==="Text Editor"?W.replace(/[\n\r]/g,"<br>"):W}frappe.model.set_value(d,A,M,W)}}),w++}if(k>=10){let A=x+1;frappe.show_progress(__("Processing"),A,k,null,!0)}},0)}),!1})}};frappe.provide("frappe.form.formatters");frappe.form.formatters.Datetime=function(n){if(n){var e=moment(frappe.datetime.convert_to_user_tz(n));return frappe.boot.sysdefaults.time_zone&&(e=e.tz(frappe.boot.sysdefaults.time_zone)),e.format(frappe.boot.sysdefaults.date_format.toUpperCase()+" HH:mm:ss")}else return""};frappe.form.formatters.Data=function(n,e){return e&&e.options=="URL"?n?`<a href="${n}" title="Open Link" target="_blank">${n}</a>`:void 0:(n=n==null?"":__(n),frappe.form.formatters._apply_custom_formatter(n,e))};frappe.form.formatters.MultiSelect=function(n){if(typeof n=="string")return __(n);if(Array.isArray(n))return n.map(e=>__(e))};var ys=Ms(vs()),aa={headerDropdown:[{label:__("Sort Ascending"),action:function(n){this.sortColumn(n.colIndex,"asc")}},{label:__("Sort Descending"),action:function(n){this.sortColumn(n.colIndex,"desc")}},{label:__("Reset sorting"),action:function(n){this.sortColumn(n.colIndex,"none")}},{label:__("Remove column"),action:function(n){this.removeColumn(n.colIndex)}}]},Vt=class extends ys.default{buildOptions(e){super.buildOptions(e),this.options.headerDropdown=[...aa.headerDropdown,...e.headerDropdown]}},Na=class extends frappe.views.QueryReport{render_datatable(){let e=this.data,t=this.columns.filter(i=>!i.hidden);if(this.raw_data.add_total_row&&(e=e.slice(),e.splice(-1,1)),this.$report.show(),this.datatable&&this.datatable.options&&this.datatable.options.showTotalRow===this.raw_data.add_total_row)this.datatable.options.treeView=this.tree_report,this.datatable.refresh(e,t);else{let i={columns:t,data:e,inlineFilters:!0,treeView:this.tree_report,layout:"fixed",cellHeight:33,showTotalRow:this.raw_data.add_total_row,direction:frappe.utils.is_rtl()?"rtl":"ltr",hooks:{columnTotal:frappe.utils.report_column_total}};this.report_settings.get_datatable_options&&(i=this.report_settings.get_datatable_options(i)),this.datatable=new Vt(this.$report[0],i)}typeof this.report_settings.initial_depth=="number"&&this.datatable.rowmanager.setTreeDepth(this.report_settings.initial_depth),this.report_settings.after_datatable_render&&this.report_settings.after_datatable_render(this.datatable)}},Ha=class extends frappe.views.ReportView{setup_datatable(e){this.$datatable_wrapper.empty(),this.datatable=new Vt(this.$datatable_wrapper[0],{columns:this.columns,data:this.get_data(e),getEditor:this.get_editing_object.bind(this),checkboxColumn:!0,inlineFilters:!0,cellHeight:35,direction:frappe.utils.is_rtl()?"rtl":"ltr",events:{onRemoveColumn:t=>{this.remove_column_from_datatable(t)},onSwitchColumn:(t,i)=>{this.switch_column(t,i)},onCheckRow:()=>{let t=this.get_checked_items();this.toggle_actions_menu_button(t.length>0)}},hooks:{columnTotal:frappe.utils.report_column_total},headerDropdown:[{label:__("Add Column"),action:t=>{let i=[],r=this.get_columns_for_picker();i=r[this.doctype].filter(d=>!this.is_column_added(d)).map(d=>({label:__(d.label),value:d.fieldname})),delete r[this.doctype];for(let d in r)r[d].filter(u=>!this.is_column_added(u)).map(u=>({label:__(u.label)+` (${d})`,value:u.fieldname+","+d})).forEach(u=>i.push(u));let l=new frappe.ui.Dialog({title:__("Add Column"),fields:[{label:__("Select Column"),fieldname:"column",fieldtype:"Autocomplete",options:i},{label:__("Insert Column Before {0}",[t.docfield.label.bold()]),fieldname:"insert_before",fieldtype:"Check"}],primary_action:({column:d,insert_before:u})=>{if(!i.map(g=>g.value).includes(d)){frappe.show_alert({message:__("Invalid column"),indicator:"orange"}),l.hide();return}let p=this.doctype;d.includes(",")&&([d,p]=d.split(","));let y=t.colIndex;u&&(y=y-1),this.add_column_to_datatable(d,p,y),l.hide()}});l.show()}}]})}};var la=class extends frappe.views.GanttView{get required_libs(){return["assets/erpnext_oob/js/lib/gantt/frappe-gantt.css","assets/erpnext_oob/js/lib/gantt/frappe-gantt.min.js"]}};frappe.views.GanttView=la;erpnext.stock.StockController.prototype.show_general_ledger=function(){var n=this;this.frm.doc.docstatus>0&&cur_frm.add_custom_button(__("Accounting Ledger"),function(){frappe.route_options={voucher_no:n.frm.doc.name,from_date:n.frm.doc.posting_date,to_date:moment(n.frm.doc.modified).format("YYYY-MM-DD"),company:n.frm.doc.company,show_cancelled_entries:n.frm.doc.docstatus===2},frappe.set_route("query-report","General Ledger")},__("View"))};})();
/*! Sortable 1.15.0 - MIT | git://github.com/SortableJS/Sortable.git */
//# sourceMappingURL=erpnext_oob.bundle.HLYWSS2M.js.map
