(()=>{var Bi=Object.create;var Yt=Object.defineProperty;var qi=Object.getOwnPropertyDescriptor;var Vi=Object.getOwnPropertyNames;var Yi=Object.getPrototypeOf,Xi=Object.prototype.hasOwnProperty;var Xt=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Gi=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Vi(e))!Xi.call(r,s)&&s!==t&&Yt(r,s,{get:()=>e[s],enumerable:!(i=qi(e,s))||i.enumerable});return r};var Ui=(r,e,t)=>(t=r!=null?Bi(Yi(r)):{},Gi(e||!r||!r.__esModule?Yt(t,"default",{value:r,enumerable:!0}):t,r));var ri=Xt((Xo,Xe)=>{(function(e){"use strict";typeof define=="function"&&define.amd?define(e):typeof Xe!="undefined"&&typeof Xe.exports!="undefined"?Xe.exports=e():window.Sortable=e()})(function(){"use strict";if(typeof window=="undefined"||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var e,t,i,s,n,a,c,u,g,b,m,_,v,y,C=[],R=!1,I=!1,N=!1,A=[],z,F,E,V,P,se,re,ve,Ce=!1,He=!1,ue,Le,St,pe,Tt=/\s+/g,G="Sortable"+new Date().getTime(),q=window,D=q.document,le=q.parseInt,fe=q.setTimeout,Rt=q.jQuery||q.Zepto,st=q.Polymer,Dt={capture:!1,passive:!1},te=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),Me=!!navigator.userAgent.match(/Edge/i),It=Me||te?"cssFloat":"float",Di="draggable"in D.createElement("div"),rt=function(){if(te)return!1;var o=D.createElement("x");return o.style.cssText="pointer-events:auto",o.style.pointerEvents==="auto"}(),nt=!1,ot=!1,ne=Math.abs,Et=Math.min,Ne=[],Ht=function(o,d){var l=H(o),p=le(l.width),f=ct(o,0,d),w=ct(o,1,d),x=f&&H(f),S=w&&H(w),k=x&&le(x.marginLeft)+le(x.marginRight)+B(f).width,T=S&&le(S.marginLeft)+le(S.marginRight)+B(w).width;if(l.display==="flex")return l.flexDirection==="column"||l.flexDirection==="column-reverse"?"vertical":"horizontal";if(f&&x.float!=="none"){var L=x.float==="left"?"left":"right";return w&&(S.clear==="both"||S.clear===L)?"vertical":"horizontal"}return f&&(x.display==="block"||x.display==="flex"||x.display==="table"||x.display==="grid"||k>=p&&l[It]==="none"||w&&l[It]==="none"&&k+T>p)?"vertical":"horizontal"},Ii=function(o,d){for(var l=0;l<A.length;l++)if(!A[l].children.length){var p=B(A[l]),f=A[l][G].options.emptyInsertThreshold,w=o>=p.left-f&&o<=p.right+f,x=d>=p.top-f&&d<=p.bottom+f;if(w&&x)return A[l]}},Ei=function(o,d,l,p,f){var w=B(l),x=p==="vertical"?w.left:w.top,S=p==="vertical"?w.right:w.bottom,k=p==="vertical"?o:d;return x<k&&k<S},Hi=function(o,d,l){var p=o===e&&pe||B(o),f=d===e&&pe||B(d),w=l==="vertical"?p.left:p.top,x=l==="vertical"?p.right:p.bottom,S=l==="vertical"?p.width:p.height,k=l==="vertical"?f.left:f.top,T=l==="vertical"?f.right:f.bottom,L=l==="vertical"?f.width:f.height;return w===k||x===T||w+S/2===k+L/2},de=function(o,d){if(!o||!o.getBoundingClientRect)return q;var l=o,p=!1;do if(l.clientWidth<l.scrollWidth||l.clientHeight<l.scrollHeight){var f=H(l);if(l.clientWidth<l.scrollWidth&&(f.overflowX=="auto"||f.overflowX=="scroll")||l.clientHeight<l.scrollHeight&&(f.overflowY=="auto"||f.overflowY=="scroll")){if(!l||!l.getBoundingClientRect||l===D.body)return q;if(p||d)return l;p=!0}}while(l=l.parentNode);return q},at=qt(function(o,d,l,p){if(d.scroll){var f=l?l[G]:window,w=d.scrollSensitivity,x=d.scrollSpeed,S=o.clientX,k=o.clientY,T=window.innerWidth,L=window.innerHeight,M=!1;g!==l&&(Oe(),u=d.scroll,b=d.scrollFn,u===!0&&(u=de(l,!0),g=u));var W=0,U=u;do{var Y=U,Z=B(Y),xe=Z.top,pt=Z.bottom,ke=Z.left,Fe=Z.right,_e=Z.width,oe=Z.height,ie,Se,ee,je,We,ft,_t,Pe,ze;if(Y!==q?(ie=Y.scrollWidth,Se=Y.scrollHeight,ee=H(Y),ft=_e<ie&&(ee.overflowX==="auto"||ee.overflowX==="scroll"),_t=oe<Se&&(ee.overflowY==="auto"||ee.overflowY==="scroll"),Pe=Y.scrollLeft,ze=Y.scrollTop):(ie=D.documentElement.scrollWidth,Se=D.documentElement.scrollHeight,ee=H(D.documentElement),ft=_e<ie&&(ee.overflowX==="auto"||ee.overflowX==="scroll"||ee.overflowX==="visible"),_t=oe<Se&&(ee.overflowY==="auto"||ee.overflowY==="scroll"||ee.overflowY==="visible"),Pe=D.documentElement.scrollLeft,ze=D.documentElement.scrollTop),je=ft&&(ne(Fe-S)<=w&&Pe+_e<ie)-(ne(ke-S)<=w&&!!Pe),We=_t&&(ne(pt-k)<=w&&ze+oe<Se)-(ne(xe-k)<=w&&!!ze),!C[W])for(var Be=0;Be<=W;Be++)C[Be]||(C[Be]={});(C[W].vx!=je||C[W].vy!=We||C[W].el!==Y)&&(C[W].el=Y,C[W].vx=je,C[W].vy=We,clearInterval(C[W].pid),Y&&(je!=0||We!=0)&&(M=!0,C[W].pid=setInterval(function(){p&&this.layer===0&&X.active._emulateDragOver(!0);var mt=C[this.layer].vy?C[this.layer].vy*x:0,gt=C[this.layer].vx?C[this.layer].vx*x:0;typeof b=="function"&&b.call(f,gt,mt,o,P,C[this.layer].el)!=="continue"||(C[this.layer].el===q?q.scrollTo(q.pageXOffset+gt,q.pageYOffset+mt):(C[this.layer].el.scrollTop+=mt,C[this.layer].el.scrollLeft+=gt))}.bind({layer:W}),24))),W++}while(d.bubbleScroll&&U!==q&&(U=de(U,!1)));R=M}},30),Oe=function(){C.forEach(function(o){clearInterval(o.pid)}),C=[]},Lt=function(o){function d(f,w){return function(x,S,k,T){var L=x.options.group.name&&S.options.group.name&&x.options.group.name===S.options.group.name;if(f==null&&(w||L))return!0;if(f==null||f===!1)return!1;if(w&&f==="clone")return f;if(typeof f=="function")return d(f(x,S,k,T),w)(x,S,k,T);var M=(w?x:S).options.group.name;return f===!0||typeof f=="string"&&f===M||f.join&&f.indexOf(M)>-1}}var l={},p=o.group;(!p||typeof p!="object")&&(p={name:p}),l.name=p.name,l.checkPull=d(p.pull,!0),l.checkPut=d(p.put),l.revertClone=p.revertClone,o.group=l},Mt=function(o){!e||!e.parentNode||e.parentNode[G]&&e.parentNode[G]._computeIsAligned(o)},Nt=function(o,d){for(var l=d;!l[G];)l=l.parentNode;return o===l},Ot=function(o,d,l){for(var p=o.parentNode;p&&!p[G];)p=p.parentNode;p&&p[G][l](ht(d,{artificialBubble:!0}))},At=function(){!rt&&i&&H(i,"display","none")},Ft=function(){!rt&&i&&H(i,"display","")};D.addEventListener("click",function(o){if(N)return o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.stopImmediatePropagation&&o.stopImmediatePropagation(),N=!1,!1},!0);var lt=function(o){if(o=o.touches?o.touches[0]:o,e){var d=Ii(o.clientX,o.clientY);d&&d[G]._onDragOver({clientX:o.clientX,clientY:o.clientY,target:d,rootEl:d})}};O(D,"dragover",lt),O(D,"mousemove",lt),O(D,"touchmove",lt);function X(o,d){if(!(o&&o.nodeType&&o.nodeType===1))throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(o);this.el=o,this.options=d=ht({},d),o[G]=this;var l={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(o.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ht(o,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(w,x){w.setData("Text",x.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:le(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:X.supportPointer!==!1&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(var p in l)!(p in d)&&(d[p]=l[p]);Lt(d);for(var f in this)f.charAt(0)==="_"&&typeof this[f]=="function"&&(this[f]=this[f].bind(this));this.nativeDraggable=d.forceFallback?!1:Di,d.supportPointer?O(o,"pointerdown",this._onTapStart):(O(o,"mousedown",this._onTapStart),O(o,"touchstart",this._onTapStart)),this.nativeDraggable&&(O(o,"dragover",this),O(o,"dragenter",this)),A.push(this.el),d.store&&d.store.get&&this.sort(d.store.get(this)||[])}X.prototype={constructor:X,_computeIsAligned:function(o){var d;if(i&&!rt?(At(),d=D.elementFromPoint(o.clientX,o.clientY),Ft()):d=o.target,d=K(d,this.options.draggable,this.el,!1),!ot&&!(!e||e.parentNode!==this.el)){for(var l=this.el.children,p=0;p<l.length;p++)K(l[p],this.options.draggable,this.el,!1)&&l[p]!==d&&(l[p].sortableMouseAligned=Ei(o.clientX,o.clientY,l[p],this._getDirection(o,null),this.options));K(d,this.options.draggable,this.el,!0)||(re=null),ot=!0,fe(function(){ot=!1},30)}},_getDirection:function(o,d){return typeof this.options.direction=="function"?this.options.direction.call(this,o,d,e):this.options.direction},_onTapStart:function(o){if(!!o.cancelable){var d=this,l=this.el,p=this.options,f=p.preventOnFilter,w=o.type,x=o.touches&&o.touches[0],S=(x||o).target,k=o.target.shadowRoot&&(o.path&&o.path[0]||o.composedPath&&o.composedPath()[0])||S,T=p.filter,L;if(Pi(l),!(te&&!o.artificialBubble&&!Nt(l,S))&&!e&&!(/mousedown|pointerdown/.test(w)&&o.button!==0||p.disabled)&&!k.isContentEditable){if(S=K(S,p.draggable,l,!1),!S){te&&Ot(l,o,"_onTapStart");return}if(c!==S){if(L=he(S,p.draggable),typeof T=="function"){if(T.call(this,o,S,this)){J(d,k,"filter",S,l,l,L),f&&o.cancelable&&o.preventDefault();return}}else if(T&&(T=T.split(",").some(function(M){if(M=K(k,M.trim(),l,!1),M)return J(d,M,"filter",S,l,l,L),!0}),T)){f&&o.cancelable&&o.preventDefault();return}p.handle&&!K(k,p.handle,l,!1)||this._prepareDragStart(o,x,S,L)}}}},_handleAutoScroll:function(o,d){if(!(!e||!this.options.scroll)){var l=o.clientX,p=o.clientY,f=D.elementFromPoint(l,p),w=this;if(d||Me||te){at(o,w.options,f,d);var x=de(f,!0);R&&(!z||l!==F||p!==E)&&(z&&clearInterval(z),z=setInterval(function(){if(!!e){var S=de(D.elementFromPoint(l,p),!0);S!==x&&(x=S,Oe(),at(o,w.options,x,d))}},10),F=l,E=p)}else{if(!w.options.bubbleScroll||de(f,!0)===window){Oe();return}at(o,w.options,de(f,!1),!1)}}},_prepareDragStart:function(o,d,l,p){var f=this,w=f.el,x=f.options,S=w.ownerDocument,k;l&&!e&&l.parentNode===w&&(n=w,e=l,t=e.parentNode,a=e.nextSibling,c=l,v=x.group,m=p,V={target:e,clientX:(d||o).clientX,clientY:(d||o).clientY},this._lastX=(d||o).clientX,this._lastY=(d||o).clientY,e.style["will-change"]="all",e.style.transition="",e.style.transform="",k=function(){f._disableDelayedDrag(),e.draggable=f.nativeDraggable,f._triggerDragStart(o,d),J(f,n,"choose",e,n,n,m),Q(e,x.chosenClass,!0)},x.ignore.split(",").forEach(function(T){jt(e,T.trim(),Pt)}),x.supportPointer?O(S,"pointerup",f._onDrop):(O(S,"mouseup",f._onDrop),O(S,"touchend",f._onDrop),O(S,"touchcancel",f._onDrop)),x.delay?(O(S,"mouseup",f._disableDelayedDrag),O(S,"touchend",f._disableDelayedDrag),O(S,"touchcancel",f._disableDelayedDrag),O(S,"mousemove",f._delayedDragTouchMoveHandler),O(S,"touchmove",f._delayedDragTouchMoveHandler),x.supportPointer&&O(S,"pointermove",f._delayedDragTouchMoveHandler),f._dragStartTimer=fe(k,x.delay)):k())},_delayedDragTouchMoveHandler:function(o){var d=o.touches?o.touches[0]:o;Et(ne(d.clientX-this._lastX),ne(d.clientY-this._lastY))>=this.options.touchStartThreshold&&this._disableDelayedDrag()},_disableDelayedDrag:function(){var o=this.el.ownerDocument;clearTimeout(this._dragStartTimer),j(o,"mouseup",this._disableDelayedDrag),j(o,"touchend",this._disableDelayedDrag),j(o,"touchcancel",this._disableDelayedDrag),j(o,"mousemove",this._delayedDragTouchMoveHandler),j(o,"touchmove",this._delayedDragTouchMoveHandler),j(o,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(o,d){d=d||(o.pointerType=="touch"?o:null),!this.nativeDraggable||d?this.options.supportPointer?O(D,"pointermove",this._onTouchMove):d?O(D,"touchmove",this._onTouchMove):O(D,"mousemove",this._onTouchMove):(O(e,"dragend",this),O(n,"dragstart",this._onDragStart));try{D.selection?Ae(function(){D.selection.empty()}):window.getSelection().removeAllRanges()}catch(l){}},_dragStarted:function(o){if(I=!1,n&&e){this.nativeDraggable&&(O(D,"dragover",this._handleAutoScroll),O(D,"dragover",Mt));var d=this.options;!o&&Q(e,d.dragClass,!1),Q(e,d.ghostClass,!0),H(e,"transform",""),X.active=this,o&&this._appendGhost(),J(this,n,"start",e,n,n,m)}else this._nulling()},_emulateDragOver:function(o){if(P){if(this._lastX===P.clientX&&this._lastY===P.clientY&&!o)return;this._lastX=P.clientX,this._lastY=P.clientY,At();for(var d=D.elementFromPoint(P.clientX,P.clientY),l=d;d&&d.shadowRoot;)d=d.shadowRoot.elementFromPoint(P.clientX,P.clientY),l=d;if(l)do{if(l[G]){var p;if(p=l[G]._onDragOver({clientX:P.clientX,clientY:P.clientY,target:d,rootEl:l}),p&&!this.options.dragoverBubble)break}d=l}while(l=l.parentNode);e.parentNode[G]._computeIsAligned(P),Ft()}},_onTouchMove:function(o){if(V){var d=this.options,l=d.fallbackTolerance,p=d.fallbackOffset,f=o.touches?o.touches[0]:o,w=i&&dt(i),x=i&&w&&w.a,S=i&&w&&w.d,k=(f.clientX-V.clientX+p.x)/(x||1),T=(f.clientY-V.clientY+p.y)/(S||1),L=o.touches?"translate3d("+k+"px,"+T+"px,0)":"translate("+k+"px,"+T+"px)";if(!X.active&&!I){if(l&&Et(ne(f.clientX-this._lastX),ne(f.clientY-this._lastY))<l)return;this._onDragStart(o,!0)}this._handleAutoScroll(f,!0),se=!0,P=f,H(i,"webkitTransform",L),H(i,"mozTransform",L),H(i,"msTransform",L),H(i,"transform",L),o.cancelable&&o.preventDefault()}},_appendGhost:function(){if(!i){var o=B(e,this.options.fallbackOnBody?D.body:n,!0),d=H(e),l=this.options;i=e.cloneNode(!0),Q(i,l.ghostClass,!1),Q(i,l.fallbackClass,!0),Q(i,l.dragClass,!0),H(i,"box-sizing","border-box"),H(i,"margin",0),H(i,"top",o.top),H(i,"left",o.left),H(i,"width",o.width),H(i,"height",o.height),H(i,"opacity","0.8"),H(i,"position","fixed"),H(i,"zIndex","100000"),H(i,"pointerEvents","none"),l.fallbackOnBody&&D.body.appendChild(i)||n.appendChild(i)}},_onDragStart:function(o,d){var l=this,p=o.dataTransfer,f=l.options;s=Vt(e),s.draggable=!1,s.style["will-change"]="",this._hideClone(),Q(s,l.options.chosenClass,!1),l._cloneId=Ae(function(){l.options.removeCloneOnHide||n.insertBefore(s,e),J(l,n,"clone",e)}),!d&&Q(e,f.dragClass,!0),d?(N=!0,l._loopId=setInterval(l._emulateDragOver,50)):(j(D,"mouseup",l._onDrop),j(D,"touchend",l._onDrop),j(D,"touchcancel",l._onDrop),p&&(p.effectAllowed="move",f.setData&&f.setData.call(l,p,e)),O(D,"drop",l),H(e,"transform","translateZ(0)")),I=!0,l._dragStartId=Ae(l._dragStarted.bind(l,d)),O(D,"selectstart",l)},_onDragOver:function(o){var d=this.el,l=o.target,p,f,w,x=this.options,S=x.group,k=X.active,T=v===S,L=x.sort,M=this;if(nt||te&&!o.rootEl&&!o.artificialBubble&&!Nt(d,l))return;function W(){return k&&(Q(e,y?y.options.ghostClass:k.options.ghostClass,!1),Q(e,x.ghostClass,!0)),y!==M&&M!==X.active?y=M:M===X.active&&(y=null),(l===e&&!e.animated||l===d&&!l.animated)&&(re=null),!x.dragoverBubble&&!o.rootEl&&l!==D&&(M._handleAutoScroll(o),e.parentNode[G]._computeIsAligned(o)),!x.dragoverBubble&&o.stopPropagation&&o.stopPropagation(),!0}function U(){J(M,n,"change",l,d,n,m,he(e,x.draggable),o)}if(o.preventDefault!==void 0&&o.cancelable&&o.preventDefault(),se=!0,l=K(l,x.draggable,d,!0),!!K(o.target,null,e,!0)||l.animated)return W();if(l!==e&&(N=!1),k&&!x.disabled&&(T?L||(w=!n.contains(e)):y===this||(this.lastPutMode=v.checkPull(this,k,e,o))&&S.checkPut(this,k,e,o))){var Y=this._getDirection(o,l);if(p=B(e),w)return this._hideClone(),t=n,a?n.insertBefore(e,a):n.appendChild(e),W();if(d.children.length===0||d.children[0]===i||Oi(o,Y,d)&&!e.animated){if(d.children.length!==0&&d.children[0]!==i&&d===o.target&&(l=zt(d)),l&&(f=B(l)),T?k._hideClone():k._showClone(this),Wt(n,d,e,p,l,f,o,!!l)!==!1)return d.appendChild(e),t=d,pe=null,U(),this._animate(p,e),l&&this._animate(f,l),W()}else if(l&&l!==e&&l.parentNode===d){var Z=0,xe,pt=l.sortableMouseAligned,ke=e.parentNode!==d,Fe=zi(l,Y==="vertical"?"top":"left");if(re!==l&&(ue=null,xe=B(l)[Y==="vertical"?"top":"left"],Ce=!1),Hi(e,l,Y)&&pt||ke||Fe||x.invertSwap||ue==="insert"||ue==="swap"?(ue!=="swap"&&(He=x.invertSwap||ke||R||Fe),Z=Ai(o,l,Y,x.swapThreshold,x.invertedSwapThreshold==null?x.swapThreshold:x.invertedSwapThreshold,He,re===l),ue="swap"):(Z=Fi(l,x),ue="insert"),Z===0)return W();pe=null,re=l,ve=Z,f=B(l);var _e=l.nextElementSibling,oe=!1;oe=Z===1;var ie=Wt(n,d,e,p,l,f,o,oe);if(ie!==!1)return(ie===1||ie===-1)&&(oe=ie===1),nt=!0,fe(Ni,30),T?k._hideClone():k._showClone(this),oe&&!_e?d.appendChild(e):l.parentNode.insertBefore(e,oe?_e:l),t=e.parentNode,xe!==void 0&&!He&&(Le=ne(xe-B(l)[Y==="vertical"?"top":"left"])),U(),!ke&&this._animate(f,l),this._animate(p,e),W()}if(d.contains(e))return W()}return te&&!o.rootEl&&Ot(d,o,"_onDragOver"),!1},_animate:function(o,d){var l=this.options.animation;if(l){var p=B(d);if(d===e&&(pe=p),o.nodeType===1&&(o=B(o)),o.left+o.width/2!==p.left+p.width/2||o.top+o.height/2!==p.top+p.height/2){var f=dt(this.el),w=f&&f.a,x=f&&f.d;H(d,"transition","none"),H(d,"transform","translate3d("+(o.left-p.left)/(w||1)+"px,"+(o.top-p.top)/(x||1)+"px,0)"),St=d.offsetWidth,H(d,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),H(d,"transform","translate3d(0,0,0)")}typeof d.animated=="number"&&clearTimeout(d.animated),d.animated=fe(function(){H(d,"transition",""),H(d,"transform",""),d.animated=!1},l)}},_offUpEvents:function(){var o=this.el.ownerDocument;j(D,"touchmove",this._onTouchMove),j(D,"pointermove",this._onTouchMove),j(o,"mouseup",this._onDrop),j(o,"touchend",this._onDrop),j(o,"pointerup",this._onDrop),j(o,"touchcancel",this._onDrop),j(D,"selectstart",this)},_onDrop:function(o){var d=this.el,l=this.options;I=!1,R=!1,He=!1,Ce=!1,clearInterval(this._loopId),clearInterval(z),Oe(),Wi(),clearTimeout(this._dragStartTimer),ut(this._cloneId),ut(this._dragStartId),j(D,"mousemove",this._onTouchMove),this.nativeDraggable&&(j(D,"drop",this),j(d,"dragstart",this._onDragStart),j(D,"dragover",this._handleAutoScroll),j(D,"dragover",Mt)),this._offUpEvents(),o&&(se&&(o.cancelable&&o.preventDefault(),!l.dropBubble&&o.stopPropagation()),i&&i.parentNode&&i.parentNode.removeChild(i),(n===t||y&&y.lastPutMode!=="clone")&&s&&s.parentNode&&s.parentNode.removeChild(s),e&&(this.nativeDraggable&&j(e,"dragend",this),Pt(e),e.style["will-change"]="",Q(e,y?y.options.ghostClass:this.options.ghostClass,!1),Q(e,this.options.chosenClass,!1),J(this,n,"unchoose",e,t,n,m,null,o),n!==t?(_=he(e,l.draggable),_>=0&&(J(null,t,"add",e,t,n,m,_,o),J(this,n,"remove",e,t,n,m,_,o),J(null,t,"sort",e,t,n,m,_,o),J(this,n,"sort",e,t,n,m,_,o)),y&&y.save()):e.nextSibling!==a&&(_=he(e,l.draggable),_>=0&&(J(this,n,"update",e,t,n,m,_,o),J(this,n,"sort",e,t,n,m,_,o))),X.active&&((_==null||_===-1)&&(_=m),J(this,n,"end",e,t,n,m,_,o),this.save()))),this._nulling()},_nulling:function(){n=e=t=i=a=s=c=u=g=C.length=z=F=E=V=P=se=_=m=re=ve=St=pe=y=v=X.active=null,Ne.forEach(function(o){o.checked=!0}),Ne.length=0},handleEvent:function(o){switch(o.type){case"drop":case"dragend":this._onDrop(o);break;case"dragenter":case"dragover":e&&(this._onDragOver(o),Mi(o));break;case"selectstart":o.preventDefault();break}},toArray:function(){for(var o=[],d,l=this.el.children,p=0,f=l.length,w=this.options;p<f;p++)d=l[p],K(d,w.draggable,this.el,!1)&&o.push(d.getAttribute(w.dataIdAttr)||ji(d));return o},sort:function(o){var d={},l=this.el;this.toArray().forEach(function(p,f){var w=l.children[f];K(w,this.options.draggable,l,!1)&&(d[p]=w)},this),o.forEach(function(p){d[p]&&(l.removeChild(d[p]),l.appendChild(d[p]))})},save:function(){var o=this.options.store;o&&o.set&&o.set(this)},closest:function(o,d){return K(o,d||this.options.draggable,this.el,!1)},option:function(o,d){var l=this.options;if(d===void 0)return l[o];l[o]=d,o==="group"&&Lt(l)},destroy:function(){var o=this.el;o[G]=null,j(o,"mousedown",this._onTapStart),j(o,"touchstart",this._onTapStart),j(o,"pointerdown",this._onTapStart),this.nativeDraggable&&(j(o,"dragover",this),j(o,"dragenter",this)),Array.prototype.forEach.call(o.querySelectorAll("[draggable]"),function(d){d.removeAttribute("draggable")}),this._onDrop(),A.splice(A.indexOf(this.el),1),this.el=o=null},_hideClone:function(){s.cloneHidden||(H(s,"display","none"),s.cloneHidden=!0,s.parentNode&&this.options.removeCloneOnHide&&s.parentNode.removeChild(s))},_showClone:function(o){if(o.lastPutMode!=="clone"){this._hideClone();return}s.cloneHidden&&(n.contains(e)&&!this.options.group.revertClone?n.insertBefore(s,e):a?n.insertBefore(s,a):n.appendChild(s),this.options.group.revertClone&&this._animate(e,s),H(s,"display",""),s.cloneHidden=!1)}};function K(o,d,l,p){if(o){l=l||D;do{if(d!=null&&(d[0]===">"&&o.parentNode===l&&Bt(o,d.substring(1))||Bt(o,d))||p&&o===l)return o;if(o===l)break}while(o=Li(o))}return null}function Li(o){return o.host&&o!==D&&o.host.nodeType?o.host:o.parentNode}function Mi(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}function O(o,d,l){o.addEventListener(d,l,Dt)}function j(o,d,l){o.removeEventListener(d,l,Dt)}function Q(o,d,l){if(o&&d)if(o.classList)o.classList[l?"add":"remove"](d);else{var p=(" "+o.className+" ").replace(Tt," ").replace(" "+d+" "," ");o.className=(p+(l?" "+d:"")).replace(Tt," ")}}function H(o,d,l){var p=o&&o.style;if(p){if(l===void 0)return D.defaultView&&D.defaultView.getComputedStyle?l=D.defaultView.getComputedStyle(o,""):o.currentStyle&&(l=o.currentStyle),d===void 0?l:l[d];!(d in p)&&d.indexOf("webkit")===-1&&(d="-webkit-"+d),p[d]=l+(typeof l=="string"?"":"px")}}function dt(o){var d="";do{var l=H(o,"transform");l&&l!=="none"&&(d=l+" "+d)}while(o=o.parentNode);if(window.DOMMatrix)return new DOMMatrix(d);if(window.WebKitCSSMatrix)return new WebKitCSSMatrix(d);if(window.CSSMatrix)return new CSSMatrix(d)}function jt(o,d,l){if(o){var p=o.getElementsByTagName(d),f=0,w=p.length;if(l)for(;f<w;f++)l(p[f],f);return p}return[]}function J(o,d,l,p,f,w,x,S,k){o=o||d[G];var T,L=o.options,M="on"+l.charAt(0).toUpperCase()+l.substr(1);window.CustomEvent&&!te&&!Me?T=new CustomEvent(l,{bubbles:!0,cancelable:!0}):(T=D.createEvent("Event"),T.initEvent(l,!0,!0)),T.to=f||d,T.from=w||d,T.item=p||d,T.clone=s,T.oldIndex=x,T.newIndex=S,T.originalEvent=k,d&&d.dispatchEvent(T),L[M]&&L[M].call(o,T)}function Wt(o,d,l,p,f,w,x,S){var k,T=o[G],L=T.options.onMove,M;return window.CustomEvent&&!te&&!Me?k=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(k=D.createEvent("Event"),k.initEvent("move",!0,!0)),k.to=d,k.from=o,k.dragged=l,k.draggedRect=p,k.related=f||d,k.relatedRect=w||B(d),k.willInsertAfter=S,k.originalEvent=x,o.dispatchEvent(k),L&&(M=L.call(T,k,x)),M}function Pt(o){o.draggable=!1}function Ni(){nt=!1}function ct(o,d,l){for(var p=0,f=0,w=o.children;f<w.length;){if(w[f].style.display!=="none"&&w[f]!==i&&w[f]!==e&&K(w[f],l.draggable,o,!1)){if(p===d)return w[f];p++}f++}return null}function zt(o){for(var d=o.lastElementChild;(d===i||d.style.display==="none")&&(d=d.previousElementSibling,!!d););return d||null}function Oi(o,d,l){var p=B(zt(l)),f=d==="vertical"?o.clientY:o.clientX,w=d==="vertical"?o.clientX:o.clientY,x=d==="vertical"?p.bottom:p.right,S=d==="vertical"?p.left:p.top,k=d==="vertical"?p.right:p.bottom,T=10;return d==="vertical"?w>k+T||w<=k&&f>x&&w>=S:f>x&&w>S||f<=x&&w>k+T}function Ai(o,d,l,p,f,w,x){var S=B(d),k=l==="vertical"?o.clientY:o.clientX,T=l==="vertical"?S.height:S.width,L=l==="vertical"?S.top:S.left,M=l==="vertical"?S.bottom:S.right,W=B(e),U=!1;if(!w){if(x&&Le<T*p)if(!Ce&&(ve===1?k>L+T*f/2:k<M-T*f/2)&&(Ce=!0),Ce)U=!0;else{var Y=l==="vertical"?W.top:W.left,Z=l==="vertical"?W.bottom:W.right;if(ve===1?k<L+Le:k>M-Le)return ve*-1}else if(k>L+T*(1-p)/2&&k<M-T*(1-p)/2)return k>L+T/2?-1:1}return U=U||w,U&&(k<L+T*f/2||k>M-T*f/2)?k>L+T/2?1:-1:0}function Fi(o,d){var l=he(e,d.draggable),p=he(o,d.draggable);return l<p?1:-1}function ji(o){for(var d=o.tagName+o.className+o.src+o.href+o.textContent,l=d.length,p=0;l--;)p+=d.charCodeAt(l);return p.toString(36)}function he(o,d){var l=0;if(!o||!o.parentNode)return-1;for(;o&&(o=o.previousElementSibling);)o.nodeName.toUpperCase()!=="TEMPLATE"&&o!==s&&l++;return l}function Bt(o,d){if(o)try{if(o.matches)return o.matches(d);if(o.msMatchesSelector)return o.msMatchesSelector(d);if(o.webkitMatchesSelector)return o.webkitMatchesSelector(d)}catch(l){return!1}return!1}var $e;function qt(o,d){return function(){if(!$e){var l=arguments,p=this;$e=fe(function(){l.length===1?o.call(p,l[0]):o.apply(p,l),$e=void 0},d)}}}function Wi(){clearTimeout($e),$e=void 0}function ht(o,d){if(o&&d)for(var l in d)d.hasOwnProperty(l)&&(o[l]=d[l]);return o}function Vt(o){return st&&st.dom?st.dom(o).cloneNode(!0):Rt?Rt(o).clone(!0)[0]:o.cloneNode(!0)}function Pi(o){Ne.length=0;for(var d=o.getElementsByTagName("input"),l=d.length;l--;){var p=d[l];p.checked&&Ne.push(p)}}function Ae(o){return fe(o,0)}function ut(o){return clearTimeout(o)}function B(o,d,l){if(!(!o.getBoundingClientRect&&o!==q)){var p,f,w,x,S,k,T;if(o!==q?(p=o.getBoundingClientRect(),f=p.top,w=p.left,x=p.bottom,S=p.right,k=p.height,T=p.width):(f=0,w=0,x=window.innerHeight,S=window.innerWidth,k=window.innerHeight,T=window.innerWidth),l&&o!==q){if(d=d||o.parentNode,!te)do if(d&&d.getBoundingClientRect&&H(d,"transform")!=="none"){var L=d.getBoundingClientRect();f-=L.top+le(H(d,"border-top-width")),w-=L.left+le(H(d,"border-left-width")),x=f+p.height,S=w+p.width;break}while(d=d.parentNode);var M=dt(o),W=M&&M.a,U=M&&M.d;M&&(f/=U,w/=W,T/=W,k/=U,x=f+k,S=w+T)}return{top:f,left:w,bottom:x,right:S,width:T,height:k}}}function zi(o,d){for(var l=de(l,!0),p=B(o)[d];l;){var f=B(l)[d],w;if(d==="top"||d==="left"?w=p>=f:w=p<=f,!w)return!0;if(l===q)break;l=de(l,!1)}return!1}return O(D,"touchmove",function(o){(X.active||I)&&o.cancelable&&o.preventDefault()}),X.utils={on:O,off:j,css:H,find:jt,is:function(o,d){return!!K(o,d,o,!1)},extend:ht,throttle:qt,closest:K,toggleClass:Q,clone:Vt,index:he,nextTick:Ae,cancelNextTick:ut,detectDirection:Ht,getChild:ct},X.create=function(o,d){return new X(o,d)},X.version="1.8.3",X})});var Ti=Xt((Go,Si)=>{"use strict";function Ki(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var Ji=Ki(ri());function h(r,e){return typeof r=="string"?(e||document).querySelector(r):r||null}h.each=(r,e)=>typeof r=="string"?Array.from((e||document).querySelectorAll(r)):r||null;h.create=(r,e)=>{let t=document.createElement(r);for(let i in e){let s=e[i];if(i==="inside")h(s).appendChild(t);else if(i==="around"){let n=h(s);n.parentNode.insertBefore(t,n),t.appendChild(n)}else i==="styles"?typeof s=="object"&&Object.keys(s).map(n=>{t.style[n]=s[n]}):i in t?t[i]=s:t.setAttribute(i,s)}return t};h.on=(r,e,t,i)=>{i?h.delegate(r,e,t,i):(i=t,h.bind(r,e,i))};h.off=(r,e,t)=>{r.removeEventListener(e,t)};h.bind=(r,e,t)=>{e.split(/\s+/).forEach(function(i){r.addEventListener(i,t)})};h.delegate=(r,e,t,i)=>{r.addEventListener(e,function(s){let n=s.target.closest(t);n&&(s.delegatedTarget=n,i.call(this,s,n))})};h.unbind=(r,e)=>{if(r)for(let t in e){let i=e[t];t.split(/\s+/).forEach(function(s){r.removeEventListener(s,i)})}};h.fire=(r,e,t)=>{let i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0);for(let s in t)i[s]=t[s];return r.dispatchEvent(i)};h.data=(r,e)=>{if(!e)return r.dataset;for(let t in e)r.dataset[t]=e[t]};h.style=(r,e)=>{if(typeof e=="string")return h.getStyle(r,e);Array.isArray(r)||(r=[r]),r.map(t=>{for(let i in e)t.style[i]=e[i]})};h.removeStyle=(r,e)=>{Array.isArray(r)||(r=[r]),Array.isArray(e)||(e=[e]),r.map(t=>{for(let i of e)t.style[i]=""})};h.getStyle=(r,e)=>{if(!e)return getComputedStyle(r);let t=getComputedStyle(r)[e];return["width","height"].includes(e)&&(t=parseFloat(t)),t};h.closest=(r,e)=>e?e.matches(r)?e:h.closest(r,e.parentNode):null;h.inViewport=(r,e)=>{let{top:t,left:i,bottom:s,right:n}=r.getBoundingClientRect(),{top:a,left:c,bottom:u,right:g}=e.getBoundingClientRect();return t>=a&&i>=c&&s<=u&&n<=g};h.scrollTop=function(e,t){requestAnimationFrame(()=>{e.scrollTop=t})};h.scrollbarSize=function(){return h.scrollBarSizeValue||(h.scrollBarSizeValue=Qi()),h.scrollBarSizeValue};function Qi(){let r=document.createElement("div");h.style(r,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(r);let e=r.offsetWidth-r.clientWidth;return document.body.removeChild(r),e}h.hasVerticalOverflow=function(r){return r.scrollHeight>r.offsetHeight+10};h.hasHorizontalOverflow=function(r){return r.scrollWidth>r.offsetWidth+10};h.measureTextWidth=function(r){let e=document.createElement("div");return e.style.position="absolute",e.style.visibility="hidden",e.style.height="auto",e.style.width="auto",e.style.whiteSpace="nowrap",e.innerText=r,document.body.appendChild(e),e.clientWidth+1};function Zi(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var me=Zi,Ge=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ue(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function es(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function ts(r,e){return e={exports:{}},r(e,e.exports),e.exports}var is=typeof Ge=="object"&&Ge&&Ge.Object===Object&&Ge,ss=is,rs=typeof self=="object"&&self&&self.Object===Object&&self,ns=ss||rs||Function("return this")(),Ee=ns,os=function(){return Ee.Date.now()},wt=os,as=Ee.Symbol,Qe=as,ui=Object.prototype,ls=ui.hasOwnProperty,ds=ui.toString,Te=Qe?Qe.toStringTag:void 0;function cs(r){var e=ls.call(r,Te),t=r[Te];try{r[Te]=void 0}catch(s){}var i=ds.call(r);return e?r[Te]=t:delete r[Te],i}var hs=cs,us=Object.prototype,ps=us.toString;function fs(r){return ps.call(r)}var _s=fs,ms="[object Null]",gs="[object Undefined]",ni=Qe?Qe.toStringTag:void 0;function bs(r){return r==null?r===void 0?gs:ms:ni&&ni in Object(r)?hs(r):_s(r)}var pi=bs;function ws(r){return r!=null&&typeof r=="object"}var ys=ws,vs="[object Symbol]";function Cs(r){return typeof r=="symbol"||ys(r)&&pi(r)==vs}var $s=Cs,oi=0/0,xs=/^\s+|\s+$/g,ks=/^[-+]0x[0-9a-f]+$/i,Ss=/^0b[01]+$/i,Ts=/^0o[0-7]+$/i,Rs=parseInt;function Ds(r){if(typeof r=="number")return r;if($s(r))return oi;if(me(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=me(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(xs,"");var t=Ss.test(r);return t||Ts.test(r)?Rs(r.slice(2),t?2:8):ks.test(r)?oi:+r}var ai=Ds,Is="Expected a function",Es=Math.max,Hs=Math.min;function Ls(r,e,t){var i,s,n,a,c,u,g=0,b=!1,m=!1,_=!0;if(typeof r!="function")throw new TypeError(Is);e=ai(e)||0,me(t)&&(b=!!t.leading,m="maxWait"in t,n=m?Es(ai(t.maxWait)||0,e):n,_="trailing"in t?!!t.trailing:_);function v(E){var V=i,P=s;return i=s=void 0,g=E,a=r.apply(P,V),a}function y(E){return g=E,c=setTimeout(I,e),b?v(E):a}function C(E){var V=E-u,P=E-g,se=e-V;return m?Hs(se,n-P):se}function R(E){var V=E-u,P=E-g;return u===void 0||V>=e||V<0||m&&P>=n}function I(){var E=wt();if(R(E))return N(E);c=setTimeout(I,C(E))}function N(E){return c=void 0,_&&i?v(E):(i=s=void 0,a)}function A(){c!==void 0&&clearTimeout(c),g=0,i=u=s=c=void 0}function z(){return c===void 0?a:N(wt())}function F(){var E=wt(),V=R(E);if(i=arguments,s=this,u=E,V){if(c===void 0)return y(u);if(m)return c=setTimeout(I,e),v(u)}return c===void 0&&(c=setTimeout(I,e)),a}return F.cancel=A,F.flush=z,F}var fi=Ls,Ms="Expected a function";function Ns(r,e,t){var i=!0,s=!0;if(typeof r!="function")throw new TypeError(Ms);return me(t)&&(i="leading"in t?!!t.leading:i,s="trailing"in t?!!t.trailing:s),fi(r,e,{leading:i,maxWait:e,trailing:s})}var Os=Ns,As="[object AsyncFunction]",Fs="[object Function]",js="[object GeneratorFunction]",Ws="[object Proxy]";function Ps(r){if(!me(r))return!1;var e=pi(r);return e==Fs||e==js||e==As||e==Ws}var zs=Ps,Bs=Ee["__core-js_shared__"],yt=Bs,li=function(){var r=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function qs(r){return!!li&&li in r}var Vs=qs,Ys=Function.prototype,Xs=Ys.toString;function Gs(r){if(r!=null){try{return Xs.call(r)}catch(e){}try{return r+""}catch(e){}}return""}var Us=Gs,Ks=/[\\^$.*+?()[\]{}|]/g,Js=/^\[object .+?Constructor\]$/,Qs=Function.prototype,Zs=Object.prototype,er=Qs.toString,tr=Zs.hasOwnProperty,ir=RegExp("^"+er.call(tr).replace(Ks,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function sr(r){if(!me(r)||Vs(r))return!1;var e=zs(r)?ir:Js;return e.test(Us(r))}var rr=sr;function nr(r,e){return r==null?void 0:r[e]}var or=nr;function ar(r,e){var t=or(r,e);return rr(t)?t:void 0}var xt=ar,lr=xt(Object,"create"),Ie=lr;function dr(){this.__data__=Ie?Ie(null):{},this.size=0}var cr=dr;function hr(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var ur=hr,pr="__lodash_hash_undefined__",fr=Object.prototype,_r=fr.hasOwnProperty;function mr(r){var e=this.__data__;if(Ie){var t=e[r];return t===pr?void 0:t}return _r.call(e,r)?e[r]:void 0}var gr=mr,br=Object.prototype,wr=br.hasOwnProperty;function yr(r){var e=this.__data__;return Ie?e[r]!==void 0:wr.call(e,r)}var vr=yr,Cr="__lodash_hash_undefined__";function $r(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Ie&&e===void 0?Cr:e,this}var xr=$r;function ge(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}ge.prototype.clear=cr;ge.prototype.delete=ur;ge.prototype.get=gr;ge.prototype.has=vr;ge.prototype.set=xr;var di=ge;function kr(){this.__data__=[],this.size=0}var Sr=kr;function Tr(r,e){return r===e||r!==r&&e!==e}var Rr=Tr;function Dr(r,e){for(var t=r.length;t--;)if(Rr(r[t][0],e))return t;return-1}var et=Dr,Ir=Array.prototype,Er=Ir.splice;function Hr(r){var e=this.__data__,t=et(e,r);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():Er.call(e,t,1),--this.size,!0}var Lr=Hr;function Mr(r){var e=this.__data__,t=et(e,r);return t<0?void 0:e[t][1]}var Nr=Mr;function Or(r){return et(this.__data__,r)>-1}var Ar=Or;function Fr(r,e){var t=this.__data__,i=et(t,r);return i<0?(++this.size,t.push([r,e])):t[i][1]=e,this}var jr=Fr;function be(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}be.prototype.clear=Sr;be.prototype.delete=Lr;be.prototype.get=Nr;be.prototype.has=Ar;be.prototype.set=jr;var Wr=be,Pr=xt(Ee,"Map"),zr=Pr;function Br(){this.size=0,this.__data__={hash:new di,map:new(zr||Wr),string:new di}}var qr=Br;function Vr(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var Yr=Vr;function Xr(r,e){var t=r.__data__;return Yr(e)?t[typeof e=="string"?"string":"hash"]:t.map}var tt=Xr;function Gr(r){var e=tt(this,r).delete(r);return this.size-=e?1:0,e}var Ur=Gr;function Kr(r){return tt(this,r).get(r)}var Jr=Kr;function Qr(r){return tt(this,r).has(r)}var Zr=Qr;function en(r,e){var t=tt(this,r),i=t.size;return t.set(r,e),this.size+=t.size==i?0:1,this}var tn=en;function we(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}we.prototype.clear=qr;we.prototype.delete=Ur;we.prototype.get=Jr;we.prototype.has=Zr;we.prototype.set=tn;var sn=we,rn="__lodash_hash_undefined__";function nn(r){return this.__data__.set(r,rn),this}var on=nn;function an(r){return this.__data__.has(r)}var ln=an;function Ze(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new sn;++e<t;)this.add(r[e])}Ze.prototype.add=Ze.prototype.push=on;Ze.prototype.has=ln;var dn=Ze;function cn(r,e,t,i){for(var s=r.length,n=t+(i?1:-1);i?n--:++n<s;)if(e(r[n],n,r))return n;return-1}var hn=cn;function un(r){return r!==r}var pn=un;function fn(r,e,t){for(var i=t-1,s=r.length;++i<s;)if(r[i]===e)return i;return-1}var _n=fn;function mn(r,e,t){return e===e?_n(r,e,t):hn(r,pn,t)}var gn=mn;function bn(r,e){var t=r==null?0:r.length;return!!t&&gn(r,e,0)>-1}var wn=bn;function yn(r,e,t){for(var i=-1,s=r==null?0:r.length;++i<s;)if(t(e,r[i]))return!0;return!1}var vn=yn;function Cn(r,e){return r.has(e)}var $n=Cn,xn=xt(Ee,"Set"),vt=xn;function kn(){}var Sn=kn;function Tn(r){var e=-1,t=Array(r.size);return r.forEach(function(i){t[++e]=i}),t}var _i=Tn,Rn=1/0,Dn=vt&&1/_i(new vt([,-0]))[1]==Rn?function(r){return new vt(r)}:Sn,In=Dn,En=200;function Hn(r,e,t){var i=-1,s=wn,n=r.length,a=!0,c=[],u=c;if(t)a=!1,s=vn;else if(n>=En){var g=e?null:In(r);if(g)return _i(g);a=!1,s=$n,u=new dn}else u=e?[]:c;e:for(;++i<n;){var b=r[i],m=e?e(b):b;if(b=t||b!==0?b:0,a&&m===m){for(var _=u.length;_--;)if(u[_]===m)continue e;e&&u.push(m),c.push(b)}else s(u,m,t)||(u!==c&&u.push(m),c.push(b))}return c}var Ln=Hn;function Mn(r){return r&&r.length?Ln(r):[]}var Nn=Mn;function mi(r){return r.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`)}function Ct(r){return Object.keys(r).map(t=>{let i=mi(t),s=r[t];return s===void 0?"":`data-${i}="${s}" `}).join("").trim()}function ci(r){var e=document.createElement("textarea");e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width="2em",e.style.height="2em",e.style.padding=0,e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",e.value=r,document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(t){console.log("Oops, unable to copy")}document.body.removeChild(e)}function On(r){return!isNaN(r)}var gi=Os,An=fi;function De(r,e=null){return(...t)=>new Promise(i=>{setTimeout(()=>{let n=r.apply(e,t);i(n)})})}function it(r,e,t){let i=t.reduce((s,n)=>(s[n]={get(){return e[n]}},s),{});Object.defineProperties(r,i)}function Fn(r){return r!==void 0||r!==null}function jn(r){return!Fn(r)}function Ke(r){return!isNaN(r)}function Wn(r){return Array.isArray(r)?r:[r]}function hi(r){return Nn(r)}function Re(r,e){return r-e}function Pn(r){return r.replace(/<[^>]*>/g,"")}function zn(r,e){return r&&(Object.keys(e).forEach(t=>{let i=new RegExp(`{(${t})}`,"g");r=r.replace(i,e[t])}),r)}var bi=class{constructor(e){this.options=e,this.sortRows=De(this.sortRows,this),this.switchColumn=De(this.switchColumn,this),this.removeColumn=De(this.removeColumn,this),this.options.filterRows=De(this.options.filterRows,this)}init(e,t){e||(e=this.options.data),t&&(this.options.columns=t),this.data=e,this.rowCount=0,this.columns=[],this.rows=[],this.prepareColumns(),this.prepareRows(),this.prepareTreeRows(),this.prepareRowView(),this.prepareNumericColumns()}get currentSort(){return this.columns.find(t=>t.sortOrder!=="none")||{colIndex:-1,sortOrder:"none"}}prepareColumns(){this.columns=[],this.validateColumns(),this.prepareDefaultColumns(),this.prepareHeader()}prepareDefaultColumns(){if(this.options.checkboxColumn&&!this.hasColumnById("_checkbox")){let e={id:"_checkbox",content:this.getCheckboxHTML(),editable:!1,resizable:!1,sortable:!1,focusable:!1,dropdown:!1,width:32};this.columns.push(e)}if(this.options.serialNoColumn&&!this.hasColumnById("_rowIndex")){let e={id:"_rowIndex",content:"",align:"center",editable:!1,resizable:!1,focusable:!1,dropdown:!1};this.columns.push(e)}}prepareHeader(){let e=this.columns.concat(this.options.columns),t={isHeader:1,editable:!0,sortable:!0,resizable:!0,focusable:!0,dropdown:!0,width:null,format:i=>i==null?"":i+""};this.columns=e.map((i,s)=>this.prepareCell(i,s)).map(i=>Object.assign({},t,i)).map(i=>(i.content=i.content||i.name||"",i.id=i.id||i.content,i))}prepareCell(e,t){let i={content:"",sortOrder:"none",colIndex:t,column:this.columns[t]};return e!==null&&typeof e=="object"?Object.assign(i,e):i.content=e,i}prepareNumericColumns(){let e=this.getRow(0);!e||(this.columns=this.columns.map((t,i)=>{let s=e[i].content;return!t.align&&On(s)&&(t.align="right"),t}))}prepareRows(){this.validateData(this.data),this.rows=this.data.map((e,t)=>{let i=this._getNextRowCount(),s=[],n={rowIndex:i};if(Array.isArray(e))for(this.options.checkboxColumn&&s.push(this.getCheckboxHTML()),this.options.serialNoColumn&&s.push(i+1+""),s=s.concat(e);s.length<this.columns.length;)s.push("");else{for(let a of this.columns)a.id==="_checkbox"?s.push(this.getCheckboxHTML()):a.id==="_rowIndex"?s.push(i+1+""):s.push(e[a.id]);n.indent=e.indent||0}return this.prepareRow(s,n)})}prepareTreeRows(){this.rows.forEach((e,t)=>{if(Ke(e.meta.indent)){let i=this.getRow(t+1);e.meta.isLeaf=!i||jn(i.meta.indent)||i.meta.indent<=e.meta.indent,e.meta.isTreeNodeClose=!1}})}prepareRowView(){this.rowViewOrder=this.rows.map(e=>e.meta.rowIndex)}prepareRow(e,t){let i={rowIndex:t.rowIndex,indent:t.indent};return e=e.map((s,n)=>this.prepareCell(s,n)).map(s=>Object.assign({},i,s)),e.meta=t,e}validateColumns(){let e=this.options.columns;if(!Array.isArray(e))throw new Je("`columns` must be an array");e.forEach((t,i)=>{if(typeof t!="string"&&typeof t!="object")throw new Je(`column "${i}" must be a string or an object`)})}validateData(e){if(Array.isArray(e)&&(e.length===0||Array.isArray(e[0])||typeof e[0]=="object"))return!0;throw new Je("`data` must be an array of arrays or objects")}appendRows(e){this.validateData(e),this.rows.push(...this.prepareRows(e))}sortRows(e,t="none"){e=+e,this.getColumns().map(i=>{i.colIndex===e?i.sortOrder=t:i.sortOrder="none"}),this._sortRows(e,t)}_sortRows(e,t){if(this.currentSort.colIndex===e&&(this.currentSort.sortOrder==="asc"&&t==="desc"||this.currentSort.sortOrder==="desc"&&t==="asc")){this.reverseArray(this.rowViewOrder),this.currentSort.sortOrder=t;return}if(this.rowViewOrder.sort((i,s)=>{let n=i,a=s,c=this.getCell(e,i).content,u=this.getCell(e,s).content;if(c=c==null?"":c,u=u==null?"":u,t==="none")return n-a;if(t==="asc"){if(c<u)return-1;if(c>u)return 1;if(c===u)return 0}else if(t==="desc"){if(c<u)return 1;if(c>u)return-1;if(c===u)return 0}return 0}),this.hasColumnById("_rowIndex")){let i=this.getColumnIndexById("_rowIndex");this.rows.forEach((s,n)=>{let a=this.rowViewOrder.indexOf(n),c=s[i];c.content=a+1+""})}}reverseArray(e){let t=null,i=null,s=e.length;for(t=0,i=s-1;t<i;t+=1,i-=1){let n=e[t];e[t]=e[i],e[i]=n}}switchColumn(e,t){let i=this.columns[e];this.columns[e]=this.columns[t],this.columns[t]=i,this.columns[e].colIndex=e,this.columns[t].colIndex=t,this.rows.forEach(s=>{let n=Object.assign({},s[e],{colIndex:t}),a=Object.assign({},s[t],{colIndex:e});s[t]=n,s[e]=a})}removeColumn(e){e=+e;let t=s=>s.colIndex!==e,i=(s,n)=>Object.assign({},s,{colIndex:n});this.columns=this.columns.filter(t).map(i),this.rows.forEach(s=>{s.splice(e,1),s.forEach((n,a)=>{n.colIndex=a})})}updateRow(e,t){e.length<this.columns.length&&(this.hasColumnById("_rowIndex")&&(e=[t+1+""].concat(e)),this.hasColumnById("_checkbox")&&(e=['<input type="checkbox" />'].concat(e)));let i=this.prepareRow(e,{rowIndex:t}),s=this.rows.findIndex(n=>n[0].rowIndex===t);return this.rows[s]=i,i}updateCell(e,t,i){let s;typeof e=="object"&&(s=e,e=s.colIndex,t=s.rowIndex,i=s),s=this.getCell(e,t);for(let n in i){let a=i[n];a!==void 0&&(s[n]=a)}return s}updateColumn(e,t){let i=this.getColumn(e);for(let s in t){let n=t[s];n!==void 0&&(i[s]=n)}return i}filterRows(e){return this.options.filterRows(this.rows,e).then(t=>(t||(t=this.getAllRowIndices()),t.then||(t=Promise.resolve(t)),t.then(i=>(this._filteredRows=i,{rowsToHide:this.getAllRowIndices().filter(n=>!i.includes(n)),rowsToShow:i}))))}getFilteredRowIndices(){return this._filteredRows||this.getAllRowIndices()}getAllRowIndices(){return this.rows.map(e=>e.meta.rowIndex)}getRowCount(){return this.rowCount}_getNextRowCount(){let e=this.rowCount;return this.rowCount++,e}getRows(e,t){return this.rows.slice(e,t)}getRowsForView(e,t){return this.rowViewOrder.map(s=>this.rows[s]).slice(e,t)}getColumns(e){let t=this.columns;return e&&(t=t.slice(this.getStandardColumnCount())),t}getStandardColumnCount(){return this.options.checkboxColumn&&this.options.serialNoColumn?2:this.options.checkboxColumn||this.options.serialNoColumn?1:0}getColumnCount(e){let t=this.columns.length;return e&&(t=t-this.getStandardColumnCount()),t}getColumn(e){return e=+e,e<0&&(e=this.columns.length+e),this.columns.find(t=>t.colIndex===e)}getColumnById(e){return this.columns.find(t=>t.id===e)}getRow(e){return e=+e,this.rows[e]}getCell(e,t){return t=+t,e=+e,this.getRow(t)[e]}getChildren(e){e=+e;let t=this.getRow(e).meta.indent,i=[];for(let s=e+1;s<this.rowCount;s++){let n=this.getRow(s);if(!isNaN(n.meta.indent)&&(n.meta.indent>t&&i.push(s),n.meta.indent===t))break}return i}getImmediateChildren(e){e=+e;let t=this.getRow(e).meta.indent,i=[],s=t+1;for(let n=e+1;n<this.rowCount;n++){let a=this.getRow(n);if(!(isNaN(a.meta.indent)||a.meta.indent>s)&&(a.meta.indent===s&&i.push(n),a.meta.indent===t))break}return i}get(){return{columns:this.columns,rows:this.rows}}getData(e){return this.data[e]}hasColumn(e){return Boolean(this.columns.find(t=>t.content===e))}hasColumnById(e){return Boolean(this.columns.find(t=>t.id===e))}getColumnIndex(e){return this.columns.findIndex(t=>t.content===e)}getColumnIndexById(e){return this.columns.findIndex(t=>t.id===e)}getCheckboxHTML(){return'<input type="checkbox" />'}},Je=class extends TypeError{},$t={chevronDown:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>'},wi=class{constructor(e){this.instance=e,it(this,this.instance,["wrapper","options","style","header","bodyScrollable","columnmanager","rowmanager","datamanager","keyboard"]),this.bindEvents()}bindEvents(){this.bindFocusCell(),this.bindEditCell(),this.bindKeyboardSelection(),this.bindCopyCellContents(),this.bindMouseEvents(),this.bindTreeEvents()}bindFocusCell(){this.bindKeyboardNav()}bindEditCell(){this.$editingCell=null,h.on(this.bodyScrollable,"dblclick",".dt-cell",(e,t)=>{this.activateEditing(t)}),this.keyboard.on("enter",()=>{this.$focusedCell&&!this.$editingCell?this.activateEditing(this.$focusedCell):this.$editingCell&&this.deactivateEditing()})}bindKeyboardNav(){let e=t=>{if(!this.$focusedCell||this.$editingCell)return!1;let i=this.$focusedCell,{rowIndex:s,colIndex:n}=h.data(i);return t==="left"?i=this.getLeftMostCell$(s):t==="right"?i=this.getRightMostCell$(s):t==="up"?i=this.getTopMostCell$(n):t==="down"&&(i=this.getBottomMostCell$(n)),this.focusCell(i),!0};["left","right","up","down","tab","shift+tab"].map(t=>this.keyboard.on(t,()=>this.focusCellInDirection(t))),["left","right","up","down"].map(t=>this.keyboard.on(`ctrl+${t}`,()=>e(t))),this.keyboard.on("esc",()=>{this.deactivateEditing(!1),this.columnmanager.toggleFilter(!1)}),this.options.inlineFilters&&(this.keyboard.on("ctrl+f",t=>{let i=h.closest(".dt-cell",t.target),{colIndex:s}=h.data(i);return this.activateFilter(s),!0}),h.on(this.header,"focusin",".dt-filter",()=>{this.unfocusCell(this.$focusedCell)}))}bindKeyboardSelection(){let e=t=>{let i=this.getSelectionCursor();return t==="left"?i=this.getLeftCell$(i):t==="right"?i=this.getRightCell$(i):t==="up"?i=this.getAboveCell$(i):t==="down"&&(i=this.getBelowCell$(i)),i};["left","right","up","down"].map(t=>this.keyboard.on(`shift+${t}`,()=>this.selectArea(e(t))))}bindCopyCellContents(){this.keyboard.on("ctrl+c",()=>{let e=this.copyCellContents(this.$focusedCell,this.$selectionCursor),t=this.instance.translate("{count} cells copied",{count:e});e&&this.instance.showToastMessage(t,2)}),this.options.pasteFromClipboard&&this.keyboard.on("ctrl+v",e=>(this.instance.pasteTarget.focus(),setTimeout(()=>{let t=this.instance.pasteTarget.value;this.instance.pasteTarget.value="",this.pasteContentInCell(t)},10),!1))}bindMouseEvents(){let e=null;h.on(this.bodyScrollable,"mousedown",".dt-cell",i=>{e=!0,this.focusCell(h(i.delegatedTarget))}),h.on(this.bodyScrollable,"mouseup",()=>{e=!1});let t=i=>{!e||this.selectArea(h(i.delegatedTarget))};h.on(this.bodyScrollable,"mousemove",".dt-cell",gi(t,50))}bindTreeEvents(){h.on(this.bodyScrollable,"click",".dt-tree-node__toggle",(e,t)=>{let i=h.closest(".dt-cell",t),{rowIndex:s}=h.data(i);i.classList.contains("dt-cell--tree-close")?this.rowmanager.openSingleNode(s):this.rowmanager.closeSingleNode(s)})}focusCell(e,{skipClearSelection:t=0,skipDOMFocus:i=0,skipScrollToCell:s=0}={}){if(!e||e===this.$editingCell)return;let{colIndex:n,isHeader:a}=h.data(e);a||this.columnmanager.getColumn(n).focusable===!1||(s||this.scrollToCell(e),this.deactivateEditing(),t||this.clearSelection(),this.$focusedCell&&this.$focusedCell.classList.remove("dt-cell--focus"),this.$focusedCell=e,e.classList.add("dt-cell--focus"),i||e.focus(),this.highlightRowColumnHeader(e))}unfocusCell(e){!e||(e.classList.remove("dt-cell--focus"),this.$focusedCell=null,this.lastHeaders&&this.lastHeaders.forEach(t=>t&&t.classList.remove("dt-cell--highlight")))}highlightRowColumnHeader(e){let{colIndex:t,rowIndex:i}=h.data(e),s=this.datamanager.getColumnIndexById("_rowIndex"),n=`.dt-cell--header-${t}`,a=`.dt-cell--${s}-${i}`;this.lastHeaders&&this.lastHeaders.forEach(g=>g&&g.classList.remove("dt-cell--highlight"));let c=h(n,this.wrapper),u=h(a,this.wrapper);this.lastHeaders=[c,u],this.lastHeaders.forEach(g=>g&&g.classList.add("dt-cell--highlight"))}selectAreaOnClusterChanged(){if(!(this.$focusedCell&&this.$selectionCursor))return;let{colIndex:e,rowIndex:t}=h.data(this.$selectionCursor),i=this.getCell$(e,t);if(!i||i===this.$selectionCursor)return;let s=h.data(this.$focusedCell);this.$focusedCell=this.getCell$(s.colIndex,s.rowIndex),this.selectArea(i)}focusCellOnClusterChanged(){if(!this.$focusedCell)return;let{colIndex:e,rowIndex:t}=h.data(this.$focusedCell),i=this.getCell$(e,t);!i||this.focusCell(i,{skipClearSelection:1,skipDOMFocus:1,skipScrollToCell:1})}selectArea(e){!this.$focusedCell||this._selectArea(this.$focusedCell,e)&&(this.$selectionCursor=e)}_selectArea(e,t){if(e===t)return!1;let i=this.getCellsInRange(e,t);return i?(this.clearSelection(),this._selectedCells=i.map(s=>this.getCell$(...s)),requestAnimationFrame(()=>{this._selectedCells.map(s=>s.classList.add("dt-cell--highlight"))}),!0):!1}getCellsInRange(e,t){let i,s,n,a;if(typeof e=="number")[i,s,n,a]=arguments;else if(typeof e=="object"){if(!(e&&t))return!1;let m=h.data(e),_=h.data(t);i=+m.colIndex,s=+m.rowIndex,n=+_.colIndex,a=+_.rowIndex}if(s>a&&([s,a]=[a,s]),i>n&&([i,n]=[n,i]),this.isStandardCell(i)||this.isStandardCell(n))return!1;let c=[],u=i,g=s,b=[];for(;g<=a;)b.push(g),g+=1;return b.map(m=>{for(;u<=n;)c.push([u,m]),u++;u=i}),c}clearSelection(){(this._selectedCells||[]).forEach(e=>e.classList.remove("dt-cell--highlight")),this._selectedCells=[],this.$selectionCursor=null}getSelectionCursor(){return this.$selectionCursor||this.$focusedCell}activateEditing(e){this.focusCell(e);let{rowIndex:t,colIndex:i}=h.data(e),s=this.columnmanager.getColumn(i);if(s&&(s.editable===!1||s.focusable===!1))return;let n=this.getCell(i,t);if(n&&n.editable===!1)return;if(this.$editingCell){let{_rowIndex:u,_colIndex:g}=h.data(this.$editingCell);if(t===u&&i===g)return}this.$editingCell=e,e.classList.add("dt-cell--editing");let a=h(".dt-cell__edit",e);a.innerHTML="";let c=this.getEditor(i,t,n.content,a);c&&(this.currentCellEditor=c,c.initValue(n.content,t,s))}deactivateEditing(e=!0){e&&this.submitEditing(),this.$focusedCell&&this.$focusedCell.focus(),this.$editingCell&&(this.$editingCell.classList.remove("dt-cell--editing"),this.$editingCell=null)}getEditor(e,t,i,s){let n=this.datamanager.getColumn(e),a=this.datamanager.getRow(t),c=this.datamanager.getData(t),u=this.options.getEditor?this.options.getEditor(e,t,i,s,n,a,c):this.getDefaultEditor(s);return u===!1?!1:(u===void 0&&(u=this.getDefaultEditor(s)),u)}getDefaultEditor(e){let t=h.create("input",{class:"dt-input",type:"text",inside:e});return{initValue(i){t.focus(),t.value=i},getValue(){return t.value},setValue(i){t.value=i}}}submitEditing(){let e=Promise.resolve();if(!this.$editingCell)return e;let t=this.$editingCell,{rowIndex:i,colIndex:s}=h.data(t),n=this.datamanager.getColumn(s);if(t){let a=this.currentCellEditor;if(a){let c=a.getValue();c.then||(c=Promise.resolve(c)),e=c.then(u=>{let g=this.getCell(s,i).content;if(g===u)return!1;let b=a.setValue(u,i,n);return this.updateCell(s,i,u),t.focus(),b&&b.then&&b.catch(m=>{console.log(m),this.updateCell(s,i,g)}),b})}}return this.currentCellEditor=null,e}copyCellContents(e,t){if(!t&&e){let{colIndex:a,rowIndex:c}=h.data(e),u=this.getCell(a,c);return ci(u.content),1}let i=this.getCellsInRange(e,t);if(!i)return 0;let s=i.map(a=>this.getCell(...a)).reduce((a,c)=>{let u=c.rowIndex;return a[u]=a[u]||[],a[u].push(c.content),a},[]),n=s.map(a=>a.join("	")).join(`
`);return ci(n),s.reduce((a,c)=>a+c.length,0)}pasteContentInCell(e){if(!this.$focusedCell)return;let t=e.split(`
`).map(a=>a.split("	")).filter(a=>a.length&&a.every(c=>c)),{colIndex:i,rowIndex:s}=h.data(this.$focusedCell),n={colIndex:+i,rowIndex:+s};t.forEach((a,c)=>{let u=c+n.rowIndex;a.forEach((g,b)=>{let m=b+n.colIndex;this.updateCell(m,u,g)})})}activateFilter(e){this.columnmanager.toggleFilter(),this.columnmanager.focusFilter(e),this.columnmanager.isFilterShown||this.$focusedCell&&this.$focusedCell.focus()}updateCell(e,t,i){let s=this.datamanager.updateCell(e,t,{content:i});this.refreshCell(s)}refreshCell(e){let t=h(this.selector(e.colIndex,e.rowIndex),this.bodyScrollable);t.innerHTML=this.getCellContent(e)}toggleTreeButton(e,t){let i=this.columnmanager.getFirstColumnIndex(),s=this.getCell$(i,e);s&&s.classList[t?"remove":"add"]("dt-cell--tree-close")}isStandardCell(e){return e<this.columnmanager.getFirstColumnIndex()}focusCellInDirection(e){if(!this.$focusedCell||this.$editingCell&&["left","right","up","down"].includes(e))return!1;this.$editingCell&&["tab","shift+tab"].includes(e)&&this.deactivateEditing();let t=this.$focusedCell;if(e==="left"||e==="shift+tab"?t=this.getLeftCell$(t):e==="right"||e==="tab"?t=this.getRightCell$(t):e==="up"?t=this.getAboveCell$(t):e==="down"&&(t=this.getBelowCell$(t)),!t)return!1;let{colIndex:i}=h.data(t);if(!this.columnmanager.getColumn(i).focusable){let n=this.$focusedCell;this.unfocusCell(n),this.$focusedCell=t;let a=this.focusCellInDirection(e);return a||this.focusCell(n),a}return this.focusCell(t),!0}getCell$(e,t){return h(this.selector(e,t),this.bodyScrollable)}getAboveCell$(e){let{colIndex:t}=h.data(e),i=e.parentElement.previousElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.previousElementSibling;return i?h(`.dt-cell--col-${t}`,i):e}getBelowCell$(e){let{colIndex:t}=h.data(e),i=e.parentElement.nextElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.nextElementSibling;return i?h(`.dt-cell--col-${t}`,i):e}getLeftCell$(e){return e.previousElementSibling}getRightCell$(e){return e.nextElementSibling}getLeftMostCell$(e){return this.getCell$(this.columnmanager.getFirstColumnIndex(),e)}getRightMostCell$(e){return this.getCell$(this.columnmanager.getLastColumnIndex(),e)}getTopMostCell$(e){return this.getCell$(e,this.rowmanager.getFirstRowIndex())}getBottomMostCell$(e){return this.getCell$(e,this.rowmanager.getLastRowIndex())}getCell(e,t){return this.instance.datamanager.getCell(e,t)}getRowHeight(){return h.style(h(".dt-row",this.bodyScrollable),"height")}scrollToCell(e){if(h.inViewport(e,this.bodyScrollable))return!1;let{rowIndex:t}=h.data(e);return this.rowmanager.scrollToRow(t),!1}getRowCountPerPage(){return Math.ceil(this.instance.getViewportHeight()/this.getRowHeight())}getCellHTML(e){let{rowIndex:t,colIndex:i,isHeader:s,isFilter:n,isTotalRow:a}=e,c=Ct({rowIndex:t,colIndex:i,isHeader:s,isFilter:n,isTotalRow:a}),u=this.datamanager.getRow(t),g=!(s||n||a);return`
            <div class="${["dt-cell","dt-cell--col-"+i,g?`dt-cell--${i}-${t}`:"",g?"dt-cell--row-"+t:"",s?"dt-cell--header":"",s?`dt-cell--header-${i}`:"",n?"dt-cell--filter":"",g&&u&&u.meta.isTreeNodeClose?"dt-cell--tree-close":""].join(" ")}" ${c} tabindex="0">
                ${this.getCellContent(e)}
            </div>
        `}getCellContent(e){let{isHeader:t,isFilter:i,colIndex:s}=e,a=!t&&e.editable!==!1?this.getEditCellHTML(s):"",u=t&&e.sortable!==!1?`<span class="sort-indicator">
                ${this.options.sortIndicator[e.sortOrder]}
            </span>`:"",b=t&&e.resizable!==!1?'<span class="dt-cell__resize-handle"></span>':"",_=t&&e.dropdown!==!1?this.columnmanager.getDropdownHTML():"",v=e.format||e.column&&e.column.format||null,y;if(t||i||!v)y=e.content;else{let R=this.datamanager.getRow(e.rowIndex),I=this.datamanager.getData(e.rowIndex);y=v(e.content,R,e.column,I)}if(e.html=y,this.options.treeView&&!(t||i)&&e.indent!==void 0){let R=this.datamanager.getRow(e.rowIndex+1),I=R&&R.meta.indent>e.indent,N=20,A="px";if(this.datamanager.getColumnIndexById("_rowIndex")+1===e.colIndex){let F=(e.indent||0)*N,E=I?`<span class="dt-tree-node__toggle" style="left: ${F-N}${A}">
                        <span class="icon-open">${$t.chevronDown}</span>
                        <span class="icon-close">${$t.chevronRight}</span>
                    </span>`:"";y=`<span class="dt-tree-node" style="padding-left: ${F}${A}">
                    ${E}
                    <span>${y}</span>
                </span>`}}return`
            <div class="${["dt-cell__content",t?`dt-cell__content--header-${s}`:`dt-cell__content--col-${s}`].join(" ")}">
                ${y}
                ${u}
                ${b}
                ${_}
            </div>
            ${a}
        `}getEditCellHTML(e){return`<div class="dt-cell__edit dt-cell__edit--col-${e}"></div>`}selector(e,t){return`.dt-cell--${e}-${t}`}},yi=class{constructor(e){this.instance=e,it(this,this.instance,["options","fireEvent","header","datamanager","cellmanager","style","wrapper","rowmanager","bodyScrollable","bodyRenderer"]),this.bindEvents()}renderHeader(){this.header.innerHTML="<div></div>",this.refreshHeader()}refreshHeader(){let e=this.datamanager.getColumns();h("div",this.header).innerHTML=this.getHeaderHTML(e),this.$filterRow=h(".dt-row-filter",this.header),this.$filterRow&&h.style(this.$filterRow,{display:"none"}),this.$columnMap=[],this.bindMoveColumn()}getHeaderHTML(e){let t=this.rowmanager.getRowHTML(e,{isHeader:1});return this.options.inlineFilters&&(t+=this.rowmanager.getRowHTML(e,{isFilter:1})),t}bindEvents(){this.bindDropdown(),this.bindResizeColumn(),this.bindPerfectColumnWidth(),this.bindFilter()}bindDropdown(){let e=".dt-dropdown__toggle",t=".dt-dropdown__list";this.instance.dropdownContainer.innerHTML=this.getDropdownListHTML(),this.$dropdownList=this.instance.dropdownContainer.firstElementChild,h.on(this.header,"click",e,a=>{this.openDropdown(a)});let i=a=>{let c=[e,e+" *",t,t+" *"].join(",");a.target.matches(c)||n()};h.on(document.body,"click",i),document.addEventListener("scroll",n,!0),this.instance.on("onDestroy",()=>{h.off(document.body,"click",i),h.off(document,"scroll",n)}),h.on(this.$dropdownList,"click",".dt-dropdown__list-item",(a,c)=>{if(!this._dropdownActiveColIndex)return;let u=this.options.headerDropdown,{index:g}=h.data(c),b=this._dropdownActiveColIndex,m=u[g].action;m&&m.call(this.instance,this.getColumn(b)),this.hideDropdown()});let s=this;function n(a){s.hideDropdown()}this.hideDropdown()}openDropdown(e){this._dropdownWidth||(h.style(this.$dropdownList,{display:""}),this._dropdownWidth=h.style(this.$dropdownList,"width")),h.style(this.$dropdownList,{display:"",left:e.clientX-this._dropdownWidth+4+"px",top:e.clientY+4+"px"});let t=h.closest(".dt-cell",e.target),{colIndex:i}=h.data(t);this._dropdownActiveColIndex=i}hideDropdown(){h.style(this.$dropdownList,{display:"none"}),this._dropdownActiveColIndex=null}bindResizeColumn(){let e=!1,t,i,s;h.on(this.header,"mousedown",".dt-cell .dt-cell__resize-handle",(c,u)=>{document.body.classList.add("dt-resize"),t=u.parentNode.parentNode;let{colIndex:b}=h.data(t),m=this.getColumn(b);m&&m.resizable===!1||(e=!0,i=h.style(h(".dt-cell__content",t),"width"),s=c.pageX)});let n=c=>{if(document.body.classList.remove("dt-resize"),!t)return;e=!1;let{colIndex:u}=h.data(t);this.setColumnWidth(u),this.style.setBodyStyle(),t=null};h.on(document.body,"mouseup",n),this.instance.on("onDestroy",()=>{h.off(document.body,"mouseup",n)});let a=c=>{if(!e)return;let u=c.pageX-s;this.options.direction==="rtl"&&(u=-1*u);let g=i+u,{colIndex:b}=h.data(t);this.options.minimumColumnWidth>g||(this.datamanager.updateColumn(b,{width:g}),this.setColumnHeaderWidth(b))};h.on(document.body,"mousemove",a),this.instance.on("onDestroy",()=>{h.off(document.body,"mousemove",a)})}bindPerfectColumnWidth(){h.on(this.header,"dblclick",".dt-cell .dt-cell__resize-handle",(e,t)=>{let i=t.parentNode.parentNode,{colIndex:s}=h.data(i),n=this.bodyRenderer.visibleRows.map(C=>C[s]).reduce((C,R)=>C.content.length>R.content.length?C:R),a=this.cellmanager.getCellHTML(n),c=document.createElement("div");c.innerHTML=a;let u=c.querySelector(".dt-cell__content").textContent,{borderLeftWidth:g,borderRightWidth:b,paddingLeft:m,paddingRight:_}=h.getStyle(this.bodyScrollable.querySelector(".dt-cell__content")),v=[g,b,m,_].map(parseFloat).reduce((C,R)=>C+R),y=h.measureTextWidth(u)+v;this.datamanager.updateColumn(s,{width:y}),this.setColumnHeaderWidth(s),this.setColumnWidth(s)})}bindMoveColumn(){if(this.options.disableReorderColumn)return;let e=h(".dt-row",this.header);this.sortable=Ji.create(e,{onEnd:t=>{let{oldIndex:i,newIndex:s}=t,n=t.item,{colIndex:a}=h.data(n);+a!==s&&this.switchColumn(i,s)},preventOnFilter:!1,filter:".dt-cell__resize-handle, .dt-dropdown",chosenClass:"dt-cell--dragging",animation:150})}sortColumn(e,t){this.instance.freeze(),this.sortRows(e,t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onSortColumn",this.getColumn(e))})}removeColumn(e){let t=this.getColumn(e);this.instance.freeze(),this.datamanager.removeColumn(e).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onRemoveColumn",t)})}switchColumn(e,t){this.instance.freeze(),this.datamanager.switchColumn(e,t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>{this.setColumnWidth(e),this.setColumnWidth(t),this.instance.unfreeze()}).then(()=>{this.fireEvent("onSwitchColumn",this.getColumn(e),this.getColumn(t))})}toggleFilter(e){if(!this.options.inlineFilters)return;let t;e===void 0?t=!this.isFilterShown:t=e,t?h.style(this.$filterRow,{display:""}):h.style(this.$filterRow,{display:"none"}),this.isFilterShown=t,this.style.setBodyStyle()}focusFilter(e){if(!this.isFilterShown)return;h(`.dt-cell--col-${e} .dt-filter`,this.$filterRow).focus()}bindFilter(){if(!this.options.inlineFilters)return;let e=t=>{this.applyFilter(this.getAppliedFilters())};h.on(this.header,"keydown",".dt-filter",An(e,300))}applyFilter(e){this.datamanager.filterRows(e).then(({rowsToShow:t})=>{this.rowmanager.showRows(t)})}getAppliedFilters(){let e={};return h.each(".dt-filter",this.header).map(t=>{let i=t.value;i&&(e[t.dataset.colIndex]=i)}),e}applyDefaultSortOrder(){let e=this.getColumns().filter(t=>t.sortOrder!=="none");if(e.length===1){let t=e[0];this.sortColumn(t.colIndex,t.sortOrder)}}sortRows(e,t){return this.datamanager.sortRows(e,t)}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}setColumnWidth(e,t){e=+e;let i=t||this.getColumn(e).width,s=[`.dt-cell__content--col-${e}`,`.dt-cell__edit--col-${e}`].join(", "),n={width:i+"px"};this.style.setStyle(s,n)}setColumnHeaderWidth(e){e=+e,this.$columnMap=this.$columnMap||[];let t=`.dt-cell__content--header-${e}`,{width:i}=this.getColumn(e),s=this.$columnMap[e];s||(s=this.header.querySelector(t),this.$columnMap[e]=s),s.style.width=i+"px"}getColumnMinWidth(e){return e=+e,this.getColumn(e).minWidth||24}getFirstColumnIndex(){return this.datamanager.getColumnIndexById("_rowIndex")+1}getHeaderCell$(e){return h(`.dt-cell--header-${e}`,this.header)}getLastColumnIndex(){return this.datamanager.getColumnCount()-1}getDropdownHTML(){let{dropdownButton:e}=this.options;return`
            <div class="dt-dropdown">
                <div class="dt-dropdown__toggle">${e}</div>
            </div>
      `}getDropdownListHTML(){let{headerDropdown:e}=this.options;return`
            <div class="dt-dropdown__list">
            ${e.map((t,i)=>`
                <div class="dt-dropdown__list-item" data-index="${i}">${t.label}</div>
            `).join("")}
            </div>
        `}},vi=class{constructor(e){this.instance=e,it(this,this.instance,["options","fireEvent","wrapper","bodyScrollable","bodyRenderer","style"]),this.bindEvents(),this.refreshRows=De(this.refreshRows,this)}get datamanager(){return this.instance.datamanager}get cellmanager(){return this.instance.cellmanager}bindEvents(){this.bindCheckbox()}bindCheckbox(){!this.options.checkboxColumn||(this.checkMap=[],h.on(this.wrapper,"click",'.dt-cell--col-0 [type="checkbox"]',(e,t)=>{let i=t.closest(".dt-cell"),{rowIndex:s,isHeader:n}=h.data(i),a=t.checked;n?this.checkAll(a):this.checkRow(s,a)}))}refreshRows(){this.instance.renderBody(),this.instance.setDimensions()}refreshRow(e,t){this.datamanager.updateRow(e,t).forEach(s=>{this.cellmanager.refreshCell(s)})}getCheckedRows(){if(!this.checkMap)return[];let e=[];for(let t in this.checkMap)this.checkMap[t]===1&&e.push(t);return e}highlightCheckedRows(){this.getCheckedRows().map(e=>this.checkRow(e,!0))}checkRow(e,t){let i=t?1:0,s=n=>`.dt-cell--0-${n} [type="checkbox"]`;this.checkMap[e]=i,h.each(s(e),this.bodyScrollable).map(n=>{n.checked=t}),this.highlightRow(e,t),this.showCheckStatus(),this.fireEvent("onCheckRow",this.datamanager.getRow(e))}checkAll(e){let t=e?1:0;e?this.checkMap=Array.from(Array(this.getTotalRows())).map(i=>t):this.checkMap=[],h.each('.dt-cell--col-0 [type="checkbox"]',this.bodyScrollable).map(i=>{i.checked=e}),this.highlightAll(e),this.showCheckStatus(),this.fireEvent("onCheckRow")}showCheckStatus(){if(!this.options.checkedRowStatus)return;let t=this.getCheckedRows().length;if(t>0){let i=this.instance.translate("{count} rows selected",{count:t});this.bodyRenderer.showToastMessage(i)}else this.bodyRenderer.clearToastMessage()}highlightRow(e,t=!0){let i=this.getRow$(e);if(!!i){if(!t&&this.bodyScrollable.classList.contains("dt-scrollable--highlight-all")){i.classList.add("dt-row--unhighlight");return}t&&i.classList.contains("dt-row--unhighlight")&&i.classList.remove("dt-row--unhighlight"),this._highlightedRows=this._highlightedRows||{},t?(i.classList.add("dt-row--highlight"),this._highlightedRows[e]=i):(i.classList.remove("dt-row--highlight"),delete this._highlightedRows[e])}}highlightAll(e=!0){if(e)this.bodyScrollable.classList.add("dt-scrollable--highlight-all");else{this.bodyScrollable.classList.remove("dt-scrollable--highlight-all");for(let t in this._highlightedRows)this._highlightedRows[t].classList.remove("dt-row--highlight");this._highlightedRows={}}}showRows(e){e=Wn(e);let t=e.map(i=>this.datamanager.getRow(i));this.bodyRenderer.renderRows(t)}showAllRows(){let e=this.datamanager.getAllRowIndices();this.showRows(e)}getChildrenToShowForNode(e){let t=this.datamanager.getRow(e);return t.meta.isTreeNodeClose=!1,this.datamanager.getImmediateChildren(e)}openSingleNode(e){let t=this.getChildrenToShowForNode(e),i=this.bodyRenderer.visibleRowIndices,s=hi([...t,...i]).sort(Re);this.showRows(s)}getChildrenToHideForNode(e){let t=this.datamanager.getRow(e);t.meta.isTreeNodeClose=!0;let i=this.datamanager.getChildren(e);return i.forEach(s=>{let n=this.datamanager.getRow(s);n.meta.isLeaf||(n.meta.isTreeNodeClose=!0)}),i}closeSingleNode(e){let t=this.getChildrenToHideForNode(e),s=this.bodyRenderer.visibleRowIndices.filter(n=>!t.includes(n)).sort(Re);this.showRows(s)}expandAllNodes(){let i=this.datamanager.getRows().filter(a=>!a.meta.isLeaf).map(a=>this.getChildrenToShowForNode(a.meta.rowIndex)).flat(),s=this.bodyRenderer.visibleRowIndices,n=hi([...i,...s]).sort(Re);this.showRows(n)}collapseAllNodes(){let i=this.datamanager.getRows().filter(a=>a.meta.indent===0).map(a=>this.getChildrenToHideForNode(a.meta.rowIndex)).flat(),n=this.bodyRenderer.visibleRowIndices.filter(a=>!i.includes(a)).sort(Re);this.showRows(n)}setTreeDepth(e){let t=this.datamanager.getRows(),i=t.filter(c=>c.meta.indent<e),s=t.filter(c=>c.meta.indent>=e),n=s.filter(c=>c.meta.indent>e);s.forEach(c=>{c.meta.isLeaf||(c.meta.isTreeNodeClose=!0)}),i.forEach(c=>{c.meta.isLeaf||(c.meta.isTreeNodeClose=!1)});let a=t.filter(c=>!n.includes(c)).map(c=>c.meta.rowIndex).sort(Re);this.showRows(a)}getRow$(e){return h(this.selector(e),this.bodyScrollable)}getTotalRows(){return this.datamanager.getRowCount()}getFirstRowIndex(){return 0}getLastRowIndex(){return this.datamanager.getRowCount()-1}scrollToRow(e){e=+e,this._lastScrollTo=this._lastScrollTo||0;let t=this.getRow$(e);if(h.inViewport(t,this.bodyScrollable))return;let{height:i}=t.getBoundingClientRect(),{top:s,bottom:n}=this.bodyScrollable.getBoundingClientRect(),a=Math.floor((n-s)/i),c=0;e>this._lastScrollTo?c=i*(e+1-a):c=i*(e+1-1),this._lastScrollTo=e,h.scrollTop(this.bodyScrollable,c)}getRowHTML(e,t){let i=Ct(t),s=t.rowIndex;return t.isFilter&&(e=e.map(n=>Object.assign({},n,{content:this.getFilterInput({colIndex:n.colIndex,name:n.name}),isFilter:1,isHeader:void 0,editable:!1})),s="filter"),t.isHeader&&(s="header"),`
            <div class="dt-row dt-row-${s}" ${i}>
                ${e.map(n=>this.cellmanager.getCellHTML(n)).join("")}
            </div>
        `}getFilterInput(e){let t=`title="Filter based on ${e.name||"Index"}"`;return`<input class="dt-filter dt-input" type="text" ${Ct(e)} tabindex="1" 
            ${e.colIndex===0?"disabled":t} />`}selector(e){return`.dt-row-${e}`}},Bn=ts(function(r,e){(function(t){r.exports=t()})(function(){return function t(i,s,n){function a(g,b){if(!s[g]){if(!i[g]){var m=typeof Ue=="function"&&Ue;if(!b&&m)return m(g,!0);if(c)return c(g,!0);var _=new Error("Cannot find module '"+g+"'");throw _.code="MODULE_NOT_FOUND",_}var v=s[g]={exports:{}};i[g][0].call(v.exports,function(y){var C=i[g][1][y];return a(C||y)},v,v.exports,t,i,s,n)}return s[g].exports}for(var c=typeof Ue=="function"&&Ue,u=0;u<n.length;u++)a(n[u]);return a}({1:[function(t,i,s){Object.defineProperty(s,"__esModule",{value:!0});var n=function(){function b(m,_){for(var v=0;v<_.length;v++){var y=_[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(m,y.key,y)}}return function(m,_,v){return _&&b(m.prototype,_),v&&b(m,v),m}}();function a(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}var c={width:"100%",height:"100%"},u=function(m){return Number(m)===Number(m)},g=function(){n(b,null,[{key:"create",value:function(_,v){return new b(_,v)}},{key:"mergeStyle",value:function(_,v){for(var y in v)_.style[y]!==v[y]&&(_.style[y]=v[y])}},{key:"getMaxBrowserHeight",value:function(){var _=document.createElement("div"),v=document.createElement("div");b.mergeStyle(_,{position:"absolute",height:"1px",opacity:0}),b.mergeStyle(v,{height:"1e7px"}),_.appendChild(v),document.body.appendChild(_);var y=v.offsetHeight;return document.body.removeChild(_),y}}]);function b(m,_){var v=this;a(this,b),this._config={},this._lastRepaint=null,this._maxElementHeight=b.getMaxBrowserHeight(),this.refresh(m,_);var y=this._config,C=function R(){var I=v._getScrollPosition(),N=v._lastRepaint;if(v._renderAnimationFrame=window.requestAnimationFrame(R),I!==N&&(!N||Math.abs(I-N)>v._averageHeight)){var A=v._renderChunk();v._lastRepaint=I,A!==!1&&typeof y.afterRender=="function"&&y.afterRender()}};C()}return n(b,[{key:"destroy",value:function(){window.cancelAnimationFrame(this._renderAnimationFrame)}},{key:"refresh",value:function(_,v){var y=this;if(Object.assign(this._config,c,v),!_||_.nodeType!==1)throw new Error("HyperList requires a valid DOM Node container");this._element=_;var C=this._config,R=this._scroller||C.scroller||document.createElement(C.scrollerTagName||"tr");if(typeof C.useFragment!="boolean"&&(this._config.useFragment=!0),!C.generate)throw new Error("Missing required `generate` function");if(!u(C.total))throw new Error("Invalid required `total` value, expected number");if(!Array.isArray(C.itemHeight)&&!u(C.itemHeight))throw new Error("\n        Invalid required `itemHeight` value, expected number or array\n      ".trim());u(C.itemHeight)?this._itemHeights=Array(C.total).fill(C.itemHeight):this._itemHeights=C.itemHeight,Object.keys(c).filter(function(F){return F in C}).forEach(function(F){var E=C[F],V=u(E),P=V?!1:E.slice(-1)==="%";if(E&&typeof E!="string"&&typeof E!="number"){var se="Invalid optional `"+F+"`, expected string or number";throw new Error(se)}else V&&(C[F]=E+"px");if(F==="height"){var re=V?E:parseInt(E.replace(/px|%/,""),10);P?y._containerHeight=window.innerHeight*re/100:y._containerHeight=u(E)?E:re}});var I={width:""+C.width,height:""+C.height,overflow:"auto",position:"relative"};b.mergeStyle(_,I);var N=C.itemHeight*C.total,A=this._maxElementHeight;N>A&&console.warn(["HyperList: The maximum element height",A+"px has","been exceeded; please reduce your item height."].join(" "));var z={opacity:"0",position:"absolute",width:"1px",height:N+"px"};b.mergeStyle(R,z),this._scroller||_.appendChild(R),this._scroller=R,this._scrollHeight=this._computeScrollHeight(),this._itemPositions=this._itemPositions||Array(C.total).fill(0),this._computePositions(0),this._renderChunk(this._lastRepaint!==null),typeof C.afterRender=="function"&&C.afterRender()}},{key:"_getRow",value:function(_){var v=this._config,y=v.generate(_),C=y.height;if(C!==void 0&&u(C)?(y=y.element,C!==this._itemHeights&&(this._itemHeights[_]=C,this._computePositions(_),this._scrollHeight=this._computeScrollHeight(_))):C=this._itemHeights[_],!y||y.nodeType!==1)throw new Error("Generator did not return a DOM Node for index: "+_);var R=y.getAttribute("class")||"";y.setAttribute("class",R+" "+(v.rowClassName||"vrow"));var I=this._itemPositions[_];return b.mergeStyle(y,{position:"absolute",top:I+"px"}),y}},{key:"_getScrollPosition",value:function(){var _=this._config;return typeof _.overrideScrollPosition=="function"?_.overrideScrollPosition():this._element.scrollTop}},{key:"_renderChunk",value:function(_){var v=this._config,y=this._element,C=this._getScrollPosition(),R=v.total,I=v.reverse?this._getReverseFrom(C):this._getFrom(C)-1;if((I<0||I-this._screenItemsLen<0)&&(I=0),!_&&this._lastFrom===I)return!1;this._lastFrom=I;var N=I+this._cachedItemsLen;(N>R||N+this._cachedItemsLen>R)&&(N=R);var A=v.useFragment?document.createDocumentFragment():[],z=this._scroller;A[v.useFragment?"appendChild":"push"](z);for(var F=I;F<N;F++){var E=this._getRow(F);A[v.useFragment?"appendChild":"push"](E)}if(v.applyPatch)return v.applyPatch(y,A);y.innerHTML="",y.appendChild(A)}},{key:"_computePositions",value:function(){var _=arguments.length<=0||arguments[0]===void 0?1:arguments[0],v=this._config,y=v.total,C=v.reverse;_<1&&!C&&(_=1);for(var R=_;R<y;R++)C?R===0?this._itemPositions[0]=this._scrollHeight-this._itemHeights[0]:this._itemPositions[R]=this._itemPositions[R-1]-this._itemHeights[R]:this._itemPositions[R]=this._itemHeights[R-1]+this._itemPositions[R-1]}},{key:"_computeScrollHeight",value:function(){var _=this,v=this._config,y=v.total,C=this._itemHeights.reduce(function(z,F){return z+F},0);b.mergeStyle(this._scroller,{opacity:0,position:"absolute",width:"1px",height:C+"px"});var R=this._itemHeights.slice(0).sort(function(z,F){return z-F}),I=Math.floor(y/2),N=y%2===0?(R[I]+R[I-1])/2:R[I],A=this._element.clientHeight?this._element.clientHeight:this._containerHeight;return this._screenItemsLen=Math.ceil(A/N),this._containerHeight=A,this._cachedItemsLen=Math.max(this._cachedItemsLen||0,this._screenItemsLen*3),this._averageHeight=N,v.reverse&&window.requestAnimationFrame(function(){_._element.scrollTop=C}),C}},{key:"_getFrom",value:function(_){for(var v=0;this._itemPositions[v]<_;)v++;return v}},{key:"_getReverseFrom",value:function(_){for(var v=this._config.total-1;v>0&&this._itemPositions[v]<_+this._containerHeight;)v--;return v}}]),b}();s.default=g,i.exports=s.default},{}]},{},[1])(1)})}),qn=es(Bn),Ci=class{constructor(e){this.instance=e,this.options=e.options,this.datamanager=e.datamanager,this.rowmanager=e.rowmanager,this.cellmanager=e.cellmanager,this.bodyScrollable=e.bodyScrollable,this.footer=this.instance.footer,this.log=e.log}renderRows(e){if(this.visibleRows=e,this.visibleRowIndices=e.map(n=>n.meta.rowIndex),e.length===0){this.bodyScrollable.innerHTML=this.getNoDataHTML();return}let t=this.datamanager.rowViewOrder.map(n=>this.visibleRowIndices.includes(n)?n:null).filter(n=>n!==null),i=getComputedStyle(this.bodyScrollable),s={width:i.width,height:i.height,itemHeight:this.options.cellHeight,total:e.length,generate:n=>{let a=document.createElement("div"),c=t[n],u=this.datamanager.getRow(c),g=this.rowmanager.getRowHTML(u,u.meta);return a.innerHTML=g,a.children[0]},afterRender:()=>{this.restoreState()}};this.hyperlist?this.hyperlist.refresh(this.bodyScrollable,s):this.hyperlist=new qn(this.bodyScrollable,s),this.renderFooter()}render(){let e=this.datamanager.getRowsForView();this.renderRows(e),this.instance.setDimensions()}renderFooter(){if(!this.options.showTotalRow)return;let e=this.getTotalRow(),t=this.rowmanager.getRowHTML(e,{isTotalRow:1,rowIndex:"totalRow"});this.footer.innerHTML=t}getTotalRow(){return this.datamanager.getColumns().map(s=>{let n=null;return["_rowIndex","_checkbox"].includes(s.id)&&(n=""),{content:n,isTotalRow:1,colIndex:s.colIndex,column:s}}).map((s,n)=>{if(s.content==="")return s;if(this.options.hooks.columnTotal){let a=this.visibleRows.map(u=>u[n].content),c=this.options.hooks.columnTotal.call(this.instance,a,s);if(c!=null)return s.content=c,s}return s.content=this.visibleRows.reduce((a,c)=>{let u=c[n];return typeof u.content=="number"?(a==null&&(a=0),a+u.content):a},s.content),s})}restoreState(){this.rowmanager.highlightCheckedRows(),this.cellmanager.selectAreaOnClusterChanged(),this.cellmanager.focusCellOnClusterChanged()}showToastMessage(e,t){this.instance.toastMessage.innerHTML=this.getToastMessageHTML(e),t&&setTimeout(()=>{this.clearToastMessage()},t*1e3)}clearToastMessage(){this.instance.toastMessage.innerHTML=""}getNoDataHTML(){return`<div class="dt-scrollable__no-data">${this.options.noDataMessage}</div>`}getToastMessageHTML(e){return`<span class="dt-toast__message">${e}</span>`}},$i=class{constructor(e){this.instance=e,it(this,this.instance,["options","datamanager","columnmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer"]),this.scopeClass="dt-instance-"+e.constructor.instances,e.datatableWrapper.classList.add(this.scopeClass);let t=document.createElement("style");e.wrapper.insertBefore(t,e.datatableWrapper),this.styleEl=t,this.bindResizeWindow(),this.bindScrollHeader()}get stylesheet(){return this.styleEl.sheet}bindResizeWindow(){this.onWindowResize=this.onWindowResize.bind(this),this.onWindowResize=gi(this.onWindowResize,300),this.options.layout==="fluid"&&h.on(window,"resize",this.onWindowResize)}bindScrollHeader(){this._settingHeaderPosition=!1,h.on(this.bodyScrollable,"scroll",e=>{this._settingHeaderPosition||(this._settingHeaderPosition=!0,requestAnimationFrame(()=>{let t=-e.target.scrollLeft;h.style(this.header,{transform:`translateX(${t}px)`}),h.style(this.footer,{transform:`translateX(${t}px)`}),this._settingHeaderPosition=!1}))})}onWindowResize(){this.distributeRemainingWidth(),this.refreshColumnWidth(),this.setBodyStyle()}destroy(){this.styleEl.remove(),h.off(window,"resize",this.onWindowResize)}setStyle(e,t){if(e.includes(",")){e.split(",").map(a=>a.trim()).forEach(a=>{this.setStyle(a,t)});return}if(e=e.trim(),!e)return;this._styleRulesMap=this._styleRulesMap||{};let i=this._getPrefixedSelector(e);this._styleRulesMap[i]&&(this.removeStyle(e),t=Object.assign({},this._styleRulesMap[i],t));let s=this._getRuleString(t),n=`${i} { ${s} }`;this._styleRulesMap[i]=t,this.stylesheet.insertRule(n)}removeStyle(e){if(e.includes(",")){e.split(",").map(s=>s.trim()).forEach(s=>{this.removeStyle(s)});return}if(e=e.trim(),!e)return;let t=this._getPrefixedSelector(e),i=Array.from(this.stylesheet.cssRules).findIndex(s=>s.selectorText===t);i!==-1&&this.stylesheet.deleteRule(i)}_getPrefixedSelector(e){return`.${this.scopeClass} ${e}`}_getRuleString(e){return Object.keys(e).map(t=>{let i=t;return t.includes("-")||(i=mi(t)),`${i}:${e[t]};`}).join("")}setDimensions(){this.setCellHeight(),this.setupMinWidth(),this.setupNaturalColumnWidth(),this.setupColumnWidth(),this.distributeRemainingWidth(),this.setColumnStyle(),this.setBodyStyle()}setCellHeight(){this.setStyle(".dt-cell",{height:this.options.cellHeight+"px"})}setupMinWidth(){h.each(".dt-cell--header",this.header).map(e=>{let{colIndex:t}=h.data(e),i=this.getColumn(t);if(!i.minWidth){let s=h.style(h(".dt-cell__content",e),"width");i.minWidth=s}})}setupNaturalColumnWidth(){!h(".dt-row")||(h.each(".dt-row-header .dt-cell",this.header).map(e=>{let{colIndex:t}=h.data(e),i=this.datamanager.getColumn(t),s=h.style(h(".dt-cell__content",e),"width");typeof s=="number"&&s>=this.options.minimumColumnWidth?i.naturalWidth=s:i.naturalWidth=this.options.minimumColumnWidth}),h.each(".dt-row-0 .dt-cell",this.bodyScrollable).map(e=>{let{colIndex:t}=h.data(e),i=this.datamanager.getColumn(t),s=h.style(h(".dt-cell__content",e),"width");typeof s=="number"&&s>=i.naturalWidth?i.naturalWidth=s:i.naturalWidth=i.naturalWidth}))}setupColumnWidth(){if(this.options.layout==="ratio"){let e=h.style(this.datatableWrapper,"width");if(this.options.serialNoColumn){let s=this.datamanager.getColumnById("_rowIndex");e=e-s.width-1}if(this.options.checkboxColumn){let s=this.datamanager.getColumnById("_checkbox");e=e-s.width-1}let t=this.datamanager.getColumns().map(s=>s.id==="_rowIndex"||s.id==="_checkbox"?0:(s.width||(s.width=1),s.ratioWidth=parseInt(s.width,10),s.ratioWidth)).reduce((s,n)=>s+n),i=e/t;this.datamanager.getColumns().map(s=>{s.id==="_rowIndex"||s.id==="_checkbox"||(s.width=Math.floor(i*s.ratioWidth)-1)})}else this.datamanager.getColumns().map(e=>{e.width||(e.width=e.naturalWidth),e.id==="_rowIndex"&&(e.width=this.getRowIndexColumnWidth()),e.width<this.options.minimumColumnWidth&&(e.width=this.options.minimumColumnWidth)})}distributeRemainingWidth(){if(this.options.layout!=="fluid")return;let e=h.style(this.instance.datatableWrapper,"width"),t=h(".dt-row",this.bodyScrollable),i=e;if(t)i=h.style(t,"width");else{let a=h(".dt-row",this.instance.header);i=Array.from(a.children).map(u=>u.offsetWidth).reduce((u,g)=>u+g,0)}let s=this.datamanager.getColumns().filter(a=>a.resizable),n=(e-i)/s.length;s.map(a=>{let c=h.style(this.getColumnHeaderElement(a.colIndex),"width"),u=Math.floor(c+n)-2;this.datamanager.updateColumn(a.colIndex,{width:u})})}setColumnStyle(){this.datamanager.getColumns().map(e=>{e.align||(e.align="left"),["left","center","right"].includes(e.align)||(e.align="left"),this.setStyle(`.dt-cell--col-${e.colIndex}`,{"text-align":e.align}),this.columnmanager.setColumnHeaderWidth(e.colIndex),this.columnmanager.setColumnWidth(e.colIndex)})}refreshColumnWidth(){this.datamanager.getColumns().map(e=>{this.columnmanager.setColumnHeaderWidth(e.colIndex),this.columnmanager.setColumnWidth(e.colIndex)})}setBodyStyle(){let e=h.style(this.datatableWrapper,"width"),t=h(".dt-row",this.bodyScrollable);if(!t)return;let i=h.style(t,"width"),s=e>i?i:e;h.style(this.bodyScrollable,{width:s+"px"}),h.removeStyle(this.bodyScrollable,"height");let n=h.getStyle(this.bodyScrollable,"height"),a=(this.bodyRenderer.hyperlist||{})._scrollHeight||1/0,c=h.hasHorizontalOverflow(this.bodyScrollable),u;a<n&&(u=a,c&&(u+=h.scrollbarSize()),h.style(this.bodyScrollable,{height:u+"px"})),this.bodyScrollable.scrollHeight-this.bodyScrollable.offsetHeight<h.scrollbarSize()&&h.style(this.bodyScrollable,{overflowY:"hidden"}),this.options.layout==="fluid"&&h.style(this.bodyScrollable,{overflowX:"hidden"})}getColumnHeaderElement(e){return e=+e,e<0?null:h(`.dt-cell--col-${e}`,this.header)}getRowIndexColumnWidth(){let e=this.datamanager.getRowCount(),t=22;return h.measureTextWidth(e+"")+t}},Vn={13:"enter",91:"meta",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",9:"tab",27:"esc",67:"c",70:"f",86:"v"},xi=class{constructor(e){this.listeners={},h.on(e,"keydown",this.handler.bind(this))}handler(e){let t=Vn[e.keyCode];e.shiftKey&&t!=="shift"&&(t="shift+"+t),(e.ctrlKey&&t!=="ctrl"||e.metaKey&&t!=="meta")&&(t="ctrl+"+t);let i=this.listeners[t];if(i&&i.length>0)for(let s of i){let n=s(e);(n===void 0||n===!0)&&e.preventDefault()}}on(e,t){e.split(",").map(s=>s.trim()).map(s=>{this.listeners[s]=this.listeners[s]||[],this.listeners[s].push(t)})}},Yn={"Sort Ascending":"Sort Ascending","Sort Descending":"Sort Descending","Reset sorting":"Reset sorting","Remove column":"Remove column","No Data":"No Data","{count} cells copied":{"1":"{count} cell copied",default:"{count} cells copied"},"{count} rows selected":{"1":"{count} row selected",default:"{count} rows selected"}},Xn={"Sort Ascending":"Aufsteigend sortieren","Sort Descending":"Absteigend sortieren","Reset sorting":"Sortierung zur\xFCcksetzen","Remove column":"Spalte entfernen","No Data":"Keine Daten","{count} cells copied":{"1":"{count} Zelle kopiert",default:"{count} Zellen kopiert"},"{count} rows selected":{"1":"{count} Zeile ausgew\xE4hlt",default:"{count} Zeilen ausgew\xE4hlt"}},Gn={"Sort Ascending":"Trier par ordre croissant","Sort Descending":"Trier par ordre d\xE9croissant","Reset sorting":"R\xE9initialiser le tri","Remove column":"Supprimer colonne","No Data":"Pas de donn\xE9es","{count} cells copied":{"1":"{count} cellule copi\xE9e",default:"{count} cellules copi\xE9es"},"{count} rows selected":{"1":"{count} ligne s\xE9lectionn\xE9e",default:"{count} lignes s\xE9lectionn\xE9es"}},Un={"Sort Ascending":"Ordinamento ascendente","Sort Descending":"Ordinamento decrescente","Reset sorting":"Azzeramento ordinamento","Remove column":"Rimuovi colonna","No Data":"Nessun dato","{count} cells copied":{"1":"Copiato {count} cella",default:"{count} celle copiate"},"{count} rows selected":{"1":"{count} linea selezionata",default:"{count} linee selezionate"}};function Kn(){return{en:Yn,de:Xn,fr:Gn,it:Un}}var ki=class{constructor(e){this.language=e,this.translations=Kn()}addTranslations(e){this.translations=Object.assign(this.translations,e)}translate(e,t){let i=this.translations[this.language]&&this.translations[this.language][e]||e;return typeof i=="object"&&(i=t&&t.count?this.getPluralizedTranslation(i,t.count):e),zn(i,t||{})}getPluralizedTranslation(e,t){return e[t]||e.default}};function Jn(r,e){let t=[];if(Object.keys(e).length===0)return r.map(i=>i.meta.rowIndex);for(let i in e){let s=e[i],a=(t.length?t.map(g=>r[g]):r).map(g=>g[i]),c=Zn(s),u=Qn(c);u?t=u(c.text,a):t=a.map(g=>g.rowIndex)}return t}function Qn(r){let e=n=>String(Pn(n.html||"")||n.content||"").toLowerCase(),t=n=>parseFloat(n.content),i=(n,a)=>{if(n.column.compareValue){let u=n.column.compareValue(n,a);if(u&&Array.isArray(u))return u}let c=t(n);return isNaN(c)?[e(n),a]:[c,a]};return{contains(n,a){return a.filter(c=>{let u=e(c),g=(n||"").toLowerCase();return!g||u.includes(g)}).map(c=>c.rowIndex)},greaterThan(n,a){return a.filter(c=>{let[u,g]=i(c,n);return u>g}).map(c=>c.rowIndex)},lessThan(n,a){return a.filter(c=>{let[u,g]=i(c,n);return u<g}).map(c=>c.rowIndex)},equals(n,a){return a.filter(c=>parseFloat(c.content)===n).map(c=>c.rowIndex)},notEquals(n,a){return a.filter(c=>parseFloat(c.content)!==n).map(c=>c.rowIndex)},range(n,a){return a.filter(c=>{let u=i(c,n[0]),g=i(c,n[1]),b=u[0];return b>=u[1]&&b<=g[1]}).map(c=>c.rowIndex)},containsNumber(n,a){return a.filter(c=>{let u=parseFloat(n,10),g=n,b=t(c),m=e(c);return u===b||m.includes(g)}).map(c=>c.rowIndex)}}[r.type]}function Zn(r=""){if(r.length===0)return{};let e=r;return[">","<","="].includes(e[0])?e=r.slice(1):e.startsWith("!=")&&(e=r.slice(2)),r.startsWith(">")&&e?{type:"greaterThan",text:e.trim()}:r.startsWith("<")&&e?{type:"lessThan",text:e.trim()}:r.startsWith("=")&&Ke(e)?{type:"equals",text:Number(r.slice(1).trim())}:Ke(e)?{type:"containsNumber",text:e}:r.startsWith("!=")&&Ke(e)?{type:"notEquals",text:Number(r.slice(2).trim())}:r.split(":").length===2?(e=r.split(":"),{type:"range",text:e.map(t=>t.trim())}):{type:"contains",text:e.toLowerCase()}}function eo(r){return{columns:[],data:[],dropdownButton:$t.chevronDown,headerDropdown:[{label:r.translate("Sort Ascending"),action:function(e){this.sortColumn(e.colIndex,"asc")}},{label:r.translate("Sort Descending"),action:function(e){this.sortColumn(e.colIndex,"desc")}},{label:r.translate("Reset sorting"),action:function(e){this.sortColumn(e.colIndex,"none")}},{label:r.translate("Remove column"),action:function(e){this.removeColumn(e.colIndex)}}],events:{onRemoveColumn(e){},onSwitchColumn(e,t){},onSortColumn(e){},onCheckRow(e){},onDestroy(){}},hooks:{columnTotal:null},sortIndicator:{asc:"\u2191",desc:"\u2193",none:""},overrideComponents:{},filterRows:Jn,freezeMessage:"",getEditor:null,serialNoColumn:!0,checkboxColumn:!1,clusterize:!0,logs:!1,layout:"fixed",noDataMessage:r.translate("No Data"),cellHeight:40,minimumColumnWidth:30,inlineFilters:!1,treeView:!1,checkedRowStatus:!0,dynamicRowHeight:!1,pasteFromClipboard:!1,showTotalRow:!1,direction:"ltr",disableReorderColumn:!1}}var to={DataManager:bi,CellManager:wi,ColumnManager:yi,RowManager:vi,BodyRenderer:Ci,Style:$i,Keyboard:xi},ye=class{constructor(e,t){if(ye.instances++,typeof e=="string"&&(e=document.querySelector(e)),this.wrapper=e,!(this.wrapper instanceof HTMLElement))throw new Error("Invalid argument given for `wrapper`");this.initializeTranslations(t),this.setDefaultOptions(),this.buildOptions(t),this.prepare(),this.initializeComponents(),this.options.data&&(this.refresh(),this.columnmanager.applyDefaultSortOrder())}initializeTranslations(e){this.language=e.language||"en",this.translationManager=new ki(this.language),e.translations&&this.translationManager.addTranslations(e.translations)}setDefaultOptions(){this.DEFAULT_OPTIONS=eo(this)}buildOptions(e){this.options=this.options||{},this.options=Object.assign({},this.DEFAULT_OPTIONS,this.options||{},e),e.headerDropdown=e.headerDropdown||[],this.options.headerDropdown=[...this.DEFAULT_OPTIONS.headerDropdown,...e.headerDropdown],this.events=Object.assign({},this.DEFAULT_OPTIONS.events,this.options.events||{},e.events||{}),this.fireEvent=this.fireEvent.bind(this)}prepare(){this.prepareDom(),this.unfreeze()}initializeComponents(){let e=Object.assign({},to,this.options.overrideComponents),{Style:t,Keyboard:i,DataManager:s,RowManager:n,ColumnManager:a,CellManager:c,BodyRenderer:u}=e;this.style=new t(this),this.keyboard=new i(this.wrapper),this.datamanager=new s(this.options),this.rowmanager=new n(this),this.columnmanager=new a(this),this.cellmanager=new c(this),this.bodyRenderer=new u(this)}prepareDom(){this.wrapper.innerHTML=`
            <div class="datatable" dir="${this.options.direction}">
                <div class="dt-header"></div>
                <div class="dt-scrollable"></div>
                <div class="dt-footer"></div>
                <div class="dt-freeze">
                    <span class="dt-freeze__message">
                        ${this.options.freezeMessage}
                    </span>
                </div>
                <div class="dt-toast"></div>
                <div class="dt-dropdown-container"></div>
                <textarea class="dt-paste-target"></textarea>
            </div>
        `,this.datatableWrapper=h(".datatable",this.wrapper),this.header=h(".dt-header",this.wrapper),this.footer=h(".dt-footer",this.wrapper),this.bodyScrollable=h(".dt-scrollable",this.wrapper),this.freezeContainer=h(".dt-freeze",this.wrapper),this.toastMessage=h(".dt-toast",this.wrapper),this.pasteTarget=h(".dt-paste-target",this.wrapper),this.dropdownContainer=h(".dt-dropdown-container",this.wrapper)}refresh(e,t){this.datamanager.init(e,t),this.render(),this.setDimensions()}destroy(){this.wrapper.innerHTML="",this.style.destroy(),this.fireEvent("onDestroy")}appendRows(e){this.datamanager.appendRows(e),this.rowmanager.refreshRows()}refreshRow(e,t){this.rowmanager.refreshRow(e,t)}render(){this.renderHeader(),this.renderBody()}renderHeader(){this.columnmanager.renderHeader()}renderBody(){this.bodyRenderer.render()}setDimensions(){this.style.setDimensions()}showToastMessage(e,t){this.bodyRenderer.showToastMessage(e,t)}clearToastMessage(){this.bodyRenderer.clearToastMessage()}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}getRows(){return this.datamanager.getRows()}getCell(e,t){return this.datamanager.getCell(e,t)}getColumnHeaderElement(e){return this.columnmanager.getColumnHeaderElement(e)}getViewportHeight(){return this.viewportHeight||(this.viewportHeight=h.style(this.bodyScrollable,"height")),this.viewportHeight}sortColumn(e,t){this.columnmanager.sortColumn(e,t)}removeColumn(e){this.columnmanager.removeColumn(e)}scrollToLastColumn(){this.datatableWrapper.scrollLeft=9999}freeze(){h.style(this.freezeContainer,{display:""})}unfreeze(){h.style(this.freezeContainer,{display:"none"})}updateOptions(e){this.buildOptions(e)}fireEvent(e,...t){let i=[...this._internalEventHandlers[e]||[],this.events[e]].filter(Boolean);for(let s of i)s.apply(this,t)}on(e,t){this._internalEventHandlers=this._internalEventHandlers||{},this._internalEventHandlers[e]=this._internalEventHandlers[e]||[],this._internalEventHandlers[e].push(t)}log(){this.options.logs&&console.log.apply(console,arguments)}translate(e,t){return this.translationManager.translate(e,t)}};ye.instances=0;var io="frappe-datatable",so="0.0.0-development",ro="A modern datatable library for the web",no="dist/frappe-datatable.cjs.js",oo="dist/frappe-datatable.min.js",ao="dist/frappe-datatable.min.js",lo={start:"yarn run dev",build:"rollup -c && NODE_ENV=production rollup -c",dev:"rollup -c -w","cy:server":"http-server -p 8989","cy:open":"cypress open","cy:run":"cypress run",test:"start-server-and-test cy:server http://localhost:8989 cy:run","test-local":"start-server-and-test cy:server http://localhost:8989 cy:open","travis-deploy-once":"travis-deploy-once","semantic-release":"semantic-release",lint:"eslint src","lint-and-build":"yarn lint && yarn build",commit:"npx git-cz"},co=["dist","src"],ho={autoprefixer:"^9.0.0",chai:"3.5.0",cypress:"^9.2.0","cz-conventional-changelog":"^2.1.0",deepmerge:"^2.0.1",eslint:"^5.0.1","eslint-config-airbnb":"^16.1.0","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.11.0","http-server":"^0.11.1",mocha:"3.3.0","postcss-custom-properties":"^7.0.0","postcss-nested":"^3.0.0",rollup:"^0.59.4","rollup-plugin-commonjs":"^8.3.0","rollup-plugin-eslint":"^4.0.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.3","rollup-plugin-postcss":"^1.2.8","rollup-plugin-uglify-es":"^0.0.1","semantic-release":"^17.1.1","start-server-and-test":"^1.4.1","travis-deploy-once":"^5.0.1"},uo={type:"git",url:"https://github.com/frappe/datatable.git"},po=["datatable","data","grid","table"],fo="Faris Ansari",_o="MIT",mo={url:"https://github.com/frappe/datatable/issues"},go="https://frappe.io/datatable",bo={hyperlist:"^1.0.0-beta",lodash:"^4.17.5",sortablejs:"^1.7.0"},wo={commitizen:{path:"cz-conventional-changelog"}},yo={name:io,version:so,description:ro,main:no,unpkg:oo,jsdelivr:ao,scripts:lo,files:co,devDependencies:ho,repository:uo,keywords:po,author:fo,license:_o,bugs:mo,homepage:go,dependencies:bo,config:wo};ye.__version__=yo.version;Si.exports=ye});$(document).on("app_ready",function(){document.referrer.endsWith("/login")&&frappe.call({method:"erpnext_oob.utils.get_user_default",callback:function(r){r.message&&r.message.forEach(function(e){var t=e.setting_key.toLowerCase().replaceAll(" ","_");frappe.defaults.set_user_default_local(t,e.setting_value)})}})});$(document).bind("toolbar_setup",function(){});frappe.views.Calendar=class extends frappe.views.Calendar{setup_options(e){super.setup_options(e),this.cal_options.locale=="zh"&&(this.cal_options.locale="zh-cn")}};var To=class extends frappe.views.ListView{get_column_html(e,t){if(e.type==="Status")return`
				<div class="list-row-col hidden-xs ellipsis">
					${this.get_indicator_html(t)}
				</div>
			`;let i=e.df||{},s=i.label,n=i.fieldname,a=t[n]||"",c=()=>i.fieldtype==="Code"?a:i.fieldtype==="Percent"?`<div class="progress level" style="margin: 0px;">
						<div class="progress-bar progress-bar-success" role="progressbar"
							aria-valuenow="${a}"
							aria-valuemin="0" aria-valuemax="100" style="width: ${Math.round(a)}%;">
						</div>
					</div>`:frappe.format(a,i,null,t),u=()=>{let v,y;return this.settings.formatters&&this.settings.formatters[n]?y=this.settings.formatters[n](a,i,t):i.fieldtype=="Text Editor"||i.fetch_from&&["Text","Small Text"].includes(i.fieldtype)?y=strip_html(a):y=typeof a=="string"?frappe.utils.escape_html(a):a,i.fieldtype==="Image"?v=i.options?`<img src="${t[i.options]}" style="max-height: 30px; max-width: 100%;">`:`<div class="missing-image small">
						<span class="octicon octicon-circle-slash"></span>
					</div>`:i.fieldtype==="Select"?v=`<span class="filterable indicator ${frappe.utils.guess_colour(y)} ellipsis"
					data-filter="${n},=,${a}">
					${__(y)}
				</span>`:i.fieldtype==="Link"?v=`<a class="filterable text-muted ellipsis"
					data-filter="${n},=,${a}">
					${__(y)}
				</a>`:["Text Editor","Text","Small Text","HTML Editor"].includes(i.fieldtype)?v=`<span class="text-muted ellipsis">
					${__(y)}
				</span>`:v=`<a class="filterable text-muted ellipsis"
					data-filter="${n},=,${a}">
					${c()}
				</a>`,`<span class="ellipsis"
				title="${__(s)}: ${__(y)}">
				${v}
			</span>`},b=["list-row-col ellipsis",{Subject:"list-subject level",Field:"hidden-xs"}[e.type],frappe.model.is_numeric_field(i)?"text-right":""].join(" "),_={Subject:this.get_subject_html(t),Field:u()}[e.type];return`
			<div class="${b}">
				${_}
			</div>
		`}get_subject_html(e){let t=frappe.session.user,i=this.columns[0].df,s=e[i.fieldname]||e.name,n=strip_html(s.toString()),a=frappe.utils.escape_html(n),c=JSON.parse(e._liked_by||"[]"),u=c.includes(t)?"liked-by":"text-extra-muted not-liked",g=JSON.parse(e._seen||"[]").includes(t)?"":"bold";return`
			<input class="level-item list-row-checkbox hidden-xs" type="checkbox" data-name="${escape(e.name)}">
			<span class="level-item" style="margin-bottom: 1px;">
				<i class="octicon octicon-heart like-action ${u}"
					data-name="${e.name}" data-doctype="${this.doctype}"
					data-liked-by="${encodeURI(e._liked_by)||"[]"}"
				>
				</i>
				<span class="likes-count">
					${c.length>99?__("99")+"+":__(c.length||"")}
				</span>
			</span>
			<span class="level-item ${g} ellipsis" title="${__(a)}">
				<a class="ellipsis" href="${this.get_form_link(e)}" title="${__(a)}" data-doctype="${this.doctype}" data-name="${e.name}">
				${__(n)}
				</a>
			</span>
		`}};frappe.model.with_doctype("Print Format");var ae=class{constructor(e){Object.assign(this,e),this.editing=Boolean(this.values&&Object.keys(this.values).length)}make(){this.make_dialog(),this.setup_dialog_events(),this.dialog.show(),window.cur_dialog=this.dialog,this.editing&&this.set_default_values()}make_dialog(){this.dialog=new frappe.ui.Dialog({title:this.get_title(),fields:this.get_fields(),primary_action:e=>{e=this.process_data(e),!this.editing&&!e.name&&(e.name=`${this.type}-${this.label}-${frappe.utils.get_random(20)}`),this.dialog.hide(),this.primary_action(e)},primary_action_label:this.primary_action_label||__("Add")})}get_title(){let e=this.editing?"Edit":"Add",t=e=e+" "+frappe.model.unscrub(this.type);return __(t)}get_fields(){}set_default_values(){return this.dialog.set_values(this.values)}process_data(e){return e}setup_dialog_events(){}hide_field(e){this.dialog.set_df_property(e,"hidden",!0)}show_field(e){this.dialog.set_df_property(e,"hidden",!1)}setup_filter(e){this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group);let t=this.dialog.get_field("filter_area_loading").$wrapper;$(`<span class="text-muted">${__("Loading Filters...")}</span>`).appendTo(t),this.filters=[],this.generate_filter_from_json&&this.generate_filter_from_json(),this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:e,on_change:()=>{}}),frappe.model.with_doctype(e,()=>{this.filter_group.add_filters_to_filter_group(this.filters),this.hide_field("filter_area_loading"),this.show_field("filter_area")})}},Gt=class extends ae{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"chart_name",label:"Chart Name",options:"Dashboard Chart",reqd:1},{fieldtype:"Data",fieldname:"label",label:"Label"}]}process_data(e){return e.label=e.label?e.label:e.chart_name,e}},Ut=class extends ae{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"document_type",label:"DocType",options:"DocType",reqd:1,onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.document_type&&this.setup_filter(this.document_type)},get_query:()=>({filters:{issingle:0,istable:0}})},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Section Break",fieldname:"filter_section",label:__("Add Filters"),depends_on:"eval: doc.document_type"},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area"}]}generate_filter_from_json(){this.values&&this.values.quick_list_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.quick_list_filter,this.values.document_type))}process_data(e){if(this.filter_group){let t=this.filter_group.get_filters();e.quick_list_filter=frappe.utils.get_filter_as_json(t)}return e.label=e.label?e.label:e.document_type,e}},Kt=class extends ae{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"onboarding_name",label:"Onboarding Name",options:"Module Onboarding",reqd:1}]}},Jt=class extends ae{constructor(e){super(e)}get_fields(){let e=this;return[{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldname:"links",fieldtype:"Table",label:__("Card Links"),editable_grid:1,data:e.values?JSON.parse(e.values.links):[],get_data:()=>e.values?JSON.parse(e.values.links):[],fields:[{fieldname:"label",fieldtype:"Data",in_list_view:1,label:"Label"},{fieldname:"icon",fieldtype:"Icon",label:"Icon"},{fieldname:"link_type",fieldtype:"Select",in_list_view:1,label:"Link Type",reqd:1,options:["DocType","Page","Report"]},{fieldname:"link_to",fieldtype:"Dynamic Link",in_list_view:1,label:"Link To",reqd:1,get_options:t=>t.doc.link_type},{fieldname:"column_break_7",fieldtype:"Column Break"},{fieldname:"dependencies",fieldtype:"Data",label:"Dependencies"},{fieldname:"only_for",fieldtype:"Link",label:"Only for",options:"Country"},{default:"0",fieldname:"onboard",fieldtype:"Check",label:"Onboard"},{default:"0",fieldname:"is_query_report",fieldtype:"Check",label:"Is Query Report"}]}]}process_data(e){let t="";return e.links?e.links.map((i,s)=>{let n=s+1;i.link_type||(t=__("Following fields have missing values")+": <br><br><ul>",t+=`<li>${__("Link Type in Row")} ${n}</li>`),i.link_to||(t+=`<li>${__("Link To in Row")} ${n}</li>`),i.label=i.label?i.label:i.link_to}):t=__("You must add atleast one link."),t&&(t+="</ul>",frappe.throw({message:__(t),title:__("Missing Values Required"),indicator:"orange"})),e.label=e.label?e.label:e.chart_name,e}},Qt=class extends ae{constructor(e){super(e)}hide_filters(){this.hide_field("count_section_break"),this.hide_field("filters_section_break")}show_filters(){this.show_field("count_section_break"),this.show_field("filters_section_break")}get_fields(){return[{fieldtype:"Select",fieldname:"type",label:"Type",reqd:1,options:`DocType
Report
Page
Dashboard
URL`,onchange:()=>{this.dialog.get_value("type")=="DocType"?this.dialog.fields_dict.link_to.get_query=()=>({query:"frappe.core.report.permitted_documents_for_user.permitted_documents_for_user.query_doctypes",filters:{user:frappe.session.user,include_single_doctypes:!0}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Dynamic Link",fieldname:"link_to",label:"Link To",options:"type",onchange:()=>{let e=this.dialog.get_value("link_to");e&&this.dialog.get_value("type")=="DocType"?frappe.model.with_doctype(e,async()=>{var n;let t=frappe.get_meta(e);e&&frappe.boot.single_types.includes(e)?this.hide_filters():e&&(this.setup_filter(e),this.show_filters());let i=["List","Report Builder","Dashboard","New"];t.is_tree===1&&i.push("Tree"),frappe.boot.calendars.includes(e)&&i.push("Calendar");let s=await frappe.db.get_value("Kanban Board",{reference_doctype:e},"name");(n=s==null?void 0:s.message)!=null&&n.name&&i.push("Kanban"),this.dialog.set_df_property("doc_view","options",i.join(`
`))}):this.hide_filters()},depends_on:e=>e.type!="URL",mandatory_depends_on:e=>e.type!="URL"},{fieldtype:"Data",fieldname:"url",label:"URL",options:"URL",default:"",depends_on:e=>e.type=="URL",mandatory_depends_on:e=>e.type=="URL"},{fieldtype:"Select",fieldname:"doc_view",label:"DocType View",options:`List
Report Builder
Dashboard
Tree
New
Calendar
Kanban`,description:__("Which view of the associated DocType should this shortcut take you to?"),default:"List",depends_on:e=>{if(this.dialog){let t=this.dialog.get_value("link_to"),i=frappe.boot.single_types.includes(t);return t&&e.type=="DocType"&&!i}return!1},onchange:()=>{this.dialog.get_value("doc_view")=="Kanban"?this.dialog.fields_dict.kanban_board.get_query=()=>({filters:{reference_doctype:this.dialog.get_value("link_to")}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Link",fieldname:"kanban_board",label:"Kanban Board",options:"Kanban Board",depends_on:()=>{var t;return((t=this.dialog)==null?void 0:t.get_value("doc_view"))=="Kanban"},mandatory_depends_on:()=>{var t;return((t=this.dialog)==null?void 0:t.get_value("doc_view"))=="Kanban"}},{fieldtype:"Section Break",fieldname:"filters_section_break",label:__("Count Filter"),hidden:1},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"count_section_break",label:__("Count Customizations"),hidden:1},{fieldtype:"Select",fieldname:"color",label:__("Color"),options:["Grey","Green","Red","Orange","Pink","Yellow","Blue","Cyan"],default:"Grey",input_class:"color-select",onchange:()=>{let e=this.dialog.fields_dict.color.value.toLowerCase(),t=this.dialog.fields_dict.color.$input;t.parent().find(".color-box").get(0)||$('<div class="color-box"></div>').insertBefore(t.get(0)),t.parent().find(".color-box").get(0).style.backgroundColor=`var(--text-on-${e})`}},{fieldtype:"Column Break",fieldname:"column_break_3"},{fieldtype:"Data",fieldname:"format",label:__("Format"),description:__("For Example: {} Open")}]}set_default_values(){super.set_default_values().then(()=>{this.dialog.fields_dict.link_to.df.onchange()})}generate_filter_from_json(){this.values&&this.values.stats_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.stats_filter,this.values.link_to))}process_data(e){if(this.dialog.get_value("type")=="DocType"&&this.filter_group){let t=this.filter_group.get_filters();e.stats_filter=frappe.utils.get_filter_as_json(t)}return e.label=e.label?e.label:frappe.model.unscrub(e.link_to),e.url&&(!validate_url(e.url)&&frappe.throw({message:__("<b>{0}</b> is not a valid URL",[e.url]),title:__("Invalid URL"),indicator:"red"}),e.label||(e.label="No Label (URL)")),e}},Zt=class extends ae{constructor(e){super(e)}get_fields(){let e;return this.for_workspace?[{fieldtype:"Link",fieldname:"number_card_name",label:__("Number Cards"),options:"Number Card",reqd:1,get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}})},{fieldtype:"Data",fieldname:"label",label:__("Label")}]:(e=[{fieldtype:"Select",label:__("Choose Existing Card or create New Card"),fieldname:"new_or_existing",options:["New Card","Existing Card"]},{fieldtype:"Link",fieldname:"card",label:__("Number Cards"),options:"Number Card",get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}}),depends_on:'eval: doc.new_or_existing == "Existing Card"'},{fieldtype:"Section Break",fieldname:"sb_1",depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Label"),fieldname:"label",fieldtype:"Data",mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Doctype"),fieldname:"document_type",fieldtype:"Link",options:"DocType",onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.set_aggregate_function_fields(this.dialog.get_values()),this.setup_filter(this.document_type)},hidden:1},{label:__("Color"),fieldname:"color",fieldtype:"Color"},{fieldtype:"Column Break",fieldname:"cb_1"},{label:__("Function"),fieldname:"function",fieldtype:"Select",options:["Count","Sum","Average","Minimum","Maximum"],mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Function Based On"),fieldname:"aggregate_function_based_on",fieldtype:"Select",depends_on:"eval: doc.function !== 'Count'",mandatory_depends_on:'eval: doc.function !== "Count" && doc.new_or_existing == "New Card"'},{fieldtype:"Section Break",fieldname:"sb_1",label:__("Add Filters"),depends_on:'eval: doc.new_or_existing == "New Card"'},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"sb_1"}],e)}setup_dialog_events(){!this.document_type&&!this.for_workspace&&(this.default_values&&this.default_values.doctype?(this.document_type=this.default_values.doctype,this.setup_filter(this.default_values.doctype),this.set_aggregate_function_fields()):this.show_field("document_type"))}set_aggregate_function_fields(){let e=[];this.document_type&&frappe.get_meta(this.document_type)&&frappe.get_meta(this.document_type).fields.map(t=>{if(frappe.model.numeric_fieldtypes.includes(t.fieldtype)){if(t.fieldtype=="Currency"&&(!t.options||t.options!=="Company:company:default_currency"))return;e.push({label:t.label,value:t.fieldname})}}),this.dialog.set_df_property("aggregate_function_based_on","options",e)}process_data(e){return this.for_workspace?(e.label=e.label?e.label:e.number_card_name,e):(e.new_or_existing=="Existing Card"&&(e.name=e.card),e.stats_filter=this.filter_group&&JSON.stringify(this.filter_group.get_filters()),e.document_type=this.document_type,e)}},ei=class extends ae{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"custom_block_name",label:"Custom Block Name",options:"Custom HTML Block",reqd:1,get_query:()=>({query:"frappe.desk.doctype.custom_html_block.custom_html_block.get_custom_blocks_for_user"})}]}};function bt(r){return{chart:Gt,shortcut:Qt,links:Jt,onboarding:Kt,quick_list:Ut,number_card:Zt,custom_block:ei}[r]||ae}var ce=class{constructor(e){Object.assign(this,e),this.make()}refresh(){this.set_title(),this.set_actions(),this.set_body(),this.setup_events(),this.set_footer()}get_config(){return{name:this.name,label:this.label}}customize(e){if(this.in_customize_mode=!0,this.action_area.empty(),e.allow_sorting&&frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,this.action_area),e.allow_hiding){this.hidden&&(this.widget.removeClass("hidden"),this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5));let t=this.hidden?"fa fa-eye":"fa fa-eye-slash",i=this.hidden?__("Show"):__("Hide");frappe.utils.add_custom_button(`<i class="${t}" aria-hidden="true"></i>`,()=>this.hide_or_show(),"show-or-hide-button",i,null,this.action_area),this.show_or_hide_button=this.action_area.find(".show-or-hide-button")}e.allow_edit&&frappe.utils.add_custom_button(frappe.utils.icon("edit","xs"),()=>this.edit(),"edit-button",__("Edit"),null,this.action_area)}make(){this.make_widget(),this.widget.appendTo(this.container)}make_widget(){this.widget=$(`<div class="widget" data-widget-name="${this.name?this.name:""}">
			<div class="widget-head">
				<div class="widget-label">
					<div class="widget-title"></div>
					<div class="widget-subtitle"></div>
				</div>
				<div class="widget-control"></div>
			</div>
			<div class="widget-body"></div>
			<div class="widget-footer"></div>
		</div>`),this.title_field=this.widget.find(".widget-title"),this.subtitle_field=this.widget.find(".widget-subtitle"),this.body=this.widget.find(".widget-body"),this.action_area=this.widget.find(".widget-control"),this.head=this.widget.find(".widget-head"),this.footer=this.widget.find(".widget-footer"),this.refresh()}set_title(e){let t=this.title||this.label||this.name,i=e?frappe.ellipsis(t,e):t;if(this.icon){let s=frappe.utils.icon(this.icon,"lg");this.title_field[0].innerHTML=`${s} <span class="ellipsis" title="${i}">${i}</span>`}else this.title_field[0].innerHTML=`<span class="ellipsis" title="${i}">${i}</span>`,e&&this.title_field[0].setAttribute("title",this.title||this.label);this.subtitle&&this.subtitle_field.html(this.subtitle)}delete(e=!0,t=!1){let i=s=>{this.widget.remove(),!t&&this.options.on_delete&&this.options.on_delete(this.name,s)};e?(this.widget.addClass("zoom-out"),setTimeout(()=>{i(!0)},300)):i(!1)}edit(){var t;let e=bt(this.widget_type);this.edit_dialog=new e({for_workspace:(t=this.options)==null?void 0:t.for_workspace,label:this.label,type:this.widget_type,values:this.get_config(),primary_action:i=>{Object.assign(this,i),i.name=this.name,this.new=!0,this.refresh(),this.options.on_edit&&this.options.on_edit(i)},primary_action_label:__("Save")}),this.edit_dialog.make()}toggle_width(){this.width=="Full"?(this.widget.removeClass("full-width"),this.width=null,this.refresh()):(this.widget.addClass("full-width"),this.width="Full",this.refresh());let e=this.width=="Full"?__("Collapse"):__("Expand");this.resize_button.attr("title",e)}hide_or_show(){this.hidden?(this.body.css("opacity",1),this.title_field.css("opacity",1),this.footer.css("opacity",1),this.hidden=!1):(this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5),this.hidden=!0),this.show_or_hide_button.empty();let e=this.hidden?"fa fa-eye":"fa fa-eye-slash",t=this.hidden?__("Show"):__("Hide");$(`<i class="${e}" aria-hidden="true" title="${t}"></i>`).appendTo(this.show_or_hide_button)}setup_events(){}set_actions(){}set_body(){}set_footer(){}};frappe.provide("frappe.utils");var qe=class extends ce{async refresh(){frappe.utils.load_video_player(),this.new&&await this.get_onboarding_data(),this.set_title(),this.set_actions(),this.set_body(),this.setup_events()}get_config(){return{label:this.onboarding_name}}make_body(){this.body.empty(),this.steps_wrapper=$('<div class="onboarding-steps-wrapper"></div>').appendTo(this.body),this.step_preview=$(`<div class="onboarding-step-preview">
			<div class="onboarding-step-body"></div>
			<div class="onboarding-step-footer"></div>
		</div>`).appendTo(this.body),this.step_body=this.step_preview.find(".onboarding-step-body"),this.step_footer=this.step_preview.find(".onboarding-step-footer"),this.steps.forEach((t,i)=>{this.add_step(t,i)});let e=this.steps.findIndex(t=>!t.is_skipped&&!t.is_complete);e==-1&&(e=0),this.show_step(this.steps[e])}add_step(e,t){let i="pending";e.is_skipped&&(i="skipped"),e.is_complete&&(i="complete");let s=$(`<a class="onboarding-step ${i}">
				<div class="step-title">
					<div class="step-index step-pending">${__(t+1)}</div>
					<div class="step-index step-skipped">${frappe.utils.icon("tick","xs")}</div>
					<div class="step-index step-complete">${frappe.utils.icon("tick","xs")}</div>
					<div>${__(e.title)}</div>
				</div>
			</a>`);if(e.$step=s,!e.is_complete&&!e.is_skipped){let n=$(`<div class="step-skip">${__("Skip")}</div>`);n.appendTo(s),n.on("click",()=>{this.skip_step(e),event.stopPropagation()})}return s.on("click",()=>this.show_step(e)),s.appendTo(this.steps_wrapper),s}show_step(e){this.active_step&&this.active_step.$step.removeClass("active"),e.$step.addClass("active"),this.active_step=e;let t={"Watch Video":a=>this.show_video(a),"Create Entry":a=>{a.is_complete?frappe.set_route(`/app/List/${a.reference_document}`):a.show_full_form?this.create_entry(a):this.show_quick_entry(a)},"Show Form Tour":a=>this.show_form_tour(a),"Update Settings":a=>this.update_settings(a),"View Report":a=>this.open_report(a),"Go to Page":a=>this.go_to_page(a)},i=()=>{this.step_body.empty(),this.step_footer.empty(),s(),e.intro_video_url?$(`<button class="btn btn-primary btn-sm">${__("Watch Tutorial")}</button>`).appendTo(this.step_footer).on("click",n):$(`<button class="btn btn-primary btn-sm">${__(e.action_label||e.action)}</button>`).appendTo(this.step_footer).on("click",()=>t[e.action](e))},s=()=>{let a=e.description?frappe.markdown(e.description):`<h1>${__(e.title)}</h1>`;e.action==="Create Entry"&&(a+=`<p>
					<a href='/app/${frappe.router.slug(e.reference_document)}'>
						${__("Show {0} List",[__(e.reference_document)])}</a>
				</p>`),this.step_body.html(a)},n=()=>{this.step_body.empty(),this.step_footer.empty();let a=$(`<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="${e.intro_video_url}"></div>`);a.appendTo(this.step_body);let c=new frappe.Plyr(a[0],{hideControls:!0,resetOnEnd:!0});$(`<button class="btn btn-primary btn-sm">${__(e.action_label||e.action)}</button>`).appendTo(this.step_footer).on("click",()=>{c.pause(),t[e.action](e)}),$(window).one("hashchange",()=>{c.pause()}),$(`<button class="btn btn-secondary ml-2 btn-sm">${__("Back")}</button>`).appendTo(this.step_footer).on("click",i)};i()}go_to_page(e){this.mark_complete(e),frappe.set_route(e.path).then(()=>{let t=e.callback_message||__("You can continue with the onboarding after exploring this page"),i=e.callback_title||__("Awesome Work"),s=frappe.msgprint({message:t,title:i,primary_action:{action:()=>{s.hide()},label:()=>__("Continue")},wide:!0})})}open_report(e){let t=frappe.utils.generate_route({name:e.reference_report,type:"report",is_query_report:e.report_type!=="Report Builder",doctype:e.report_reference_doctype}),i=frappe.get_route();frappe.set_route(t).then(()=>{let s=frappe.msgprint({message:__(e.report_description),title:__(e.reference_report),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(e)}),s.hide()},label:()=>__("Continue")},secondary_action:{action:()=>{s.hide(),frappe.set_route(i).then(()=>{this.mark_complete(e)})},label:__("Go Back")}});frappe.msg_dialog.custom_onhide=()=>this.mark_complete(e)})}show_form_tour(e){let t;e.is_single?t=frappe.router.slug(e.reference_document):t=`${frappe.router.slug(e.reference_document)}/new`;let i=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=s=>{let n=()=>{let c=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Onboarding complete"),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(e)}),c.hide()},label:()=>__("Continue")}})},a=e.form_tour;s.tour.init({tour_name:a,on_finish:n}).then(()=>s.tour.start())},frappe.set_route(t)}update_settings(e){let t=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=i=>{i.scroll_to_field(e.field),i.doc.__unsaved=!0},frappe.route_hooks.after_save=i=>{let s=!1,n={},a=i.doc[e.field],c=null;a&&e.value_to_validate=="%"&&(s=!0),a==e.value_to_validate&&(s=!0),cstr(a)==cstr(e.value_to_validate)&&(s=!0),s?(n.message=__("Let's take you back to onboarding"),n.title=__("Action Complete"),n.primary_action={action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")},c=()=>n.primary_action.action()):(n.message=__("Looks like you didn't change the value"),n.title=__("Try Again"),n.secondary_action={action:()=>frappe.set_route(t),label:__("Go Back")},n.primary_action={action:()=>{frappe.set_route(t).then(()=>{setTimeout(()=>{this.skip_step(e)},300)})},label:__("Skip Step")},c=()=>n.secondary_action.action()),frappe.msgprint(n),frappe.msg_dialog.custom_onhide=()=>c()},frappe.set_route("Form",e.reference_document)}async create_entry(e){let t=frappe.get_route(),i=await this.get_first_document(e.reference_document);frappe.route_hooks={},frappe.route_hooks.after_load=n=>{let a=()=>{frappe.msgprint({message:__("Awesome, now try making an entry yourself"),title:__("Document Saved"),primary_action:{action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(e)}},c=e.form_tour;n.tour.init({tour_name:c,on_finish:a}).then(()=>n.tour.start())};let s=()=>{frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Action Complete"),primary_action:{action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(e)}};e.is_submittable?(frappe.route_hooks.after_save=()=>{frappe.msgprint({message:__("Submit this document to complete this step."),title:__("Document Saved")})},frappe.route_hooks.after_submit=s):frappe.route_hooks.after_save=s,frappe.set_route("Form",e.reference_document,i)}show_quick_entry(e){let t=frappe.get_route_str();frappe.ui.form.make_quick_entry(e.reference_document,()=>{if(frappe.get_route_str()!=t){let i=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Document Saved"),primary_action:{action:()=>{i.hide(),frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}});frappe.msg_dialog.custom_onhide=()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})}}else frappe.show_alert(__("Document Saved")+"<br>"+__("Let us continue with the onboarding")),this.mark_complete(e)},null,null,!0)}show_video(e){frappe.help.show_video(e.video_url,e.title),this.mark_complete(e)}mark_complete(e){let t=e.$step,i=()=>{e.is_complete=!0,t.removeClass("skipped"),t.addClass("complete")};this.update_step_status(e,"is_complete",1,i),this.activate_next_step(e)}skip_step(e){let t=e.$step,i=()=>{e.is_skipped=!0,t.removeClass("complete"),t.removeClass("pending"),t.addClass("skipped")};this.update_step_status(e,"is_skipped",1,i),this.activate_next_step(e)}activate_next_step(e){let t=this.steps.findIndex(s=>s==e),i=this.steps[t+1];!i||this.show_step(i)}update_step_status(e,t,i,s){let n={is_complete:"complete",is_skipped:"skipped"};frappe.route_hooks={},frappe.call("frappe.desk.desktop.update_onboarding_step",{name:e.name,field:t,value:i}).then(()=>{s(),e.$step.removeClass("pending").removeClass("complete").removeClass("skipped").addClass(n[t]),this.steps.filter(c=>!(c.is_complete||c.is_skipped)).length==0&&this.show_success()})}show_success(){let e=this.success||__("You seem good to go!"),t=this.success_state_image||"/assets/frappe/images/ui-states/success-color.png",i="";this.docs_url&&(i=__('Congratulations on completing the module setup. If you want to learn more you can refer to the documentation <a target="_blank" href="{0}">here</a>.',[this.docs_url]));let s=$(`<div class="text-center onboarding-success">
					<img src="${t}" alt="Success State" class="zoom-in success-state">
					<h3>${e}</h3>
					<div class="text-muted">${i}</div>
					<button class="btn btn-primary btn-sm">${__("Continue")}</button>
			</div>
		`);s.find(".btn").on("click",()=>this.delete()),this.step_preview.empty(),s.appendTo(this.step_preview)}set_body(){this.widget.addClass("onboarding-widget-box"),this.is_dismissed()?this.widget.hide():this.make_body()}is_dismissed(){if(this.in_customize_mode)return!1;let e=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");if(Object.keys(e).includes(this.title)){let t=new Date(e[this.title]),i=new Date;return frappe.datetime.get_hour_diff(i,t)<24}return!1}set_actions(){if(this.in_customize_mode)return;this.action_area.empty();let e=$(`<div class="small" style="cursor:pointer;">${__("Dismiss",null,"Stop showing the onboarding widget.")}</div>`);e.on("click",()=>{let t=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");t[this.title]=frappe.datetime.now_datetime(),localStorage.setItem("dismissed-onboarding",JSON.stringify(t)),this.delete(!0,!0),this.widget.closest(".ce-block").hide(),frappe.telemetry.capture("dismissed_"+frappe.scrub(this.title),"frappe_onboarding")}),e.appendTo(this.action_area)}get_onboarding_data(){return frappe.model.with_doc("Module Onboarding",this.onboarding_name).then(e=>{if(e){this.onboarding_doc=e,this.label=e.label,this.title=e.title||__("Let's Get Started"),this.subtitle=e.subtitle,this.success=e.success,this.docs_url=e.docs_url,this.user_can_dismiss=e.user_can_dismiss;let t="frappe.desk.doctype.onboarding_step.onboarding_step.get_onboarding_steps";return frappe.xcall(t,{ob_steps:e.steps}).then(i=>{this.steps=i})}})}async get_first_document(e){let{message:t}=await frappe.db.get_value("Form Tour",{reference_doctype:e},["first_document"]),i;return t.first_document&&await frappe.db.get_list(e,{order_by:"creation"}).then(s=>{Array.isArray(s)&&s.length&&(i=s[0].name)}),i||"new"}};var ti=class extends qe{show_step(e){e.description=__(e.description),e.title=__(e.title),super.show_step(e)}};frappe.widget.widget_factory.onboarding=ti;frappe.provide("frappe.utils");var Ve=class extends ce{constructor(e){e.shadow=!0;super(e)}get_config(){return{name:this.name,number_card_name:this.number_card_name,label:this.label,color:this.color,hidden:this.hidden}}refresh(){this.set_body()}set_body(){this.widget.addClass("number-widget-box"),this.make_card()}make_card(){frappe.model.with_doc("Number Card",this.number_card_name||this.name).then(e=>{if(e)this.card_doc=e,this.render_card();else if(this.document_type)frappe.run_serially([()=>this.create_number_card(),()=>this.render_card()]);else{this.delete(!1);return}this.set_events()})}create_number_card(){return this.set_doc_args(),frappe.xcall("frappe.desk.doctype.number_card.number_card.create_number_card",{args:this.card_doc}).then(e=>{this.name=e.name,this.card_doc=e,this.widget.attr("data-widget-name",this.name)})}set_events(){$(this.body).click(()=>{this.in_customize_mode||this.card_doc.type=="Custom"||this.set_route()})}set_route(){let e=this.card_doc.type!=="Report",t=e?this.card_doc.document_type:this.card_doc.report_name,i=frappe.utils.generate_route({name:t,type:e?"doctype":"report",is_query_report:!e});if(e){let s=JSON.parse(this.card_doc.filters_json);frappe.route_options=s.reduce((n,a)=>Object.assign(n,{[`${a[0]}.${a[1]}`]:[a[2],a[3]]}),{})}frappe.set_route(i)}set_doc_args(){this.card_doc=Object.assign({},{document_type:this.document_type,label:this.label,function:this.function,aggregate_function_based_on:this.aggregate_function_based_on,color:this.color,filters_json:this.stats_filter})}get_settings(e){return this.filters=this.get_filters(),{Custom:{method:this.card_doc.method,args:{filters:this.filters},get_number:i=>this.get_number_for_custom_card(i)},Report:{method:"frappe.desk.query_report.run",args:{report_name:this.card_doc.report_name,filters:this.filters,ignore_prepared_report:1},get_number:i=>this.get_number_for_report_card(i)},"Document Type":{method:"frappe.desk.doctype.number_card.number_card.get_result",args:{doc:this.card_doc,filters:this.filters},get_number:i=>this.get_number_for_doctype_card(i)}}[e]}get_filters(){return frappe.dashboard_utils.get_all_filters(this.card_doc)}render_card(){this.prepare_actions(),this.set_title(),this.set_loading_state(),this.card_doc.type||(this.card_doc.type="Document Type"),this.settings=this.get_settings(this.card_doc.type),frappe.run_serially([()=>this.render_number(),()=>this.render_stats()])}set_loading_state(){$(this.body).html(`<div class="number-card-loading text-muted">
			${__("Loading...")}
		</div>`)}get_number(){return frappe.xcall(this.settings.method,this.settings.args).then(e=>this.settings.get_number(e))}get_number_for_custom_card(e){typeof e=="object"?(this.number=e.value,this.set_formatted_number(e)):this.formatted_number=e}get_number_for_doctype_card(e){if(this.number=e,this.card_doc.function!=="Count")return frappe.model.with_doctype(this.card_doc.document_type,()=>{let t=frappe.meta.get_docfield(this.card_doc.document_type,this.card_doc.aggregate_function_based_on);this.set_formatted_number(t)});this.formatted_number=e}get_number_for_report_card(e){let t=this.card_doc.report_field,i=e.result.reduce((n,a)=>(a[t]&&n.push(a[t]),n),[]),s=e.columns.find(n=>n.fieldname==t);this.number=frappe.report_utils.get_result_of_fn(this.card_doc.report_function,i),this.set_formatted_number(s)}set_formatted_number(e){let t=frappe.sys_defaults.country,s=frappe.utils.shorten_number(this.number,t,5).split(" "),n=s[1]||"",a=$(frappe.format(s[0],e)).text();this.formatted_number=a+" "+__(n)}render_number(){return this.get_number().then(()=>{$(this.body).html(`<div class="widget-content">
				<div class="number" style="color:${this.card_doc.color}">${this.formatted_number}</div>
				</div>`)})}render_stats(){if(this.card_doc.type!=="Document Type")return;let e="",t="";return this.get_percentage_stats().then(()=>{this.percentage_stat==0||this.percentage_stat==null?t="grey-stat":this.percentage_stat>0?(e=`<span class="indicator-pill-round green">
						${frappe.utils.icon("arrow-up-right","xs")}
					</span>`,t="green-stat"):(e=`<span class="indicator-pill-round red">
						${frappe.utils.icon("arrow-down-left","xs")}
					</span>`,t="red-stat");let s={Daily:__("since yesterday"),Weekly:__("since last week"),Monthly:__("since last month"),Yearly:__("since last year")}[this.card_doc.stats_time_interval],n=(()=>{if(this.percentage_stat==null)return NaN;let a=this.percentage_stat.split(" "),c=a[1]||"";return Math.abs(a[0])+" "+c})();isNaN(n)||$(this.body).find(".widget-content").append(`<div class="card-stats ${t}">
				<span class="percentage-stat-area">
					${e}
					<span class="percentage-stat">
						${n} %
					</span>
				</span>
				<span class="stat-period text-muted">
					${s}
				</span>
			</div>`)})}get_percentage_stats(){return frappe.xcall("frappe.desk.doctype.number_card.number_card.get_percentage_difference",{doc:this.card_doc,filters:this.filters,result:this.number}).then(e=>{e!==void 0&&(this.percentage_stat=frappe.utils.shorten_number(e))})}prepare_actions(){if(this.in_customize_mode)return;let e=[{label:__("Refresh"),action:"action-refresh",handler:()=>{this.render_card()}},{label:__("Edit"),action:"action-edit",handler:()=>{let t=this.number_card_name||this.name;frappe.set_route("Form","Number Card",t)}}];this.set_card_actions(e)}set_card_actions(e){this.card_actions=$(`<div class="card-actions dropdown pull-right">
				<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				...
				</a>
				<ul class="dropdown-menu" style="max-height: 300px; overflow-y: auto;">
					${e.map(t=>`<li class="dropdown-item">
									<a data-action="${t.action}">${t.label}</a>
								</li>`).join("")}
				</ul>
			</div>`),this.card_actions.find("a[data-action]").each((t,i)=>{let s=i.dataset.action;$(i).click(e.find(n=>n.action===s))}),this.action_area.html(this.card_actions)}};var ii=class extends Ve{set_title(){$(this.title_field).html(`<div class="number-label">${__(this.card_doc.label)}</div>`)}};frappe.widget.widget_factory.number_card=ii;frappe.provide("frappe.widget.utils");frappe.provide("frappe.dashboards");frappe.provide("frappe.dashboards.chart_sources");var Ye=class extends ce{constructor(e){e.shadow=!0;super(e);this.height=this.height||240}get_config(){return{name:this.name,chart_name:this.chart_name,label:this.label,hidden:this.hidden,width:this.width}}refresh(){delete this.dashboard_chart,this.set_body(),this.make_chart()}set_chart_title(){let e=this.widget.width()<600?40:60;this.set_title(e)}set_body(){this.widget.addClass("dashboard-widget-box"),this.width=="Full"&&this.widget.addClass("full-width")}setup_container(){this.body.empty(),this.chart_doc.type=="Heatmap"&&this.setup_heatmap_container(),this.loading=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("Loading...")}</div>`),this.loading.appendTo(this.body),this.empty=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("No Data")}</div>`),this.empty.hide().appendTo(this.body),this.chart_wrapper=$("<div></div>"),this.chart_wrapper.appendTo(this.body),this.$heatmap_legend=null,this.set_chart_title()}setup_heatmap_container(){this.widget.addClass("heatmap-chart"),this.widget.removeClass("full-width").addClass("full-width"),this.width="Full"}set_summary(){this.$summary?this.$summary.empty():(this.$summary=$('<div class="report-summary"></div>').hide(),this.head.after(this.$summary)),this.summary.forEach(e=>{frappe.utils.build_summary_item(e).appendTo(this.$summary)}),this.summary.length&&this.$summary.show()}make_chart(){this.get_settings().then(()=>{if(!this.settings){this.deleted=!0,this.widget.remove();return}this.chart_settings||(this.chart_settings={}),this.setup_container(),this.in_customize_mode||(this.action_area.empty(),this.prepare_chart_actions(),this.chart_doc.timeseries&&this.render_time_series_filters()),frappe.run_serially([()=>this.prepare_chart_object(),()=>this.setup_filter_button(),()=>this.fetch_and_update_chart()])})}render_time_series_filters(){let e=this.get_time_series_filters();frappe.dashboard_utils.render_chart_filters(e,"chart-actions",this.action_area,0)}get_time_series_filters(){let e;return this.chart_doc.type=="Heatmap"?e=[{label:this.chart_settings.heatmap_year||this.chart_doc.heatmap_year,options:frappe.dashboard_utils.get_years_since_creation(frappe.boot.user.creation),action:t=>{this.selected_heatmap_year=t,this.save_chart_config_for_user({heatmap_year:this.selected_heatmap_year}),this.fetch_and_update_chart()}}]:e=[{label:this.chart_settings.time_interval||this.chart_doc.time_interval,options:["Yearly","Quarterly","Monthly","Weekly","Daily"],icon:"calendar",class:"time-interval-filter",action:t=>{this.selected_time_interval=t,this.save_chart_config_for_user({time_interval:this.selected_time_interval}),this.fetch_and_update_chart()}},{label:this.chart_settings.timespan||this.chart_doc.timespan,options:["Select Date Range","Last Year","Last Quarter","Last Month","Last Week"],class:"timespan-filter",action:t=>{this.selected_timespan=t,this.selected_timespan==="Select Date Range"?this.render_date_range_field():(this.selected_from_date=null,this.selected_to_date=null,this.date_field_wrapper&&(this.date_field_wrapper.hide(),this.title_field.show(),this.subtitle_field.show(),this.head.css("flex-direction","row")),this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:null,to_date:null}),this.fetch_and_update_chart())}}],e}fetch_and_update_chart(){this.args={timespan:this.selected_timespan||this.chart_settings.timespan,time_interval:this.selected_time_interval||this.chart_settings.time_interval,from_date:this.selected_from_date||this.chart_settings.from_date,to_date:this.selected_to_date||this.chart_settings.to_date,heatmap_year:this.selected_heatmap_year||this.chart_settings.heatmap_year},this.fetch(this.filters,!0,this.args).then(e=>{this.chart_doc.chart_type=="Report"&&(this.report_result=e,this.summary=e.report_summary,e=this.get_report_chart_data(e)),this.update_chart_object(),this.data=e,this.render()})}render_date_range_field(){(!this.date_field_wrapper||!this.date_field_wrapper.is(":visible"))&&(this.date_field_wrapper=$('<div class="dashboard-date-field pull-right"></div>').insertAfter(this.action_area.find(".timespan-filter")),this.width!=="Full"&&this.widget.width()<700&&(this.title_field.hide(),this.subtitle_field.hide(),this.head.css("flex-direction","row-reverse")),this.date_range_field=frappe.ui.form.make_control({df:{fieldtype:"DateRange",fieldname:"from_date",placeholder:"Date Range",input_class:"input-xs",default:[this.chart_settings.from_date,this.chart_settings.to_date],value:[this.chart_settings.from_date,this.chart_settings.to_date],reqd:1,change:()=>{let e=this.date_range_field.get_value();this.selected_from_date=e[0],this.selected_to_date=e[1],e&&e.length==2&&(this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:this.selected_from_date,to_date:this.selected_to_date}),this.fetch_and_update_chart())}},parent:this.date_field_wrapper,render_input:1}),this.date_range_field.$input.focus())}get_report_chart_data(e){if(e.chart&&this.chart_doc.use_report_chart)return e.chart.data;{let t=[];this.chart_doc.y_axis.map(a=>{t.push(a.y_field)});let i={y_fields:t,x_field:this.chart_doc.x_field,chart_type:this.chart_doc.type,color:this.chart_doc.color},s=e.columns.map(a=>frappe.report_utils.prepare_field_from_column(a));return frappe.report_utils.make_chart_options(s,e,i).data}}prepare_chart_actions(){let e=[{label:__("Refresh"),action:"action-refresh",handler:()=>{delete this.dashboard_chart,this.make_chart()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Dashboard Chart",this.chart_doc.name)}},{label:__("Reset Chart"),action:"action-reset",handler:()=>{this.reset_chart(),delete this.dashboard_chart,this.make_chart()}}];this.chart_doc.document_type?e.push({label:__("{0} List",[this.chart_doc.document_type]),action:"action-list",handler:()=>{frappe.set_route("List",this.chart_doc.document_type)}}):this.chart_doc.chart_type==="Report"&&e.push({label:__("{0} Report",[this.chart_doc.report_name]),action:"action-list",handler:()=>{frappe.set_route("query-report",this.chart_doc.report_name,this.filters)}}),this.set_chart_actions(e)}setup_filter_button(){this.in_customize_mode||(this.is_document_type=this.chart_doc.chart_type!=="Report"&&this.chart_doc.chart_type!=="Custom",this.filter_button=$(`<div class="filter-chart btn btn-xs pull-right">
				${frappe.utils.icon("filter","sm")}
			</div>`),this.filter_button.appendTo(this.action_area),this.is_document_type?(this.filter_group&&(this.filters=this.filter_group.get_filters()),this.create_filter_group_and_add_filters()):this.filter_button.on("click",()=>{let e;frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(t=>{this.is_document_type?e=[{fieldtype:"HTML",fieldname:"filter_area"}]:t?e=t.filter(i=>i.fieldname).map(i=>(Object.assign(i,i.dashboard_config||{}),i)):e=[{fieldtype:"HTML",options:__("No Filters Set")}],this.setup_filter_dialog(e)})}))}setup_filter_dialog(e){let t=this,i=new frappe.ui.Dialog({title:__("Set Filters for {0}",[this.chart_doc.chart_name]),fields:e,primary_action:function(){let s=this.get_values();s&&(this.hide(),t.filters=s,t.save_chart_config_for_user({filters:t.filters}),t.fetch_and_update_chart())},primary_action_label:"Set"});i.show(),this.chart_doc.chart_type=="Report"&&(frappe.query_report=new frappe.views.QueryReport({filters:i.fields_list}),frappe.query_reports[this.chart_doc.report_name].onload&&frappe.query_reports[this.chart_doc.report_name].onload(frappe.query_report)),i.set_values(this.filters)}reset_chart(){this.save_chart_config_for_user(null,1),this.chart_settings={},this.filters=null,this.selected_time_interval=null,this.selected_timespan=null,this.selected_heatmap_year=null}save_chart_config_for_user(e,t=0){Object.assign(this.chart_settings,e),frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.save_chart_config",{reset:t,config:this.chart_settings,chart_name:this.chart_doc.chart_name})}create_filter_group_and_add_filters(){this.filter_group=new frappe.ui.FilterGroup({doctype:this.chart_doc.document_type,parent_doctype:this.chart_doc.parent_document_type,filter_button:this.filter_button,on_change:()=>{this.filters=this.filter_group.get_filters(),this.save_chart_config_for_user({filters:this.filters}),this.fetch_and_update_chart()}}),this.filters&&frappe.model.with_doctype(this.chart_doc.document_type,()=>{this.filter_group.add_filters_to_filter_group(this.filters)})}set_chart_actions(e){this.chart_actions=$(`<div class="chart-actions dropdown pull-right">
			<button data-toggle="dropdown"
				aria-haspopup="true"aria-expanded="false"
				class="btn btn-xs btn-secondary chart-menu"
			>
				<svg class="icon icon-sm">
					<use href="#icon-dot-horizontal">
					</use>
				</svg>
			</button>
			<ul class="dropdown-menu dropdown-menu-right">
				${e.map(t=>`<li><a class="dropdown-item" data-action="${t.action}">${t.label}</a></li>`).join("")}
			</ul>
		</div>
		`),this.chart_actions.find("a[data-action]").each((t,i)=>{let s=i.dataset.action;$(i).click(e.find(n=>n.action===s))}),this.chart_actions.appendTo(this.action_area)}fetch(e,t=!1,i){let s=this.settings.method;return this.chart_doc.chart_type=="Report"?i={report_name:this.chart_doc.report_name,filters:e,ignore_prepared_report:1}:i={chart_name:this.chart_doc.name,filters:e,refresh:t?1:0,time_interval:i&&i.time_interval?i.time_interval:null,timespan:i&&i.timespan?i.timespan:null,from_date:i&&i.from_date?i.from_date:null,to_date:i&&i.to_date?i.to_date:null,heatmap_year:i&&i.heatmap_year?i.heatmap_year:null},frappe.xcall(s,i)}async get_source_doctype(){if(this.chart_doc.document_type)return this.chart_doc.document_type;if(this.chart_doc.chart_type=="Report"&&this.chart_doc.report_name)return await frappe.db.get_value("Report",this.chart_doc.report_name,"ref_doctype").then(e=>e.message.ref_doctype)}async render(){let e=()=>{let t=this.get_chart_args();this.dashboard_chart?this.dashboard_chart.update(this.data):this.dashboard_chart=frappe.utils.make_chart(this.chart_wrapper[0],t)};!this.data||!this.data.labels||!Object.keys(this.data).length?(this.chart_wrapper.hide(),this.loading.hide(),this.$summary&&this.$summary.hide(),this.empty.show()):(this.loading.hide(),this.empty.hide(),this.chart_wrapper.show(),this.chart_doc.document_type=await this.get_source_doctype(),this.chart_doc.document_type?frappe.model.with_doctype(this.chart_doc.document_type,e):e(),this.width=="Full"&&this.summary&&this.set_summary(),this.chart_doc.type=="Heatmap"&&this.render_heatmap_legend())}get_chart_args(){var u,g;let e=this.get_chart_colors(),t,i,s={Line:"line",Bar:"bar",Percentage:"percentage",Pie:"pie",Donut:"donut",Heatmap:"heatmap"},n=["Pie","Donut"].includes(this.chart_doc.type)?6:9,a={data:this.data,type:s[this.chart_doc.type],colors:e,height:this.height,maxSlices:this.chart_doc.number_of_groups||n,axisOptions:{xIsSeries:this.chart_doc.timeseries,shortenYAxisNumbers:1}};if(this.chart_doc.document_type){let m=frappe.get_meta(this.chart_doc.document_type).fields.find(_=>_.fieldname==this.chart_doc.value_based_on);t=m==null?void 0:m.fieldtype,i=m==null?void 0:m.options}if(this.chart_doc.chart_type=="Report"&&((g=(u=this.report_result)==null?void 0:u.chart)==null?void 0:g.fieldtype)&&(t=this.report_result.chart.fieldtype,i=this.report_result.chart.options),a.tooltipOptions={formatTooltipY:b=>frappe.format(b,{fieldtype:t,options:i},{always_show_decimals:!0,inline:!0})},this.chart_doc.type=="Heatmap"){let b=parseInt(this.selected_heatmap_year||this.chart_settings.heatmap_year||this.chart_doc.heatmap_year);a.data.start=new Date(`${b}-01-01`),a.data.end=new Date(`${b+1}-01-01`)}let c=b=>{let m=JSON.parse(b);for(let _ in m)typeof a[_]=="object"&&typeof m[_]=="object"?a[_]=Object.assign(a[_],m[_]):a[_]=m[_]};return this.custom_options&&c(this.custom_options),this.chart_doc.custom_options&&c(this.chart_doc.custom_options),a}get_chart_colors(){let e=[];return this.chart_doc.y_axis.length?this.chart_doc.y_axis.map(t=>{e.push(t.color)}):["Line","Bar"].includes(this.chart_doc.type)?e=[this.chart_doc.color||[]]:this.chart_doc.type=="Heatmap"&&(e=[]),e}render_heatmap_legend(){let e,t=i=>{e=JSON.parse(i).colors};this.custom_options&&t(this.custom_options),this.chart_doc.custom_options&&t(this.chart_doc.custom_options),!this.$heatmap_legend&&this.widget.width()>991&&(this.$heatmap_legend=$(`
				<div class="heatmap-legend">
					<ul class="legend-colors">
						<li style="background-color: ${e[0]||"#ebedf0"}"></li>
						<li style="background-color: ${e[1]||"#c6e48b"}"></li>
						<li style="background-color: ${e[2]||"#7bc96f"}"></li>
						<li style="background-color: ${e[3]||"#239a3b"}"></li>
						<li style="background-color: ${e[4]||"#196127"}"></li>
					</ul>
					<div class="legend-label">
						<div style="margin-bottom: 45px">${__("Less")}</div>
						<div>${__("More")}</div>
					</div>
				</div>
				`),this.body.append(this.$heatmap_legend))}update_last_synced(){if(!this.chart_doc.last_synced_on)return;let e=__("Last synced {0}",[comment_when(this.chart_doc.last_synced_on)]);this.subtitle_field.html(e)}update_chart_object(){frappe.db.get_doc("Dashboard Chart",this.chart_doc.name).then(e=>{this.chart_doc=e,this.update_last_synced()})}prepare_chart_object(){return this.chart_doc.type=="Heatmap"&&!this.chart_doc.heatmap_year&&(this.chart_doc.heatmap_year=frappe.dashboard_utils.get_year(frappe.datetime.now_date())),this.set_chart_filters()}set_chart_filters(){let e=this.chart_settings.filters||null,t=frappe.dashboard_utils.get_all_filters(this.chart_doc);return this.chart_doc.chart_type=="Report"?frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(i=>{t=this.update_default_date_filters(i,t),this.filters=frappe.utils.parse_array(e)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(t)}):(this.filters=frappe.utils.parse_array(e)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(t),Promise.resolve())}update_default_date_filters(e,t){return e&&e.map(i=>{["Date","DateRange"].includes(i.fieldtype)&&i.default&&(i.reqd||t[i.fieldname])&&(t[i.fieldname]=i.default)}),t}get_settings(){return frappe.model.with_doc("Dashboard Chart",this.chart_name).then(e=>{if(e)if(this.chart_doc=e,this.chart_doc.chart_type=="Custom"){if(frappe.dashboards.chart_sources[this.chart_doc.source])return this.settings=frappe.dashboards.chart_sources[this.chart_doc.source],Promise.resolve();{let t="frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config";return frappe.xcall(t,{name:this.chart_doc.source}).then(i=>{frappe.dom.eval(i),this.settings=frappe.dashboards.chart_sources[this.chart_doc.source]})}}else return this.chart_doc.chart_type=="Report"?(this.settings={method:"frappe.desk.query_report.run"},Promise.resolve()):(this.settings={method:"frappe.desk.doctype.dashboard_chart.dashboard_chart.get"},Promise.resolve())})}};var si=class extends Ye{set_chart_title(){this.label=__(this.label||this.name),super.set_chart_title()}};frappe.widget.widget_factory.chart=si;frappe.dashboard_utils.render_chart_filters=function(r,e,t,i){r.forEach(s=>{let n="",a="";s.icon&&(n=frappe.utils.icon(s.icon)),s.class&&(a=s.class);let c=`<div class="${e} ${a} btn-group dropdown pull-right">
					<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<button class="btn btn-secondary btn-xs">
			 				${n}
							<span class="filter-label">${__(s.label)}</span>
							${frappe.utils.icon("select","xs")}
						</button>
				</a>`,u;s.fieldnames?u=s.options.map((m,_)=>`<li>
						<a class="dropdown-item" data-fieldname="${s.fieldnames[_]}" selected_item="${m}">${__(m)}</a>
					</li>`).join(""):u=s.options.map(m=>`<li><a class="dropdown-item" selected_item="${m}">${__(m)}</a></li>`).join("");let g=c+`<ul class="dropdown-menu">${u}</ul></div>`,b=$(g);i?b.prependTo(t):b.appendTo(t),b.find(".dropdown-menu").on("click","li a",m=>{let _=$(m.currentTarget),v;_.attr("data-fieldname")&&(v=_.attr("data-fieldname"));let y=_.attr("selected_item");_.parents(`.${e}`).find(".filter-label").text(__(y)),s.action(y,v)})})};frappe.ui.Page=class extends frappe.ui.Page{add_auto_select(e,t,i){return this.add_field({label:e,fieldtype:"Autocomplete",options:t,change:i}).$wrapper.find("input").empty()}};frappe.search.utils._fuzzy_search=function(r,e){r=r||"";var t=e||"",i=t.replace(/-/g," "),s=t.length,n=r.length,a=n/s,c=3,u=2;if(n>s)return 0;if([t,i].includes(r)||[t,i].some(y=>y.toLowerCase().indexOf(r)===0))return 10+a;if(t.indexOf(r)!==-1&&r!==r.toLowerCase())return 9+a;if(t=t.toLowerCase(),r=r.toLowerCase(),t.indexOf(r)!==-1)return 8+a;var g=0,b=0;e:for(var m=0,_=0;m<n;m++){if(b!==0&&g++,g>c)return 0;var v=r.charCodeAt(m);for(b=0;_<s;){if(t.charCodeAt(_++)===v)continue e;if(++b>u)return 0}return 0}return g+b>0?(5+a)/(g+b):0};frappe.search.utils.fuzzy_search=function(r,e){let t=__(e||""),i=this._fuzzy_search(r,t);return i===0&&frappe.boot.lang!="en"&&(i=this._fuzzy_search(r,e)),i};frappe.ui.form.ControlLink=class extends frappe.ui.form.ControlLink{make_input(){var e=this;$('<div class="link-field ui-front" style="position: relative; line-height: 1;">			<input type="text" class="input-with-feedback form-control data-value">			<span class="link-btn">				<a class="btn-open no-decoration" title="'+__("Open Link")+'">					<i class="octicon octicon-arrow-right"></i></a>			</span>		</div>').prependTo(this.input_area),this.$input_area=$(this.input_area),this.$input=this.$input_area.find("input"),this.$link=this.$input_area.find(".link-btn"),this.$link_open=this.$link.find(".btn-open"),this.set_input_attributes(),this.$input.on("focus",function(){setTimeout(function(){if(e.$input.val()&&e.get_options()){let t=e.get_options(),i=e.doc?e.doc[e.df.fieldname]:e.$input.attr("data-value"),s=i||e.get_input_value();e.$link.toggle(!0),e.$link_open.attr("href",frappe.utils.get_form_link(t,s))}e.$input.val()||e.$input.val("").trigger("input")},500)}),this.$input.on("blur",function(){setTimeout(function(){e.$link.toggle(!1)},500)}),this.$input.attr("data-target",this.df.options),this.input=this.$input.get(0),this.has_input=!0,this.translate_values=!0,this.setup_buttons(),this.setup_awesomeplete()}setup_awesomeplete(){var e=this;this.$input.cache={},this.awesomplete=new Awesomplete(e.input,{minChars:0,maxItems:99,autoFirst:!0,list:[],data:function(t){return{label:t.label||t.value,value:t.value}},filter:function(){return!0},item:function(t){var i=this.get_item(t.value);i.label||(i.label=i.value);var s=e.translate_values?__(i.label):i.label,n=i.html||"<strong>"+s+"</strong>";return i.description&&i.value!==i.description&&(n+='<br><span class="small">'+__(i.description)+"</span>"),$("<li></li>").data("item.autocomplete",i).prop("aria-selected","false").html("<a><p>"+n+"</p></a>").get(0)},sort:function(){return 0},replace:function(t){}}),this.$input.on("input",frappe.utils.debounce(function(t){e.$link.toggle(!1);var i=e.get_options();if(!!i){e.$input.cache[i]||(e.$input.cache[i]={});var s=t.target.value;e.$input.cache[i][s]!=null&&(e.awesomplete.list=e.$input.cache[i][s]);var n={txt:s,doctype:i,ignore_user_permissions:e.df.ignore_user_permissions,reference_doctype:e.get_reference_doctype()||""};e.set_custom_query(n),frappe.call({type:"POST",method:"frappe.desk.search.search_link",no_spinner:!0,args:n,callback:function(a){if(!!e.$input.is(":focus")){if(a.results=e.merge_duplicates(a.results),n.filters){let c=e.get_filter_description(n.filters);if(c){let u=c.replace(/<b>/g,"").replace(/[</b>]/g,"");a.results.push({html:`<span class="text-muted" style="line-height: 1.5" title="${u}">${c}</span>`,value:"",action:()=>{}})}}e.df.only_select||(frappe.model.can_create(i)&&a.results.push({label:"<span class='text-primary link-option'><i class='fa fa-plus' style='margin-right: 5px;'></i> "+__("Create a new {0}",[__(e.get_options())])+"</span>",value:"create_new__link_option",action:e.new_doc}),locals&&locals.DocType&&a.results.push({label:"<span class='text-primary link-option'><i class='fa fa-search' style='margin-right: 5px;'></i> "+__("Advanced Search")+"</span>",value:"advanced_search__link_option",action:e.open_advanced_search})),e.$input.cache[i][s]=a.results,e.awesomplete.list=e.$input.cache[i][s]}}})}},500)),this.$input.on("blur",function(){if(e.selected){e.selected=!1;return}var t=e.get_input_value(),i=e.doc?e.doc[e.df.fieldname]:e.$input.attr("data-value"),s=__(i)!=t?t:i;s!==e.last_value&&e.parse_validate_and_set_in_model(s)}),this.$input.on("awesomplete-open",function(){e.$wrapper.css({"z-index":100}),e.$wrapper.find("ul").css({"z-index":100}),e.autocomplete_open=!0}),this.$input.on("awesomplete-close",function(){e.$wrapper.css({"z-index":1}),e.autocomplete_open=!1}),this.$input.on("awesomplete-select",function(t){var i=t.originalEvent,s=e.awesomplete.get_item(i.text.value);e.autocomplete_open=!1;var n=9;if(t.keyCode===n)return t.preventDefault(),e.awesomplete.close(),!1;s.action&&(s.value="",s.action.apply(e)),e.df.remember_last_selected_value&&(frappe.boot.user.last_selected_values[e.df.options]=s.value),e.parse_validate_and_set_in_model(s.value)}),this.$input.on("awesomplete-selectcomplete",function(t){var i=t.originalEvent;i.text.value.indexOf("__link_option")!==-1&&e.$input.val("")})}get_filter_description(e){let t=this.get_options(),i=[],s=null;if(frappe.model.with_doctype(t,()=>{s=frappe.get_meta(t)}),Array.isArray(e))i=e;else for(let c in e){let u=e[c];Array.isArray(u)||(u=["=",u]),i.push([c,...u])}i=i.map(c=>c.length===3?[t,...c]:c);function n(c){let u=c[0],g=c[1],b=frappe.meta.get_docfield(u,g),m=b?b.label:frappe.model.unscrub(g);b&&b.fieldtype==="Check"&&(c[3]=c[3]?__("Yes"):__("No")),c[3]&&Array.isArray(c[3])&&c[3].length>5&&(c[3]=c[3].slice(0,5),c[3].push("..."));let _=c[3]==null||c[3]===""?__("empty"):c[3];return[__(m).bold(),__(c[2]),(Array.isArray(c[3])?String(_.map(v=>__(v))):String(__(_))).bold()].join(" ")}let a=i.map(n).join(", ");return __("Filters applied for {0}",[a])}set_formatted_input(e){var t=this;t.$input&&t.$input.attr("data-value",e===void 0?"":e),t.$input&&t.$input.val(t.format_for_input(__(e))),super.set_formatted_input(e)}get_value(){let e=this,t=e.doc?e.doc[e.df.fieldname]:e.$input?e.$input.attr("data-value"):void 0,i=t||e.get_input_value();return this.get_status()==="Write"?this.parse?this.parse(i):i:i||this.value||null}};frappe.ui.form.ControlAutocomplete=class extends frappe.ui.form.ControlAutocomplete{setup_awesomplete(){let e=super.setup_awesomplete()||{};return Object.assign(e,{filter:function(t,i){let s=t.value;return __(t.value)!=t.value&&(s+=__(t.value)),Awesomplete.FILTER_CONTAINS(s,i)}})}set_formatted_input(e){var t=this;e&&t.$input&&t.$input.attr("data-value",e===void 0?"":e),e&&t.$input&&t.$input.val(t.format_for_input(__(e)))}get_value(){let e=this,t=e.$input&&e.$input.attr("data-value")?e.$input.attr("data-value"):e.doc?e.doc[e.df.fieldname]:void 0,i=t||e.get_input_value();return this.get_status()==="Write"?this.parse?this.parse(i):i:i||void 0}get_parsed_value(e){let t=this;if(t.doc){let i=t.$input&&t.$input.attr("data-value")?t.$input.attr("data-value"):t.doc?t.doc[t.df.fieldname]:void 0;e=i||t.get_input_value()}else e=super.get_parsed_value(e);return e}};frappe.ui.FieldSelect=class extends frappe.ui.FieldSelect{init(e){super.init(e),this.awesomplete.filter=function(t,i){if(!i)return;let s=t.label+t.value;return Awesomplete.FILTER_CONTAINS(s,i)}}};frappe.ui.form.add_options=function(r,e){let t=$(r);if(!Array.isArray(e))return t;for(var i=0,s=e.length;i<s;i++){var n=e[i],a=null,c=null;if(!is_null(n)){var u=is_null(n.value),g=is_null(n.label),b=Boolean(n.disabled),m=Boolean(n.selected);if(u&&g)if(n&&typeof n=="string"&&n.includes(";")){let _=n.split(";");a=_[0],c=__(_.slice(-1)[0])}else a=n,c=__(n);else a=u?"":n.value,c=g?__(a):__(n.label)}$("<option>").html(cstr(c)).attr("value",a).prop("disabled",b).prop("selected",m).appendTo(t.get(0))}return t.get(0).selectedIndex=0,t.trigger("select-change"),t};(function(r){r.fn.add_options=function(t){for(var i=0,s=t.length;i<s;i++){var n=t[i],a=null,c=null;if(!is_null(n)){var u=is_null(n.value),g=is_null(n.label),b=Boolean(n.disabled);if(u&&g)if(n&&typeof n=="string"&&n.includes(";")){let m=n.split(";");a=m[0],c=__(m.slice(-1)[0])}else a=n,c=__(n);else a=u?"":n.value,c=g?__(a):__(n.label)}r("<option>").html(cstr(c)).attr("value",a).prop("disabled",b).appendTo(this)}return this.selectedIndex=0,r(this).trigger("select-change"),r(this)},r.fn.set_working=function(){this.prop("disabled",!0)},r.fn.done_working=function(){this.prop("disabled",!1)};let e=r.fn.val;r.fn.val=function(){let t=e.apply(this,arguments);return arguments.length>0&&r(this).trigger("select-change"),t}})(jQuery);frappe.ui.form.ControlDateRange=class extends frappe.ui.form.ControlDateRange{set_date_options(){super.set_date_options();let e="en";frappe.boot.user&&(e=frappe.boot.user.language),$.fn.datepicker.language[e]&&(this.datepicker_options.language=e)}};frappe.ui.form.ControlTable=class extends frappe.ui.form.ControlTable{make(){super.make(),this.$wrapper.off("paste",":text"),this.$wrapper.on("paste",":text",e=>{let t=this.df.fieldname,i=this.grid,s=i.grid_pagination,n=i.grid_rows,a=i.doctype,c=$(e.target).closest(".grid-row").data("name"),u=$(e.target).closest(".form-in-grid").length,g=frappe.utils.get_clipboard_data(e);if(!g||u)return;let b=frappe.utils.csv_to_array(g,"	");if(b.length===1&&b[0].length===1)return;let m=[];if(this.get_field(b[0][0]))b[0].forEach(y=>{m.push(this.get_field(y))}),b.shift();else{let y=n[0].get_visible_columns(),C=!1;y.forEach(R=>{(C||R.fieldname===$(e.target).data("fieldname"))&&(m.push(R.fieldname),C=!0)})}let _=locals[a][c].idx,v=b.length;return b.forEach((y,C)=>{setTimeout(()=>{if(!!y.filter(Boolean).length){_>this.frm.doc[t].length&&this.grid.add_new_row(),_>1&&(_-1)%s.page_length===0&&s.go_to_page(s.page_index+1);let I=n[_-1].doc.name;y.forEach((N,A)=>{let z=m[A];if(z){if(N){let F=frappe.meta.get_field(a,z).fieldtype;N=F&&F==="Text Editor"?N.replace(/[\n\r]/g,"<br>"):N}frappe.model.set_value(a,I,z,N)}}),_++}if(v>=10){let I=C+1;frappe.show_progress(__("Processing"),I,v,null,!0)}},0)}),!1})}};frappe.provide("frappe.form.formatters");frappe.form.formatters.Datetime=function(r){if(r){var e=moment(frappe.datetime.convert_to_user_tz(r));return frappe.boot.sysdefaults.time_zone&&(e=e.tz(frappe.boot.sysdefaults.time_zone)),e.format(frappe.boot.sysdefaults.date_format.toUpperCase()+" HH:mm:ss")}else return""};frappe.form.formatters.Data=function(r,e){return e&&e.options=="URL"?r?`<a href="${r}" title="Open Link" target="_blank">${r}</a>`:void 0:(r=r==null?"":__(r),frappe.form.formatters._apply_custom_formatter(r,e))};frappe.form.formatters.MultiSelect=function(r){if(typeof r=="string")return __(r);if(Array.isArray(r))return r.map(e=>__(e))};var Ri=Ui(Ti()),vo={headerDropdown:[{label:__("Sort Ascending"),action:function(r){this.sortColumn(r.colIndex,"asc")}},{label:__("Sort Descending"),action:function(r){this.sortColumn(r.colIndex,"desc")}},{label:__("Reset sorting"),action:function(r){this.sortColumn(r.colIndex,"none")}},{label:__("Remove column"),action:function(r){this.removeColumn(r.colIndex)}}]},kt=class extends Ri.default{buildOptions(e){super.buildOptions(e),this.options.headerDropdown=[...vo.headerDropdown,...e.headerDropdown]}},Co=class extends frappe.views.QueryReport{render_datatable(){let e=this.data,t=this.columns.filter(i=>!i.hidden);if(this.raw_data.add_total_row&&(e=e.slice(),e.splice(-1,1)),this.$report.show(),this.datatable&&this.datatable.options&&this.datatable.options.showTotalRow===this.raw_data.add_total_row)this.datatable.options.treeView=this.tree_report,this.datatable.refresh(e,t);else{let i={columns:t,data:e,inlineFilters:!0,treeView:this.tree_report,layout:"fixed",cellHeight:33,showTotalRow:this.raw_data.add_total_row,direction:frappe.utils.is_rtl()?"rtl":"ltr",hooks:{columnTotal:frappe.utils.report_column_total}};this.report_settings.get_datatable_options&&(i=this.report_settings.get_datatable_options(i)),this.datatable=new kt(this.$report[0],i)}typeof this.report_settings.initial_depth=="number"&&this.datatable.rowmanager.setTreeDepth(this.report_settings.initial_depth),this.report_settings.after_datatable_render&&this.report_settings.after_datatable_render(this.datatable)}};frappe.views.QueryReport=Co;var $o=class extends frappe.views.ReportView{setup_datatable(e){this.$datatable_wrapper.empty(),this.datatable=new kt(this.$datatable_wrapper[0],{columns:this.columns,data:this.get_data(e),getEditor:this.get_editing_object.bind(this),checkboxColumn:!0,inlineFilters:!0,cellHeight:35,direction:frappe.utils.is_rtl()?"rtl":"ltr",events:{onRemoveColumn:t=>{this.remove_column_from_datatable(t)},onSwitchColumn:(t,i)=>{this.switch_column(t,i)},onCheckRow:()=>{let t=this.get_checked_items();this.toggle_actions_menu_button(t.length>0)}},hooks:{columnTotal:frappe.utils.report_column_total},headerDropdown:[{label:__("Add Column"),action:t=>{let i=[],s=this.get_columns_for_picker();i=s[this.doctype].filter(a=>!this.is_column_added(a)).map(a=>({label:__(a.label),value:a.fieldname})),delete s[this.doctype];for(let a in s)s[a].filter(c=>!this.is_column_added(c)).map(c=>({label:__(c.label)+` (${a})`,value:c.fieldname+","+a})).forEach(c=>i.push(c));let n=new frappe.ui.Dialog({title:__("Add Column"),fields:[{label:__("Select Column"),fieldname:"column",fieldtype:"Autocomplete",options:i},{label:__("Insert Column Before {0}",[t.docfield.label.bold()]),fieldname:"insert_before",fieldtype:"Check"}],primary_action:({column:a,insert_before:c})=>{if(!i.map(b=>b.value).includes(a)){frappe.show_alert({message:__("Invalid column"),indicator:"orange"}),n.hide();return}let u=this.doctype;a.includes(",")&&([a,u]=a.split(","));let g=t.colIndex;c&&(g=g-1),this.add_column_to_datatable(a,u,g),n.hide()}});n.show()}}]})}};frappe.views.ReportView=$o;var xo=class extends frappe.views.GanttView{get required_libs(){return["assets/erpnext_oob/js/lib/gantt/frappe-gantt.css","assets/erpnext_oob/js/lib/gantt/frappe-gantt.min.js"]}};frappe.views.GanttView=xo;erpnext.stock.StockController.prototype.show_general_ledger=function(){var r=this;this.frm.doc.docstatus>0&&cur_frm.add_custom_button(__("Accounting Ledger"),function(){frappe.route_options={voucher_no:r.frm.doc.name,from_date:r.frm.doc.posting_date,to_date:moment(r.frm.doc.modified).format("YYYY-MM-DD"),company:r.frm.doc.company,show_cancelled_entries:r.frm.doc.docstatus===2},frappe.set_route("query-report","General Ledger")},__("View"))};})();
/**!
 * Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
//# sourceMappingURL=erpnext_oob.bundle.FOYXL5T7.js.map
