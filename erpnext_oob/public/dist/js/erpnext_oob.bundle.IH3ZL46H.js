(()=>{var zi=Object.create;var Yt=Object.defineProperty;var Bi=Object.getOwnPropertyDescriptor;var qi=Object.getOwnPropertyNames;var Vi=Object.getPrototypeOf,Yi=Object.prototype.hasOwnProperty;var Xt=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Xi=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of qi(e))!Yi.call(r,s)&&s!==t&&Yt(r,s,{get:()=>e[s],enumerable:!(i=Bi(e,s))||i.enumerable});return r};var Gi=(r,e,t)=>(t=r!=null?zi(Vi(r)):{},Xi(e||!r||!r.__esModule?Yt(t,"default",{value:r,enumerable:!0}):t,r));var si=Xt((Yo,Xe)=>{(function(e){"use strict";typeof define=="function"&&define.amd?define(e):typeof Xe!="undefined"&&typeof Xe.exports!="undefined"?Xe.exports=e():window.Sortable=e()})(function(){"use strict";if(typeof window=="undefined"||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var e,t,i,s,o,a,h,u,g,b,_,m,v,y,C=[],R=!1,I=!1,N=!1,A=[],z,F,E,V,P,se,re,ve,Ce=!1,He=!1,ue,Le,kt,pe,Tt=/\s+/g,G="Sortable"+new Date().getTime(),q=window,D=q.document,ae=q.parseInt,fe=q.setTimeout,Rt=q.jQuery||q.Zepto,st=q.Polymer,Dt={capture:!1,passive:!1},te=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),Me=!!navigator.userAgent.match(/Edge/i),It=Me||te?"cssFloat":"float",Ri="draggable"in D.createElement("div"),rt=function(){if(te)return!1;var n=D.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}(),nt=!1,ot=!1,ne=Math.abs,Et=Math.min,Ne=[],Ht=function(n,d){var l=H(n),p=ae(l.width),f=ht(n,0,d),w=ht(n,1,d),x=f&&H(f),k=w&&H(w),S=x&&ae(x.marginLeft)+ae(x.marginRight)+B(f).width,T=k&&ae(k.marginLeft)+ae(k.marginRight)+B(w).width;if(l.display==="flex")return l.flexDirection==="column"||l.flexDirection==="column-reverse"?"vertical":"horizontal";if(f&&x.float!=="none"){var L=x.float==="left"?"left":"right";return w&&(k.clear==="both"||k.clear===L)?"vertical":"horizontal"}return f&&(x.display==="block"||x.display==="flex"||x.display==="table"||x.display==="grid"||S>=p&&l[It]==="none"||w&&l[It]==="none"&&S+T>p)?"vertical":"horizontal"},Di=function(n,d){for(var l=0;l<A.length;l++)if(!A[l].children.length){var p=B(A[l]),f=A[l][G].options.emptyInsertThreshold,w=n>=p.left-f&&n<=p.right+f,x=d>=p.top-f&&d<=p.bottom+f;if(w&&x)return A[l]}},Ii=function(n,d,l,p,f){var w=B(l),x=p==="vertical"?w.left:w.top,k=p==="vertical"?w.right:w.bottom,S=p==="vertical"?n:d;return x<S&&S<k},Ei=function(n,d,l){var p=n===e&&pe||B(n),f=d===e&&pe||B(d),w=l==="vertical"?p.left:p.top,x=l==="vertical"?p.right:p.bottom,k=l==="vertical"?p.width:p.height,S=l==="vertical"?f.left:f.top,T=l==="vertical"?f.right:f.bottom,L=l==="vertical"?f.width:f.height;return w===S||x===T||w+k/2===S+L/2},le=function(n,d){if(!n||!n.getBoundingClientRect)return q;var l=n,p=!1;do if(l.clientWidth<l.scrollWidth||l.clientHeight<l.scrollHeight){var f=H(l);if(l.clientWidth<l.scrollWidth&&(f.overflowX=="auto"||f.overflowX=="scroll")||l.clientHeight<l.scrollHeight&&(f.overflowY=="auto"||f.overflowY=="scroll")){if(!l||!l.getBoundingClientRect||l===D.body)return q;if(p||d)return l;p=!0}}while(l=l.parentNode);return q},at=qt(function(n,d,l,p){if(d.scroll){var f=l?l[G]:window,w=d.scrollSensitivity,x=d.scrollSpeed,k=n.clientX,S=n.clientY,T=window.innerWidth,L=window.innerHeight,M=!1;g!==l&&(Oe(),u=d.scroll,b=d.scrollFn,u===!0&&(u=le(l,!0),g=u));var W=0,U=u;do{var Y=U,Z=B(Y),xe=Z.top,pt=Z.bottom,Se=Z.left,Fe=Z.right,_e=Z.width,oe=Z.height,ie,ke,ee,je,We,ft,_t,Pe,ze;if(Y!==q?(ie=Y.scrollWidth,ke=Y.scrollHeight,ee=H(Y),ft=_e<ie&&(ee.overflowX==="auto"||ee.overflowX==="scroll"),_t=oe<ke&&(ee.overflowY==="auto"||ee.overflowY==="scroll"),Pe=Y.scrollLeft,ze=Y.scrollTop):(ie=D.documentElement.scrollWidth,ke=D.documentElement.scrollHeight,ee=H(D.documentElement),ft=_e<ie&&(ee.overflowX==="auto"||ee.overflowX==="scroll"||ee.overflowX==="visible"),_t=oe<ke&&(ee.overflowY==="auto"||ee.overflowY==="scroll"||ee.overflowY==="visible"),Pe=D.documentElement.scrollLeft,ze=D.documentElement.scrollTop),je=ft&&(ne(Fe-k)<=w&&Pe+_e<ie)-(ne(Se-k)<=w&&!!Pe),We=_t&&(ne(pt-S)<=w&&ze+oe<ke)-(ne(xe-S)<=w&&!!ze),!C[W])for(var Be=0;Be<=W;Be++)C[Be]||(C[Be]={});(C[W].vx!=je||C[W].vy!=We||C[W].el!==Y)&&(C[W].el=Y,C[W].vx=je,C[W].vy=We,clearInterval(C[W].pid),Y&&(je!=0||We!=0)&&(M=!0,C[W].pid=setInterval(function(){p&&this.layer===0&&X.active._emulateDragOver(!0);var mt=C[this.layer].vy?C[this.layer].vy*x:0,gt=C[this.layer].vx?C[this.layer].vx*x:0;typeof b=="function"&&b.call(f,gt,mt,n,P,C[this.layer].el)!=="continue"||(C[this.layer].el===q?q.scrollTo(q.pageXOffset+gt,q.pageYOffset+mt):(C[this.layer].el.scrollTop+=mt,C[this.layer].el.scrollLeft+=gt))}.bind({layer:W}),24))),W++}while(d.bubbleScroll&&U!==q&&(U=le(U,!1)));R=M}},30),Oe=function(){C.forEach(function(n){clearInterval(n.pid)}),C=[]},Lt=function(n){function d(f,w){return function(x,k,S,T){var L=x.options.group.name&&k.options.group.name&&x.options.group.name===k.options.group.name;if(f==null&&(w||L))return!0;if(f==null||f===!1)return!1;if(w&&f==="clone")return f;if(typeof f=="function")return d(f(x,k,S,T),w)(x,k,S,T);var M=(w?x:k).options.group.name;return f===!0||typeof f=="string"&&f===M||f.join&&f.indexOf(M)>-1}}var l={},p=n.group;(!p||typeof p!="object")&&(p={name:p}),l.name=p.name,l.checkPull=d(p.pull,!0),l.checkPut=d(p.put),l.revertClone=p.revertClone,n.group=l},Mt=function(n){!e||!e.parentNode||e.parentNode[G]&&e.parentNode[G]._computeIsAligned(n)},Nt=function(n,d){for(var l=d;!l[G];)l=l.parentNode;return n===l},Ot=function(n,d,l){for(var p=n.parentNode;p&&!p[G];)p=p.parentNode;p&&p[G][l](ct(d,{artificialBubble:!0}))},At=function(){!rt&&i&&H(i,"display","none")},Ft=function(){!rt&&i&&H(i,"display","")};D.addEventListener("click",function(n){if(N)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),N=!1,!1},!0);var lt=function(n){if(n=n.touches?n.touches[0]:n,e){var d=Di(n.clientX,n.clientY);d&&d[G]._onDragOver({clientX:n.clientX,clientY:n.clientY,target:d,rootEl:d})}};O(D,"dragover",lt),O(D,"mousemove",lt),O(D,"touchmove",lt);function X(n,d){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(n);this.el=n,this.options=d=ct({},d),n[G]=this;var l={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ht(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(w,x){w.setData("Text",x.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:ae(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:X.supportPointer!==!1&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(var p in l)!(p in d)&&(d[p]=l[p]);Lt(d);for(var f in this)f.charAt(0)==="_"&&typeof this[f]=="function"&&(this[f]=this[f].bind(this));this.nativeDraggable=d.forceFallback?!1:Ri,d.supportPointer?O(n,"pointerdown",this._onTapStart):(O(n,"mousedown",this._onTapStart),O(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(O(n,"dragover",this),O(n,"dragenter",this)),A.push(this.el),d.store&&d.store.get&&this.sort(d.store.get(this)||[])}X.prototype={constructor:X,_computeIsAligned:function(n){var d;if(i&&!rt?(At(),d=D.elementFromPoint(n.clientX,n.clientY),Ft()):d=n.target,d=K(d,this.options.draggable,this.el,!1),!ot&&!(!e||e.parentNode!==this.el)){for(var l=this.el.children,p=0;p<l.length;p++)K(l[p],this.options.draggable,this.el,!1)&&l[p]!==d&&(l[p].sortableMouseAligned=Ii(n.clientX,n.clientY,l[p],this._getDirection(n,null),this.options));K(d,this.options.draggable,this.el,!0)||(re=null),ot=!0,fe(function(){ot=!1},30)}},_getDirection:function(n,d){return typeof this.options.direction=="function"?this.options.direction.call(this,n,d,e):this.options.direction},_onTapStart:function(n){if(!!n.cancelable){var d=this,l=this.el,p=this.options,f=p.preventOnFilter,w=n.type,x=n.touches&&n.touches[0],k=(x||n).target,S=n.target.shadowRoot&&(n.path&&n.path[0]||n.composedPath&&n.composedPath()[0])||k,T=p.filter,L;if(Wi(l),!(te&&!n.artificialBubble&&!Nt(l,k))&&!e&&!(/mousedown|pointerdown/.test(w)&&n.button!==0||p.disabled)&&!S.isContentEditable){if(k=K(k,p.draggable,l,!1),!k){te&&Ot(l,n,"_onTapStart");return}if(h!==k){if(L=ce(k,p.draggable),typeof T=="function"){if(T.call(this,n,k,this)){J(d,S,"filter",k,l,l,L),f&&n.cancelable&&n.preventDefault();return}}else if(T&&(T=T.split(",").some(function(M){if(M=K(S,M.trim(),l,!1),M)return J(d,M,"filter",k,l,l,L),!0}),T)){f&&n.cancelable&&n.preventDefault();return}p.handle&&!K(S,p.handle,l,!1)||this._prepareDragStart(n,x,k,L)}}}},_handleAutoScroll:function(n,d){if(!(!e||!this.options.scroll)){var l=n.clientX,p=n.clientY,f=D.elementFromPoint(l,p),w=this;if(d||Me||te){at(n,w.options,f,d);var x=le(f,!0);R&&(!z||l!==F||p!==E)&&(z&&clearInterval(z),z=setInterval(function(){if(!!e){var k=le(D.elementFromPoint(l,p),!0);k!==x&&(x=k,Oe(),at(n,w.options,x,d))}},10),F=l,E=p)}else{if(!w.options.bubbleScroll||le(f,!0)===window){Oe();return}at(n,w.options,le(f,!1),!1)}}},_prepareDragStart:function(n,d,l,p){var f=this,w=f.el,x=f.options,k=w.ownerDocument,S;l&&!e&&l.parentNode===w&&(o=w,e=l,t=e.parentNode,a=e.nextSibling,h=l,v=x.group,_=p,V={target:e,clientX:(d||n).clientX,clientY:(d||n).clientY},this._lastX=(d||n).clientX,this._lastY=(d||n).clientY,e.style["will-change"]="all",e.style.transition="",e.style.transform="",S=function(){f._disableDelayedDrag(),e.draggable=f.nativeDraggable,f._triggerDragStart(n,d),J(f,o,"choose",e,o,o,_),Q(e,x.chosenClass,!0)},x.ignore.split(",").forEach(function(T){jt(e,T.trim(),Pt)}),x.supportPointer?O(k,"pointerup",f._onDrop):(O(k,"mouseup",f._onDrop),O(k,"touchend",f._onDrop),O(k,"touchcancel",f._onDrop)),x.delay?(O(k,"mouseup",f._disableDelayedDrag),O(k,"touchend",f._disableDelayedDrag),O(k,"touchcancel",f._disableDelayedDrag),O(k,"mousemove",f._delayedDragTouchMoveHandler),O(k,"touchmove",f._delayedDragTouchMoveHandler),x.supportPointer&&O(k,"pointermove",f._delayedDragTouchMoveHandler),f._dragStartTimer=fe(S,x.delay)):S())},_delayedDragTouchMoveHandler:function(n){var d=n.touches?n.touches[0]:n;Et(ne(d.clientX-this._lastX),ne(d.clientY-this._lastY))>=this.options.touchStartThreshold&&this._disableDelayedDrag()},_disableDelayedDrag:function(){var n=this.el.ownerDocument;clearTimeout(this._dragStartTimer),j(n,"mouseup",this._disableDelayedDrag),j(n,"touchend",this._disableDelayedDrag),j(n,"touchcancel",this._disableDelayedDrag),j(n,"mousemove",this._delayedDragTouchMoveHandler),j(n,"touchmove",this._delayedDragTouchMoveHandler),j(n,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(n,d){d=d||(n.pointerType=="touch"?n:null),!this.nativeDraggable||d?this.options.supportPointer?O(D,"pointermove",this._onTouchMove):d?O(D,"touchmove",this._onTouchMove):O(D,"mousemove",this._onTouchMove):(O(e,"dragend",this),O(o,"dragstart",this._onDragStart));try{D.selection?Ae(function(){D.selection.empty()}):window.getSelection().removeAllRanges()}catch(l){}},_dragStarted:function(n){if(I=!1,o&&e){this.nativeDraggable&&(O(D,"dragover",this._handleAutoScroll),O(D,"dragover",Mt));var d=this.options;!n&&Q(e,d.dragClass,!1),Q(e,d.ghostClass,!0),H(e,"transform",""),X.active=this,n&&this._appendGhost(),J(this,o,"start",e,o,o,_)}else this._nulling()},_emulateDragOver:function(n){if(P){if(this._lastX===P.clientX&&this._lastY===P.clientY&&!n)return;this._lastX=P.clientX,this._lastY=P.clientY,At();for(var d=D.elementFromPoint(P.clientX,P.clientY),l=d;d&&d.shadowRoot;)d=d.shadowRoot.elementFromPoint(P.clientX,P.clientY),l=d;if(l)do{if(l[G]){var p;if(p=l[G]._onDragOver({clientX:P.clientX,clientY:P.clientY,target:d,rootEl:l}),p&&!this.options.dragoverBubble)break}d=l}while(l=l.parentNode);e.parentNode[G]._computeIsAligned(P),Ft()}},_onTouchMove:function(n){if(V){var d=this.options,l=d.fallbackTolerance,p=d.fallbackOffset,f=n.touches?n.touches[0]:n,w=i&&dt(i),x=i&&w&&w.a,k=i&&w&&w.d,S=(f.clientX-V.clientX+p.x)/(x||1),T=(f.clientY-V.clientY+p.y)/(k||1),L=n.touches?"translate3d("+S+"px,"+T+"px,0)":"translate("+S+"px,"+T+"px)";if(!X.active&&!I){if(l&&Et(ne(f.clientX-this._lastX),ne(f.clientY-this._lastY))<l)return;this._onDragStart(n,!0)}this._handleAutoScroll(f,!0),se=!0,P=f,H(i,"webkitTransform",L),H(i,"mozTransform",L),H(i,"msTransform",L),H(i,"transform",L),n.cancelable&&n.preventDefault()}},_appendGhost:function(){if(!i){var n=B(e,this.options.fallbackOnBody?D.body:o,!0),d=H(e),l=this.options;i=e.cloneNode(!0),Q(i,l.ghostClass,!1),Q(i,l.fallbackClass,!0),Q(i,l.dragClass,!0),H(i,"box-sizing","border-box"),H(i,"margin",0),H(i,"top",n.top),H(i,"left",n.left),H(i,"width",n.width),H(i,"height",n.height),H(i,"opacity","0.8"),H(i,"position","fixed"),H(i,"zIndex","100000"),H(i,"pointerEvents","none"),l.fallbackOnBody&&D.body.appendChild(i)||o.appendChild(i)}},_onDragStart:function(n,d){var l=this,p=n.dataTransfer,f=l.options;s=Vt(e),s.draggable=!1,s.style["will-change"]="",this._hideClone(),Q(s,l.options.chosenClass,!1),l._cloneId=Ae(function(){l.options.removeCloneOnHide||o.insertBefore(s,e),J(l,o,"clone",e)}),!d&&Q(e,f.dragClass,!0),d?(N=!0,l._loopId=setInterval(l._emulateDragOver,50)):(j(D,"mouseup",l._onDrop),j(D,"touchend",l._onDrop),j(D,"touchcancel",l._onDrop),p&&(p.effectAllowed="move",f.setData&&f.setData.call(l,p,e)),O(D,"drop",l),H(e,"transform","translateZ(0)")),I=!0,l._dragStartId=Ae(l._dragStarted.bind(l,d)),O(D,"selectstart",l)},_onDragOver:function(n){var d=this.el,l=n.target,p,f,w,x=this.options,k=x.group,S=X.active,T=v===k,L=x.sort,M=this;if(nt||te&&!n.rootEl&&!n.artificialBubble&&!Nt(d,l))return;function W(){return S&&(Q(e,y?y.options.ghostClass:S.options.ghostClass,!1),Q(e,x.ghostClass,!0)),y!==M&&M!==X.active?y=M:M===X.active&&(y=null),(l===e&&!e.animated||l===d&&!l.animated)&&(re=null),!x.dragoverBubble&&!n.rootEl&&l!==D&&(M._handleAutoScroll(n),e.parentNode[G]._computeIsAligned(n)),!x.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),!0}function U(){J(M,o,"change",l,d,o,_,ce(e,x.draggable),n)}if(n.preventDefault!==void 0&&n.cancelable&&n.preventDefault(),se=!0,l=K(l,x.draggable,d,!0),!!K(n.target,null,e,!0)||l.animated)return W();if(l!==e&&(N=!1),S&&!x.disabled&&(T?L||(w=!o.contains(e)):y===this||(this.lastPutMode=v.checkPull(this,S,e,n))&&k.checkPut(this,S,e,n))){var Y=this._getDirection(n,l);if(p=B(e),w)return this._hideClone(),t=o,a?o.insertBefore(e,a):o.appendChild(e),W();if(d.children.length===0||d.children[0]===i||Ni(n,Y,d)&&!e.animated){if(d.children.length!==0&&d.children[0]!==i&&d===n.target&&(l=zt(d)),l&&(f=B(l)),T?S._hideClone():S._showClone(this),Wt(o,d,e,p,l,f,n,!!l)!==!1)return d.appendChild(e),t=d,pe=null,U(),this._animate(p,e),l&&this._animate(f,l),W()}else if(l&&l!==e&&l.parentNode===d){var Z=0,xe,pt=l.sortableMouseAligned,Se=e.parentNode!==d,Fe=Pi(l,Y==="vertical"?"top":"left");if(re!==l&&(ue=null,xe=B(l)[Y==="vertical"?"top":"left"],Ce=!1),Ei(e,l,Y)&&pt||Se||Fe||x.invertSwap||ue==="insert"||ue==="swap"?(ue!=="swap"&&(He=x.invertSwap||Se||R||Fe),Z=Oi(n,l,Y,x.swapThreshold,x.invertedSwapThreshold==null?x.swapThreshold:x.invertedSwapThreshold,He,re===l),ue="swap"):(Z=Ai(l,x),ue="insert"),Z===0)return W();pe=null,re=l,ve=Z,f=B(l);var _e=l.nextElementSibling,oe=!1;oe=Z===1;var ie=Wt(o,d,e,p,l,f,n,oe);if(ie!==!1)return(ie===1||ie===-1)&&(oe=ie===1),nt=!0,fe(Mi,30),T?S._hideClone():S._showClone(this),oe&&!_e?d.appendChild(e):l.parentNode.insertBefore(e,oe?_e:l),t=e.parentNode,xe!==void 0&&!He&&(Le=ne(xe-B(l)[Y==="vertical"?"top":"left"])),U(),!Se&&this._animate(f,l),this._animate(p,e),W()}if(d.contains(e))return W()}return te&&!n.rootEl&&Ot(d,n,"_onDragOver"),!1},_animate:function(n,d){var l=this.options.animation;if(l){var p=B(d);if(d===e&&(pe=p),n.nodeType===1&&(n=B(n)),n.left+n.width/2!==p.left+p.width/2||n.top+n.height/2!==p.top+p.height/2){var f=dt(this.el),w=f&&f.a,x=f&&f.d;H(d,"transition","none"),H(d,"transform","translate3d("+(n.left-p.left)/(w||1)+"px,"+(n.top-p.top)/(x||1)+"px,0)"),kt=d.offsetWidth,H(d,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),H(d,"transform","translate3d(0,0,0)")}typeof d.animated=="number"&&clearTimeout(d.animated),d.animated=fe(function(){H(d,"transition",""),H(d,"transform",""),d.animated=!1},l)}},_offUpEvents:function(){var n=this.el.ownerDocument;j(D,"touchmove",this._onTouchMove),j(D,"pointermove",this._onTouchMove),j(n,"mouseup",this._onDrop),j(n,"touchend",this._onDrop),j(n,"pointerup",this._onDrop),j(n,"touchcancel",this._onDrop),j(D,"selectstart",this)},_onDrop:function(n){var d=this.el,l=this.options;I=!1,R=!1,He=!1,Ce=!1,clearInterval(this._loopId),clearInterval(z),Oe(),ji(),clearTimeout(this._dragStartTimer),ut(this._cloneId),ut(this._dragStartId),j(D,"mousemove",this._onTouchMove),this.nativeDraggable&&(j(D,"drop",this),j(d,"dragstart",this._onDragStart),j(D,"dragover",this._handleAutoScroll),j(D,"dragover",Mt)),this._offUpEvents(),n&&(se&&(n.cancelable&&n.preventDefault(),!l.dropBubble&&n.stopPropagation()),i&&i.parentNode&&i.parentNode.removeChild(i),(o===t||y&&y.lastPutMode!=="clone")&&s&&s.parentNode&&s.parentNode.removeChild(s),e&&(this.nativeDraggable&&j(e,"dragend",this),Pt(e),e.style["will-change"]="",Q(e,y?y.options.ghostClass:this.options.ghostClass,!1),Q(e,this.options.chosenClass,!1),J(this,o,"unchoose",e,t,o,_,null,n),o!==t?(m=ce(e,l.draggable),m>=0&&(J(null,t,"add",e,t,o,_,m,n),J(this,o,"remove",e,t,o,_,m,n),J(null,t,"sort",e,t,o,_,m,n),J(this,o,"sort",e,t,o,_,m,n)),y&&y.save()):e.nextSibling!==a&&(m=ce(e,l.draggable),m>=0&&(J(this,o,"update",e,t,o,_,m,n),J(this,o,"sort",e,t,o,_,m,n))),X.active&&((m==null||m===-1)&&(m=_),J(this,o,"end",e,t,o,_,m,n),this.save()))),this._nulling()},_nulling:function(){o=e=t=i=a=s=h=u=g=C.length=z=F=E=V=P=se=m=_=re=ve=kt=pe=y=v=X.active=null,Ne.forEach(function(n){n.checked=!0}),Ne.length=0},handleEvent:function(n){switch(n.type){case"drop":case"dragend":this._onDrop(n);break;case"dragenter":case"dragover":e&&(this._onDragOver(n),Li(n));break;case"selectstart":n.preventDefault();break}},toArray:function(){for(var n=[],d,l=this.el.children,p=0,f=l.length,w=this.options;p<f;p++)d=l[p],K(d,w.draggable,this.el,!1)&&n.push(d.getAttribute(w.dataIdAttr)||Fi(d));return n},sort:function(n){var d={},l=this.el;this.toArray().forEach(function(p,f){var w=l.children[f];K(w,this.options.draggable,l,!1)&&(d[p]=w)},this),n.forEach(function(p){d[p]&&(l.removeChild(d[p]),l.appendChild(d[p]))})},save:function(){var n=this.options.store;n&&n.set&&n.set(this)},closest:function(n,d){return K(n,d||this.options.draggable,this.el,!1)},option:function(n,d){var l=this.options;if(d===void 0)return l[n];l[n]=d,n==="group"&&Lt(l)},destroy:function(){var n=this.el;n[G]=null,j(n,"mousedown",this._onTapStart),j(n,"touchstart",this._onTapStart),j(n,"pointerdown",this._onTapStart),this.nativeDraggable&&(j(n,"dragover",this),j(n,"dragenter",this)),Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(d){d.removeAttribute("draggable")}),this._onDrop(),A.splice(A.indexOf(this.el),1),this.el=n=null},_hideClone:function(){s.cloneHidden||(H(s,"display","none"),s.cloneHidden=!0,s.parentNode&&this.options.removeCloneOnHide&&s.parentNode.removeChild(s))},_showClone:function(n){if(n.lastPutMode!=="clone"){this._hideClone();return}s.cloneHidden&&(o.contains(e)&&!this.options.group.revertClone?o.insertBefore(s,e):a?o.insertBefore(s,a):o.appendChild(s),this.options.group.revertClone&&this._animate(e,s),H(s,"display",""),s.cloneHidden=!1)}};function K(n,d,l,p){if(n){l=l||D;do{if(d!=null&&(d[0]===">"&&n.parentNode===l&&Bt(n,d.substring(1))||Bt(n,d))||p&&n===l)return n;if(n===l)break}while(n=Hi(n))}return null}function Hi(n){return n.host&&n!==D&&n.host.nodeType?n.host:n.parentNode}function Li(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function O(n,d,l){n.addEventListener(d,l,Dt)}function j(n,d,l){n.removeEventListener(d,l,Dt)}function Q(n,d,l){if(n&&d)if(n.classList)n.classList[l?"add":"remove"](d);else{var p=(" "+n.className+" ").replace(Tt," ").replace(" "+d+" "," ");n.className=(p+(l?" "+d:"")).replace(Tt," ")}}function H(n,d,l){var p=n&&n.style;if(p){if(l===void 0)return D.defaultView&&D.defaultView.getComputedStyle?l=D.defaultView.getComputedStyle(n,""):n.currentStyle&&(l=n.currentStyle),d===void 0?l:l[d];!(d in p)&&d.indexOf("webkit")===-1&&(d="-webkit-"+d),p[d]=l+(typeof l=="string"?"":"px")}}function dt(n){var d="";do{var l=H(n,"transform");l&&l!=="none"&&(d=l+" "+d)}while(n=n.parentNode);if(window.DOMMatrix)return new DOMMatrix(d);if(window.WebKitCSSMatrix)return new WebKitCSSMatrix(d);if(window.CSSMatrix)return new CSSMatrix(d)}function jt(n,d,l){if(n){var p=n.getElementsByTagName(d),f=0,w=p.length;if(l)for(;f<w;f++)l(p[f],f);return p}return[]}function J(n,d,l,p,f,w,x,k,S){n=n||d[G];var T,L=n.options,M="on"+l.charAt(0).toUpperCase()+l.substr(1);window.CustomEvent&&!te&&!Me?T=new CustomEvent(l,{bubbles:!0,cancelable:!0}):(T=D.createEvent("Event"),T.initEvent(l,!0,!0)),T.to=f||d,T.from=w||d,T.item=p||d,T.clone=s,T.oldIndex=x,T.newIndex=k,T.originalEvent=S,d&&d.dispatchEvent(T),L[M]&&L[M].call(n,T)}function Wt(n,d,l,p,f,w,x,k){var S,T=n[G],L=T.options.onMove,M;return window.CustomEvent&&!te&&!Me?S=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(S=D.createEvent("Event"),S.initEvent("move",!0,!0)),S.to=d,S.from=n,S.dragged=l,S.draggedRect=p,S.related=f||d,S.relatedRect=w||B(d),S.willInsertAfter=k,S.originalEvent=x,n.dispatchEvent(S),L&&(M=L.call(T,S,x)),M}function Pt(n){n.draggable=!1}function Mi(){nt=!1}function ht(n,d,l){for(var p=0,f=0,w=n.children;f<w.length;){if(w[f].style.display!=="none"&&w[f]!==i&&w[f]!==e&&K(w[f],l.draggable,n,!1)){if(p===d)return w[f];p++}f++}return null}function zt(n){for(var d=n.lastElementChild;(d===i||d.style.display==="none")&&(d=d.previousElementSibling,!!d););return d||null}function Ni(n,d,l){var p=B(zt(l)),f=d==="vertical"?n.clientY:n.clientX,w=d==="vertical"?n.clientX:n.clientY,x=d==="vertical"?p.bottom:p.right,k=d==="vertical"?p.left:p.top,S=d==="vertical"?p.right:p.bottom,T=10;return d==="vertical"?w>S+T||w<=S&&f>x&&w>=k:f>x&&w>k||f<=x&&w>S+T}function Oi(n,d,l,p,f,w,x){var k=B(d),S=l==="vertical"?n.clientY:n.clientX,T=l==="vertical"?k.height:k.width,L=l==="vertical"?k.top:k.left,M=l==="vertical"?k.bottom:k.right,W=B(e),U=!1;if(!w){if(x&&Le<T*p)if(!Ce&&(ve===1?S>L+T*f/2:S<M-T*f/2)&&(Ce=!0),Ce)U=!0;else{var Y=l==="vertical"?W.top:W.left,Z=l==="vertical"?W.bottom:W.right;if(ve===1?S<L+Le:S>M-Le)return ve*-1}else if(S>L+T*(1-p)/2&&S<M-T*(1-p)/2)return S>L+T/2?-1:1}return U=U||w,U&&(S<L+T*f/2||S>M-T*f/2)?S>L+T/2?1:-1:0}function Ai(n,d){var l=ce(e,d.draggable),p=ce(n,d.draggable);return l<p?1:-1}function Fi(n){for(var d=n.tagName+n.className+n.src+n.href+n.textContent,l=d.length,p=0;l--;)p+=d.charCodeAt(l);return p.toString(36)}function ce(n,d){var l=0;if(!n||!n.parentNode)return-1;for(;n&&(n=n.previousElementSibling);)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==s&&l++;return l}function Bt(n,d){if(n)try{if(n.matches)return n.matches(d);if(n.msMatchesSelector)return n.msMatchesSelector(d);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(d)}catch(l){return!1}return!1}var $e;function qt(n,d){return function(){if(!$e){var l=arguments,p=this;$e=fe(function(){l.length===1?n.call(p,l[0]):n.apply(p,l),$e=void 0},d)}}}function ji(){clearTimeout($e),$e=void 0}function ct(n,d){if(n&&d)for(var l in d)d.hasOwnProperty(l)&&(n[l]=d[l]);return n}function Vt(n){return st&&st.dom?st.dom(n).cloneNode(!0):Rt?Rt(n).clone(!0)[0]:n.cloneNode(!0)}function Wi(n){Ne.length=0;for(var d=n.getElementsByTagName("input"),l=d.length;l--;){var p=d[l];p.checked&&Ne.push(p)}}function Ae(n){return fe(n,0)}function ut(n){return clearTimeout(n)}function B(n,d,l){if(!(!n.getBoundingClientRect&&n!==q)){var p,f,w,x,k,S,T;if(n!==q?(p=n.getBoundingClientRect(),f=p.top,w=p.left,x=p.bottom,k=p.right,S=p.height,T=p.width):(f=0,w=0,x=window.innerHeight,k=window.innerWidth,S=window.innerHeight,T=window.innerWidth),l&&n!==q){if(d=d||n.parentNode,!te)do if(d&&d.getBoundingClientRect&&H(d,"transform")!=="none"){var L=d.getBoundingClientRect();f-=L.top+ae(H(d,"border-top-width")),w-=L.left+ae(H(d,"border-left-width")),x=f+p.height,k=w+p.width;break}while(d=d.parentNode);var M=dt(n),W=M&&M.a,U=M&&M.d;M&&(f/=U,w/=W,T/=W,S/=U,x=f+S,k=w+T)}return{top:f,left:w,bottom:x,right:k,width:T,height:S}}}function Pi(n,d){for(var l=le(l,!0),p=B(n)[d];l;){var f=B(l)[d],w;if(d==="top"||d==="left"?w=p>=f:w=p<=f,!w)return!0;if(l===q)break;l=le(l,!1)}return!1}return O(D,"touchmove",function(n){(X.active||I)&&n.cancelable&&n.preventDefault()}),X.utils={on:O,off:j,css:H,find:jt,is:function(n,d){return!!K(n,d,n,!1)},extend:ct,throttle:qt,closest:K,toggleClass:Q,clone:Vt,index:ce,nextTick:Ae,cancelNextTick:ut,detectDirection:Ht,getChild:ht},X.create=function(n,d){return new X(n,d)},X.version="1.8.3",X})});var ki=Xt((Xo,Si)=>{"use strict";function Ui(r){return r&&typeof r=="object"&&"default"in r?r.default:r}var Ki=Ui(si());function c(r,e){return typeof r=="string"?(e||document).querySelector(r):r||null}c.each=(r,e)=>typeof r=="string"?Array.from((e||document).querySelectorAll(r)):r||null;c.create=(r,e)=>{let t=document.createElement(r);for(let i in e){let s=e[i];if(i==="inside")c(s).appendChild(t);else if(i==="around"){let o=c(s);o.parentNode.insertBefore(t,o),t.appendChild(o)}else i==="styles"?typeof s=="object"&&Object.keys(s).map(o=>{t.style[o]=s[o]}):i in t?t[i]=s:t.setAttribute(i,s)}return t};c.on=(r,e,t,i)=>{i?c.delegate(r,e,t,i):(i=t,c.bind(r,e,i))};c.off=(r,e,t)=>{r.removeEventListener(e,t)};c.bind=(r,e,t)=>{e.split(/\s+/).forEach(function(i){r.addEventListener(i,t)})};c.delegate=(r,e,t,i)=>{r.addEventListener(e,function(s){let o=s.target.closest(t);o&&(s.delegatedTarget=o,i.call(this,s,o))})};c.unbind=(r,e)=>{if(r)for(let t in e){let i=e[t];t.split(/\s+/).forEach(function(s){r.removeEventListener(s,i)})}};c.fire=(r,e,t)=>{let i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0);for(let s in t)i[s]=t[s];return r.dispatchEvent(i)};c.data=(r,e)=>{if(!e)return r.dataset;for(let t in e)r.dataset[t]=e[t]};c.style=(r,e)=>{if(typeof e=="string")return c.getStyle(r,e);Array.isArray(r)||(r=[r]),r.map(t=>{for(let i in e)t.style[i]=e[i]})};c.removeStyle=(r,e)=>{Array.isArray(r)||(r=[r]),Array.isArray(e)||(e=[e]),r.map(t=>{for(let i of e)t.style[i]=""})};c.getStyle=(r,e)=>{if(!e)return getComputedStyle(r);let t=getComputedStyle(r)[e];return["width","height"].includes(e)&&(t=parseFloat(t)),t};c.closest=(r,e)=>e?e.matches(r)?e:c.closest(r,e.parentNode):null;c.inViewport=(r,e)=>{let{top:t,left:i,bottom:s,right:o}=r.getBoundingClientRect(),{top:a,left:h,bottom:u,right:g}=e.getBoundingClientRect();return t>=a&&i>=h&&s<=u&&o<=g};c.scrollTop=function(e,t){requestAnimationFrame(()=>{e.scrollTop=t})};c.scrollbarSize=function(){return c.scrollBarSizeValue||(c.scrollBarSizeValue=Ji()),c.scrollBarSizeValue};function Ji(){let r=document.createElement("div");c.style(r,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(r);let e=r.offsetWidth-r.clientWidth;return document.body.removeChild(r),e}c.hasVerticalOverflow=function(r){return r.scrollHeight>r.offsetHeight+10};c.hasHorizontalOverflow=function(r){return r.scrollWidth>r.offsetWidth+10};c.measureTextWidth=function(r){let e=document.createElement("div");return e.style.position="absolute",e.style.visibility="hidden",e.style.height="auto",e.style.width="auto",e.style.whiteSpace="nowrap",e.innerText=r,document.body.appendChild(e),e.clientWidth+1};function Qi(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var me=Qi,Ge=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ue(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function Zi(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function es(r,e){return e={exports:{}},r(e,e.exports),e.exports}var ts=typeof Ge=="object"&&Ge&&Ge.Object===Object&&Ge,is=ts,ss=typeof self=="object"&&self&&self.Object===Object&&self,rs=is||ss||Function("return this")(),Ee=rs,ns=function(){return Ee.Date.now()},wt=ns,os=Ee.Symbol,Qe=os,ci=Object.prototype,as=ci.hasOwnProperty,ls=ci.toString,Te=Qe?Qe.toStringTag:void 0;function ds(r){var e=as.call(r,Te),t=r[Te];try{r[Te]=void 0}catch(s){}var i=ls.call(r);return e?r[Te]=t:delete r[Te],i}var hs=ds,cs=Object.prototype,us=cs.toString;function ps(r){return us.call(r)}var fs=ps,_s="[object Null]",ms="[object Undefined]",ri=Qe?Qe.toStringTag:void 0;function gs(r){return r==null?r===void 0?ms:_s:ri&&ri in Object(r)?hs(r):fs(r)}var ui=gs;function bs(r){return r!=null&&typeof r=="object"}var ws=bs,ys="[object Symbol]";function vs(r){return typeof r=="symbol"||ws(r)&&ui(r)==ys}var Cs=vs,ni=0/0,$s=/^\s+|\s+$/g,xs=/^[-+]0x[0-9a-f]+$/i,Ss=/^0b[01]+$/i,ks=/^0o[0-7]+$/i,Ts=parseInt;function Rs(r){if(typeof r=="number")return r;if(Cs(r))return ni;if(me(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=me(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace($s,"");var t=Ss.test(r);return t||ks.test(r)?Ts(r.slice(2),t?2:8):xs.test(r)?ni:+r}var oi=Rs,Ds="Expected a function",Is=Math.max,Es=Math.min;function Hs(r,e,t){var i,s,o,a,h,u,g=0,b=!1,_=!1,m=!0;if(typeof r!="function")throw new TypeError(Ds);e=oi(e)||0,me(t)&&(b=!!t.leading,_="maxWait"in t,o=_?Is(oi(t.maxWait)||0,e):o,m="trailing"in t?!!t.trailing:m);function v(E){var V=i,P=s;return i=s=void 0,g=E,a=r.apply(P,V),a}function y(E){return g=E,h=setTimeout(I,e),b?v(E):a}function C(E){var V=E-u,P=E-g,se=e-V;return _?Es(se,o-P):se}function R(E){var V=E-u,P=E-g;return u===void 0||V>=e||V<0||_&&P>=o}function I(){var E=wt();if(R(E))return N(E);h=setTimeout(I,C(E))}function N(E){return h=void 0,m&&i?v(E):(i=s=void 0,a)}function A(){h!==void 0&&clearTimeout(h),g=0,i=u=s=h=void 0}function z(){return h===void 0?a:N(wt())}function F(){var E=wt(),V=R(E);if(i=arguments,s=this,u=E,V){if(h===void 0)return y(u);if(_)return h=setTimeout(I,e),v(u)}return h===void 0&&(h=setTimeout(I,e)),a}return F.cancel=A,F.flush=z,F}var pi=Hs,Ls="Expected a function";function Ms(r,e,t){var i=!0,s=!0;if(typeof r!="function")throw new TypeError(Ls);return me(t)&&(i="leading"in t?!!t.leading:i,s="trailing"in t?!!t.trailing:s),pi(r,e,{leading:i,maxWait:e,trailing:s})}var Ns=Ms,Os="[object AsyncFunction]",As="[object Function]",Fs="[object GeneratorFunction]",js="[object Proxy]";function Ws(r){if(!me(r))return!1;var e=ui(r);return e==As||e==Fs||e==Os||e==js}var Ps=Ws,zs=Ee["__core-js_shared__"],yt=zs,ai=function(){var r=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function Bs(r){return!!ai&&ai in r}var qs=Bs,Vs=Function.prototype,Ys=Vs.toString;function Xs(r){if(r!=null){try{return Ys.call(r)}catch(e){}try{return r+""}catch(e){}}return""}var Gs=Xs,Us=/[\\^$.*+?()[\]{}|]/g,Ks=/^\[object .+?Constructor\]$/,Js=Function.prototype,Qs=Object.prototype,Zs=Js.toString,er=Qs.hasOwnProperty,tr=RegExp("^"+Zs.call(er).replace(Us,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ir(r){if(!me(r)||qs(r))return!1;var e=Ps(r)?tr:Ks;return e.test(Gs(r))}var sr=ir;function rr(r,e){return r==null?void 0:r[e]}var nr=rr;function or(r,e){var t=nr(r,e);return sr(t)?t:void 0}var xt=or,ar=xt(Object,"create"),Ie=ar;function lr(){this.__data__=Ie?Ie(null):{},this.size=0}var dr=lr;function hr(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var cr=hr,ur="__lodash_hash_undefined__",pr=Object.prototype,fr=pr.hasOwnProperty;function _r(r){var e=this.__data__;if(Ie){var t=e[r];return t===ur?void 0:t}return fr.call(e,r)?e[r]:void 0}var mr=_r,gr=Object.prototype,br=gr.hasOwnProperty;function wr(r){var e=this.__data__;return Ie?e[r]!==void 0:br.call(e,r)}var yr=wr,vr="__lodash_hash_undefined__";function Cr(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Ie&&e===void 0?vr:e,this}var $r=Cr;function ge(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}ge.prototype.clear=dr;ge.prototype.delete=cr;ge.prototype.get=mr;ge.prototype.has=yr;ge.prototype.set=$r;var li=ge;function xr(){this.__data__=[],this.size=0}var Sr=xr;function kr(r,e){return r===e||r!==r&&e!==e}var Tr=kr;function Rr(r,e){for(var t=r.length;t--;)if(Tr(r[t][0],e))return t;return-1}var et=Rr,Dr=Array.prototype,Ir=Dr.splice;function Er(r){var e=this.__data__,t=et(e,r);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():Ir.call(e,t,1),--this.size,!0}var Hr=Er;function Lr(r){var e=this.__data__,t=et(e,r);return t<0?void 0:e[t][1]}var Mr=Lr;function Nr(r){return et(this.__data__,r)>-1}var Or=Nr;function Ar(r,e){var t=this.__data__,i=et(t,r);return i<0?(++this.size,t.push([r,e])):t[i][1]=e,this}var Fr=Ar;function be(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}be.prototype.clear=Sr;be.prototype.delete=Hr;be.prototype.get=Mr;be.prototype.has=Or;be.prototype.set=Fr;var jr=be,Wr=xt(Ee,"Map"),Pr=Wr;function zr(){this.size=0,this.__data__={hash:new li,map:new(Pr||jr),string:new li}}var Br=zr;function qr(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var Vr=qr;function Yr(r,e){var t=r.__data__;return Vr(e)?t[typeof e=="string"?"string":"hash"]:t.map}var tt=Yr;function Xr(r){var e=tt(this,r).delete(r);return this.size-=e?1:0,e}var Gr=Xr;function Ur(r){return tt(this,r).get(r)}var Kr=Ur;function Jr(r){return tt(this,r).has(r)}var Qr=Jr;function Zr(r,e){var t=tt(this,r),i=t.size;return t.set(r,e),this.size+=t.size==i?0:1,this}var en=Zr;function we(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}we.prototype.clear=Br;we.prototype.delete=Gr;we.prototype.get=Kr;we.prototype.has=Qr;we.prototype.set=en;var tn=we,sn="__lodash_hash_undefined__";function rn(r){return this.__data__.set(r,sn),this}var nn=rn;function on(r){return this.__data__.has(r)}var an=on;function Ze(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new tn;++e<t;)this.add(r[e])}Ze.prototype.add=Ze.prototype.push=nn;Ze.prototype.has=an;var ln=Ze;function dn(r,e,t,i){for(var s=r.length,o=t+(i?1:-1);i?o--:++o<s;)if(e(r[o],o,r))return o;return-1}var hn=dn;function cn(r){return r!==r}var un=cn;function pn(r,e,t){for(var i=t-1,s=r.length;++i<s;)if(r[i]===e)return i;return-1}var fn=pn;function _n(r,e,t){return e===e?fn(r,e,t):hn(r,un,t)}var mn=_n;function gn(r,e){var t=r==null?0:r.length;return!!t&&mn(r,e,0)>-1}var bn=gn;function wn(r,e,t){for(var i=-1,s=r==null?0:r.length;++i<s;)if(t(e,r[i]))return!0;return!1}var yn=wn;function vn(r,e){return r.has(e)}var Cn=vn,$n=xt(Ee,"Set"),vt=$n;function xn(){}var Sn=xn;function kn(r){var e=-1,t=Array(r.size);return r.forEach(function(i){t[++e]=i}),t}var fi=kn,Tn=1/0,Rn=vt&&1/fi(new vt([,-0]))[1]==Tn?function(r){return new vt(r)}:Sn,Dn=Rn,In=200;function En(r,e,t){var i=-1,s=bn,o=r.length,a=!0,h=[],u=h;if(t)a=!1,s=yn;else if(o>=In){var g=e?null:Dn(r);if(g)return fi(g);a=!1,s=Cn,u=new ln}else u=e?[]:h;e:for(;++i<o;){var b=r[i],_=e?e(b):b;if(b=t||b!==0?b:0,a&&_===_){for(var m=u.length;m--;)if(u[m]===_)continue e;e&&u.push(_),h.push(b)}else s(u,_,t)||(u!==h&&u.push(_),h.push(b))}return h}var Hn=En;function Ln(r){return r&&r.length?Hn(r):[]}var Mn=Ln;function _i(r){return r.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`)}function Ct(r){return Object.keys(r).map(t=>{let i=_i(t),s=r[t];return s===void 0?"":`data-${i}="${s}" `}).join("").trim()}function di(r){var e=document.createElement("textarea");e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width="2em",e.style.height="2em",e.style.padding=0,e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",e.value=r,document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(t){console.log("Oops, unable to copy")}document.body.removeChild(e)}function Nn(r){return!isNaN(r)}var mi=Ns,On=pi;function De(r,e=null){return(...t)=>new Promise(i=>{setTimeout(()=>{let o=r.apply(e,t);i(o)})})}function it(r,e,t){let i=t.reduce((s,o)=>(s[o]={get(){return e[o]}},s),{});Object.defineProperties(r,i)}function An(r){return r!==void 0||r!==null}function Fn(r){return!An(r)}function Ke(r){return!isNaN(r)}function jn(r){return Array.isArray(r)?r:[r]}function hi(r){return Mn(r)}function Re(r,e){return r-e}function Wn(r){return r.replace(/<[^>]*>/g,"")}function Pn(r,e){return r&&(Object.keys(e).forEach(t=>{let i=new RegExp(`{(${t})}`,"g");r=r.replace(i,e[t])}),r)}var gi=class{constructor(e){this.options=e,this.sortRows=De(this.sortRows,this),this.switchColumn=De(this.switchColumn,this),this.removeColumn=De(this.removeColumn,this),this.options.filterRows=De(this.options.filterRows,this)}init(e,t){e||(e=this.options.data),t&&(this.options.columns=t),this.data=e,this.rowCount=0,this.columns=[],this.rows=[],this.prepareColumns(),this.prepareRows(),this.prepareTreeRows(),this.prepareRowView(),this.prepareNumericColumns()}get currentSort(){return this.columns.find(t=>t.sortOrder!=="none")||{colIndex:-1,sortOrder:"none"}}prepareColumns(){this.columns=[],this.validateColumns(),this.prepareDefaultColumns(),this.prepareHeader()}prepareDefaultColumns(){if(this.options.checkboxColumn&&!this.hasColumnById("_checkbox")){let e={id:"_checkbox",content:this.getCheckboxHTML(),editable:!1,resizable:!1,sortable:!1,focusable:!1,dropdown:!1,width:32};this.columns.push(e)}if(this.options.serialNoColumn&&!this.hasColumnById("_rowIndex")){let e={id:"_rowIndex",content:"",align:"center",editable:!1,resizable:!1,focusable:!1,dropdown:!1};this.columns.push(e)}}prepareHeader(){let e=this.columns.concat(this.options.columns),t={isHeader:1,editable:!0,sortable:!0,resizable:!0,focusable:!0,dropdown:!0,width:null,format:i=>i==null?"":i+""};this.columns=e.map((i,s)=>this.prepareCell(i,s)).map(i=>Object.assign({},t,i)).map(i=>(i.content=i.content||i.name||"",i.id=i.id||i.content,i))}prepareCell(e,t){let i={content:"",sortOrder:"none",colIndex:t,column:this.columns[t]};return e!==null&&typeof e=="object"?Object.assign(i,e):i.content=e,i}prepareNumericColumns(){let e=this.getRow(0);!e||(this.columns=this.columns.map((t,i)=>{let s=e[i].content;return!t.align&&Nn(s)&&(t.align="right"),t}))}prepareRows(){this.validateData(this.data),this.rows=this.data.map((e,t)=>{let i=this._getNextRowCount(),s=[],o={rowIndex:i};if(Array.isArray(e))for(this.options.checkboxColumn&&s.push(this.getCheckboxHTML()),this.options.serialNoColumn&&s.push(i+1+""),s=s.concat(e);s.length<this.columns.length;)s.push("");else{for(let a of this.columns)a.id==="_checkbox"?s.push(this.getCheckboxHTML()):a.id==="_rowIndex"?s.push(i+1+""):s.push(e[a.id]);o.indent=e.indent||0}return this.prepareRow(s,o)})}prepareTreeRows(){this.rows.forEach((e,t)=>{if(Ke(e.meta.indent)){let i=this.getRow(t+1);e.meta.isLeaf=!i||Fn(i.meta.indent)||i.meta.indent<=e.meta.indent,e.meta.isTreeNodeClose=!1}})}prepareRowView(){this.rowViewOrder=this.rows.map(e=>e.meta.rowIndex)}prepareRow(e,t){let i={rowIndex:t.rowIndex,indent:t.indent};return e=e.map((s,o)=>this.prepareCell(s,o)).map(s=>Object.assign({},i,s)),e.meta=t,e}validateColumns(){let e=this.options.columns;if(!Array.isArray(e))throw new Je("`columns` must be an array");e.forEach((t,i)=>{if(typeof t!="string"&&typeof t!="object")throw new Je(`column "${i}" must be a string or an object`)})}validateData(e){if(Array.isArray(e)&&(e.length===0||Array.isArray(e[0])||typeof e[0]=="object"))return!0;throw new Je("`data` must be an array of arrays or objects")}appendRows(e){this.validateData(e),this.rows.push(...this.prepareRows(e))}sortRows(e,t="none"){e=+e,this.getColumns().map(i=>{i.colIndex===e?i.sortOrder=t:i.sortOrder="none"}),this._sortRows(e,t)}_sortRows(e,t){if(this.currentSort.colIndex===e&&(this.currentSort.sortOrder==="asc"&&t==="desc"||this.currentSort.sortOrder==="desc"&&t==="asc")){this.reverseArray(this.rowViewOrder),this.currentSort.sortOrder=t;return}if(this.rowViewOrder.sort((i,s)=>{let o=i,a=s,h=this.getCell(e,i).content,u=this.getCell(e,s).content;if(h=h==null?"":h,u=u==null?"":u,t==="none")return o-a;if(t==="asc"){if(h<u)return-1;if(h>u)return 1;if(h===u)return 0}else if(t==="desc"){if(h<u)return 1;if(h>u)return-1;if(h===u)return 0}return 0}),this.hasColumnById("_rowIndex")){let i=this.getColumnIndexById("_rowIndex");this.rows.forEach((s,o)=>{let a=this.rowViewOrder.indexOf(o),h=s[i];h.content=a+1+""})}}reverseArray(e){let t=null,i=null,s=e.length;for(t=0,i=s-1;t<i;t+=1,i-=1){let o=e[t];e[t]=e[i],e[i]=o}}switchColumn(e,t){let i=this.columns[e];this.columns[e]=this.columns[t],this.columns[t]=i,this.columns[e].colIndex=e,this.columns[t].colIndex=t,this.rows.forEach(s=>{let o=Object.assign({},s[e],{colIndex:t}),a=Object.assign({},s[t],{colIndex:e});s[t]=o,s[e]=a})}removeColumn(e){e=+e;let t=s=>s.colIndex!==e,i=(s,o)=>Object.assign({},s,{colIndex:o});this.columns=this.columns.filter(t).map(i),this.rows.forEach(s=>{s.splice(e,1),s.forEach((o,a)=>{o.colIndex=a})})}updateRow(e,t){e.length<this.columns.length&&(this.hasColumnById("_rowIndex")&&(e=[t+1+""].concat(e)),this.hasColumnById("_checkbox")&&(e=['<input type="checkbox" />'].concat(e)));let i=this.prepareRow(e,{rowIndex:t}),s=this.rows.findIndex(o=>o[0].rowIndex===t);return this.rows[s]=i,i}updateCell(e,t,i){let s;typeof e=="object"&&(s=e,e=s.colIndex,t=s.rowIndex,i=s),s=this.getCell(e,t);for(let o in i){let a=i[o];a!==void 0&&(s[o]=a)}return s}updateColumn(e,t){let i=this.getColumn(e);for(let s in t){let o=t[s];o!==void 0&&(i[s]=o)}return i}filterRows(e){return this.options.filterRows(this.rows,e).then(t=>(t||(t=this.getAllRowIndices()),t.then||(t=Promise.resolve(t)),t.then(i=>(this._filteredRows=i,{rowsToHide:this.getAllRowIndices().filter(o=>!i.includes(o)),rowsToShow:i}))))}getFilteredRowIndices(){return this._filteredRows||this.getAllRowIndices()}getAllRowIndices(){return this.rows.map(e=>e.meta.rowIndex)}getRowCount(){return this.rowCount}_getNextRowCount(){let e=this.rowCount;return this.rowCount++,e}getRows(e,t){return this.rows.slice(e,t)}getRowsForView(e,t){return this.rowViewOrder.map(s=>this.rows[s]).slice(e,t)}getColumns(e){let t=this.columns;return e&&(t=t.slice(this.getStandardColumnCount())),t}getStandardColumnCount(){return this.options.checkboxColumn&&this.options.serialNoColumn?2:this.options.checkboxColumn||this.options.serialNoColumn?1:0}getColumnCount(e){let t=this.columns.length;return e&&(t=t-this.getStandardColumnCount()),t}getColumn(e){return e=+e,e<0&&(e=this.columns.length+e),this.columns.find(t=>t.colIndex===e)}getColumnById(e){return this.columns.find(t=>t.id===e)}getRow(e){return e=+e,this.rows[e]}getCell(e,t){return t=+t,e=+e,this.getRow(t)[e]}getChildren(e){e=+e;let t=this.getRow(e).meta.indent,i=[];for(let s=e+1;s<this.rowCount;s++){let o=this.getRow(s);if(!isNaN(o.meta.indent)&&(o.meta.indent>t&&i.push(s),o.meta.indent===t))break}return i}getImmediateChildren(e){e=+e;let t=this.getRow(e).meta.indent,i=[],s=t+1;for(let o=e+1;o<this.rowCount;o++){let a=this.getRow(o);if(!(isNaN(a.meta.indent)||a.meta.indent>s)&&(a.meta.indent===s&&i.push(o),a.meta.indent===t))break}return i}get(){return{columns:this.columns,rows:this.rows}}getData(e){return this.data[e]}hasColumn(e){return Boolean(this.columns.find(t=>t.content===e))}hasColumnById(e){return Boolean(this.columns.find(t=>t.id===e))}getColumnIndex(e){return this.columns.findIndex(t=>t.content===e)}getColumnIndexById(e){return this.columns.findIndex(t=>t.id===e)}getCheckboxHTML(){return'<input type="checkbox" />'}},Je=class extends TypeError{},$t={chevronDown:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>'},bi=class{constructor(e){this.instance=e,it(this,this.instance,["wrapper","options","style","header","bodyScrollable","columnmanager","rowmanager","datamanager","keyboard"]),this.bindEvents()}bindEvents(){this.bindFocusCell(),this.bindEditCell(),this.bindKeyboardSelection(),this.bindCopyCellContents(),this.bindMouseEvents(),this.bindTreeEvents()}bindFocusCell(){this.bindKeyboardNav()}bindEditCell(){this.$editingCell=null,c.on(this.bodyScrollable,"dblclick",".dt-cell",(e,t)=>{this.activateEditing(t)}),this.keyboard.on("enter",()=>{this.$focusedCell&&!this.$editingCell?this.activateEditing(this.$focusedCell):this.$editingCell&&this.deactivateEditing()})}bindKeyboardNav(){let e=t=>{if(!this.$focusedCell||this.$editingCell)return!1;let i=this.$focusedCell,{rowIndex:s,colIndex:o}=c.data(i);return t==="left"?i=this.getLeftMostCell$(s):t==="right"?i=this.getRightMostCell$(s):t==="up"?i=this.getTopMostCell$(o):t==="down"&&(i=this.getBottomMostCell$(o)),this.focusCell(i),!0};["left","right","up","down","tab","shift+tab"].map(t=>this.keyboard.on(t,()=>this.focusCellInDirection(t))),["left","right","up","down"].map(t=>this.keyboard.on(`ctrl+${t}`,()=>e(t))),this.keyboard.on("esc",()=>{this.deactivateEditing(!1),this.columnmanager.toggleFilter(!1)}),this.options.inlineFilters&&(this.keyboard.on("ctrl+f",t=>{let i=c.closest(".dt-cell",t.target),{colIndex:s}=c.data(i);return this.activateFilter(s),!0}),c.on(this.header,"focusin",".dt-filter",()=>{this.unfocusCell(this.$focusedCell)}))}bindKeyboardSelection(){let e=t=>{let i=this.getSelectionCursor();return t==="left"?i=this.getLeftCell$(i):t==="right"?i=this.getRightCell$(i):t==="up"?i=this.getAboveCell$(i):t==="down"&&(i=this.getBelowCell$(i)),i};["left","right","up","down"].map(t=>this.keyboard.on(`shift+${t}`,()=>this.selectArea(e(t))))}bindCopyCellContents(){this.keyboard.on("ctrl+c",()=>{let e=this.copyCellContents(this.$focusedCell,this.$selectionCursor),t=this.instance.translate("{count} cells copied",{count:e});e&&this.instance.showToastMessage(t,2)}),this.options.pasteFromClipboard&&this.keyboard.on("ctrl+v",e=>(this.instance.pasteTarget.focus(),setTimeout(()=>{let t=this.instance.pasteTarget.value;this.instance.pasteTarget.value="",this.pasteContentInCell(t)},10),!1))}bindMouseEvents(){let e=null;c.on(this.bodyScrollable,"mousedown",".dt-cell",i=>{e=!0,this.focusCell(c(i.delegatedTarget))}),c.on(this.bodyScrollable,"mouseup",()=>{e=!1});let t=i=>{!e||this.selectArea(c(i.delegatedTarget))};c.on(this.bodyScrollable,"mousemove",".dt-cell",mi(t,50))}bindTreeEvents(){c.on(this.bodyScrollable,"click",".dt-tree-node__toggle",(e,t)=>{let i=c.closest(".dt-cell",t),{rowIndex:s}=c.data(i);i.classList.contains("dt-cell--tree-close")?this.rowmanager.openSingleNode(s):this.rowmanager.closeSingleNode(s)})}focusCell(e,{skipClearSelection:t=0,skipDOMFocus:i=0,skipScrollToCell:s=0}={}){if(!e||e===this.$editingCell)return;let{colIndex:o,isHeader:a}=c.data(e);a||this.columnmanager.getColumn(o).focusable===!1||(s||this.scrollToCell(e),this.deactivateEditing(),t||this.clearSelection(),this.$focusedCell&&this.$focusedCell.classList.remove("dt-cell--focus"),this.$focusedCell=e,e.classList.add("dt-cell--focus"),i||e.focus(),this.highlightRowColumnHeader(e))}unfocusCell(e){!e||(e.classList.remove("dt-cell--focus"),this.$focusedCell=null,this.lastHeaders&&this.lastHeaders.forEach(t=>t&&t.classList.remove("dt-cell--highlight")))}highlightRowColumnHeader(e){let{colIndex:t,rowIndex:i}=c.data(e),s=this.datamanager.getColumnIndexById("_rowIndex"),o=`.dt-cell--header-${t}`,a=`.dt-cell--${s}-${i}`;this.lastHeaders&&this.lastHeaders.forEach(g=>g&&g.classList.remove("dt-cell--highlight"));let h=c(o,this.wrapper),u=c(a,this.wrapper);this.lastHeaders=[h,u],this.lastHeaders.forEach(g=>g&&g.classList.add("dt-cell--highlight"))}selectAreaOnClusterChanged(){if(!(this.$focusedCell&&this.$selectionCursor))return;let{colIndex:e,rowIndex:t}=c.data(this.$selectionCursor),i=this.getCell$(e,t);if(!i||i===this.$selectionCursor)return;let s=c.data(this.$focusedCell);this.$focusedCell=this.getCell$(s.colIndex,s.rowIndex),this.selectArea(i)}focusCellOnClusterChanged(){if(!this.$focusedCell)return;let{colIndex:e,rowIndex:t}=c.data(this.$focusedCell),i=this.getCell$(e,t);!i||this.focusCell(i,{skipClearSelection:1,skipDOMFocus:1,skipScrollToCell:1})}selectArea(e){!this.$focusedCell||this._selectArea(this.$focusedCell,e)&&(this.$selectionCursor=e)}_selectArea(e,t){if(e===t)return!1;let i=this.getCellsInRange(e,t);return i?(this.clearSelection(),this._selectedCells=i.map(s=>this.getCell$(...s)),requestAnimationFrame(()=>{this._selectedCells.map(s=>s.classList.add("dt-cell--highlight"))}),!0):!1}getCellsInRange(e,t){let i,s,o,a;if(typeof e=="number")[i,s,o,a]=arguments;else if(typeof e=="object"){if(!(e&&t))return!1;let _=c.data(e),m=c.data(t);i=+_.colIndex,s=+_.rowIndex,o=+m.colIndex,a=+m.rowIndex}if(s>a&&([s,a]=[a,s]),i>o&&([i,o]=[o,i]),this.isStandardCell(i)||this.isStandardCell(o))return!1;let h=[],u=i,g=s,b=[];for(;g<=a;)b.push(g),g+=1;return b.map(_=>{for(;u<=o;)h.push([u,_]),u++;u=i}),h}clearSelection(){(this._selectedCells||[]).forEach(e=>e.classList.remove("dt-cell--highlight")),this._selectedCells=[],this.$selectionCursor=null}getSelectionCursor(){return this.$selectionCursor||this.$focusedCell}activateEditing(e){this.focusCell(e);let{rowIndex:t,colIndex:i}=c.data(e),s=this.columnmanager.getColumn(i);if(s&&(s.editable===!1||s.focusable===!1))return;let o=this.getCell(i,t);if(o&&o.editable===!1)return;if(this.$editingCell){let{_rowIndex:u,_colIndex:g}=c.data(this.$editingCell);if(t===u&&i===g)return}this.$editingCell=e,e.classList.add("dt-cell--editing");let a=c(".dt-cell__edit",e);a.innerHTML="";let h=this.getEditor(i,t,o.content,a);h&&(this.currentCellEditor=h,h.initValue(o.content,t,s))}deactivateEditing(e=!0){e&&this.submitEditing(),this.$focusedCell&&this.$focusedCell.focus(),this.$editingCell&&(this.$editingCell.classList.remove("dt-cell--editing"),this.$editingCell=null)}getEditor(e,t,i,s){let o=this.datamanager.getColumn(e),a=this.datamanager.getRow(t),h=this.datamanager.getData(t),u=this.options.getEditor?this.options.getEditor(e,t,i,s,o,a,h):this.getDefaultEditor(s);return u===!1?!1:(u===void 0&&(u=this.getDefaultEditor(s)),u)}getDefaultEditor(e){let t=c.create("input",{class:"dt-input",type:"text",inside:e});return{initValue(i){t.focus(),t.value=i},getValue(){return t.value},setValue(i){t.value=i}}}submitEditing(){let e=Promise.resolve();if(!this.$editingCell)return e;let t=this.$editingCell,{rowIndex:i,colIndex:s}=c.data(t),o=this.datamanager.getColumn(s);if(t){let a=this.currentCellEditor;if(a){let h=a.getValue();h.then||(h=Promise.resolve(h)),e=h.then(u=>{let g=this.getCell(s,i).content;if(g===u)return!1;let b=a.setValue(u,i,o);return this.updateCell(s,i,u),t.focus(),b&&b.then&&b.catch(_=>{console.log(_),this.updateCell(s,i,g)}),b})}}return this.currentCellEditor=null,e}copyCellContents(e,t){if(!t&&e){let{colIndex:a,rowIndex:h}=c.data(e),u=this.getCell(a,h);return di(u.content),1}let i=this.getCellsInRange(e,t);if(!i)return 0;let s=i.map(a=>this.getCell(...a)).reduce((a,h)=>{let u=h.rowIndex;return a[u]=a[u]||[],a[u].push(h.content),a},[]),o=s.map(a=>a.join("	")).join(`
`);return di(o),s.reduce((a,h)=>a+h.length,0)}pasteContentInCell(e){if(!this.$focusedCell)return;let t=e.split(`
`).map(a=>a.split("	")).filter(a=>a.length&&a.every(h=>h)),{colIndex:i,rowIndex:s}=c.data(this.$focusedCell),o={colIndex:+i,rowIndex:+s};t.forEach((a,h)=>{let u=h+o.rowIndex;a.forEach((g,b)=>{let _=b+o.colIndex;this.updateCell(_,u,g)})})}activateFilter(e){this.columnmanager.toggleFilter(),this.columnmanager.focusFilter(e),this.columnmanager.isFilterShown||this.$focusedCell&&this.$focusedCell.focus()}updateCell(e,t,i){let s=this.datamanager.updateCell(e,t,{content:i});this.refreshCell(s)}refreshCell(e){let t=c(this.selector(e.colIndex,e.rowIndex),this.bodyScrollable);t.innerHTML=this.getCellContent(e)}toggleTreeButton(e,t){let i=this.columnmanager.getFirstColumnIndex(),s=this.getCell$(i,e);s&&s.classList[t?"remove":"add"]("dt-cell--tree-close")}isStandardCell(e){return e<this.columnmanager.getFirstColumnIndex()}focusCellInDirection(e){if(!this.$focusedCell||this.$editingCell&&["left","right","up","down"].includes(e))return!1;this.$editingCell&&["tab","shift+tab"].includes(e)&&this.deactivateEditing();let t=this.$focusedCell;if(e==="left"||e==="shift+tab"?t=this.getLeftCell$(t):e==="right"||e==="tab"?t=this.getRightCell$(t):e==="up"?t=this.getAboveCell$(t):e==="down"&&(t=this.getBelowCell$(t)),!t)return!1;let{colIndex:i}=c.data(t);if(!this.columnmanager.getColumn(i).focusable){let o=this.$focusedCell;this.unfocusCell(o),this.$focusedCell=t;let a=this.focusCellInDirection(e);return a||this.focusCell(o),a}return this.focusCell(t),!0}getCell$(e,t){return c(this.selector(e,t),this.bodyScrollable)}getAboveCell$(e){let{colIndex:t}=c.data(e),i=e.parentElement.previousElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.previousElementSibling;return i?c(`.dt-cell--col-${t}`,i):e}getBelowCell$(e){let{colIndex:t}=c.data(e),i=e.parentElement.nextElementSibling;for(;i&&i.classList.contains("dt-row--hide");)i=i.nextElementSibling;return i?c(`.dt-cell--col-${t}`,i):e}getLeftCell$(e){return e.previousElementSibling}getRightCell$(e){return e.nextElementSibling}getLeftMostCell$(e){return this.getCell$(this.columnmanager.getFirstColumnIndex(),e)}getRightMostCell$(e){return this.getCell$(this.columnmanager.getLastColumnIndex(),e)}getTopMostCell$(e){return this.getCell$(e,this.rowmanager.getFirstRowIndex())}getBottomMostCell$(e){return this.getCell$(e,this.rowmanager.getLastRowIndex())}getCell(e,t){return this.instance.datamanager.getCell(e,t)}getRowHeight(){return c.style(c(".dt-row",this.bodyScrollable),"height")}scrollToCell(e){if(c.inViewport(e,this.bodyScrollable))return!1;let{rowIndex:t}=c.data(e);return this.rowmanager.scrollToRow(t),!1}getRowCountPerPage(){return Math.ceil(this.instance.getViewportHeight()/this.getRowHeight())}getCellHTML(e){let{rowIndex:t,colIndex:i,isHeader:s,isFilter:o,isTotalRow:a}=e,h=Ct({rowIndex:t,colIndex:i,isHeader:s,isFilter:o,isTotalRow:a}),u=this.datamanager.getRow(t),g=!(s||o||a);return`
            <div class="${["dt-cell","dt-cell--col-"+i,g?`dt-cell--${i}-${t}`:"",g?"dt-cell--row-"+t:"",s?"dt-cell--header":"",s?`dt-cell--header-${i}`:"",o?"dt-cell--filter":"",g&&u&&u.meta.isTreeNodeClose?"dt-cell--tree-close":""].join(" ")}" ${h} tabindex="0">
                ${this.getCellContent(e)}
            </div>
        `}getCellContent(e){let{isHeader:t,isFilter:i,colIndex:s}=e,a=!t&&e.editable!==!1?this.getEditCellHTML(s):"",u=t&&e.sortable!==!1?`<span class="sort-indicator">
                ${this.options.sortIndicator[e.sortOrder]}
            </span>`:"",b=t&&e.resizable!==!1?'<span class="dt-cell__resize-handle"></span>':"",m=t&&e.dropdown!==!1?this.columnmanager.getDropdownHTML():"",v=e.format||e.column&&e.column.format||null,y;if(t||i||!v)y=e.content;else{let R=this.datamanager.getRow(e.rowIndex),I=this.datamanager.getData(e.rowIndex);y=v(e.content,R,e.column,I)}if(e.html=y,this.options.treeView&&!(t||i)&&e.indent!==void 0){let R=this.datamanager.getRow(e.rowIndex+1),I=R&&R.meta.indent>e.indent,N=20,A="px";if(this.datamanager.getColumnIndexById("_rowIndex")+1===e.colIndex){let F=(e.indent||0)*N,E=I?`<span class="dt-tree-node__toggle" style="left: ${F-N}${A}">
                        <span class="icon-open">${$t.chevronDown}</span>
                        <span class="icon-close">${$t.chevronRight}</span>
                    </span>`:"";y=`<span class="dt-tree-node" style="padding-left: ${F}${A}">
                    ${E}
                    <span>${y}</span>
                </span>`}}return`
            <div class="${["dt-cell__content",t?`dt-cell__content--header-${s}`:`dt-cell__content--col-${s}`].join(" ")}">
                ${y}
                ${u}
                ${b}
                ${m}
            </div>
            ${a}
        `}getEditCellHTML(e){return`<div class="dt-cell__edit dt-cell__edit--col-${e}"></div>`}selector(e,t){return`.dt-cell--${e}-${t}`}},wi=class{constructor(e){this.instance=e,it(this,this.instance,["options","fireEvent","header","datamanager","cellmanager","style","wrapper","rowmanager","bodyScrollable","bodyRenderer"]),this.bindEvents()}renderHeader(){this.header.innerHTML="<div></div>",this.refreshHeader()}refreshHeader(){let e=this.datamanager.getColumns();c("div",this.header).innerHTML=this.getHeaderHTML(e),this.$filterRow=c(".dt-row-filter",this.header),this.$filterRow&&c.style(this.$filterRow,{display:"none"}),this.$columnMap=[],this.bindMoveColumn()}getHeaderHTML(e){let t=this.rowmanager.getRowHTML(e,{isHeader:1});return this.options.inlineFilters&&(t+=this.rowmanager.getRowHTML(e,{isFilter:1})),t}bindEvents(){this.bindDropdown(),this.bindResizeColumn(),this.bindPerfectColumnWidth(),this.bindFilter()}bindDropdown(){let e=".dt-dropdown__toggle",t=".dt-dropdown__list";this.instance.dropdownContainer.innerHTML=this.getDropdownListHTML(),this.$dropdownList=this.instance.dropdownContainer.firstElementChild,c.on(this.header,"click",e,a=>{this.openDropdown(a)});let i=a=>{let h=[e,e+" *",t,t+" *"].join(",");a.target.matches(h)||o()};c.on(document.body,"click",i),document.addEventListener("scroll",o,!0),this.instance.on("onDestroy",()=>{c.off(document.body,"click",i),c.off(document,"scroll",o)}),c.on(this.$dropdownList,"click",".dt-dropdown__list-item",(a,h)=>{if(!this._dropdownActiveColIndex)return;let u=this.options.headerDropdown,{index:g}=c.data(h),b=this._dropdownActiveColIndex,_=u[g].action;_&&_.call(this.instance,this.getColumn(b)),this.hideDropdown()});let s=this;function o(a){s.hideDropdown()}this.hideDropdown()}openDropdown(e){this._dropdownWidth||(c.style(this.$dropdownList,{display:""}),this._dropdownWidth=c.style(this.$dropdownList,"width")),c.style(this.$dropdownList,{display:"",left:e.clientX-this._dropdownWidth+4+"px",top:e.clientY+4+"px"});let t=c.closest(".dt-cell",e.target),{colIndex:i}=c.data(t);this._dropdownActiveColIndex=i}hideDropdown(){c.style(this.$dropdownList,{display:"none"}),this._dropdownActiveColIndex=null}bindResizeColumn(){let e=!1,t,i,s;c.on(this.header,"mousedown",".dt-cell .dt-cell__resize-handle",(h,u)=>{document.body.classList.add("dt-resize"),t=u.parentNode.parentNode;let{colIndex:b}=c.data(t),_=this.getColumn(b);_&&_.resizable===!1||(e=!0,i=c.style(c(".dt-cell__content",t),"width"),s=h.pageX)});let o=h=>{if(document.body.classList.remove("dt-resize"),!t)return;e=!1;let{colIndex:u}=c.data(t);this.setColumnWidth(u),this.style.setBodyStyle(),t=null};c.on(document.body,"mouseup",o),this.instance.on("onDestroy",()=>{c.off(document.body,"mouseup",o)});let a=h=>{if(!e)return;let u=h.pageX-s;this.options.direction==="rtl"&&(u=-1*u);let g=i+u,{colIndex:b}=c.data(t);this.options.minimumColumnWidth>g||(this.datamanager.updateColumn(b,{width:g}),this.setColumnHeaderWidth(b))};c.on(document.body,"mousemove",a),this.instance.on("onDestroy",()=>{c.off(document.body,"mousemove",a)})}bindPerfectColumnWidth(){c.on(this.header,"dblclick",".dt-cell .dt-cell__resize-handle",(e,t)=>{let i=t.parentNode.parentNode,{colIndex:s}=c.data(i),o=this.bodyRenderer.visibleRows.map(C=>C[s]).reduce((C,R)=>C.content.length>R.content.length?C:R),a=this.cellmanager.getCellHTML(o),h=document.createElement("div");h.innerHTML=a;let u=h.querySelector(".dt-cell__content").textContent,{borderLeftWidth:g,borderRightWidth:b,paddingLeft:_,paddingRight:m}=c.getStyle(this.bodyScrollable.querySelector(".dt-cell__content")),v=[g,b,_,m].map(parseFloat).reduce((C,R)=>C+R),y=c.measureTextWidth(u)+v;this.datamanager.updateColumn(s,{width:y}),this.setColumnHeaderWidth(s),this.setColumnWidth(s)})}bindMoveColumn(){if(this.options.disableReorderColumn)return;let e=c(".dt-row",this.header);this.sortable=Ki.create(e,{onEnd:t=>{let{oldIndex:i,newIndex:s}=t,o=t.item,{colIndex:a}=c.data(o);+a!==s&&this.switchColumn(i,s)},preventOnFilter:!1,filter:".dt-cell__resize-handle, .dt-dropdown",chosenClass:"dt-cell--dragging",animation:150})}sortColumn(e,t){this.instance.freeze(),this.sortRows(e,t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onSortColumn",this.getColumn(e))})}removeColumn(e){let t=this.getColumn(e);this.instance.freeze(),this.datamanager.removeColumn(e).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onRemoveColumn",t)})}switchColumn(e,t){this.instance.freeze(),this.datamanager.switchColumn(e,t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>{this.setColumnWidth(e),this.setColumnWidth(t),this.instance.unfreeze()}).then(()=>{this.fireEvent("onSwitchColumn",this.getColumn(e),this.getColumn(t))})}toggleFilter(e){if(!this.options.inlineFilters)return;let t;e===void 0?t=!this.isFilterShown:t=e,t?c.style(this.$filterRow,{display:""}):c.style(this.$filterRow,{display:"none"}),this.isFilterShown=t,this.style.setBodyStyle()}focusFilter(e){if(!this.isFilterShown)return;c(`.dt-cell--col-${e} .dt-filter`,this.$filterRow).focus()}bindFilter(){if(!this.options.inlineFilters)return;let e=t=>{this.applyFilter(this.getAppliedFilters())};c.on(this.header,"keydown",".dt-filter",On(e,300))}applyFilter(e){this.datamanager.filterRows(e).then(({rowsToShow:t})=>{this.rowmanager.showRows(t)})}getAppliedFilters(){let e={};return c.each(".dt-filter",this.header).map(t=>{let i=t.value;i&&(e[t.dataset.colIndex]=i)}),e}applyDefaultSortOrder(){let e=this.getColumns().filter(t=>t.sortOrder!=="none");if(e.length===1){let t=e[0];this.sortColumn(t.colIndex,t.sortOrder)}}sortRows(e,t){return this.datamanager.sortRows(e,t)}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}setColumnWidth(e,t){e=+e;let i=t||this.getColumn(e).width,s=[`.dt-cell__content--col-${e}`,`.dt-cell__edit--col-${e}`].join(", "),o={width:i+"px"};this.style.setStyle(s,o)}setColumnHeaderWidth(e){e=+e,this.$columnMap=this.$columnMap||[];let t=`.dt-cell__content--header-${e}`,{width:i}=this.getColumn(e),s=this.$columnMap[e];s||(s=this.header.querySelector(t),this.$columnMap[e]=s),s.style.width=i+"px"}getColumnMinWidth(e){return e=+e,this.getColumn(e).minWidth||24}getFirstColumnIndex(){return this.datamanager.getColumnIndexById("_rowIndex")+1}getHeaderCell$(e){return c(`.dt-cell--header-${e}`,this.header)}getLastColumnIndex(){return this.datamanager.getColumnCount()-1}getDropdownHTML(){let{dropdownButton:e}=this.options;return`
            <div class="dt-dropdown">
                <div class="dt-dropdown__toggle">${e}</div>
            </div>
      `}getDropdownListHTML(){let{headerDropdown:e}=this.options;return`
            <div class="dt-dropdown__list">
            ${e.map((t,i)=>`
                <div class="dt-dropdown__list-item" data-index="${i}">${t.label}</div>
            `).join("")}
            </div>
        `}},yi=class{constructor(e){this.instance=e,it(this,this.instance,["options","fireEvent","wrapper","bodyScrollable","bodyRenderer","style"]),this.bindEvents(),this.refreshRows=De(this.refreshRows,this)}get datamanager(){return this.instance.datamanager}get cellmanager(){return this.instance.cellmanager}bindEvents(){this.bindCheckbox()}bindCheckbox(){!this.options.checkboxColumn||(this.checkMap=[],c.on(this.wrapper,"click",'.dt-cell--col-0 [type="checkbox"]',(e,t)=>{let i=t.closest(".dt-cell"),{rowIndex:s,isHeader:o}=c.data(i),a=t.checked;o?this.checkAll(a):this.checkRow(s,a)}))}refreshRows(){this.instance.renderBody(),this.instance.setDimensions()}refreshRow(e,t){this.datamanager.updateRow(e,t).forEach(s=>{this.cellmanager.refreshCell(s)})}getCheckedRows(){if(!this.checkMap)return[];let e=[];for(let t in this.checkMap)this.checkMap[t]===1&&e.push(t);return e}highlightCheckedRows(){this.getCheckedRows().map(e=>this.checkRow(e,!0))}checkRow(e,t){let i=t?1:0,s=o=>`.dt-cell--0-${o} [type="checkbox"]`;this.checkMap[e]=i,c.each(s(e),this.bodyScrollable).map(o=>{o.checked=t}),this.highlightRow(e,t),this.showCheckStatus(),this.fireEvent("onCheckRow",this.datamanager.getRow(e))}checkAll(e){let t=e?1:0;e?this.checkMap=Array.from(Array(this.getTotalRows())).map(i=>t):this.checkMap=[],c.each('.dt-cell--col-0 [type="checkbox"]',this.bodyScrollable).map(i=>{i.checked=e}),this.highlightAll(e),this.showCheckStatus(),this.fireEvent("onCheckRow")}showCheckStatus(){if(!this.options.checkedRowStatus)return;let t=this.getCheckedRows().length;if(t>0){let i=this.instance.translate("{count} rows selected",{count:t});this.bodyRenderer.showToastMessage(i)}else this.bodyRenderer.clearToastMessage()}highlightRow(e,t=!0){let i=this.getRow$(e);if(!!i){if(!t&&this.bodyScrollable.classList.contains("dt-scrollable--highlight-all")){i.classList.add("dt-row--unhighlight");return}t&&i.classList.contains("dt-row--unhighlight")&&i.classList.remove("dt-row--unhighlight"),this._highlightedRows=this._highlightedRows||{},t?(i.classList.add("dt-row--highlight"),this._highlightedRows[e]=i):(i.classList.remove("dt-row--highlight"),delete this._highlightedRows[e])}}highlightAll(e=!0){if(e)this.bodyScrollable.classList.add("dt-scrollable--highlight-all");else{this.bodyScrollable.classList.remove("dt-scrollable--highlight-all");for(let t in this._highlightedRows)this._highlightedRows[t].classList.remove("dt-row--highlight");this._highlightedRows={}}}showRows(e){e=jn(e);let t=e.map(i=>this.datamanager.getRow(i));this.bodyRenderer.renderRows(t)}showAllRows(){let e=this.datamanager.getAllRowIndices();this.showRows(e)}getChildrenToShowForNode(e){let t=this.datamanager.getRow(e);return t.meta.isTreeNodeClose=!1,this.datamanager.getImmediateChildren(e)}openSingleNode(e){let t=this.getChildrenToShowForNode(e),i=this.bodyRenderer.visibleRowIndices,s=hi([...t,...i]).sort(Re);this.showRows(s)}getChildrenToHideForNode(e){let t=this.datamanager.getRow(e);t.meta.isTreeNodeClose=!0;let i=this.datamanager.getChildren(e);return i.forEach(s=>{let o=this.datamanager.getRow(s);o.meta.isLeaf||(o.meta.isTreeNodeClose=!0)}),i}closeSingleNode(e){let t=this.getChildrenToHideForNode(e),s=this.bodyRenderer.visibleRowIndices.filter(o=>!t.includes(o)).sort(Re);this.showRows(s)}expandAllNodes(){let i=this.datamanager.getRows().filter(a=>!a.meta.isLeaf).map(a=>this.getChildrenToShowForNode(a.meta.rowIndex)).flat(),s=this.bodyRenderer.visibleRowIndices,o=hi([...i,...s]).sort(Re);this.showRows(o)}collapseAllNodes(){let i=this.datamanager.getRows().filter(a=>a.meta.indent===0).map(a=>this.getChildrenToHideForNode(a.meta.rowIndex)).flat(),o=this.bodyRenderer.visibleRowIndices.filter(a=>!i.includes(a)).sort(Re);this.showRows(o)}setTreeDepth(e){let t=this.datamanager.getRows(),i=t.filter(h=>h.meta.indent<e),s=t.filter(h=>h.meta.indent>=e),o=s.filter(h=>h.meta.indent>e);s.forEach(h=>{h.meta.isLeaf||(h.meta.isTreeNodeClose=!0)}),i.forEach(h=>{h.meta.isLeaf||(h.meta.isTreeNodeClose=!1)});let a=t.filter(h=>!o.includes(h)).map(h=>h.meta.rowIndex).sort(Re);this.showRows(a)}getRow$(e){return c(this.selector(e),this.bodyScrollable)}getTotalRows(){return this.datamanager.getRowCount()}getFirstRowIndex(){return 0}getLastRowIndex(){return this.datamanager.getRowCount()-1}scrollToRow(e){e=+e,this._lastScrollTo=this._lastScrollTo||0;let t=this.getRow$(e);if(c.inViewport(t,this.bodyScrollable))return;let{height:i}=t.getBoundingClientRect(),{top:s,bottom:o}=this.bodyScrollable.getBoundingClientRect(),a=Math.floor((o-s)/i),h=0;e>this._lastScrollTo?h=i*(e+1-a):h=i*(e+1-1),this._lastScrollTo=e,c.scrollTop(this.bodyScrollable,h)}getRowHTML(e,t){let i=Ct(t),s=t.rowIndex;return t.isFilter&&(e=e.map(o=>Object.assign({},o,{content:this.getFilterInput({colIndex:o.colIndex,name:o.name}),isFilter:1,isHeader:void 0,editable:!1})),s="filter"),t.isHeader&&(s="header"),`
            <div class="dt-row dt-row-${s}" ${i}>
                ${e.map(o=>this.cellmanager.getCellHTML(o)).join("")}
            </div>
        `}getFilterInput(e){let t=`title="Filter based on ${e.name||"Index"}"`;return`<input class="dt-filter dt-input" type="text" ${Ct(e)} tabindex="1" 
            ${e.colIndex===0?"disabled":t} />`}selector(e){return`.dt-row-${e}`}},zn=es(function(r,e){(function(t){r.exports=t()})(function(){return function t(i,s,o){function a(g,b){if(!s[g]){if(!i[g]){var _=typeof Ue=="function"&&Ue;if(!b&&_)return _(g,!0);if(h)return h(g,!0);var m=new Error("Cannot find module '"+g+"'");throw m.code="MODULE_NOT_FOUND",m}var v=s[g]={exports:{}};i[g][0].call(v.exports,function(y){var C=i[g][1][y];return a(C||y)},v,v.exports,t,i,s,o)}return s[g].exports}for(var h=typeof Ue=="function"&&Ue,u=0;u<o.length;u++)a(o[u]);return a}({1:[function(t,i,s){Object.defineProperty(s,"__esModule",{value:!0});var o=function(){function b(_,m){for(var v=0;v<m.length;v++){var y=m[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(_,y.key,y)}}return function(_,m,v){return m&&b(_.prototype,m),v&&b(_,v),_}}();function a(b,_){if(!(b instanceof _))throw new TypeError("Cannot call a class as a function")}var h={width:"100%",height:"100%"},u=function(_){return Number(_)===Number(_)},g=function(){o(b,null,[{key:"create",value:function(m,v){return new b(m,v)}},{key:"mergeStyle",value:function(m,v){for(var y in v)m.style[y]!==v[y]&&(m.style[y]=v[y])}},{key:"getMaxBrowserHeight",value:function(){var m=document.createElement("div"),v=document.createElement("div");b.mergeStyle(m,{position:"absolute",height:"1px",opacity:0}),b.mergeStyle(v,{height:"1e7px"}),m.appendChild(v),document.body.appendChild(m);var y=v.offsetHeight;return document.body.removeChild(m),y}}]);function b(_,m){var v=this;a(this,b),this._config={},this._lastRepaint=null,this._maxElementHeight=b.getMaxBrowserHeight(),this.refresh(_,m);var y=this._config,C=function R(){var I=v._getScrollPosition(),N=v._lastRepaint;if(v._renderAnimationFrame=window.requestAnimationFrame(R),I!==N&&(!N||Math.abs(I-N)>v._averageHeight)){var A=v._renderChunk();v._lastRepaint=I,A!==!1&&typeof y.afterRender=="function"&&y.afterRender()}};C()}return o(b,[{key:"destroy",value:function(){window.cancelAnimationFrame(this._renderAnimationFrame)}},{key:"refresh",value:function(m,v){var y=this;if(Object.assign(this._config,h,v),!m||m.nodeType!==1)throw new Error("HyperList requires a valid DOM Node container");this._element=m;var C=this._config,R=this._scroller||C.scroller||document.createElement(C.scrollerTagName||"tr");if(typeof C.useFragment!="boolean"&&(this._config.useFragment=!0),!C.generate)throw new Error("Missing required `generate` function");if(!u(C.total))throw new Error("Invalid required `total` value, expected number");if(!Array.isArray(C.itemHeight)&&!u(C.itemHeight))throw new Error("\n        Invalid required `itemHeight` value, expected number or array\n      ".trim());u(C.itemHeight)?this._itemHeights=Array(C.total).fill(C.itemHeight):this._itemHeights=C.itemHeight,Object.keys(h).filter(function(F){return F in C}).forEach(function(F){var E=C[F],V=u(E),P=V?!1:E.slice(-1)==="%";if(E&&typeof E!="string"&&typeof E!="number"){var se="Invalid optional `"+F+"`, expected string or number";throw new Error(se)}else V&&(C[F]=E+"px");if(F==="height"){var re=V?E:parseInt(E.replace(/px|%/,""),10);P?y._containerHeight=window.innerHeight*re/100:y._containerHeight=u(E)?E:re}});var I={width:""+C.width,height:""+C.height,overflow:"auto",position:"relative"};b.mergeStyle(m,I);var N=C.itemHeight*C.total,A=this._maxElementHeight;N>A&&console.warn(["HyperList: The maximum element height",A+"px has","been exceeded; please reduce your item height."].join(" "));var z={opacity:"0",position:"absolute",width:"1px",height:N+"px"};b.mergeStyle(R,z),this._scroller||m.appendChild(R),this._scroller=R,this._scrollHeight=this._computeScrollHeight(),this._itemPositions=this._itemPositions||Array(C.total).fill(0),this._computePositions(0),this._renderChunk(this._lastRepaint!==null),typeof C.afterRender=="function"&&C.afterRender()}},{key:"_getRow",value:function(m){var v=this._config,y=v.generate(m),C=y.height;if(C!==void 0&&u(C)?(y=y.element,C!==this._itemHeights&&(this._itemHeights[m]=C,this._computePositions(m),this._scrollHeight=this._computeScrollHeight(m))):C=this._itemHeights[m],!y||y.nodeType!==1)throw new Error("Generator did not return a DOM Node for index: "+m);var R=y.getAttribute("class")||"";y.setAttribute("class",R+" "+(v.rowClassName||"vrow"));var I=this._itemPositions[m];return b.mergeStyle(y,{position:"absolute",top:I+"px"}),y}},{key:"_getScrollPosition",value:function(){var m=this._config;return typeof m.overrideScrollPosition=="function"?m.overrideScrollPosition():this._element.scrollTop}},{key:"_renderChunk",value:function(m){var v=this._config,y=this._element,C=this._getScrollPosition(),R=v.total,I=v.reverse?this._getReverseFrom(C):this._getFrom(C)-1;if((I<0||I-this._screenItemsLen<0)&&(I=0),!m&&this._lastFrom===I)return!1;this._lastFrom=I;var N=I+this._cachedItemsLen;(N>R||N+this._cachedItemsLen>R)&&(N=R);var A=v.useFragment?document.createDocumentFragment():[],z=this._scroller;A[v.useFragment?"appendChild":"push"](z);for(var F=I;F<N;F++){var E=this._getRow(F);A[v.useFragment?"appendChild":"push"](E)}if(v.applyPatch)return v.applyPatch(y,A);y.innerHTML="",y.appendChild(A)}},{key:"_computePositions",value:function(){var m=arguments.length<=0||arguments[0]===void 0?1:arguments[0],v=this._config,y=v.total,C=v.reverse;m<1&&!C&&(m=1);for(var R=m;R<y;R++)C?R===0?this._itemPositions[0]=this._scrollHeight-this._itemHeights[0]:this._itemPositions[R]=this._itemPositions[R-1]-this._itemHeights[R]:this._itemPositions[R]=this._itemHeights[R-1]+this._itemPositions[R-1]}},{key:"_computeScrollHeight",value:function(){var m=this,v=this._config,y=v.total,C=this._itemHeights.reduce(function(z,F){return z+F},0);b.mergeStyle(this._scroller,{opacity:0,position:"absolute",width:"1px",height:C+"px"});var R=this._itemHeights.slice(0).sort(function(z,F){return z-F}),I=Math.floor(y/2),N=y%2===0?(R[I]+R[I-1])/2:R[I],A=this._element.clientHeight?this._element.clientHeight:this._containerHeight;return this._screenItemsLen=Math.ceil(A/N),this._containerHeight=A,this._cachedItemsLen=Math.max(this._cachedItemsLen||0,this._screenItemsLen*3),this._averageHeight=N,v.reverse&&window.requestAnimationFrame(function(){m._element.scrollTop=C}),C}},{key:"_getFrom",value:function(m){for(var v=0;this._itemPositions[v]<m;)v++;return v}},{key:"_getReverseFrom",value:function(m){for(var v=this._config.total-1;v>0&&this._itemPositions[v]<m+this._containerHeight;)v--;return v}}]),b}();s.default=g,i.exports=s.default},{}]},{},[1])(1)})}),Bn=Zi(zn),vi=class{constructor(e){this.instance=e,this.options=e.options,this.datamanager=e.datamanager,this.rowmanager=e.rowmanager,this.cellmanager=e.cellmanager,this.bodyScrollable=e.bodyScrollable,this.footer=this.instance.footer,this.log=e.log}renderRows(e){if(this.visibleRows=e,this.visibleRowIndices=e.map(o=>o.meta.rowIndex),e.length===0){this.bodyScrollable.innerHTML=this.getNoDataHTML();return}let t=this.datamanager.rowViewOrder.map(o=>this.visibleRowIndices.includes(o)?o:null).filter(o=>o!==null),i=getComputedStyle(this.bodyScrollable),s={width:i.width,height:i.height,itemHeight:this.options.cellHeight,total:e.length,generate:o=>{let a=document.createElement("div"),h=t[o],u=this.datamanager.getRow(h),g=this.rowmanager.getRowHTML(u,u.meta);return a.innerHTML=g,a.children[0]},afterRender:()=>{this.restoreState()}};this.hyperlist?this.hyperlist.refresh(this.bodyScrollable,s):this.hyperlist=new Bn(this.bodyScrollable,s),this.renderFooter()}render(){let e=this.datamanager.getRowsForView();this.renderRows(e),this.instance.setDimensions()}renderFooter(){if(!this.options.showTotalRow)return;let e=this.getTotalRow(),t=this.rowmanager.getRowHTML(e,{isTotalRow:1,rowIndex:"totalRow"});this.footer.innerHTML=t}getTotalRow(){return this.datamanager.getColumns().map(s=>{let o=null;return["_rowIndex","_checkbox"].includes(s.id)&&(o=""),{content:o,isTotalRow:1,colIndex:s.colIndex,column:s}}).map((s,o)=>{if(s.content==="")return s;if(this.options.hooks.columnTotal){let a=this.visibleRows.map(u=>u[o].content),h=this.options.hooks.columnTotal.call(this.instance,a,s);if(h!=null)return s.content=h,s}return s.content=this.visibleRows.reduce((a,h)=>{let u=h[o];return typeof u.content=="number"?(a==null&&(a=0),a+u.content):a},s.content),s})}restoreState(){this.rowmanager.highlightCheckedRows(),this.cellmanager.selectAreaOnClusterChanged(),this.cellmanager.focusCellOnClusterChanged()}showToastMessage(e,t){this.instance.toastMessage.innerHTML=this.getToastMessageHTML(e),t&&setTimeout(()=>{this.clearToastMessage()},t*1e3)}clearToastMessage(){this.instance.toastMessage.innerHTML=""}getNoDataHTML(){return`<div class="dt-scrollable__no-data">${this.options.noDataMessage}</div>`}getToastMessageHTML(e){return`<span class="dt-toast__message">${e}</span>`}},Ci=class{constructor(e){this.instance=e,it(this,this.instance,["options","datamanager","columnmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer"]),this.scopeClass="dt-instance-"+e.constructor.instances,e.datatableWrapper.classList.add(this.scopeClass);let t=document.createElement("style");e.wrapper.insertBefore(t,e.datatableWrapper),this.styleEl=t,this.bindResizeWindow(),this.bindScrollHeader()}get stylesheet(){return this.styleEl.sheet}bindResizeWindow(){this.onWindowResize=this.onWindowResize.bind(this),this.onWindowResize=mi(this.onWindowResize,300),this.options.layout==="fluid"&&c.on(window,"resize",this.onWindowResize)}bindScrollHeader(){this._settingHeaderPosition=!1,c.on(this.bodyScrollable,"scroll",e=>{this._settingHeaderPosition||(this._settingHeaderPosition=!0,requestAnimationFrame(()=>{let t=-e.target.scrollLeft;c.style(this.header,{transform:`translateX(${t}px)`}),c.style(this.footer,{transform:`translateX(${t}px)`}),this._settingHeaderPosition=!1}))})}onWindowResize(){this.distributeRemainingWidth(),this.refreshColumnWidth(),this.setBodyStyle()}destroy(){this.styleEl.remove(),c.off(window,"resize",this.onWindowResize)}setStyle(e,t){if(e.includes(",")){e.split(",").map(a=>a.trim()).forEach(a=>{this.setStyle(a,t)});return}if(e=e.trim(),!e)return;this._styleRulesMap=this._styleRulesMap||{};let i=this._getPrefixedSelector(e);this._styleRulesMap[i]&&(this.removeStyle(e),t=Object.assign({},this._styleRulesMap[i],t));let s=this._getRuleString(t),o=`${i} { ${s} }`;this._styleRulesMap[i]=t,this.stylesheet.insertRule(o)}removeStyle(e){if(e.includes(",")){e.split(",").map(s=>s.trim()).forEach(s=>{this.removeStyle(s)});return}if(e=e.trim(),!e)return;let t=this._getPrefixedSelector(e),i=Array.from(this.stylesheet.cssRules).findIndex(s=>s.selectorText===t);i!==-1&&this.stylesheet.deleteRule(i)}_getPrefixedSelector(e){return`.${this.scopeClass} ${e}`}_getRuleString(e){return Object.keys(e).map(t=>{let i=t;return t.includes("-")||(i=_i(t)),`${i}:${e[t]};`}).join("")}setDimensions(){this.setCellHeight(),this.setupMinWidth(),this.setupNaturalColumnWidth(),this.setupColumnWidth(),this.distributeRemainingWidth(),this.setColumnStyle(),this.setBodyStyle()}setCellHeight(){this.setStyle(".dt-cell",{height:this.options.cellHeight+"px"})}setupMinWidth(){c.each(".dt-cell--header",this.header).map(e=>{let{colIndex:t}=c.data(e),i=this.getColumn(t);if(!i.minWidth){let s=c.style(c(".dt-cell__content",e),"width");i.minWidth=s}})}setupNaturalColumnWidth(){!c(".dt-row")||(c.each(".dt-row-header .dt-cell",this.header).map(e=>{let{colIndex:t}=c.data(e),i=this.datamanager.getColumn(t),s=c.style(c(".dt-cell__content",e),"width");typeof s=="number"&&s>=this.options.minimumColumnWidth?i.naturalWidth=s:i.naturalWidth=this.options.minimumColumnWidth}),c.each(".dt-row-0 .dt-cell",this.bodyScrollable).map(e=>{let{colIndex:t}=c.data(e),i=this.datamanager.getColumn(t),s=c.style(c(".dt-cell__content",e),"width");typeof s=="number"&&s>=i.naturalWidth?i.naturalWidth=s:i.naturalWidth=i.naturalWidth}))}setupColumnWidth(){if(this.options.layout==="ratio"){let e=c.style(this.datatableWrapper,"width");if(this.options.serialNoColumn){let s=this.datamanager.getColumnById("_rowIndex");e=e-s.width-1}if(this.options.checkboxColumn){let s=this.datamanager.getColumnById("_checkbox");e=e-s.width-1}let t=this.datamanager.getColumns().map(s=>s.id==="_rowIndex"||s.id==="_checkbox"?0:(s.width||(s.width=1),s.ratioWidth=parseInt(s.width,10),s.ratioWidth)).reduce((s,o)=>s+o),i=e/t;this.datamanager.getColumns().map(s=>{s.id==="_rowIndex"||s.id==="_checkbox"||(s.width=Math.floor(i*s.ratioWidth)-1)})}else this.datamanager.getColumns().map(e=>{e.width||(e.width=e.naturalWidth),e.id==="_rowIndex"&&(e.width=this.getRowIndexColumnWidth()),e.width<this.options.minimumColumnWidth&&(e.width=this.options.minimumColumnWidth)})}distributeRemainingWidth(){if(this.options.layout!=="fluid")return;let e=c.style(this.instance.datatableWrapper,"width"),t=c(".dt-row",this.bodyScrollable),i=e;if(t)i=c.style(t,"width");else{let a=c(".dt-row",this.instance.header);i=Array.from(a.children).map(u=>u.offsetWidth).reduce((u,g)=>u+g,0)}let s=this.datamanager.getColumns().filter(a=>a.resizable),o=(e-i)/s.length;s.map(a=>{let h=c.style(this.getColumnHeaderElement(a.colIndex),"width"),u=Math.floor(h+o)-2;this.datamanager.updateColumn(a.colIndex,{width:u})})}setColumnStyle(){this.datamanager.getColumns().map(e=>{e.align||(e.align="left"),["left","center","right"].includes(e.align)||(e.align="left"),this.setStyle(`.dt-cell--col-${e.colIndex}`,{"text-align":e.align}),this.columnmanager.setColumnHeaderWidth(e.colIndex),this.columnmanager.setColumnWidth(e.colIndex)})}refreshColumnWidth(){this.datamanager.getColumns().map(e=>{this.columnmanager.setColumnHeaderWidth(e.colIndex),this.columnmanager.setColumnWidth(e.colIndex)})}setBodyStyle(){let e=c.style(this.datatableWrapper,"width"),t=c(".dt-row",this.bodyScrollable);if(!t)return;let i=c.style(t,"width"),s=e>i?i:e;c.style(this.bodyScrollable,{width:s+"px"}),c.removeStyle(this.bodyScrollable,"height");let o=c.getStyle(this.bodyScrollable,"height"),a=(this.bodyRenderer.hyperlist||{})._scrollHeight||1/0,h=c.hasHorizontalOverflow(this.bodyScrollable),u;a<o&&(u=a,h&&(u+=c.scrollbarSize()),c.style(this.bodyScrollable,{height:u+"px"})),this.bodyScrollable.scrollHeight-this.bodyScrollable.offsetHeight<c.scrollbarSize()&&c.style(this.bodyScrollable,{overflowY:"hidden"}),this.options.layout==="fluid"&&c.style(this.bodyScrollable,{overflowX:"hidden"})}getColumnHeaderElement(e){return e=+e,e<0?null:c(`.dt-cell--col-${e}`,this.header)}getRowIndexColumnWidth(){let e=this.datamanager.getRowCount(),t=22;return c.measureTextWidth(e+"")+t}},qn={13:"enter",91:"meta",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",9:"tab",27:"esc",67:"c",70:"f",86:"v"},$i=class{constructor(e){this.listeners={},c.on(e,"keydown",this.handler.bind(this))}handler(e){let t=qn[e.keyCode];e.shiftKey&&t!=="shift"&&(t="shift+"+t),(e.ctrlKey&&t!=="ctrl"||e.metaKey&&t!=="meta")&&(t="ctrl+"+t);let i=this.listeners[t];if(i&&i.length>0)for(let s of i){let o=s(e);(o===void 0||o===!0)&&e.preventDefault()}}on(e,t){e.split(",").map(s=>s.trim()).map(s=>{this.listeners[s]=this.listeners[s]||[],this.listeners[s].push(t)})}},Vn={"Sort Ascending":"Sort Ascending","Sort Descending":"Sort Descending","Reset sorting":"Reset sorting","Remove column":"Remove column","No Data":"No Data","{count} cells copied":{"1":"{count} cell copied",default:"{count} cells copied"},"{count} rows selected":{"1":"{count} row selected",default:"{count} rows selected"}},Yn={"Sort Ascending":"Aufsteigend sortieren","Sort Descending":"Absteigend sortieren","Reset sorting":"Sortierung zur\xFCcksetzen","Remove column":"Spalte entfernen","No Data":"Keine Daten","{count} cells copied":{"1":"{count} Zelle kopiert",default:"{count} Zellen kopiert"},"{count} rows selected":{"1":"{count} Zeile ausgew\xE4hlt",default:"{count} Zeilen ausgew\xE4hlt"}},Xn={"Sort Ascending":"Trier par ordre croissant","Sort Descending":"Trier par ordre d\xE9croissant","Reset sorting":"R\xE9initialiser le tri","Remove column":"Supprimer colonne","No Data":"Pas de donn\xE9es","{count} cells copied":{"1":"{count} cellule copi\xE9e",default:"{count} cellules copi\xE9es"},"{count} rows selected":{"1":"{count} ligne s\xE9lectionn\xE9e",default:"{count} lignes s\xE9lectionn\xE9es"}},Gn={"Sort Ascending":"Ordinamento ascendente","Sort Descending":"Ordinamento decrescente","Reset sorting":"Azzeramento ordinamento","Remove column":"Rimuovi colonna","No Data":"Nessun dato","{count} cells copied":{"1":"Copiato {count} cella",default:"{count} celle copiate"},"{count} rows selected":{"1":"{count} linea selezionata",default:"{count} linee selezionate"}};function Un(){return{en:Vn,de:Yn,fr:Xn,it:Gn}}var xi=class{constructor(e){this.language=e,this.translations=Un()}addTranslations(e){this.translations=Object.assign(this.translations,e)}translate(e,t){let i=this.translations[this.language]&&this.translations[this.language][e]||e;return typeof i=="object"&&(i=t&&t.count?this.getPluralizedTranslation(i,t.count):e),Pn(i,t||{})}getPluralizedTranslation(e,t){return e[t]||e.default}};function Kn(r,e){let t=[];if(Object.keys(e).length===0)return r.map(i=>i.meta.rowIndex);for(let i in e){let s=e[i],a=(t.length?t.map(g=>r[g]):r).map(g=>g[i]),h=Qn(s),u=Jn(h);u?t=u(h.text,a):t=a.map(g=>g.rowIndex)}return t}function Jn(r){let e=o=>String(Wn(o.html||"")||o.content||"").toLowerCase(),t=o=>parseFloat(o.content),i=(o,a)=>{if(o.column.compareValue){let u=o.column.compareValue(o,a);if(u&&Array.isArray(u))return u}let h=t(o);return isNaN(h)?[e(o),a]:[h,a]};return{contains(o,a){return a.filter(h=>{let u=e(h),g=(o||"").toLowerCase();return!g||u.includes(g)}).map(h=>h.rowIndex)},greaterThan(o,a){return a.filter(h=>{let[u,g]=i(h,o);return u>g}).map(h=>h.rowIndex)},lessThan(o,a){return a.filter(h=>{let[u,g]=i(h,o);return u<g}).map(h=>h.rowIndex)},equals(o,a){return a.filter(h=>parseFloat(h.content)===o).map(h=>h.rowIndex)},notEquals(o,a){return a.filter(h=>parseFloat(h.content)!==o).map(h=>h.rowIndex)},range(o,a){return a.filter(h=>{let u=i(h,o[0]),g=i(h,o[1]),b=u[0];return b>=u[1]&&b<=g[1]}).map(h=>h.rowIndex)},containsNumber(o,a){return a.filter(h=>{let u=parseFloat(o,10),g=o,b=t(h),_=e(h);return u===b||_.includes(g)}).map(h=>h.rowIndex)}}[r.type]}function Qn(r=""){if(r.length===0)return{};let e=r;return[">","<","="].includes(e[0])?e=r.slice(1):e.startsWith("!=")&&(e=r.slice(2)),r.startsWith(">")&&e?{type:"greaterThan",text:e.trim()}:r.startsWith("<")&&e?{type:"lessThan",text:e.trim()}:r.startsWith("=")&&Ke(e)?{type:"equals",text:Number(r.slice(1).trim())}:Ke(e)?{type:"containsNumber",text:e}:r.startsWith("!=")&&Ke(e)?{type:"notEquals",text:Number(r.slice(2).trim())}:r.split(":").length===2?(e=r.split(":"),{type:"range",text:e.map(t=>t.trim())}):{type:"contains",text:e.toLowerCase()}}function Zn(r){return{columns:[],data:[],dropdownButton:$t.chevronDown,headerDropdown:[{label:r.translate("Sort Ascending"),action:function(e){this.sortColumn(e.colIndex,"asc")}},{label:r.translate("Sort Descending"),action:function(e){this.sortColumn(e.colIndex,"desc")}},{label:r.translate("Reset sorting"),action:function(e){this.sortColumn(e.colIndex,"none")}},{label:r.translate("Remove column"),action:function(e){this.removeColumn(e.colIndex)}}],events:{onRemoveColumn(e){},onSwitchColumn(e,t){},onSortColumn(e){},onCheckRow(e){},onDestroy(){}},hooks:{columnTotal:null},sortIndicator:{asc:"\u2191",desc:"\u2193",none:""},overrideComponents:{},filterRows:Kn,freezeMessage:"",getEditor:null,serialNoColumn:!0,checkboxColumn:!1,clusterize:!0,logs:!1,layout:"fixed",noDataMessage:r.translate("No Data"),cellHeight:40,minimumColumnWidth:30,inlineFilters:!1,treeView:!1,checkedRowStatus:!0,dynamicRowHeight:!1,pasteFromClipboard:!1,showTotalRow:!1,direction:"ltr",disableReorderColumn:!1}}var eo={DataManager:gi,CellManager:bi,ColumnManager:wi,RowManager:yi,BodyRenderer:vi,Style:Ci,Keyboard:$i},ye=class{constructor(e,t){if(ye.instances++,typeof e=="string"&&(e=document.querySelector(e)),this.wrapper=e,!(this.wrapper instanceof HTMLElement))throw new Error("Invalid argument given for `wrapper`");this.initializeTranslations(t),this.setDefaultOptions(),this.buildOptions(t),this.prepare(),this.initializeComponents(),this.options.data&&(this.refresh(),this.columnmanager.applyDefaultSortOrder())}initializeTranslations(e){this.language=e.language||"en",this.translationManager=new xi(this.language),e.translations&&this.translationManager.addTranslations(e.translations)}setDefaultOptions(){this.DEFAULT_OPTIONS=Zn(this)}buildOptions(e){this.options=this.options||{},this.options=Object.assign({},this.DEFAULT_OPTIONS,this.options||{},e),e.headerDropdown=e.headerDropdown||[],this.options.headerDropdown=[...this.DEFAULT_OPTIONS.headerDropdown,...e.headerDropdown],this.events=Object.assign({},this.DEFAULT_OPTIONS.events,this.options.events||{},e.events||{}),this.fireEvent=this.fireEvent.bind(this)}prepare(){this.prepareDom(),this.unfreeze()}initializeComponents(){let e=Object.assign({},eo,this.options.overrideComponents),{Style:t,Keyboard:i,DataManager:s,RowManager:o,ColumnManager:a,CellManager:h,BodyRenderer:u}=e;this.style=new t(this),this.keyboard=new i(this.wrapper),this.datamanager=new s(this.options),this.rowmanager=new o(this),this.columnmanager=new a(this),this.cellmanager=new h(this),this.bodyRenderer=new u(this)}prepareDom(){this.wrapper.innerHTML=`
            <div class="datatable" dir="${this.options.direction}">
                <div class="dt-header"></div>
                <div class="dt-scrollable"></div>
                <div class="dt-footer"></div>
                <div class="dt-freeze">
                    <span class="dt-freeze__message">
                        ${this.options.freezeMessage}
                    </span>
                </div>
                <div class="dt-toast"></div>
                <div class="dt-dropdown-container"></div>
                <textarea class="dt-paste-target"></textarea>
            </div>
        `,this.datatableWrapper=c(".datatable",this.wrapper),this.header=c(".dt-header",this.wrapper),this.footer=c(".dt-footer",this.wrapper),this.bodyScrollable=c(".dt-scrollable",this.wrapper),this.freezeContainer=c(".dt-freeze",this.wrapper),this.toastMessage=c(".dt-toast",this.wrapper),this.pasteTarget=c(".dt-paste-target",this.wrapper),this.dropdownContainer=c(".dt-dropdown-container",this.wrapper)}refresh(e,t){this.datamanager.init(e,t),this.render(),this.setDimensions()}destroy(){this.wrapper.innerHTML="",this.style.destroy(),this.fireEvent("onDestroy")}appendRows(e){this.datamanager.appendRows(e),this.rowmanager.refreshRows()}refreshRow(e,t){this.rowmanager.refreshRow(e,t)}render(){this.renderHeader(),this.renderBody()}renderHeader(){this.columnmanager.renderHeader()}renderBody(){this.bodyRenderer.render()}setDimensions(){this.style.setDimensions()}showToastMessage(e,t){this.bodyRenderer.showToastMessage(e,t)}clearToastMessage(){this.bodyRenderer.clearToastMessage()}getColumn(e){return this.datamanager.getColumn(e)}getColumns(){return this.datamanager.getColumns()}getRows(){return this.datamanager.getRows()}getCell(e,t){return this.datamanager.getCell(e,t)}getColumnHeaderElement(e){return this.columnmanager.getColumnHeaderElement(e)}getViewportHeight(){return this.viewportHeight||(this.viewportHeight=c.style(this.bodyScrollable,"height")),this.viewportHeight}sortColumn(e,t){this.columnmanager.sortColumn(e,t)}removeColumn(e){this.columnmanager.removeColumn(e)}scrollToLastColumn(){this.datatableWrapper.scrollLeft=9999}freeze(){c.style(this.freezeContainer,{display:""})}unfreeze(){c.style(this.freezeContainer,{display:"none"})}updateOptions(e){this.buildOptions(e)}fireEvent(e,...t){let i=[...this._internalEventHandlers[e]||[],this.events[e]].filter(Boolean);for(let s of i)s.apply(this,t)}on(e,t){this._internalEventHandlers=this._internalEventHandlers||{},this._internalEventHandlers[e]=this._internalEventHandlers[e]||[],this._internalEventHandlers[e].push(t)}log(){this.options.logs&&console.log.apply(console,arguments)}translate(e,t){return this.translationManager.translate(e,t)}};ye.instances=0;var to="frappe-datatable",io="0.0.0-development",so="A modern datatable library for the web",ro="dist/frappe-datatable.cjs.js",no="dist/frappe-datatable.min.js",oo="dist/frappe-datatable.min.js",ao={start:"yarn run dev",build:"rollup -c && NODE_ENV=production rollup -c",dev:"rollup -c -w","cy:server":"http-server -p 8989","cy:open":"cypress open","cy:run":"cypress run",test:"start-server-and-test cy:server http://localhost:8989 cy:run","test-local":"start-server-and-test cy:server http://localhost:8989 cy:open","travis-deploy-once":"travis-deploy-once","semantic-release":"semantic-release",lint:"eslint src","lint-and-build":"yarn lint && yarn build",commit:"npx git-cz"},lo=["dist","src"],ho={autoprefixer:"^9.0.0",chai:"3.5.0",cypress:"^9.2.0","cz-conventional-changelog":"^2.1.0",deepmerge:"^2.0.1",eslint:"^5.0.1","eslint-config-airbnb":"^16.1.0","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.11.0","http-server":"^0.11.1",mocha:"3.3.0","postcss-custom-properties":"^7.0.0","postcss-nested":"^3.0.0",rollup:"^0.59.4","rollup-plugin-commonjs":"^8.3.0","rollup-plugin-eslint":"^4.0.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.3","rollup-plugin-postcss":"^1.2.8","rollup-plugin-uglify-es":"^0.0.1","semantic-release":"^17.1.1","start-server-and-test":"^1.4.1","travis-deploy-once":"^5.0.1"},co={type:"git",url:"https://github.com/frappe/datatable.git"},uo=["datatable","data","grid","table"],po="Faris Ansari",fo="MIT",_o={url:"https://github.com/frappe/datatable/issues"},mo="https://frappe.io/datatable",go={hyperlist:"^1.0.0-beta",lodash:"^4.17.5",sortablejs:"^1.7.0"},bo={commitizen:{path:"cz-conventional-changelog"}},wo={name:to,version:io,description:so,main:ro,unpkg:no,jsdelivr:oo,scripts:ao,files:lo,devDependencies:ho,repository:co,keywords:uo,author:po,license:fo,bugs:_o,homepage:mo,dependencies:go,config:bo};ye.__version__=wo.version;Si.exports=ye});$(document).on("app_ready",function(){document.referrer.endsWith("/login")&&frappe.call({method:"erpnext_oob.utils.get_user_default",callback:function(r){r.message&&r.message.forEach(function(e){var t=e.setting_key.toLowerCase().replaceAll(" ","_");frappe.defaults.set_user_default_local(t,e.setting_value)})}})});$(document).bind("toolbar_setup",function(){});frappe.views.Calendar=class extends frappe.views.Calendar{setup_options(e){super.setup_options(e),this.cal_options.locale=="zh"&&(this.cal_options.locale="zh-cn")}};var ko=class extends frappe.views.ListView{get_column_html(e,t){if(e.type==="Status")return`
				<div class="list-row-col hidden-xs ellipsis">
					${this.get_indicator_html(t)}
				</div>
			`;let i=e.df||{},s=i.label,o=i.fieldname,a=t[o]||"",h=()=>i.fieldtype==="Code"?a:i.fieldtype==="Percent"?`<div class="progress level" style="margin: 0px;">
						<div class="progress-bar progress-bar-success" role="progressbar"
							aria-valuenow="${a}"
							aria-valuemin="0" aria-valuemax="100" style="width: ${Math.round(a)}%;">
						</div>
					</div>`:frappe.format(a,i,null,t),u=()=>{let v,y;return this.settings.formatters&&this.settings.formatters[o]?y=this.settings.formatters[o](a,i,t):i.fieldtype=="Text Editor"||i.fetch_from&&["Text","Small Text"].includes(i.fieldtype)?y=strip_html(a):y=typeof a=="string"?frappe.utils.escape_html(a):a,i.fieldtype==="Image"?v=i.options?`<img src="${t[i.options]}" style="max-height: 30px; max-width: 100%;">`:`<div class="missing-image small">
						<span class="octicon octicon-circle-slash"></span>
					</div>`:i.fieldtype==="Select"?v=`<span class="filterable indicator ${frappe.utils.guess_colour(y)} ellipsis"
					data-filter="${o},=,${a}">
					${__(y)}
				</span>`:i.fieldtype==="Link"?v=`<a class="filterable text-muted ellipsis"
					data-filter="${o},=,${a}">
					${__(y)}
				</a>`:["Text Editor","Text","Small Text","HTML Editor"].includes(i.fieldtype)?v=`<span class="text-muted ellipsis">
					${__(y)}
				</span>`:v=`<a class="filterable text-muted ellipsis"
					data-filter="${o},=,${a}">
					${h()}
				</a>`,`<span class="ellipsis"
				title="${__(s)}: ${__(y)}">
				${v}
			</span>`},b=["list-row-col ellipsis",{Subject:"list-subject level",Field:"hidden-xs"}[e.type],frappe.model.is_numeric_field(i)?"text-right":""].join(" "),m={Subject:this.get_subject_html(t),Field:u()}[e.type];return`
			<div class="${b}">
				${m}
			</div>
		`}get_subject_html(e){let t=frappe.session.user,i=this.columns[0].df,s=e[i.fieldname]||e.name,o=strip_html(s.toString()),a=frappe.utils.escape_html(o),h=JSON.parse(e._liked_by||"[]"),u=h.includes(t)?"liked-by":"text-extra-muted not-liked",g=JSON.parse(e._seen||"[]").includes(t)?"":"bold";return`
			<input class="level-item list-row-checkbox hidden-xs" type="checkbox" data-name="${escape(e.name)}">
			<span class="level-item" style="margin-bottom: 1px;">
				<i class="octicon octicon-heart like-action ${u}"
					data-name="${e.name}" data-doctype="${this.doctype}"
					data-liked-by="${encodeURI(e._liked_by)||"[]"}"
				>
				</i>
				<span class="likes-count">
					${h.length>99?__("99")+"+":__(h.length||"")}
				</span>
			</span>
			<span class="level-item ${g} ellipsis" title="${__(a)}">
				<a class="ellipsis" href="${this.get_form_link(e)}" title="${__(a)}" data-doctype="${this.doctype}" data-name="${e.name}">
				${__(o)}
				</a>
			</span>
		`}};frappe.model.with_doctype("Print Format");var de=class{constructor(e){Object.assign(this,e),this.editing=Boolean(this.values&&Object.keys(this.values).length)}make(){this.make_dialog(),this.setup_dialog_events(),this.dialog.show(),window.cur_dialog=this.dialog,this.editing&&this.set_default_values()}make_dialog(){this.dialog=new frappe.ui.Dialog({title:this.get_title(),fields:this.get_fields(),primary_action:e=>{e=this.process_data(e),!this.editing&&!e.name&&(e.name=`${this.type}-${this.label}-${frappe.utils.get_random(20)}`),this.dialog.hide(),this.primary_action(e)},primary_action_label:this.primary_action_label||__("Add")})}get_title(){let e=this.editing?"Edit":"Add",t=e=e+" "+frappe.model.unscrub(this.type);return __(t)}get_fields(){}set_default_values(){return this.dialog.set_values(this.values)}process_data(e){return e}setup_dialog_events(){}hide_field(e){this.dialog.set_df_property(e,"hidden",!0)}show_field(e){this.dialog.set_df_property(e,"hidden",!1)}setup_filter(e){this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group);let t=this.dialog.get_field("filter_area_loading").$wrapper;$(`<span class="text-muted">${__("Loading Filters...")}</span>`).appendTo(t),this.filters=[],this.generate_filter_from_json(),this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:e,on_change:()=>{}}),frappe.model.with_doctype(e,()=>{this.filter_group.add_filters_to_filter_group(this.filters),this.hide_field("filter_area_loading"),this.show_field("filter_area")})}},Gt=class extends de{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"chart_name",label:"Chart Name",options:"Dashboard Chart",reqd:1},{fieldtype:"Data",fieldname:"label",label:"Label"}]}process_data(e){return e.label=e.label?e.label:e.chart_name,e}},Ut=class extends de{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"document_type",label:"DocType",options:"DocType",reqd:1,onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.document_type&&this.setup_filter(this.document_type)},get_query:()=>({filters:{issingle:0,istable:0}})},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Section Break",fieldname:"filter_section",label:__("Add Filters"),depends_on:"eval: doc.document_type"},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area"}]}generate_filter_from_json(){this.values&&this.values.quick_list_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.quick_list_filter,this.values.document_type))}process_data(e){if(this.filter_group){let t=this.filter_group.get_filters();e.quick_list_filter=frappe.utils.get_filter_as_json(t)}return e.label=e.label?e.label:e.document_type,e}},Kt=class extends de{constructor(e){super(e)}get_fields(){return[{fieldtype:"Link",fieldname:"onboarding_name",label:"Onboarding Name",options:"Module Onboarding",reqd:1}]}},Jt=class extends de{constructor(e){super(e)}get_fields(){let e=this;return[{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldname:"links",fieldtype:"Table",label:__("Card Links"),editable_grid:1,data:e.values?JSON.parse(e.values.links):[],get_data:()=>e.values?JSON.parse(e.values.links):[],fields:[{fieldname:"label",fieldtype:"Data",in_list_view:1,label:"Label"},{fieldname:"icon",fieldtype:"Icon",label:"Icon"},{fieldname:"link_type",fieldtype:"Select",in_list_view:1,label:"Link Type",reqd:1,options:["DocType","Page","Report"]},{fieldname:"link_to",fieldtype:"Dynamic Link",in_list_view:1,label:"Link To",reqd:1,get_options:t=>t.doc.link_type},{fieldname:"column_break_7",fieldtype:"Column Break"},{fieldname:"dependencies",fieldtype:"Data",label:"Dependencies"},{fieldname:"only_for",fieldtype:"Link",label:"Only for",options:"Country"},{default:"0",fieldname:"onboard",fieldtype:"Check",label:"Onboard"},{default:"0",fieldname:"is_query_report",fieldtype:"Check",label:"Is Query Report"}]}]}process_data(e){let t="";return e.links?e.links.map((i,s)=>{let o=s+1;i.link_type||(t=__("Following fields have missing values")+": <br><br><ul>",t+=`<li>${__("Link Type in Row")} ${o}</li>`),i.link_to||(t+=`<li>${__("Link To in Row")} ${o}</li>`),i.label=i.label?i.label:i.link_to}):t=__("You must add atleast one link."),t&&(t+="</ul>",frappe.throw({message:__(t),title:__("Missing Values Required"),indicator:"orange"})),e.label=e.label?e.label:e.chart_name,e}},Qt=class extends de{constructor(e){super(e)}hide_filters(){this.hide_field("count_section_break"),this.hide_field("filters_section_break")}show_filters(){this.show_field("count_section_break"),this.show_field("filters_section_break")}get_fields(){return[{fieldtype:"Select",fieldname:"type",label:"Type",reqd:1,options:`DocType
Report
Page
Dashboard`,onchange:()=>{this.dialog.get_value("type")=="DocType"?this.dialog.fields_dict.link_to.get_query=()=>({query:"frappe.core.report.permitted_documents_for_user.permitted_documents_for_user.query_doctypes",filters:{user:frappe.session.user}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Dynamic Link",fieldname:"link_to",label:"Link To",reqd:1,options:"type",onchange:()=>{if(this.dialog.get_value("type")=="DocType"){let e=this.dialog.get_value("link_to");frappe.model.with_doctype(e,()=>{let t=frappe.get_meta(e);e&&frappe.boot.single_types.includes(e)?this.hide_filters():e&&(this.setup_filter(e),this.show_filters());let i=["List","Report Builder","Dashboard","New"];t.is_tree==="Tree"&&i.push("Tree"),frappe.boot.calendars.includes(e)&&i.push("Calendar"),this.dialog.set_df_property("doc_view","options",i.join(`
`))})}else this.hide_filters()}},{fieldtype:"Select",fieldname:"doc_view",label:"DocType View",options:`List
Report Builder
Dashboard
Tree
New
Calendar
Kanban`,description:__("Which view of the associated DocType should this shortcut take you to?"),default:"List",depends_on:e=>{if(this.dialog){let t=this.dialog.get_value("link_to"),i=frappe.boot.single_types.includes(t);return e.type=="DocType"&&!i}return!1}},{fieldtype:"Section Break",fieldname:"filters_section_break",label:__("Count Filter"),hidden:1},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"count_section_break",label:__("Count Customizations"),hidden:1},{fieldtype:"Select",fieldname:"color",label:__("Color"),options:["Grey","Green","Red","Orange","Pink","Yellow","Blue","Cyan"],default:"Grey",input_class:"color-select",onchange:()=>{let e=this.dialog.fields_dict.color.value.toLowerCase(),t=this.dialog.fields_dict.color.$input;t.parent().find(".color-box").get(0)||$('<div class="color-box"></div>').insertBefore(t.get(0)),t.parent().find(".color-box").get(0).style.backgroundColor=`var(--text-on-${e})`}},{fieldtype:"Column Break",fieldname:"column_break_3"},{fieldtype:"Data",fieldname:"format",label:__("Format"),description:__("For Example: {} Open")}]}set_default_values(){super.set_default_values().then(()=>{this.dialog.fields_dict.link_to.df.onchange()})}generate_filter_from_json(){this.values&&this.values.stats_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.stats_filter,this.values.link_to))}process_data(e){if(this.dialog.get_value("type")=="DocType"&&this.filter_group){let t=this.filter_group.get_filters();e.stats_filter=frappe.utils.get_filter_as_json(t)}return e.label=e.label?e.label:frappe.model.unscrub(e.link_to),e}},Zt=class extends de{constructor(e){super(e)}get_fields(){let e;return e=[{fieldtype:"Select",label:__("Choose Existing Card or create New Card"),fieldname:"new_or_existing",options:["New Card","Existing Card"]},{fieldtype:"Link",fieldname:"card",label:__("Number Cards"),options:"Number Card",get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}}),depends_on:'eval: doc.new_or_existing == "Existing Card"'},{fieldtype:"Section Break",fieldname:"sb_1",depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Label"),fieldname:"label",fieldtype:"Data",mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Doctype"),fieldname:"document_type",fieldtype:"Link",options:"DocType",onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.set_aggregate_function_fields(this.dialog.get_values()),this.setup_filter(this.document_type)},hidden:1},{label:__("Color"),fieldname:"color",fieldtype:"Color"},{fieldtype:"Column Break",fieldname:"cb_1"},{label:__("Function"),fieldname:"function",fieldtype:"Select",options:["Count","Sum","Average","Minimum","Maximum"],mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Function Based On"),fieldname:"aggregate_function_based_on",fieldtype:"Select",depends_on:"eval: doc.function !== 'Count'",mandatory_depends_on:'eval: doc.function !== "Count" && doc.new_or_existing == "New Card"'},{fieldtype:"Section Break",fieldname:"sb_1",label:__("Add Filters"),depends_on:'eval: doc.new_or_existing == "New Card"'},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"sb_1"}],e}setup_dialog_events(){this.document_type||(this.default_values&&this.default_values.doctype?(this.document_type=this.default_values.doctype,this.setup_filter(this.default_values.doctype),this.set_aggregate_function_fields()):this.show_field("document_type"))}set_aggregate_function_fields(){let e=[];this.document_type&&frappe.get_meta(this.document_type)&&frappe.get_meta(this.document_type).fields.map(t=>{if(frappe.model.numeric_fieldtypes.includes(t.fieldtype)){if(t.fieldtype=="Currency"&&(!t.options||t.options!=="Company:company:default_currency"))return;e.push({label:t.label,value:t.fieldname})}}),this.dialog.set_df_property("aggregate_function_based_on","options",e)}process_data(e){return e.new_or_existing=="Existing Card"&&(e.name=e.card),e.stats_filter=this.filter_group&&JSON.stringify(this.filter_group.get_filters()),e.document_type=this.document_type,e}};function bt(r){return{chart:Gt,shortcut:Qt,number_card:Zt,links:Jt,onboarding:Kt,quick_list:Ut}[r]||de}var he=class{constructor(e){Object.assign(this,e),this.make()}refresh(){this.set_title(),this.set_actions(),this.set_body(),this.setup_events(),this.set_footer()}get_config(){return{name:this.name,label:this.label}}customize(e){if(this.in_customize_mode=!0,this.action_area.empty(),e.allow_sorting&&frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,this.action_area),e.allow_hiding){this.hidden&&(this.widget.removeClass("hidden"),this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5));let t=this.hidden?"fa fa-eye":"fa fa-eye-slash",i=this.hidden?__("Show"):__("Hide");frappe.utils.add_custom_button(`<i class="${t}" aria-hidden="true"></i>`,()=>this.hide_or_show(),"show-or-hide-button",i,null,this.action_area),this.show_or_hide_button=this.action_area.find(".show-or-hide-button")}e.allow_edit&&frappe.utils.add_custom_button(frappe.utils.icon("edit","xs"),()=>this.edit(),"edit-button",__("Edit"),null,this.action_area)}make(){this.make_widget(),this.widget.appendTo(this.container)}make_widget(){this.widget=$(`<div class="widget" data-widget-name="${this.name?this.name:""}">
			<div class="widget-head">
				<div class="widget-label">
					<div class="widget-title"></div>
					<div class="widget-subtitle"></div>
				</div>
				<div class="widget-control"></div>
			</div>
			<div class="widget-body"></div>
			<div class="widget-footer"></div>
		</div>`),this.title_field=this.widget.find(".widget-title"),this.subtitle_field=this.widget.find(".widget-subtitle"),this.body=this.widget.find(".widget-body"),this.action_area=this.widget.find(".widget-control"),this.head=this.widget.find(".widget-head"),this.footer=this.widget.find(".widget-footer"),this.refresh()}set_title(e){let t=this.title||this.label||this.name,i=e?frappe.ellipsis(t,e):t;if(this.icon){let s=frappe.utils.icon(this.icon,"lg");this.title_field[0].innerHTML=`${s} <span class="ellipsis" title="${i}">${i}</span>`}else this.title_field[0].innerHTML=`<span class="ellipsis" title="${i}">${i}</span>`,e&&this.title_field[0].setAttribute("title",this.title||this.label);this.subtitle&&this.subtitle_field.html(this.subtitle)}delete(e=!0,t=!1){let i=s=>{this.widget.remove(),!t&&this.options.on_delete&&this.options.on_delete(this.name,s)};e?(this.widget.addClass("zoom-out"),setTimeout(()=>{i(!0)},300)):i(!1)}edit(){let e=bt(this.widget_type);this.edit_dialog=new e({label:this.label,type:this.widget_type,values:this.get_config(),primary_action:t=>{Object.assign(this,t),t.name=this.name,this.new=!0,this.refresh(),this.options.on_edit&&this.options.on_edit(t)},primary_action_label:__("Save")}),this.edit_dialog.make()}toggle_width(){this.width=="Full"?(this.widget.removeClass("full-width"),this.width=null,this.refresh()):(this.widget.addClass("full-width"),this.width="Full",this.refresh());let e=this.width=="Full"?__("Collapse"):__("Expand");this.resize_button.attr("title",e)}hide_or_show(){this.hidden?(this.body.css("opacity",1),this.title_field.css("opacity",1),this.footer.css("opacity",1),this.hidden=!1):(this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5),this.hidden=!0),this.show_or_hide_button.empty();let e=this.hidden?"fa fa-eye":"fa fa-eye-slash",t=this.hidden?__("Show"):__("Hide");$(`<i class="${e}" aria-hidden="true" title="${t}"></i>`).appendTo(this.show_or_hide_button)}setup_events(){}set_actions(){}set_body(){}set_footer(){}};frappe.provide("frappe.utils");var qe=class extends he{async refresh(){frappe.utils.load_video_player(),this.new&&await this.get_onboarding_data(),this.set_title(),this.set_actions(),this.set_body(),this.setup_events()}get_config(){return{label:this.onboarding_name}}make_body(){this.body.empty(),this.steps_wrapper=$('<div class="onboarding-steps-wrapper"></div>').appendTo(this.body),this.step_preview=$(`<div class="onboarding-step-preview">
			<div class="onboarding-step-body"></div>
			<div class="onboarding-step-footer"></div>
		</div>`).appendTo(this.body),this.step_body=this.step_preview.find(".onboarding-step-body"),this.step_footer=this.step_preview.find(".onboarding-step-footer"),this.steps.forEach((e,t)=>{this.add_step(e,t)}),this.show_step(this.steps[0])}add_step(e,t){let i="pending";e.is_skipped&&(i="skipped"),e.is_complete&&(i="complete");let s=$(`<a class="onboarding-step ${i}">
				<div class="step-title">
					<div class="step-index step-pending">${__(t+1)}</div>
					<div class="step-index step-skipped">${frappe.utils.icon("tick","xs")}</div>
					<div class="step-index step-complete">${frappe.utils.icon("tick","xs")}</div>
					<div>${__(e.title)}</div>
				</div>
			</a>`);if(e.$step=s,!e.is_complete&&!e.is_skipped){let o=$(`<div class="step-skip">${__("Skip")}</div>`);o.appendTo(s),o.on("click",()=>{this.skip_step(e),event.stopPropagation()})}return s.on("click",()=>this.show_step(e)),s.appendTo(this.steps_wrapper),s}show_step(e){this.active_step&&this.active_step.$step.removeClass("active"),e.$step.addClass("active"),this.active_step=e;let t={"Watch Video":a=>this.show_video(a),"Create Entry":a=>{a.is_complete?frappe.set_route(`/app/List/${a.reference_document}`):a.show_full_form?this.create_entry(a):this.show_quick_entry(a)},"Show Form Tour":a=>this.show_form_tour(a),"Update Settings":a=>this.update_settings(a),"View Report":a=>this.open_report(a),"Go to Page":a=>this.go_to_page(a)},i=()=>{this.step_body.empty(),this.step_footer.empty(),s(),e.intro_video_url?$(`<button class="btn btn-primary btn-sm">${__("Watch Tutorial")}</button>`).appendTo(this.step_footer).on("click",o):$(`<button class="btn btn-primary btn-sm">${__(e.action_label||e.action)}</button>`).appendTo(this.step_footer).on("click",()=>t[e.action](e))},s=()=>{let a=e.description?frappe.markdown(e.description):`<h1>${__(e.title)}</h1>`;e.action==="Create Entry"&&(a+=`<p>
					<a href='/app/${frappe.router.slug(e.reference_document)}'>
						${__("Show {0} List",[__(e.reference_document)])}</a>
				</p>`),this.step_body.html(a)},o=()=>{this.step_body.empty(),this.step_footer.empty();let a=$(`<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="${e.intro_video_url}"></div>`);a.appendTo(this.step_body);let h=new frappe.Plyr(a[0],{hideControls:!0,resetOnEnd:!0});$(`<button class="btn btn-primary btn-sm">${__(e.action_label||e.action)}</button>`).appendTo(this.step_footer).on("click",()=>{h.pause(),t[e.action](e)}),$(window).one("hashchange",()=>{h.pause()}),$(`<button class="btn btn-secondary ml-2 btn-sm">${__("Back")}</button>`).appendTo(this.step_footer).on("click",i)};i()}go_to_page(e){this.mark_complete(e),frappe.set_route(e.path).then(()=>{let t=e.callback_message||__("You can continue with the onboarding after exploring this page"),i=e.callback_title||__("Awesome Work"),s=frappe.msgprint({message:t,title:i,primary_action:{action:()=>{s.hide()},label:()=>__("Continue")},wide:!0})})}open_report(e){let t=frappe.utils.generate_route({name:e.reference_report,type:"report",is_query_report:e.report_type!=="Report Builder",doctype:e.report_reference_doctype}),i=frappe.get_route();frappe.set_route(t).then(()=>{let s=frappe.msgprint({message:__(e.report_description),title:__(e.reference_report),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(e)}),s.hide()},label:()=>__("Continue")},secondary_action:{action:()=>{s.hide(),frappe.set_route(i).then(()=>{this.mark_complete(e)})},label:__("Go Back")}});frappe.msg_dialog.custom_onhide=()=>this.mark_complete(e)})}show_form_tour(e){let t;e.is_single?t=frappe.router.slug(e.reference_document):t=`${frappe.router.slug(e.reference_document)}/new`;let i=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=s=>{let o=()=>{let h=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Onboarding complete"),primary_action:{action:()=>{frappe.set_route(i).then(()=>{this.mark_complete(e)}),h.hide()},label:()=>__("Continue")}})},a=e.form_tour;s.tour.init({tour_name:a,on_finish:o}).then(()=>s.tour.start())},frappe.set_route(t)}update_settings(e){let t=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=i=>{i.scroll_to_field(e.field),i.doc.__unsaved=!0},frappe.route_hooks.after_save=i=>{let s=!1,o={},a=i.doc[e.field],h=null;a&&e.value_to_validate=="%"&&(s=!0),a==e.value_to_validate&&(s=!0),cstr(a)==cstr(e.value_to_validate)&&(s=!0),s?(o.message=__("Let's take you back to onboarding"),o.title=__("Action Complete"),o.primary_action={action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")},h=()=>o.primary_action.action()):(o.message=__("Looks like you didn't change the value"),o.title=__("Try Again"),o.secondary_action={action:()=>frappe.set_route(t),label:__("Go Back")},o.primary_action={action:()=>{frappe.set_route(t).then(()=>{setTimeout(()=>{this.skip_step(e)},300)})},label:__("Skip Step")},h=()=>o.secondary_action.action()),frappe.msgprint(o),frappe.msg_dialog.custom_onhide=()=>h()},frappe.set_route("Form",e.reference_document)}async create_entry(e){let t=frappe.get_route(),i=await this.get_first_document(e.reference_document);frappe.route_hooks={},frappe.route_hooks.after_load=o=>{let a=()=>{frappe.msgprint({message:__("Awesome, now try making an entry yourself"),title:__("Document Saved"),primary_action:{action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(e)}},h=e.form_tour;o.tour.init({tour_name:h,on_finish:a}).then(()=>o.tour.start())};let s=()=>{frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Action Complete"),primary_action:{action:()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(e)}};e.is_submittable?(frappe.route_hooks.after_save=()=>{frappe.msgprint({message:__("Submit this document to complete this step."),title:__("Document Saved")})},frappe.route_hooks.after_submit=s):frappe.route_hooks.after_save=s,frappe.set_route("Form",e.reference_document,i)}show_quick_entry(e){let t=frappe.get_route_str();frappe.ui.form.make_quick_entry(e.reference_document,()=>{if(frappe.get_route_str()!=t){let i=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Document Saved"),primary_action:{action:()=>{i.hide(),frappe.set_route(t).then(()=>{this.mark_complete(e)})},label:__("Continue")}});frappe.msg_dialog.custom_onhide=()=>{frappe.set_route(t).then(()=>{this.mark_complete(e)})}}else frappe.msgprint({message:__("Let us continue with the onboarding"),title:__("Document Saved")}),this.mark_complete(e)},null,null,!0)}show_video(e){frappe.help.show_video(e.video_url,e.title),this.mark_complete(e)}mark_complete(e){let t=e.$step,i=()=>{e.is_complete=!0,t.removeClass("skipped"),t.addClass("complete")};this.update_step_status(e,"is_complete",1,i)}skip_step(e){let t=e.$step,i=()=>{e.is_skipped=!0,t.removeClass("complete"),t.removeClass("pending"),t.addClass("skipped")};this.update_step_status(e,"is_skipped",1,i)}update_step_status(e,t,i,s){let o={is_complete:"complete",is_skipped:"skipped"};frappe.route_hooks={},frappe.call("frappe.desk.desktop.update_onboarding_step",{name:e.name,field:t,value:i}).then(()=>{s(),e.$step.removeClass("pending").removeClass("complete").removeClass("skipped").addClass(o[t]),this.steps.filter(h=>!(h.is_complete||h.is_skipped)).length==0&&this.show_success()})}show_success(){let e=this.success||__("You seem good to go!"),t=this.success_state_image||"/assets/frappe/images/ui-states/success-color.png",i="";this.docs_url&&(i=__('Congratulations on completing the module setup. If you want to learn more you can refer to the documentation <a target="_blank" href="{0}">here</a>.',[this.docs_url]));let s=$(`<div class="text-center onboarding-success">
					<img src="${t}" alt="Success State" class="zoom-in success-state">
					<h3>${e}</h3>
					<div class="text-muted">${i}</div>
					<button class="btn btn-primary btn-sm">${__("Continue")}</button>
			</div>
		`);s.find(".btn").on("click",()=>this.delete()),this.step_preview.empty(),s.appendTo(this.step_preview)}set_body(){this.widget.addClass("onboarding-widget-box"),this.is_dismissed()?this.widget.hide():this.make_body()}is_dismissed(){if(this.in_customize_mode)return!1;let e=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");if(Object.keys(e).includes(this.title)){let t=new Date(e[this.title]),i=new Date;return frappe.datetime.get_hour_diff(i,t)<24}return!1}set_actions(){if(this.in_customize_mode)return;this.action_area.empty();let e=$(`<div class="small" style="cursor:pointer;">${__("Dismiss",null,"Stop showing the onboarding widget.")}</div>`);e.on("click",()=>{let t=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");t[this.title]=frappe.datetime.now_datetime(),localStorage.setItem("dismissed-onboarding",JSON.stringify(t)),this.delete(!0,!0),this.widget.closest(".ce-block").hide()}),e.appendTo(this.action_area)}get_onboarding_data(){return frappe.model.with_doc("Module Onboarding",this.onboarding_name).then(e=>{if(e){this.onboarding_doc=e,this.label=e.label,this.title=e.title||__("Let's Get Started"),this.subtitle=e.subtitle,this.success=e.success,this.docs_url=e.docs_url,this.user_can_dismiss=e.user_can_dismiss;let t="frappe.desk.doctype.onboarding_step.onboarding_step.get_onboarding_steps";return frappe.xcall(t,{ob_steps:e.steps}).then(i=>{this.steps=i})}})}async get_first_document(e){let{message:t}=await frappe.db.get_value("Form Tour",{reference_doctype:e},["first_document"]),i;return t.first_document&&await frappe.db.get_list(e,{order_by:"creation"}).then(s=>{Array.isArray(s)&&s.length&&(i=s[0].name)}),i||"new"}};var ei=class extends qe{show_step(e){e.description=__(e.description),e.title=__(e.title),super.show_step(e)}};frappe.widget.widget_factory.onboarding=ei;frappe.provide("frappe.utils");var Ve=class extends he{constructor(e){e.shadow=!0;super(e)}get_config(){return{name:this.name,label:this.label,color:this.color,hidden:this.hidden}}refresh(){this.set_body()}set_body(){this.widget.addClass("number-widget-box"),this.make_card()}set_title(){$(this.title_field).html(`<div class="number-label">${this.card_doc.label}</div>`)}make_card(){frappe.model.with_doc("Number Card",this.name).then(e=>{if(e)this.card_doc=e,this.render_card();else if(this.document_type)frappe.run_serially([()=>this.create_number_card(),()=>this.render_card()]);else{this.delete(!1);return}this.set_events()})}create_number_card(){return this.set_doc_args(),frappe.xcall("frappe.desk.doctype.number_card.number_card.create_number_card",{args:this.card_doc}).then(e=>{this.name=e.name,this.card_doc=e,this.widget.attr("data-widget-name",this.name)})}set_events(){$(this.body).click(()=>{this.in_customize_mode||this.card_doc.type=="Custom"||this.set_route()})}set_route(){let e=this.card_doc.type!=="Report",t=e?this.card_doc.document_type:this.card_doc.report_name,i=frappe.utils.generate_route({name:t,type:e?"doctype":"report",is_query_report:!e});if(e){let s=JSON.parse(this.card_doc.filters_json);frappe.route_options=s.reduce((o,a)=>Object.assign(o,{[`${a[0]}.${a[1]}`]:[a[2],a[3]]}),{})}frappe.set_route(i)}set_doc_args(){this.card_doc=Object.assign({},{document_type:this.document_type,label:this.label,function:this.function,aggregate_function_based_on:this.aggregate_function_based_on,color:this.color,filters_json:this.stats_filter})}get_settings(e){return this.filters=this.get_filters(),{Custom:{method:this.card_doc.method,args:{filters:this.filters},get_number:i=>this.get_number_for_custom_card(i)},Report:{method:"frappe.desk.query_report.run",args:{report_name:this.card_doc.report_name,filters:this.filters,ignore_prepared_report:1},get_number:i=>this.get_number_for_report_card(i)},"Document Type":{method:"frappe.desk.doctype.number_card.number_card.get_result",args:{doc:this.card_doc,filters:this.filters},get_number:i=>this.get_number_for_doctype_card(i)}}[e]}get_filters(){return frappe.dashboard_utils.get_all_filters(this.card_doc)}render_card(){this.prepare_actions(),this.set_title(),this.set_loading_state(),this.card_doc.type||(this.card_doc.type="Document Type"),this.settings=this.get_settings(this.card_doc.type),frappe.run_serially([()=>this.render_number(),()=>this.render_stats()])}set_loading_state(){$(this.body).html(`<div class="number-card-loading text-muted">
			${__("Loading...")}
		</div>`)}get_number(){return frappe.xcall(this.settings.method,this.settings.args).then(e=>this.settings.get_number(e))}get_number_for_custom_card(e){typeof e=="object"?(this.number=e.value,this.set_formatted_number(e)):this.formatted_number=e}get_number_for_doctype_card(e){if(this.number=e,this.card_doc.function!=="Count")return frappe.model.with_doctype(this.card_doc.document_type,()=>{let t=frappe.meta.get_docfield(this.card_doc.document_type,this.card_doc.aggregate_function_based_on);this.set_formatted_number(t)});this.formatted_number=e}get_number_for_report_card(e){let t=this.card_doc.report_field,i=e.result.reduce((o,a)=>(a[t]&&o.push(a[t]),o),[]),s=e.columns.find(o=>o.fieldname==t);this.number=frappe.report_utils.get_result_of_fn(this.card_doc.report_function,i),this.set_formatted_number(s)}set_formatted_number(e){let t=frappe.sys_defaults.country,s=frappe.utils.shorten_number(this.number,t,5).split(" "),o=s[1]||"",a=$(frappe.format(s[0],e)).text();this.formatted_number=a+" "+__(o)}render_number(){return this.get_number().then(()=>{$(this.body).html(`<div class="widget-content">
				<div class="number" style="color:${this.card_doc.color}">${this.formatted_number}</div>
				</div>`)})}render_stats(){if(this.card_doc.type!=="Document Type")return;let e="",t="";return this.get_percentage_stats().then(()=>{this.percentage_stat==0||this.percentage_stat==null?t="grey-stat":this.percentage_stat>0?(e=`<span class="indicator-pill-round green">
						${frappe.utils.icon("arrow-up-right","xs")}
					</span>`,t="green-stat"):(e=`<span class="indicator-pill-round red">
						${frappe.utils.icon("arrow-down-left","xs")}
					</span>`,t="red-stat");let s={Daily:__("since yesterday"),Weekly:__("since last week"),Monthly:__("since last month"),Yearly:__("since last year")}[this.card_doc.stats_time_interval],o=(()=>{if(this.percentage_stat==null)return NaN;let a=this.percentage_stat.split(" "),h=a[1]||"";return Math.abs(a[0])+" "+h})();isNaN(o)||$(this.body).find(".widget-content").append(`<div class="card-stats ${t}">
				<span class="percentage-stat-area">
					${e}
					<span class="percentage-stat">
						${o} %
					</span>
				</span>
				<span class="stat-period text-muted">
					${s}
				</span>
			</div>`)})}get_percentage_stats(){return frappe.xcall("frappe.desk.doctype.number_card.number_card.get_percentage_difference",{doc:this.card_doc,filters:this.filters,result:this.number}).then(e=>{e!==void 0&&(this.percentage_stat=frappe.utils.shorten_number(e))})}prepare_actions(){let e=[{label:__("Refresh"),action:"action-refresh",handler:()=>{this.render_card()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Number Card",this.name)}}];this.set_card_actions(e)}set_card_actions(e){this.card_actions=$(`<div class="card-actions dropdown pull-right">
				<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				...
				</a>
				<ul class="dropdown-menu" style="max-height: 300px; overflow-y: auto;">
					${e.map(t=>`<li class="dropdown-item">
									<a data-action="${t.action}">${t.label}</a>
								</li>`).join("")}
				</ul>
			</div>`),this.card_actions.find("a[data-action]").each((t,i)=>{let s=i.dataset.action;$(i).click(e.find(o=>o.action===s))}),this.action_area.html(this.card_actions)}};var ti=class extends Ve{set_title(){$(this.title_field).html(`<div class="number-label">${__(this.card_doc.label)}</div>`)}};frappe.widget.widget_factory.number_card=ti;frappe.provide("frappe.widget.utils");frappe.provide("frappe.dashboards");frappe.provide("frappe.dashboards.chart_sources");var Ye=class extends he{constructor(e){e.shadow=!0;super(e);this.height=this.height||240}get_config(){return{name:this.name,chart_name:this.chart_name,label:this.label,hidden:this.hidden,width:this.width}}refresh(){delete this.dashboard_chart,this.set_body(),this.make_chart()}set_chart_title(){let e=this.widget.width()<600?40:60;this.set_title(e)}set_body(){this.widget.addClass("dashboard-widget-box"),this.width=="Full"&&this.widget.addClass("full-width")}setup_container(){this.body.empty(),this.chart_doc.type=="Heatmap"&&this.setup_heatmap_container(),this.loading=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("Loading...")}</div>`),this.loading.appendTo(this.body),this.empty=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("No Data")}</div>`),this.empty.hide().appendTo(this.body),this.chart_wrapper=$("<div></div>"),this.chart_wrapper.appendTo(this.body),this.$heatmap_legend=null,this.set_chart_title()}setup_heatmap_container(){this.widget.addClass("heatmap-chart"),this.widget.removeClass("full-width").addClass("full-width"),this.width="Full"}set_summary(){this.$summary?this.$summary.empty():(this.$summary=$('<div class="report-summary"></div>').hide(),this.head.after(this.$summary)),this.summary.forEach(e=>{frappe.utils.build_summary_item(e).appendTo(this.$summary)}),this.summary.length&&this.$summary.show()}make_chart(){this.get_settings().then(()=>{if(!this.settings){this.deleted=!0,this.widget.remove();return}this.chart_settings||(this.chart_settings={}),this.setup_container(),this.in_customize_mode||(this.action_area.empty(),this.prepare_chart_actions(),this.chart_doc.timeseries&&this.chart_doc.chart_type!=="Custom"&&this.render_time_series_filters()),frappe.run_serially([()=>this.prepare_chart_object(),()=>this.setup_filter_button(),()=>this.fetch_and_update_chart()])})}render_time_series_filters(){let e=this.get_time_series_filters();frappe.dashboard_utils.render_chart_filters(e,"chart-actions",this.action_area,0)}get_time_series_filters(){let e;return this.chart_doc.type=="Heatmap"?e=[{label:this.chart_settings.heatmap_year||this.chart_doc.heatmap_year,options:frappe.dashboard_utils.get_years_since_creation(frappe.boot.user.creation),action:t=>{this.selected_heatmap_year=t,this.save_chart_config_for_user({heatmap_year:this.selected_heatmap_year}),this.fetch_and_update_chart()}}]:e=[{label:this.chart_settings.time_interval||this.chart_doc.time_interval,options:["Yearly","Quarterly","Monthly","Weekly","Daily"],icon:"calendar",class:"time-interval-filter",action:t=>{this.selected_time_interval=t,this.save_chart_config_for_user({time_interval:this.selected_time_interval}),this.fetch_and_update_chart()}},{label:this.chart_settings.timespan||this.chart_doc.timespan,options:["Select Date Range","Last Year","Last Quarter","Last Month","Last Week"],class:"timespan-filter",action:t=>{this.selected_timespan=t,this.selected_timespan==="Select Date Range"?this.render_date_range_field():(this.selected_from_date=null,this.selected_to_date=null,this.date_field_wrapper&&(this.date_field_wrapper.hide(),this.title_field.show(),this.subtitle_field.show(),this.head.css("flex-direction","row")),this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:null,to_date:null}),this.fetch_and_update_chart())}}],e}fetch_and_update_chart(){this.args={timespan:this.selected_timespan||this.chart_settings.timespan,time_interval:this.selected_time_interval||this.chart_settings.time_interval,from_date:this.selected_from_date||this.chart_settings.from_date,to_date:this.selected_to_date||this.chart_settings.to_date,heatmap_year:this.selected_heatmap_year||this.chart_settings.heatmap_year},this.fetch(this.filters,!0,this.args).then(e=>{this.chart_doc.chart_type=="Report"&&(this.report_result=e,this.summary=e.report_summary,e=this.get_report_chart_data(e)),this.update_chart_object(),this.data=e,this.render()})}render_date_range_field(){(!this.date_field_wrapper||!this.date_field_wrapper.is(":visible"))&&(this.date_field_wrapper=$('<div class="dashboard-date-field pull-right"></div>').insertAfter(this.action_area.find(".timespan-filter")),this.width!=="Full"&&this.widget.width()<700&&(this.title_field.hide(),this.subtitle_field.hide(),this.head.css("flex-direction","row-reverse")),this.date_range_field=frappe.ui.form.make_control({df:{fieldtype:"DateRange",fieldname:"from_date",placeholder:"Date Range",input_class:"input-xs",default:[this.chart_settings.from_date,this.chart_settings.to_date],value:[this.chart_settings.from_date,this.chart_settings.to_date],reqd:1,change:()=>{let e=this.date_range_field.get_value();this.selected_from_date=e[0],this.selected_to_date=e[1],e&&e.length==2&&(this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:this.selected_from_date,to_date:this.selected_to_date}),this.fetch_and_update_chart())}},parent:this.date_field_wrapper,render_input:1}),this.date_range_field.$input.focus())}get_report_chart_data(e){if(e.chart&&this.chart_doc.use_report_chart)return e.chart.data;{let t=[];this.chart_doc.y_axis.map(a=>{t.push(a.y_field)});let i={y_fields:t,x_field:this.chart_doc.x_field,chart_type:this.chart_doc.type,color:this.chart_doc.color},s=e.columns.map(a=>frappe.report_utils.prepare_field_from_column(a));return frappe.report_utils.make_chart_options(s,e,i).data}}prepare_chart_actions(){let e=[{label:__("Refresh"),action:"action-refresh",handler:()=>{delete this.dashboard_chart,this.make_chart()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Dashboard Chart",this.chart_doc.name)}},{label:__("Reset Chart"),action:"action-reset",handler:()=>{this.reset_chart(),delete this.dashboard_chart,this.make_chart()}}];this.chart_doc.document_type?e.push({label:__("{0} List",[this.chart_doc.document_type]),action:"action-list",handler:()=>{frappe.set_route("List",this.chart_doc.document_type)}}):this.chart_doc.chart_type==="Report"&&e.push({label:__("{0} Report",[this.chart_doc.report_name]),action:"action-list",handler:()=>{frappe.set_route("query-report",this.chart_doc.report_name,this.filters)}}),this.set_chart_actions(e)}setup_filter_button(){this.in_customize_mode||(this.is_document_type=this.chart_doc.chart_type!=="Report"&&this.chart_doc.chart_type!=="Custom",this.filter_button=$(`<div class="filter-chart btn btn-xs pull-right">
				${frappe.utils.icon("filter","sm")}
			</div>`),this.filter_button.appendTo(this.action_area),this.is_document_type?(this.filter_group&&(this.filters=this.filter_group.get_filters()),this.create_filter_group_and_add_filters()):this.filter_button.on("click",()=>{let e;frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(t=>{this.is_document_type?e=[{fieldtype:"HTML",fieldname:"filter_area"}]:t?e=t.filter(i=>i.fieldname).map(i=>(Object.assign(i,i.dashboard_config||{}),i)):e=[{fieldtype:"HTML",options:__("No Filters Set")}],this.setup_filter_dialog(e)})}))}setup_filter_dialog(e){let t=this,i=new frappe.ui.Dialog({title:__("Set Filters for {0}",[this.chart_doc.chart_name]),fields:e,primary_action:function(){let s=this.get_values();s&&(this.hide(),t.filters=s,t.save_chart_config_for_user({filters:t.filters}),t.fetch_and_update_chart())},primary_action_label:"Set"});i.show(),this.chart_doc.chart_type=="Report"&&(frappe.query_report=new frappe.views.QueryReport({filters:i.fields_list}),frappe.query_reports[this.chart_doc.report_name].onload&&frappe.query_reports[this.chart_doc.report_name].onload(frappe.query_report)),i.set_values(this.filters)}reset_chart(){this.save_chart_config_for_user(null,1),this.chart_settings={},this.filters=null,this.selected_time_interval=null,this.selected_timespan=null,this.selected_heatmap_year=null}save_chart_config_for_user(e,t=0){Object.assign(this.chart_settings,e),frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.save_chart_config",{reset:t,config:this.chart_settings,chart_name:this.chart_doc.chart_name})}create_filter_group_and_add_filters(){this.filter_group=new frappe.ui.FilterGroup({doctype:this.chart_doc.document_type,parent_doctype:this.chart_doc.parent_document_type,filter_button:this.filter_button,on_change:()=>{this.filters=this.filter_group.get_filters(),this.save_chart_config_for_user({filters:this.filters}),this.fetch_and_update_chart()}}),this.filters&&frappe.model.with_doctype(this.chart_doc.document_type,()=>{this.filter_group.add_filters_to_filter_group(this.filters)})}set_chart_actions(e){this.chart_actions=$(`<div class="chart-actions dropdown pull-right">
			<button data-toggle="dropdown"
				aria-haspopup="true"aria-expanded="false"
				class="btn btn-xs btn-secondary chart-menu"
			>
				<svg class="icon icon-sm">
					<use href="#icon-dot-horizontal">
					</use>
				</svg>
			</button>
			<ul class="dropdown-menu dropdown-menu-right">
				${e.map(t=>`<li><a class="dropdown-item" data-action="${t.action}">${t.label}</a></li>`).join("")}
			</ul>
		</div>
		`),this.chart_actions.find("a[data-action]").each((t,i)=>{let s=i.dataset.action;$(i).click(e.find(o=>o.action===s))}),this.chart_actions.appendTo(this.action_area)}fetch(e,t=!1,i){let s=this.settings.method;return this.chart_doc.chart_type=="Report"?i={report_name:this.chart_doc.report_name,filters:e,ignore_prepared_report:1}:i={chart_name:this.chart_doc.name,filters:e,refresh:t?1:0,time_interval:i&&i.time_interval?i.time_interval:null,timespan:i&&i.timespan?i.timespan:null,from_date:i&&i.from_date?i.from_date:null,to_date:i&&i.to_date?i.to_date:null,heatmap_year:i&&i.heatmap_year?i.heatmap_year:null},frappe.xcall(s,i)}async get_source_doctype(){if(this.chart_doc.document_type)return this.chart_doc.document_type;if(this.chart_doc.chart_type=="Report"&&this.chart_doc.report_name)return await frappe.db.get_value("Report",this.chart_doc.report_name,"ref_doctype").then(e=>e.message.ref_doctype)}async render(){let e=()=>{let t=this.get_chart_args();this.dashboard_chart?this.dashboard_chart.update(this.data):this.dashboard_chart=frappe.utils.make_chart(this.chart_wrapper[0],t)};!this.data||!this.data.labels||!Object.keys(this.data).length?(this.chart_wrapper.hide(),this.loading.hide(),this.$summary&&this.$summary.hide(),this.empty.show()):(this.loading.hide(),this.empty.hide(),this.chart_wrapper.show(),this.chart_doc.document_type=await this.get_source_doctype(),this.chart_doc.document_type?frappe.model.with_doctype(this.chart_doc.document_type,e):e(),this.width=="Full"&&this.summary&&this.set_summary(),this.chart_doc.type=="Heatmap"&&this.render_heatmap_legend())}get_chart_args(){var u,g;let e=this.get_chart_colors(),t,i,s={Line:"line",Bar:"bar",Percentage:"percentage",Pie:"pie",Donut:"donut",Heatmap:"heatmap"},o=["Pie","Donut"].includes(this.chart_doc.type)?6:9,a={data:this.data,type:s[this.chart_doc.type],colors:e,height:this.height,maxSlices:this.chart_doc.number_of_groups||o,axisOptions:{xIsSeries:this.chart_doc.timeseries,shortenYAxisNumbers:1}};if(this.chart_doc.document_type){let _=frappe.get_meta(this.chart_doc.document_type).fields.find(m=>m.fieldname==this.chart_doc.value_based_on);t=_==null?void 0:_.fieldtype,i=_==null?void 0:_.options}if(this.chart_doc.chart_type=="Report"&&((g=(u=this.report_result)==null?void 0:u.chart)==null?void 0:g.fieldtype)&&(t=this.report_result.chart.fieldtype,i=this.report_result.chart.options),a.tooltipOptions={formatTooltipY:b=>frappe.format(b,{fieldtype:t,options:i},{always_show_decimals:!0,inline:!0})},this.chart_doc.type=="Heatmap"){let b=parseInt(this.selected_heatmap_year||this.chart_settings.heatmap_year||this.chart_doc.heatmap_year);a.data.start=new Date(`${b}-01-01`),a.data.end=new Date(`${b+1}-01-01`)}let h=b=>{let _=JSON.parse(b);for(let m in _)typeof a[m]=="object"&&typeof _[m]=="object"?a[m]=Object.assign(a[m],_[m]):a[m]=_[m]};return this.custom_options&&h(this.custom_options),this.chart_doc.custom_options&&h(this.chart_doc.custom_options),a}get_chart_colors(){let e=[];return this.chart_doc.y_axis.length?this.chart_doc.y_axis.map(t=>{e.push(t.color)}):["Line","Bar"].includes(this.chart_doc.type)?e=[this.chart_doc.color||[]]:this.chart_doc.type=="Heatmap"&&(e=[]),e}render_heatmap_legend(){let e,t=i=>{e=JSON.parse(i).colors};this.custom_options&&t(this.custom_options),this.chart_doc.custom_options&&t(this.chart_doc.custom_options),!this.$heatmap_legend&&this.widget.width()>991&&(this.$heatmap_legend=$(`
				<div class="heatmap-legend">
					<ul class="legend-colors">
						<li style="background-color: ${e[0]||"#ebedf0"}"></li>
						<li style="background-color: ${e[1]||"#c6e48b"}"></li>
						<li style="background-color: ${e[2]||"#7bc96f"}"></li>
						<li style="background-color: ${e[3]||"#239a3b"}"></li>
						<li style="background-color: ${e[4]||"#196127"}"></li>
					</ul>
					<div class="legend-label">
						<div style="margin-bottom: 45px">${__("Less")}</div>
						<div>${__("More")}</div>
					</div>
				</div>
				`),this.body.append(this.$heatmap_legend))}update_last_synced(){if(!this.chart_doc.last_synced_on)return;let e=__("Last synced {0}",[comment_when(this.chart_doc.last_synced_on)]);this.subtitle_field.html(e)}update_chart_object(){frappe.db.get_doc("Dashboard Chart",this.chart_doc.name).then(e=>{this.chart_doc=e,this.update_last_synced()})}prepare_chart_object(){return this.chart_doc.type=="Heatmap"&&!this.chart_doc.heatmap_year&&(this.chart_doc.heatmap_year=frappe.dashboard_utils.get_year(frappe.datetime.now_date())),this.set_chart_filters()}set_chart_filters(){let e=this.chart_settings.filters||null,t=frappe.dashboard_utils.get_all_filters(this.chart_doc);return this.chart_doc.chart_type=="Report"?frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(i=>{t=this.update_default_date_filters(i,t),this.filters=frappe.utils.parse_array(e)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(t)}):(this.filters=frappe.utils.parse_array(e)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(t),Promise.resolve())}update_default_date_filters(e,t){return e&&e.map(i=>{["Date","DateRange"].includes(i.fieldtype)&&i.default&&(i.reqd||t[i.fieldname])&&(t[i.fieldname]=i.default)}),t}get_settings(){return frappe.model.with_doc("Dashboard Chart",this.chart_name).then(e=>{if(e)if(this.chart_doc=e,this.chart_doc.chart_type=="Custom"){if(frappe.dashboards.chart_sources[this.chart_doc.source])return this.settings=frappe.dashboards.chart_sources[this.chart_doc.source],Promise.resolve();{let t="frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config";return frappe.xcall(t,{name:this.chart_doc.source}).then(i=>{frappe.dom.eval(i),this.settings=frappe.dashboards.chart_sources[this.chart_doc.source]})}}else return this.chart_doc.chart_type=="Report"?(this.settings={method:"frappe.desk.query_report.run"},Promise.resolve()):(this.settings={method:"frappe.desk.doctype.dashboard_chart.dashboard_chart.get"},Promise.resolve())})}};var ii=class extends Ye{set_chart_title(){this.label=__(this.label||this.name),super.set_chart_title()}};frappe.widget.widget_factory.chart=ii;frappe.dashboard_utils.render_chart_filters=function(r,e,t,i){r.forEach(s=>{let o="",a="";s.icon&&(o=frappe.utils.icon(s.icon)),s.class&&(a=s.class);let h=`<div class="${e} ${a} btn-group dropdown pull-right">
					<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<button class="btn btn-secondary btn-xs">
			 				${o}
							<span class="filter-label">${__(s.label)}</span>
							${frappe.utils.icon("select","xs")}
						</button>
				</a>`,u;s.fieldnames?u=s.options.map((_,m)=>`<li>
						<a class="dropdown-item" data-fieldname="${s.fieldnames[m]}" selected_item="${_}">${__(_)}</a>
					</li>`).join(""):u=s.options.map(_=>`<li><a class="dropdown-item" selected_item="${_}">${__(_)}</a></li>`).join("");let g=h+`<ul class="dropdown-menu">${u}</ul></div>`,b=$(g);i?b.prependTo(t):b.appendTo(t),b.find(".dropdown-menu").on("click","li a",_=>{let m=$(_.currentTarget),v;m.attr("data-fieldname")&&(v=m.attr("data-fieldname"));let y=m.attr("selected_item");m.parents(`.${e}`).find(".filter-label").text(__(y)),s.action(y,v)})})};frappe.ui.Page=class extends frappe.ui.Page{add_auto_select(e,t,i){return this.add_field({label:e,fieldtype:"Autocomplete",options:t,change:i}).$wrapper.find("input").empty()}};frappe.search.utils._fuzzy_search=function(r,e){r=r||"";var t=e||"",i=t.replace(/-/g," "),s=t.length,o=r.length,a=o/s,h=3,u=2;if(o>s)return 0;if([t,i].includes(r)||[t,i].some(y=>y.toLowerCase().indexOf(r)===0))return 10+a;if(t.indexOf(r)!==-1&&r!==r.toLowerCase())return 9+a;if(t=t.toLowerCase(),r=r.toLowerCase(),t.indexOf(r)!==-1)return 8+a;var g=0,b=0;e:for(var _=0,m=0;_<o;_++){if(b!==0&&g++,g>h)return 0;var v=r.charCodeAt(_);for(b=0;m<s;){if(t.charCodeAt(m++)===v)continue e;if(++b>u)return 0}return 0}return g+b>0?(5+a)/(g+b):0};frappe.search.utils.fuzzy_search=function(r,e){let t=__(e||""),i=this._fuzzy_search(r,t);return i===0&&frappe.boot.lang!="en"&&(i=this._fuzzy_search(r,e)),i};frappe.ui.form.ControlLink=class extends frappe.ui.form.ControlLink{make_input(){var e=this;$('<div class="link-field ui-front" style="position: relative; line-height: 1;">			<input type="text" class="input-with-feedback form-control data-value">			<span class="link-btn">				<a class="btn-open no-decoration" title="'+__("Open Link")+'">					<i class="octicon octicon-arrow-right"></i></a>			</span>		</div>').prependTo(this.input_area),this.$input_area=$(this.input_area),this.$input=this.$input_area.find("input"),this.$link=this.$input_area.find(".link-btn"),this.$link_open=this.$link.find(".btn-open"),this.set_input_attributes(),this.$input.on("focus",function(){setTimeout(function(){if(e.$input.val()&&e.get_options()){let t=e.get_options(),i=e.doc?e.doc[e.df.fieldname]:e.$input.attr("data-value"),s=i||e.get_input_value();e.$link.toggle(!0),e.$link_open.attr("href",frappe.utils.get_form_link(t,s))}e.$input.val()||e.$input.val("").trigger("input")},500)}),this.$input.on("blur",function(){setTimeout(function(){e.$link.toggle(!1)},500)}),this.$input.attr("data-target",this.df.options),this.input=this.$input.get(0),this.has_input=!0,this.translate_values=!0,this.setup_buttons(),this.setup_awesomeplete()}setup_awesomeplete(){var e=this;this.$input.cache={},this.awesomplete=new Awesomplete(e.input,{minChars:0,maxItems:99,autoFirst:!0,list:[],data:function(t){return{label:t.label||t.value,value:t.value}},filter:function(){return!0},item:function(t){var i=this.get_item(t.value);i.label||(i.label=i.value);var s=e.translate_values?__(i.label):i.label,o=i.html||"<strong>"+s+"</strong>";return i.description&&i.value!==i.description&&(o+='<br><span class="small">'+__(i.description)+"</span>"),$("<li></li>").data("item.autocomplete",i).prop("aria-selected","false").html("<a><p>"+o+"</p></a>").get(0)},sort:function(){return 0},replace:function(t){}}),this.$input.on("input",frappe.utils.debounce(function(t){e.$link.toggle(!1);var i=e.get_options();if(!!i){e.$input.cache[i]||(e.$input.cache[i]={});var s=t.target.value;e.$input.cache[i][s]!=null&&(e.awesomplete.list=e.$input.cache[i][s]);var o={txt:s,doctype:i,ignore_user_permissions:e.df.ignore_user_permissions,reference_doctype:e.get_reference_doctype()||""};e.set_custom_query(o),frappe.call({type:"POST",method:"frappe.desk.search.search_link",no_spinner:!0,args:o,callback:function(a){if(!!e.$input.is(":focus")){if(a.results=e.merge_duplicates(a.results),o.filters){let h=e.get_filter_description(o.filters);if(h){let u=h.replace(/<b>/g,"").replace(/[</b>]/g,"");a.results.push({html:`<span class="text-muted" style="line-height: 1.5" title="${u}">${h}</span>`,value:"",action:()=>{}})}}e.df.only_select||(frappe.model.can_create(i)&&a.results.push({label:"<span class='text-primary link-option'><i class='fa fa-plus' style='margin-right: 5px;'></i> "+__("Create a new {0}",[__(e.get_options())])+"</span>",value:"create_new__link_option",action:e.new_doc}),locals&&locals.DocType&&a.results.push({label:"<span class='text-primary link-option'><i class='fa fa-search' style='margin-right: 5px;'></i> "+__("Advanced Search")+"</span>",value:"advanced_search__link_option",action:e.open_advanced_search})),e.$input.cache[i][s]=a.results,e.awesomplete.list=e.$input.cache[i][s]}}})}},500)),this.$input.on("blur",function(){if(e.selected){e.selected=!1;return}var t=e.get_input_value(),i=e.doc?e.doc[e.df.fieldname]:e.$input.attr("data-value"),s=__(i)!=t?t:i;s!==e.last_value&&e.parse_validate_and_set_in_model(s)}),this.$input.on("awesomplete-open",function(){e.$wrapper.css({"z-index":100}),e.$wrapper.find("ul").css({"z-index":100}),e.autocomplete_open=!0}),this.$input.on("awesomplete-close",function(){e.$wrapper.css({"z-index":1}),e.autocomplete_open=!1}),this.$input.on("awesomplete-select",function(t){var i=t.originalEvent,s=e.awesomplete.get_item(i.text.value);e.autocomplete_open=!1;var o=9;if(t.keyCode===o)return t.preventDefault(),e.awesomplete.close(),!1;s.action&&(s.value="",s.action.apply(e)),e.df.remember_last_selected_value&&(frappe.boot.user.last_selected_values[e.df.options]=s.value),e.parse_validate_and_set_in_model(s.value)}),this.$input.on("awesomplete-selectcomplete",function(t){var i=t.originalEvent;i.text.value.indexOf("__link_option")!==-1&&e.$input.val("")})}get_filter_description(e){let t=this.get_options(),i=[],s=null;if(frappe.model.with_doctype(t,()=>{s=frappe.get_meta(t)}),Array.isArray(e))i=e;else for(let h in e){let u=e[h];Array.isArray(u)||(u=["=",u]),i.push([h,...u])}i=i.map(h=>h.length===3?[t,...h]:h);function o(h){let u=h[0],g=h[1],b=frappe.meta.get_docfield(u,g),_=b?b.label:frappe.model.unscrub(g);b&&b.fieldtype==="Check"&&(h[3]=h[3]?__("Yes"):__("No")),h[3]&&Array.isArray(h[3])&&h[3].length>5&&(h[3]=h[3].slice(0,5),h[3].push("..."));let m=h[3]==null||h[3]===""?__("empty"):h[3];return[__(_).bold(),__(h[2]),(Array.isArray(h[3])?String(m.map(v=>__(v))):String(__(m))).bold()].join(" ")}let a=i.map(o).join(", ");return __("Filters applied for {0}",[a])}set_formatted_input(e){var t=this;t.$input&&t.$input.attr("data-value",e===void 0?"":e),t.$input&&t.$input.val(t.format_for_input(__(e))),super.set_formatted_input(e)}get_value(){let e=this,t=e.doc?e.doc[e.df.fieldname]:e.$input?e.$input.attr("data-value"):void 0,i=t||e.get_input_value();return this.get_status()==="Write"?this.parse?this.parse(i):i:i||this.value||null}};frappe.ui.form.ControlAutocomplete=class extends frappe.ui.form.ControlAutocomplete{setup_awesomplete(){let e=super.setup_awesomplete()||{};return Object.assign(e,{filter:function(t,i){let s=t.value;return __(t.value)!=t.value&&(s+=__(t.value)),Awesomplete.FILTER_CONTAINS(s,i)}})}set_formatted_input(e){var t=this;e&&t.$input&&t.$input.attr("data-value",e===void 0?"":e),e&&t.$input&&t.$input.val(t.format_for_input(__(e)))}get_value(){let e=this,t=e.$input&&e.$input.attr("data-value")?e.$input.attr("data-value"):e.doc?e.doc[e.df.fieldname]:void 0,i=t||e.get_input_value();return this.get_status()==="Write"?this.parse?this.parse(i):i:i||void 0}get_parsed_value(e){let t=this;if(t.doc){let i=t.$input&&t.$input.attr("data-value")?t.$input.attr("data-value"):t.doc?t.doc[t.df.fieldname]:void 0;e=i||t.get_input_value()}else e=super.get_parsed_value(e);return e}};frappe.ui.FieldSelect=class extends frappe.ui.FieldSelect{init(e){super.init(e),this.awesomplete.filter=function(t,i){if(!i)return;let s=t.label+t.value;return Awesomplete.FILTER_CONTAINS(s,i)}}};(function(r){r.fn.add_options=function(t){for(var i=0,s=t.length;i<s;i++){var o=t[i],a=null,h=null;if(!is_null(o)){var u=is_null(o.value),g=is_null(o.label),b=Boolean(o.disabled);if(u&&g)if(o&&typeof o=="string"&&o.includes(";")){let _=o.split(";");a=_[0],h=__(_.slice(-1)[0])}else a=o,h=__(o);else a=u?"":o.value,h=g?__(a):__(o.label)}r("<option>").html(cstr(h)).attr("value",a).prop("disabled",b).appendTo(this)}return this.selectedIndex=0,r(this).trigger("select-change"),r(this)},r.fn.set_working=function(){this.prop("disabled",!0)},r.fn.done_working=function(){this.prop("disabled",!1)};let e=r.fn.val;r.fn.val=function(){let t=e.apply(this,arguments);return arguments.length>0&&r(this).trigger("select-change"),t}})(jQuery);frappe.ui.form.ControlDateRange=class extends frappe.ui.form.ControlDateRange{set_date_options(){super.set_date_options();let e="en";frappe.boot.user&&(e=frappe.boot.user.language),$.fn.datepicker.language[e]&&(this.datepicker_options.language=e)}};frappe.ui.form.ControlTable=class extends frappe.ui.form.ControlTable{make(){super.make(),this.$wrapper.off("paste",":text"),this.$wrapper.on("paste",":text",e=>{let t=this.df.fieldname,i=this.grid,s=i.grid_pagination,o=i.grid_rows,a=i.doctype,h=$(e.target).closest(".grid-row").data("name"),u=$(e.target).closest(".form-in-grid").length,g=frappe.utils.get_clipboard_data(e);if(!g||u)return;let b=frappe.utils.csv_to_array(g,"	");if(b.length===1&&b[0].length===1)return;let _=[];if(this.get_field(b[0][0]))b[0].forEach(y=>{_.push(this.get_field(y))}),b.shift();else{let y=o[0].get_visible_columns(),C=!1;y.forEach(R=>{(C||R.fieldname===$(e.target).data("fieldname"))&&(_.push(R.fieldname),C=!0)})}let m=locals[a][h].idx,v=b.length;return b.forEach((y,C)=>{setTimeout(()=>{if(!!y.filter(Boolean).length){m>this.frm.doc[t].length&&this.grid.add_new_row(),m>1&&(m-1)%s.page_length===0&&s.go_to_page(s.page_index+1);let I=o[m-1].doc.name;y.forEach((N,A)=>{let z=_[A];if(z){if(N){let F=frappe.meta.get_field(a,z).fieldtype;N=F&&F==="Text Editor"?N.replace(/[\n\r]/g,"<br>"):N}frappe.model.set_value(a,I,z,N)}}),m++}if(v>=10){let I=C+1;frappe.show_progress(__("Processing"),I,v,null,!0)}},0)}),!1})}};frappe.provide("frappe.form.formatters");frappe.form.formatters.Datetime=function(r){if(r){var e=moment(frappe.datetime.convert_to_user_tz(r));return frappe.boot.sysdefaults.time_zone&&(e=e.tz(frappe.boot.sysdefaults.time_zone)),e.format(frappe.boot.sysdefaults.date_format.toUpperCase()+" HH:mm:ss")}else return""};frappe.form.formatters.Data=function(r){return r==null?"":__(r)};frappe.form.formatters.MultiSelect=function(r){if(typeof r=="string")return __(r);if(Array.isArray(r))return r.map(e=>__(e))};var Ti=Gi(ki()),yo={headerDropdown:[{label:__("Sort Ascending"),action:function(r){this.sortColumn(r.colIndex,"asc")}},{label:__("Sort Descending"),action:function(r){this.sortColumn(r.colIndex,"desc")}},{label:__("Reset sorting"),action:function(r){this.sortColumn(r.colIndex,"none")}},{label:__("Remove column"),action:function(r){this.removeColumn(r.colIndex)}}]},St=class extends Ti.default{buildOptions(e){super.buildOptions(e),this.options.headerDropdown=[...yo.headerDropdown,...e.headerDropdown]}},vo=class extends frappe.views.QueryReport{render_datatable(){let e=this.data,t=this.columns.filter(i=>!i.hidden);if(this.raw_data.add_total_row&&(e=e.slice(),e.splice(-1,1)),this.$report.show(),this.datatable&&this.datatable.options&&this.datatable.options.showTotalRow===this.raw_data.add_total_row)this.datatable.options.treeView=this.tree_report,this.datatable.refresh(e,t);else{let i={columns:t,data:e,inlineFilters:!0,treeView:this.tree_report,layout:"fixed",cellHeight:33,showTotalRow:this.raw_data.add_total_row,direction:frappe.utils.is_rtl()?"rtl":"ltr",hooks:{columnTotal:frappe.utils.report_column_total}};this.report_settings.get_datatable_options&&(i=this.report_settings.get_datatable_options(i)),this.datatable=new St(this.$report[0],i)}typeof this.report_settings.initial_depth=="number"&&this.datatable.rowmanager.setTreeDepth(this.report_settings.initial_depth),this.report_settings.after_datatable_render&&this.report_settings.after_datatable_render(this.datatable)}};frappe.views.QueryReport=vo;var Co=class extends frappe.views.ReportView{setup_datatable(e){this.$datatable_wrapper.empty(),this.datatable=new St(this.$datatable_wrapper[0],{columns:this.columns,data:this.get_data(e),getEditor:this.get_editing_object.bind(this),checkboxColumn:!0,inlineFilters:!0,cellHeight:35,direction:frappe.utils.is_rtl()?"rtl":"ltr",events:{onRemoveColumn:t=>{this.remove_column_from_datatable(t)},onSwitchColumn:(t,i)=>{this.switch_column(t,i)},onCheckRow:()=>{let t=this.get_checked_items();this.toggle_actions_menu_button(t.length>0)}},hooks:{columnTotal:frappe.utils.report_column_total},headerDropdown:[{label:__("Add Column"),action:t=>{let i=[],s=this.get_columns_for_picker();i=s[this.doctype].filter(a=>!this.is_column_added(a)).map(a=>({label:__(a.label),value:a.fieldname})),delete s[this.doctype];for(let a in s)s[a].filter(h=>!this.is_column_added(h)).map(h=>({label:__(h.label)+` (${a})`,value:h.fieldname+","+a})).forEach(h=>i.push(h));let o=new frappe.ui.Dialog({title:__("Add Column"),fields:[{label:__("Select Column"),fieldname:"column",fieldtype:"Autocomplete",options:i},{label:__("Insert Column Before {0}",[t.docfield.label.bold()]),fieldname:"insert_before",fieldtype:"Check"}],primary_action:({column:a,insert_before:h})=>{if(!i.map(b=>b.value).includes(a)){frappe.show_alert({message:__("Invalid column"),indicator:"orange"}),o.hide();return}let u=this.doctype;a.includes(",")&&([a,u]=a.split(","));let g=t.colIndex;h&&(g=g-1),this.add_column_to_datatable(a,u,g),o.hide()}});o.show()}}]})}};frappe.views.ReportView=Co;var $o=class extends frappe.views.GanttView{get required_libs(){return["assets/erpnext_oob/js/lib/gantt/frappe-gantt.css","assets/erpnext_oob/js/lib/gantt/frappe-gantt.min.js"]}};frappe.views.GanttView=$o;erpnext.stock.StockController.prototype.show_general_ledger=function(){var r=this;this.frm.doc.docstatus>0&&cur_frm.add_custom_button(__("Accounting Ledger"),function(){frappe.route_options={voucher_no:r.frm.doc.name,from_date:r.frm.doc.posting_date,to_date:moment(r.frm.doc.modified).format("YYYY-MM-DD"),company:r.frm.doc.company,show_cancelled_entries:r.frm.doc.docstatus===2},frappe.set_route("query-report","General Ledger")},__("View"))};})();
/**!
 * Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
//# sourceMappingURL=erpnext_oob.bundle.IH3ZL46H.js.map
